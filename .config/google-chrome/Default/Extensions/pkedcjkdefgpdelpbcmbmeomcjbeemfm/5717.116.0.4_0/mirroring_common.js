'use strict';var xg;m("mr.IssueSeverity",{wea:"fatal",Fha:"warning",Nfa:"notification"},void 0);m("mr.IssueAction",{lea:"dismiss",pfa:"learn_more"},void 0);var yg=function(a,b,c){this.routeId=null;this.severity=b;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction=c;this.helpPageId=this.secondaryActions=null};yg.prototype.w9=function(a){this.helpPageId=a;return this};yg.prototype.X$=function(a){this.secondaryActions=a;return this};
yg.prototype.C9=function(a){if(!a&&"fatal"==this.severity)throw Error("All FATAL issues must be blocking.");this.isBlocking=a;return this};var zg=function(a,b){var c=this;this.$o=void 0===b?null:b;this.promise=new Promise(function(b,f){var e=function(a){c.$o=null;f(a)};c.E6=e;a(function(a){c.$o=null;b(a)},e)})};zg.prototype.cancel=function(a){this.E6(a);if(this.$o){var b=this.$o;this.$o=null;setTimeout(function(){return b(a)},0)}};
zg.prototype.jw=function(a,b){b=void 0===b?null:b;var c=this;return new zg(function(e,f){c.promise.then(function(b){if(a)try{e(a(b))}catch(k){f(k)}else e(b)},function(a){if(b)try{e(b(a))}catch(k){f(k)}else f(a)})},function(a){c.cancel(a)})};zg.prototype.then=function(a,b){return this.jw(a,void 0===b?null:b)};zg.prototype.catch=function(a){return this.jw(null,a)};
var Ag=function(a){return new zg(function(b){b(a)})},Bg=function(a){return new zg(function(b,c){c(a)})},Cg=function(a){return new zg(function(b,c){a.then(b,c)})},Dg=function(a,b){var c=!1,e=null;return new zg(function(f,g){a.then(function(a){c||(e=b(a),e.promise.then(f,g))},g)},function(a){e?e.cancel(a):c=!0})};var Eg=function(){return null!=Lb&&-1!=Lb.indexOf("CrOS")},Fg=function(){var a=Lb;if("string"!=typeof a)return!1;a=a.match(/Windows NT \d+.\d+/);if(!(a instanceof Array))return!1;a=a[0];a=a.match(/\d+.\d+/);if(!(a instanceof Array))return!1;a=a[0];return 6.2<=parseFloat(a)},Gg=function(){return Eg()?"ChromeOS":bc?"Windows":ac?"Mac":cc?"Linux":"Other"};var Hg="undefined"!=typeof chrome&&!!chrome.networkingPrivate&&!!chrome.networkingPrivate.setWifiTDLSEnabledState&&Eg(),Ig=Eg()||bc;var Jg=function(a,b,c,e){this.OD=a;this.Yd=b;this.w2=c||null;this.E5=e||null};d=Jg.prototype;d.JI=function(){return"tab"==this.OD};d.FI=function(){return"offscreen_tab"==this.OD};d.PB=function(a){return this.JI()?this.hO():this.FI()?this.Jba():this.Hba(a)};d.hO=function(){var a={audio:this.Yd.shouldCaptureAudio,video:this.Yd.shouldCaptureVideo};this.Yd.shouldCaptureVideo&&(a.videoConstraints={mandatory:{enableAutoThrottling:!0}},this.lM(a.videoConstraints.mandatory));return a};
d.Jba=function(){var a=this.hO();a.presentationId=this.E5;return a};d.Hba=function(a){var b={audio:!1,video:!1};this.Yd.shouldCaptureVideo&&(b.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a}},this.lM(b.video.mandatory));Ig&&this.Yd.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a}});return b};
d.lM=function(a){var b=this.Yd.minWidth,c=this.Yd.minHeight;this.Yd.senderSideLetterboxing&&(c=this.Yd.TG(),b=c.width,c=c.height);Object.assign(a,{minWidth:b,minHeight:c,maxWidth:this.Yd.maxWidth,maxHeight:this.Yd.maxHeight,maxFrameRate:this.Yd.maxFrameRate})};var Kg=function(a){this.ta=a;this.ei=Date.now()};Kg.prototype.zx=function(a,b){null!=b&&(a+="_"+b);return a};Kg.prototype.sm=function(a){this.ta=a};Kg.prototype.end=function(a){Lg(this.zx(this.ta,a),Date.now()-this.ei)};var Lg=function(a,b){0>b&&(Mg.l("Timing analytics event with negative time"),b=0);1E4<b&&(b=1E4);try{chrome.metricsPrivate.recordTime(a,b)}catch(c){Mg.l("Failed to record time "+b+" in "+a)}},Mg=C("mr.Timing"),Ng=function(a){Kg.call(this,a)};ja(Ng,Kg);
Ng.prototype.end=function(a){a=this.zx(this.ta,a);var b=Date.now()-this.ei;if(0>b)Og.l("Timing analytics event with negative time");else{1E4>b&&(b=1E4);18E4<b&&(b=18E4);try{chrome.metricsPrivate.recordMediumTime(a,b)}catch(c){Og.l("Failed to record time "+b+" in "+a)}}};var Og=C("mr.MediumTiming"),Pg=function(a){Kg.call(this,a)};ja(Pg,Kg);
Pg.prototype.end=function(a){a=this.zx(this.ta,a);var b=Date.now()-this.ei;if(0>b)Qg.l("Timing analytics event with negative time");else{18E4>b&&(b=18E4);36E5<b&&(b=36E5);try{chrome.metricsPrivate.recordLongTime(a,b)}catch(c){Qg.l("Failed to record time "+b+" in "+a)}}};
var Qg=C("mr.LongTiming"),Rg=C("mr.Analytics"),Sg=function(a){try{chrome.metricsPrivate.recordUserAction(a)}catch(b){Rg.l("Failed to record event "+a)}},Tg=function(a,b,c){var e,f=0,g;for(g in c)f++,c[g]==b&&(e=g);if(e){c={metricName:a,type:"histogram-linear",min:1,max:f,buckets:f+1};try{chrome.metricsPrivate.recordValue(c,b)}catch(k){Rg.l("Failed to record enum value "+e+" ("+b+") in "+a,k)}}else Rg.error("Unknown analytics value, "+b+" for histogram, "+a,Error())},Ug=function(a,b){try{if(0>b)throw Error("Invalid count for "+
a+": "+b);100<b&&Rg.l("Small count for "+a+" exceeded limits: "+b,Error());chrome.metricsPrivate.recordSmallCount(a,b)}catch(c){Rg.l("Failed to record small count "+a+" ("+b+")",c)}};var Vg={Nda:0,Lda:1,Pda:2,Mda:3,rda:4,Oda:5,Tea:6,iha:7,fea:8,RC:9},Wg=function(a,b){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=b&&9>=b?b:9};ja(Wg,Error);var Xg=function(a){this.zk=a;this.kc=this.Xl=null;this.a=C("mr.mirror.MirrorMediaStream")};d=Xg.prototype;d.ZM=function(a){this.Xl=a};d.start=function(){return this.zk.JI()?this.jba():this.zk.FI()?this.cba():this.aba()};
d.jba=function(){var a=this,b=this.zk.PB();this.a.info("Starting tab capture with constraints "+JSON.stringify(b));return new Promise(function(c,e){chrome.tabCapture.capture(b,function(b){b?(a.qB(b),c(a)):e(a.FE())});window.setTimeout(function(){e(new Wg("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};d.i0=function(a){a&&this.a.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
d.FE=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new Wg(chrome.runtime.lastError.message,7):new Wg("empty_stream",0)};
d.aba=function(){var a=this;return(new Promise(function(a,c){var b=["screen","audio"];"Linux"==Gg()&&b.push("window");var f=chrome.desktopCapture.chooseDesktopMedia(b,a);window.setTimeout(function(){chrome.desktopCapture.cancelChooseDesktopMedia(f);c(new Wg("timeout",1))},6E4)})).then(function(b){if(!b)throw new Wg("User cancelled capture dialog",3);var c=a.zk.PB(b);a.a.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(c)});return new Promise(function(a,b){navigator.webkitGetUserMedia(c,
a,function(a){var c=8;if("PermissionDeniedError"==a.name||"NotAllowedError"==a.name)c=3;b(new Wg(a.name+" "+a.constraintName+": "+a.message,c))})})}).then(function(b){if(b)a.qB(b);else throw new Wg("empty_stream",8);return a})};d.cba=function(){var a=this,b=this.zk.PB();this.a.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(b)});return new Promise(function(c,e){chrome.tabCapture.captureOffscreenTab(a.zk.w2.toString(),b,function(b){b?(a.qB(b),c(a)):e(a.FE())})})};
d.qB=function(a){var b=this;this.kc=a;a.getTracks().forEach(function(a){a.onended=b.i0.bind(b)})};d.stop=function(){this.kc&&(this.kc.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.kc=null,this.Xl&&this.Xl())};var Yg,Zg={vfa:0,Qda:1,Rda:2,hea:3,iea:4,Bea:5,Uea:6,ufa:7,Ffa:8,Gfa:9,xga:10,Nga:11,Oga:12,Xga:13,hha:14},$g=function(a){void 0==Yg&&(Tg("MediaRouter.Provider.WakeEvent",a,Zg),Yg=a)};var ch=function(a){return ah(a)||bh(a)},dh=function(a){if(!Ca(a,"http:")&&!Ca(a,"https:"))return!1;var b=document.createElement("a");b.href=a;return"http:"!=b.protocol&&"https:"!=b.protocol?!1:-1==b.hash.indexOf("__castAppId__")},eh=["https://docs.google.com"],ah=function(a){return Ca(a,"urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},bh=function(a){return"urn:x-org.chromium.media:source:desktop"==a};var fh=function(a){return(new Promise(function(b){chrome.tabs.get(a,b)})).then(function(b){if(!b)throw Error("No such tab "+a);return b})};var gh=function(){},lh=function(a){hh.info("Loading module "+a);var b=ih.get(a)||null;if(b)return Promise.resolve(b);b=jh.get(a);b||(b=new zc,jh.set(a,b),kh(a,b));return b.promise},kh=function(a,b){var c=mh.get(a)||null;if(!c)b.reject(Error("No corresponding bundle for "+a));else if(!nh.has(c)){var e=oh.get(c);e||(hh.info("Loading bundle "+c+" for module "+a),e=ph(c),oh.set(c,e));e.catch(function(a){b.reject(a)})}},ph=function(a){var b=new zc;b.promise.then(function(){hh.info("Bundle "+a+" loaded")},
function(b){hh.error("Failed to load bundle "+a);throw b;});var c=document.createElement("script");c.src=chrome.extension.getURL(a);c.setAttribute("type","text/javascript");c.async=!0;c.onload=function(){return b.resolve(void 0)};c.onerror=function(){return b.reject(Error("Failed to load bundle "+a))};document.head.appendChild(c);return b.promise},qh=function(a,b){if(ih.has(a))throw Error("Duplicate module "+a);ih.set(a,b);(a=jh.get(a))&&a.resolve(b)};
gh.prototype.handleEvent=function(a,b){for(var c=1;c<arguments.length;++c);throw Error("Not implemented");};
var mh=new Map([["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.discovery.CloudSinkDiscoveryService","background_script.js"],["mr.dial.SinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService","mirroring_webrtc.js"]]),nh=new Set(["background_script.js"]),hh=C("mr.Module"),ih=new Map,jh=new Map,
oh=new Map;var rh=chrome.i18n.getMessage("545449835455981095");var sh=function(a,b){this.l8=a;this.jt=b||null;this.ef=this.Ga=null;this.m=C("mr.mirror.Service."+a);this.Dz=u(this.g0,this);this.Do=!1};ja(sh,gh);d=sh.prototype;d.uc=function(a){this.Do||(this.jt=a,this.Do=!0,this.VE())};d.VE=function(){};d.getName=function(){return this.l8};
d.Up=function(a,b,c,e,f){var g=this;this.m.info("Start mirroring on route "+a.id);return this.Do?Cg(this.cF(b,a.Fe.tabId).then(function(){return g.RN()}).then(function(){var a=th(b,c,e);return(new Xg(a)).start()}).then(function(b){g.ef=b;b.ZM(function(){g.Xl(b)});return f?f(a).promise:a}).then(function(a){if(g.Ga)throw new Wg("Cannot start multiple sessions");g.Ga=g.jr(c,a);return g.Ga.start(g.ef.kc)}).then(function(){ah(b)&&!chrome.tabs.onUpdated.hasListener(g.Dz)&&chrome.tabs.onUpdated.addListener(g.Dz);
return g.KK(a,b,c)}).then(null,function(a){g.wK(a);return g.eh().then(function(){throw a;})})):Bg(Error("Not initialized"))};d.Qu=function(a,b,c,e,f,g){this.m.info("Update mirroring on route "+a.id);return this.Do?Cg(this.cF(b,f).then(this.iU.bind(this,a,b,c,e,g))):Bg(Error("Not initialized"))};d.cF=function(a,b){return ah(a)?b?fh(b).then(function(a){if(!a.active)throw new Wg("Tab to be mirrored is not active",7);}):Promise.reject(new Wg("BUG: Tab ID is required.")):Promise.resolve()};
d.iU=function(a,b,c,e,f){var g=this;if(!this.Ga)return Promise.reject(new Wg("No session to update streams on",7));if(!this.Ga.YN())return Promise.reject(new Wg("Session does not support updating stream",7));var k=!1;return Promise.resolve().then(function(){var a=th(b,c,e);return(new Xg(a)).start()}).then(function(b){var c=g.ef;g.ef=b;b.ZM(u(g.Xl,g,b));k=!0;c.stop();return f?f(a).promise:a}).then(function(a){if(!g.Ga)throw new Wg("Session ended while updating stream");g.Ga.R$(a);return g.Ga.AO(g.ef.kc)}).then(this.KK.bind(this,
a,b,c)).then(null,function(a){g.wK(a);if(k)return g.eh().then(function(){throw a;});throw a;})};
d.KK=function(a,b,c){var e=this;return new Promise(function(f,g){if(e.Ga)if(ah(b))e.Ga.qca(a.Fe.tabId).then(function(){e.Ga.Wt();e.Nt();f(e.Ga.Ya)},function(a){e.m.error("Failed to obtain initial tab info.",a);g(a)});else{if(dh(b)){var k="Capturing "+a.mediaSource;e.Ga.hB(k,k,null);e.Ga.Wt();e.jA()}else e.Ga.hB("Capturing Desktop","Capturing Desktop",null),e.Ga.Wt(),e.Jt();e.ES(c,e.ef);f(e.Ga.Ya)}else g(new Wg("Session gone before executing post-startup steps",7))})};
d.wK=function(a){a.reason=null!=a.reason?a.reason:9;this.m.error("Failed to start mirroring: "+a.message+",  reason = "+a.reason+": "+a.stack);this.Lt(a.reason)};d.Xl=function(a){this.ef==a&&(this.Mt(),this.eh())};d.RN=function(){var a=this;return this.Do?this.eh().then(function(b){b&&a.Kt();return b}):Promise.reject("Not initialized")};
d.eh=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.Dz);this.ef&&(this.ef.stop(),this.ef=null);if(!this.Ga)return Promise.resolve(!1);var b=this.Ga;this.Ga=null;return this.Qv(b).catch(function(b){return a.m.error("Error in before-cleanup steps",b)}).then(function(){return b.stop()}).catch(function(b){return a.m.error("Error stopping session",b)}).then(function(){a.jt.xz(b.Ya.id)}).catch(function(b){return a.m.error("Error in ended callbacks",b)}).then(function(){return!0})};
d.Qv=function(){return Promise.resolve()};d.g0=function(a,b,c){$g(14);this.Ga&&this.Ga.tabId&&this.Ga.tabId==a&&("complete"==b.status||b.favIconUrl&&"complete"==c.status)&&(this.Ga.BO(c),this.jt.hK(this.Ga.Ya),this.Ga.Wt())};var th=function(a,b,c){if(ah(a))return new Jg("tab",b);if(bh(a))return new Jg("desktop",b);if(dh(a)){if(!c)throw new Wg("Missing offscreen tab presentation id");return new Jg("offscreen_tab",b,a,c)}throw new Wg("Source URN does not suggest a known capture type.");};d=sh.prototype;
d.ES=function(a,b){a.shouldCaptureAudio&&b.kc&&!b.kc.getAudioTracks().length&&this.jt.ng().send(new yg(rh,"notification","dismiss"))};d.jr=function(){};d.Nt=function(){};d.Jt=function(){};d.jA=function(){};d.Kt=function(){};d.Lt=function(){};d.Mt=function(){};d.Fg=function(){return Promise.reject("Not implemented")};var uh=function(a){this.Ya=a;this.Cs=!1;this.tabId=this.pA=this.iconUrl=null};d=uh.prototype;d.hB=function(a,b,c){this.Ya.description=a;this.Cs||this.Ya.offTheRecord?this.iconUrl=this.pA=null:(this.pA=b,this.iconUrl=c)};d.Wt=function(){this.Cs||this.Ya.offTheRecord||this.TL()};d.qca=function(a){this.tabId=a;return fh(a).then(this.BO.bind(this))};d.BO=function(a){this.Cs=a.incognito;this.hB(a.title,Ca(a.url,"file://")?"Local content (Tab)":Bc(a.url.match(Ac)[3]||null,!0)+" (Tab)",a.favIconUrl)};
d.R$=function(a){this.Ya=a};d.start=function(){};d.YN=function(){return!1};d.AO=function(){};d.stop=function(){return Promise.resolve()};d.TL=function(){};var wh=function(){var a=this;this.maxWidth=1920;this.maxHeight=1080;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.maxLatencyMillis=800;this.animatedLatencyMillis=this.minLatencyMillis=400;this.dscpEnabled=ac||cc||Eg()||Fg();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;var b=window.localStorage?window.localStorage.getItem(vh):null;if(b)try{var c=
JSON.parse(String(b));if(c instanceof Object)this.EO(c),C("mr.mirror.Settings").l(function(){return"Initial mr.mirror.Settings overridden to: "+a.Ju()});else throw Error("localStorage["+vh+"] does not parse as an Object: "+b);}catch(e){throw C("mr.mirror.Settings").error(vh+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',e),Error("Overrides not parseable.  See ERROR log for details.");}};d=wh.prototype;d.clone=function(){var a=new wh;a.EO(this);return a};
d.Ju=function(){return JSON.stringify(this,function(a,b){if(0==a.length||!a.endsWith("_"))return b})};d.EO=function(a){for(var b=ia(Object.keys(a)),c=b.next();!c.done;c=b.next())c=c.value,c.endsWith("_")||typeof a[c]!==typeof this[c]||(this[c]=a[c])};d.mJ=function(){this.LS();Object.freeze(this)};
d.LS=function(){var a=screen.width,b=screen.height;this.maxHeight*a<this.maxWidth*b?(a=Math.min(this.maxWidth,a),a-=a%160,b=90*a/160):(b=Math.min(this.maxHeight,b),b-=b%90,a=160*b/90);if(a<Math.max(160,this.minWidth)||b<Math.max(90,this.minHeight))a=Math.max(160,this.minWidth),b=Math.max(90,this.minHeight);this.maxWidth=a;this.maxHeight=b};
d.TG=function(){if(this.l2())return{width:this.minWidth,height:this.minHeight};for(var a=this.maxWidth,b=this.maxHeight;0!=b;)var c=a%b,a=b,b=c;b=this.maxWidth/a;a=this.maxHeight/a;if(b<this.minWidth||a<this.minHeight)if(c=Math.max(this.minWidth/b,this.minHeight/a),b*=c,a*=c,b>this.maxWidth||a>this.maxHeight)b=this.maxWidth,a=this.maxHeight;b=Math.round(b);a=Math.round(a);return{width:b,height:a}};
d.l2=function(){return 0==this.minHeight||0==this.maxHeight?!1:Math.floor(100*this.minWidth/this.minHeight)==Math.floor(100*this.maxWidth/this.maxHeight)};var vh="mr.mirror.Settings.Overrides";var xh=function(a,b){this.type=a;this.data=b},yh=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new xh(a.type,a.data)},zh=function(a,b,c,e){this.description=a;this.settings=b||null;this.mediaConstraints=c||null;this.presentationUrl=e||null};var Bh=function(a,b){this.a=C("cv2.PeerConnection");this.a2=Ah;this.I=this.uT(b);this.Ew=this.oT(a);this.rU=!0;this.$L=new zc;this.OA=!1;this.ot=0;this.ws=null;this.VI=this.oz=0;this.bd=!1;this.ZJ=this.$J=this.rz=this.iK=this.R2=n};d=Bh.prototype;d.WM=function(a){this.rz=a};d.VM=function(a){this.$J=a};d.UM=function(a){this.ZJ=a};d.YM=function(a){this.iK=a};d.XM=function(a){this.Ew.onmessage=function(b){a(b.data)}};d.Es=function(){return this.bd};
d.yY=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);return b};d.uT=function(a){var b=this.yY(a);a=new webkitRTCPeerConnection(b);a.onicecandidate=u(this.uz,this);a.Bpa=u(this.l3,this);a.oniceconnectionstatechange=u(this.k3,this);this.a.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(b)});return a};d.oT=function(a){return this.I.createDataChannel(a,{reliable:!1})};d.W7=function(a){"string"==typeof a?this.Ew.send(a):this.Ew.send(JSON.stringify(a))};
d.start=function(){this.bd||(this.bd=!0,this.zn())};d.stop=function(){this.a.info("Stopping peer connection...");this.bd&&(this.bd=!1,"closed"!=this.I.signalingState&&this.I.close());this.I=null};d.addStream=function(a){this.I.addStream(a)};d.removeStream=function(a){this.bd&&this.I.removeStream(a)};d.zn=function(){var a=this;this.a.info("Sending offer to peer.");this.oz=Date.now();this.I.createOffer(u(this.HM,this),function(b){a.a.l("Error creating offer.",b)},this.a2);this.$L.promise.then(function(b){a.iK(b)})};
d.HM=function(a){var b=this;this.a.info(function(){return"Setting local description: "+JSON.stringify(a)});this.I.setLocalDescription(a,function(){b.a.info("Local description set successfully")},function(a){b.a.l("Error setting local description.",a)})};d.eV=function(a){return{type:a.type,sdp:a.sdp}};
d.setRemoteDescription=function(a){var b=this;this.a.v(function(){return"<===: "+JSON.stringify(a)});var c=new RTCSessionDescription(a);this.a.info(function(){return"Setting remote description: "+JSON.stringify(c)});this.I.setRemoteDescription(c,function(){b.a.info("Remote description set successfully.")},function(a){b.a.l("Error setting remote description.",a)})};
d.uz=function(a){var b=this;a.candidate?(this.ot++,this.VI=Date.now(),1==this.ot?this.ws=Zd(function(){b.a.info("ICE candidate gathering timed out.");b.ws=null;b.DA()},5E3):this.OA&&this.a.l("Received ICE candidate after resolving session description.")):(this.a.info("End of ICE candidates."),Lg("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.oz),this.DA(),0<this.ot&&Lg("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.VI-this.oz))};
d.l3=function(){"completed"==this.I.iceGatheringState&&this.DA()};d.DA=function(){$d(this.ws);this.ws=null;this.OA||(this.a.info("Resolving sesion description after gathering "+this.ot+" ICE candidates."),this.$L.resolve(this.eV(this.I.localDescription)),this.OA=!0)};
d.k3=function(a){var b=this;if(this.I){var c=this.I.iceConnectionState;this.a.info("New ICE connection state: "+c+".");"connected"==c?this.rz("iceconnected"):"completed"==c?this.rz("icecompleted"):"failed"==c?(this.a.l(function(){return"Ice connection failed: "+JSON.stringify(a)}),this.$J("icefailed")):"closed"==c?this.ZJ("iceclosed"):"disconnected"==c&&(this.a.l("Ice connection state is bad."),this.rU&&this.Es()?(this.a.info("Restarting ICE."),this.I.createOffer(u(this.HM,this),function(a){b.a.l("Error creating new offer.",
a)},Ch)):this.R2())}};var Ah={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},Ch={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};n.SN=window.localStorage;
var Dh=0,Fh=function(a){return(a=window.localStorage.getItem(Eh(a,!1)))?JSON.parse(a):null},Gh=function(a){return(a=window.localStorage.getItem(Eh(a,!0)))?JSON.parse(a):null},Ih=function(a){if(Hh.has(a.oa()))throw Error("Duplicate instance name "+a.oa());Hh.set(a.oa(),a);a.Wa()},Oh=function(a){for(var b=0,c=ia(Object.keys(n.SN)),e=c.next();!e.done;e=c.next()){var e=e.value,f=e.length+window.localStorage.getItem(e).length;e.startsWith("mr.")?Dh+=f:b+=f}Jh=a;(window.localStorage.getItem("version")&&window.localStorage.getItem("version")!==
chrome.runtime.getManifest().version||Kh(a))&&Lh();Mh.info("initialize: "+Dh+" bytes used, "+b+" other bytes");chrome.runtime.onSuspend.addListener(Nh)},Jh=null,Mh=C("mr.PersistentDataManager"),Hh=new Map,Eh=function(a,b){return"mr."+(b?"persistent.":"temp.")+a.oa()},Kh=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},Nh=function(){Mh.info("onSuspend");Ph("version",chrome.runtime.getManifest().version);Jh&&Ph("mrInstanceId",Jh);Hh.forEach(Qh)},
Qh=function(a){var b=a.getData();b&&void 0!=b[0]&&Ph(Eh(a,!1),JSON.stringify(b[0]));b&&void 0!=b[1]&&Ph(Eh(a,!0),JSON.stringify(b[1]))},Ph=function(a,b){var c;c=window.localStorage.getItem(a);c=void 0!=c?b.length-c.length:a.length+b.length;52E5<=Dh+c&&(Mh.l("Unable to write "+c+" bytes"),Lh());52E5<=Dh+c?Mh.error("Unable to write "+c+" bytes after clearing temporary"):(window.localStorage.setItem(a,b),Dh+=c)},Lh=function(){for(var a=ia(Object.keys(n.SN)),b=a.next();!b.done;b=a.next())b=b.value,b.startsWith("mr.temp.")&&
(Dh-=b.length+window.localStorage.getItem(b).length,delete window.localStorage[b]);Mh.info("removeTemporary_: "+Dh+" bytes used")};var Rh=B("Firefox"),Sh=Pb()||B("iPod"),Th=B("iPad"),Uh=B("Android")&&!(Ob()||B("Firefox")||B("Opera")||B("Silk")),Vh=Ob(),Wh=B("Safari")&&!(Ob()||B("Coast")||B("Opera")||B("Edge")||B("Silk")||B("Android"))&&!(Pb()||B("iPad")||B("iPod"));var Xh=function(a){this.pba=a;this.Sl=1E3*Math.floor(1E6*Math.random())};d=Xh.prototype;d.tU=function(){Ih(this)};d.ds=function(){var a=this.Sl++;0==a&&(a=this.Sl++);return a};d.oa=function(){return"IdGenerator."+this.pba};d.getData=function(){return[this.Sl]};d.Wa=function(){var a=Fh(this);a&&(this.Sl=a)};var Yh=function(a){return z(a,function(a){a=a.toString(16);return 1<a.length?a:"0"+a}).join("")},Zh=function(a){for(var b=[],c=0,e=0;e<a.length;e++){var f=a.charCodeAt(e);128>f?b[c++]=f:(2048>f?b[c++]=f>>6|192:(55296==(f&64512)&&e+1<a.length&&56320==(a.charCodeAt(e+1)&64512)?(f=65536+((f&1023)<<10)+(a.charCodeAt(++e)&1023),b[c++]=f>>18|240,b[c++]=f>>12&63|128):b[c++]=f>>12|224,b[c++]=f>>6&63|128),b[c++]=f&63|128)}return b};chrome.cast.VERSION=[1,2];m("chrome.cast.VERSION",chrome.cast.VERSION,void 0);chrome.cast.Aca=!0;m("chrome.cast.usingPresentationApi",chrome.cast.Aca,void 0);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};m("chrome.cast.Error",chrome.cast.Error,void 0);chrome.cast.sQ=function(a){this.platform=a;this.packageId=this.url=null};m("chrome.cast.SenderApplication",chrome.cast.sQ,void 0);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};
m("chrome.cast.Image",chrome.cast.Image,void 0);chrome.cast.Volume=function(a,b){this.level=l(a)?a:null;this.muted=l(b)?b:null};m("chrome.cast.Volume",chrome.cast.Volume,void 0);var $h=function(a,b,c,e,f){this.id=a;this.friendlyName=b;this.iconType=void 0===c?"generic":c;this.description=void 0===e?null:e;this.domain=void 0===f?null:f};var ai=function(a,b){this.input=a;this.domain=b};var bi=function(a,b){this.Wg=a;this.Sba=b},ci=new bi("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),di=new bi("https://www.googleapis.com/calendar/v3",""),ei=new bi("https://www.googleapis.com/hangouts/v1",""),fi=new bi("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var gi=function(a,b){this.email=a;this.imageUrl=null!=b?b:null},hi=function(a){this.type=a},ii=function(a,b,c){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=null!=b?b:null;this.flungUrl=null!=c?c:null};ja(ii,hi);
var ji=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},ki={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},li=new ji("_knockingStartWebrtcSession",ki,"viewer"),mi=new ji("_startWebrtcSession",ki),ni=new ji("_stopSession",{},"viewer");var oi=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];for(var e=a,c=ia(c),f=c.next();!f.done;f=c.next()){if(void 0==e||"object"!=typeof e)return;e=e[f.value]}return e};var pi=function(a){return Promise.all(a.map(function(a){return a.then(function(a){return{Mr:!0,value:a}},function(a){return{Mr:!1,reason:a}})}))};var qi=function(){this.mc=-1};var ri={AC:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},oP:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},si=ri,si=ri;var ui=function(a,b){var c=["0"];b=ti[b][0]&7;if(0<b){c.push(".");for(var e=0;e<b;e++)c.push("0")}return a.replace(/0.00/g,c.join(""))},ti={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,
"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.",
"S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd","RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var vi={DC:".",mv:",",IC:"%",vv:"0",TP:"+",KP:"-",GC:"E",JC:"\u2030",nv:"\u221e",PP:"NaN",CC:"#,##0.###",oQ:"#E0",SP:"#,##0%",pP:"\u00a4#,##0.00",sP:"USD"},wi=vi,wi=vi;var xi=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},yi=xi,yi=xi;var zi=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},Ai=zi,Ai=zi;var Bi=function(a,b){this.width=a;this.height=b};d=Bi.prototype;d.clone=function(){return new Bi(this.width,this.height)};d.toString=function(){return"("+this.width+" x "+this.height+")"};d.vR=function(){return this.width*this.height};d.yb=function(){return!this.vR()};d.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};d.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
d.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};d.scale=function(a,b){b=t(b)?b:a;this.width*=a;this.height*=b;return this};var Ci=function(a){this.Tl=0;this.Ll=a||100;this.Wf=[]};d=Ci.prototype;d.add=function(a){var b=this.Wf[this.Tl];this.Wf[this.Tl]=a;this.Tl=(this.Tl+1)%this.Ll;return b};d.get=function(a){a=this.PJ(a);return this.Wf[a]};d.set=function(a,b){a=this.PJ(a);this.Wf[a]=b};d.V=function(){return this.Wf.length};d.yb=function(){return 0==this.Wf.length};d.clear=function(){this.Tl=this.Wf.length=0};d.H=function(){return this.mY(this.V())};
d.mY=function(a){var b=this.V(),c=[];for(a=this.V()-a;a<b;a++)c.push(this.get(a));return c};d.rb=function(){for(var a=[],b=this.V(),c=0;c<b;c++)a[c]=c;return a};d.La=function(a){return a<this.V()};d.Kk=function(a){for(var b=this.V(),c=0;c<b;c++)if(this.get(c)==a)return!0;return!1};d.PJ=function(a){if(a>=this.Wf.length)throw Error("Out of bounds exception");return this.Wf.length<this.Ll?a:(this.Tl+Number(a))%this.Ll};var Di=function(){this.mc=64;this.fa=[];this.aw=[];this.IQ=[];this.wt=[];this.wt[0]=128;for(var a=1;a<this.mc;++a)this.wt[a]=0;this.Mu=this.xl=0;this.reset()};w(Di,qi);Di.prototype.reset=function(){this.fa[0]=1732584193;this.fa[1]=4023233417;this.fa[2]=2562383102;this.fa[3]=271733878;this.fa[4]=3285377520;this.Mu=this.xl=0};
Di.prototype.hh=function(a,b){b||(b=0);var c=this.IQ;if(r(a))for(var e=0;16>e;e++)c[e]=a.charCodeAt(b)<<24|a.charCodeAt(b+1)<<16|a.charCodeAt(b+2)<<8|a.charCodeAt(b+3),b+=4;else for(e=0;16>e;e++)c[e]=a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3],b+=4;for(e=16;80>e;e++){var f=c[e-3]^c[e-8]^c[e-14]^c[e-16];c[e]=(f<<1|f>>>31)&4294967295}a=this.fa[0];b=this.fa[1];for(var g=this.fa[2],k=this.fa[3],p=this.fa[4],q,e=0;80>e;e++)40>e?20>e?(f=k^b&(g^k),q=1518500249):(f=b^g^k,q=1859775393):60>e?(f=b&g|k&(b|g),q=2400959708):
(f=b^g^k,q=3395469782),f=(a<<5|a>>>27)+f+p+q+c[e]&4294967295,p=k,k=g,g=(b<<30|b>>>2)&4294967295,b=a,a=f;this.fa[0]=this.fa[0]+a&4294967295;this.fa[1]=this.fa[1]+b&4294967295;this.fa[2]=this.fa[2]+g&4294967295;this.fa[3]=this.fa[3]+k&4294967295;this.fa[4]=this.fa[4]+p&4294967295};
Di.prototype.update=function(a,b){if(null!=a){l(b)||(b=a.length);for(var c=b-this.mc,e=0,f=this.aw,g=this.xl;e<b;){if(0==g)for(;e<=c;)this.hh(a,e),e+=this.mc;if(r(a))for(;e<b;){if(f[g]=a.charCodeAt(e),++g,++e,g==this.mc){this.hh(f);g=0;break}}else for(;e<b;)if(f[g]=a[e],++g,++e,g==this.mc){this.hh(f);g=0;break}}this.xl=g;this.Mu+=b}};
Di.prototype.digest=function(){var a=[],b=8*this.Mu;56>this.xl?this.update(this.wt,56-this.xl):this.update(this.wt,this.mc-(this.xl-56));for(var c=this.mc-1;56<=c;c--)this.aw[c]=b&255,b/=256;this.hh(this.aw);for(c=b=0;5>c;c++)for(var e=24;0<=e;e-=8)a[b]=this.fa[c]>>e&255,++b;return a};var Ei={ACCEPTED:0,eea:1,TIMEOUT:2},Fi={SUCCESS:0,yP:1},Gi={GQ:0,fQ:1,Jha:2,Pea:3,Oea:4,Bfa:5,TIMEOUT:6,uga:7},Hi={Mea:0,dha:1},Ii={dga:0,rfa:1,zha:2,Hea:3},Ji=function(a){Tg("MediaRouter.Cloud.Knock.Result",a,Ei)},Ki=function(a){Tg("MediaRouter.Cloud.Session.Start",a,Fi)},Li=function(a){Tg("MediaRouter.Cloud.Session.Type",a,Hi)},Mi=function(a){Tg("MediaRouter.Cloud.Device.UserRole",a,Ii)};var Ni=function(a){this.Eb=a;this.id=a.id;this.a=C("mr.cloud.devices.CloudDevice")};d=Ni.prototype;d.isAvailable=function(){if(this.getState().appStatus){var a=this.R0(),b=this.L0(),c=this.$D(864E5);this.a.v("Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}a=this.$D(9E5);this.a.info("Availability for legacy receiver app: "+a);return a};d.$D=function(a){var b=this.zX();return!!(b&&b>Date.now()-a)};d.L0=function(){return"available"==this.getState().appStatus};
d.R0=function(){return"online"==this.Eb.connectionStatus};d.zX=function(){return this.Eb.lastUpdateTimeMs?Number(this.Eb.lastUpdateTimeMs):null};d.rh=function(){return this.getState().settings.receiverName};d.getId=function(){return this.id};d.getState=function(){return this.Eb.state._cloudCast};d.Y0=function(){return this.Eb.invitations?0!=this.Eb.invitations.length:!1};var Oi=function(a,b,c,e,f,g){this.NI=a;this.Bd=b;this.Wk=e||null;this.Nl=c||null;this.Re=f||null;this.Kj=g||null};d=Oi.prototype;d.rh=function(){var a="";this.Re?a=this.Re:this.Nl&&(a=this.Nl);return a};d.getId=function(){return this.NI+"@"+this.Bd};d.getService=function(){return this.Bd};d.sh=function(){return this.Wk};d.merge=function(a){!this.Kj&&a.Kj&&(this.Kj=a.Kj);!this.Re&&a.Re&&(this.Re=a.Re);this.Re&&a.Re&&this.Kj&&(this.Re=a.Re)};var Pi=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},Qi=function(a){this.qb=a};d=Qi.prototype;d.a8=function(a,b,c){var e=this;return this.UL(li,a,b,c,35E3).then(function(a){return e.TH(a)})};d.d8=function(a,b,c){var e=this;return this.UL(mi,a,b,c,23E3).then(function(a){var b=a.state;return"done"==b?(a=e.FK(a),new Pi(b,a.type,new ii(a.sessionDescription))):new Pi(b)})};d.g8=function(a){return this.Gf(a,ni,{})};
d.UL=function(a,b,c,e,f){var g={_webrtcMessage:JSON.stringify(c.presentationUrl?new ii(c.description,null,c.presentationUrl):new ii(c.description))};c.settings&&(g._settings=c.settings.Ju());c.mediaConstraints&&(g._optMediaConstraints=JSON.stringify(c.mediaConstraints));e&&(g._user=JSON.stringify(e));return this.Gf(b,a,g,f)};
d.TH=function(a){var b=this,c=a.state;switch(c){case "done":return Promise.resolve(this.F4(a));case "queued":case "inProgress":return this.Eca(a).then(function(a){return b.TH(a)});default:return Promise.resolve(new Pi(c))}};d.Eca=function(a){var b=this;return new Promise(function(c){var e=setInterval(function(){b.OU(a.id).then(function(a){"queued"!=a.state&&"inProgress"!=a.state&&(clearInterval(e),c(a))})},2E3)})};
d.F4=function(a){a=this.FK(a);return"__cloud_webrtc_session_message__"==a.type?new Pi("done","knocking_cloud_webrtc_session_message",new ii(a.sessionDescription)):new Pi("done",a.type)};d.Gf=function(a,b,c,e){a={deviceId:a,name:"_cloudCast."+b.name,parameters:c,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=this.qb.Ii(ci.Wg,["commands"],b);return this.qb.$g(e,"POST",a)};d.FK=function(a){return a.results&&a.results.results?JSON.parse(a.results.results):null};
d.OU=function(a){a=this.qb.Ii(ci.Wg,["commands",a]);return this.qb.$g(a,"GET")};Qi.$inject=["gapiService"];var Ri=function(a,b,c,e,f){for(var g=[],k=4;k<arguments.length;++k)g[k-4]=arguments[k];var p=this;this.Xk=a;this.ta=b;this.lt=c;this.Ha=e;this.A1=g;this.ul=!1;this.wg=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return p.WT.apply(p,[].concat(ka(b)))}};d=Ri.prototype;d.cR=function(){Ih(this)};d.cU=function(){this.Ha.addListener.apply(this.Ha,[].concat([this.wg],ka(this.A1)))};d.addListener=function(){this.ul||(this.ul=!0,this.cU())};
d.removeListener=function(){this.ul&&(this.Ha.removeListener(this.wg),this.ul=!1)};d.Xu=function(a){for(var b=0;b<arguments.length;++b);return!0};d.WT=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var e=this;$g(this.Xk);if(!this.Xu.apply(this,[].concat(ka(b))))return!1;lh(this.lt).then(function(a){return a.handleEvent.apply(a,[].concat([e.Ha],ka(b)))});return this.Iw()};d.Bl=function(){return this.ul};d.oa=function(){return"mr.EventListener."+this.ta};d.getData=function(){return[this.ul]};
d.Wa=function(){Fh(this)&&this.addListener()};d.Iw=function(){};var Si=function(a){this.qb=a;this.Zk=this.Hl=this.fj=null;this.Gs=this.Ds=!1;this.a=C("mr.cloud.devices.CloudDevicesService");Ih(this)};d=Si.prototype;d.getDevice=function(a){a=this.qb.Ii(ci.Wg,["devices",a]);return this.qb.$g(a,"GET").then(function(a){return new Ni(a)})};d.w1=function(){return this.gJ({descriptionSubstring:"Chrome Streaming Receiver"})};
d.gJ=function(a){var b=this,c=this.qb.Ii(ci.Wg,["devices"],a);return this.qb.$g(c,"GET").then(function(c){var e=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new Ni(a)});if(c=c.nextPageToken){var g=Gb(a);g.token=c;return b.gJ(g).then(function(a){return e.concat(a)})}return e})};d.oa=function(){return"CloudDevicesService"};d.getData=function(){return[new Ti(this.fj,this.Zk,this.Hl)]};
d.Wa=function(){var a=Fh(this);a&&(this.fj=a.s1,this.Zk=a.gcmRegistrationId,this.Hl=a.q1)};d.z6=function(){var a=this;return new Promise(function(b,c){a.Ds?c(Error("Registering...")):(a.Ds=!0,a.Zk&&a.Hl&&a.Hl+864E5>=Date.now()?(a.Ds=!1,b(a.Zk)):chrome.gcm.register(["919648714761"],function(e){a.Ds=!1;e?(a.a.v("Got GCM ID: "+e),a.Zk=e,a.Hl=Date.now(),a.fj=null,b(e)):(a.a.l("Error: "+chrome.runtime.lastError.message),a.Zk=null,a.Hl=null,a.fj=null,c(Error(chrome.runtime.lastError.message)))}))})};
d.Oaa=function(){return!this.fj||this.fj+864E5<Date.now()};d.subscribe=function(a){var b=this;if(this.Gs)return Promise.resolve();this.Gs=!0;if(!a||!this.Oaa())return Promise.resolve();a={filters:["myDevices"],gcmRegistrationId:a,gcmSenderId:"919648714761",expirationTimeMs:864E5};var c=this.qb.Ii(ci.Wg,["subscriptions","subscribe"],{});return this.qb.$g(c,"POST",a).then(function(){b.a.v("Subscribed on: "+Date.now());b.fj=Date.now();b.Gs=!1;return Promise.resolve()},function(a){b.Gs=!1;throw a;})};
var Ti=function(a,b,c){this.s1=a;this.gcmRegistrationId=b;this.q1=c};var Ui=function(){this.Lf=!1;this.Se=null;this.El=!1;this.a=C("mr.cloud.identity.IdentityService");Ih(this);this.y1();this.qN()};d=Ui.prototype;d.S0=function(){return"google.com"==this.KH()};d.i1=function(){return this.El||this.Lf&&!!this.Se&&(-1!=Vi.indexOf(this.Se)||-1!=Vi.indexOf(this.KH()))};d.KH=function(){return this.Se?this.Se.substr(this.Se.indexOf("@")+1):""};
d.getAuthToken=function(){return chrome.identity?new Promise(function(a,b){chrome.identity.getAuthToken({interactive:!1},function(c){chrome.runtime.lastError?b(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==c?b(Error("User is not logged in (no token found)")):a(c)})}):Promise.reject(Error("chrome.identity permission required for auth."))};d.JU=function(a){return new Promise(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})};
d.qN=function(){var a=this;this.getAuthToken().then(function(b){chrome.identity.getProfileUserInfo(function(c){a.Lf=!!c.email||!!c.id;a.Se=c.email||null;b&&!a.Lf&&(a.El=!0)})},function(b){a.a.v("Unable to set sign in and email.",b)})};d.y1=function(){var a=this;chrome.identity.onSignInChanged.addListener(function(b,c){$g(6);a.Lf=c;a.a.info("Signed in change: "+a.Lf);a.Lf?a.qN():(a.Se=null,a.El=!1)})};
d.t6=function(){var a=this;return this.getAuthToken().then(function(b){var c=window.gapi;if(!c)return a.a.error("gapi not loaded."),!1;a.a.info("Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};d.oa=function(){return"IdentityService"};d.getData=function(){return[null,{signedIn:this.Lf,userEmail:this.Se,kioskAuth:this.El}]};d.Wa=function(){var a=Gh(this);a&&(a.signedIn&&(this.Lf=a.signedIn),a.userEmail&&(this.Se=a.userEmail),a.kioskAuth&&(this.El=a.kioskAuth))};var Vi="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var Wi=function(){var a=this;this.a=C("mr.cloud.settings.SettingsService");this.qz=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){$g(13);if(a.qz){b=ia(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.qz.call(null,c.value);break}}})};d=Wi.prototype;d.k$=function(a){this.qz=a};
d.Qba=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&a.l("Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})};d.eW=function(){var a=this;return this.aG().catch(function(){return a.aG().catch(function(b){a.a.l("Error retrieving cloud on setting.",b);return!1})})};d.aG=function(){return this.CG("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})};
d.CG=function(a){return new Promise(function(b,c){chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?c(chrome.runtime.lastError):b(a)})})};d.cW=function(){var a=this;return this.$F().catch(function(){return a.$F().catch(function(b){a.a.l("Error retrieving cloud enabled setting.",b);return!1})})};d.$F=function(){return this.FY("media_router.cloudservices.enabled").then(function(a){return!!a.value})};
d.FY=function(a){return new Promise(function(b,c){chrome.settingsPrivate.getPref(a,function(a){chrome.runtime.lastError?c(chrome.runtime.lastError):b(a)})})};d.j$=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&a.l("Error setting notified Hangout privacy.",chrome.runtime.lastError)})};
d.rY=function(){var a=this;return this.VG().catch(function(){return a.VG().catch(function(b){a.a.l("Error retrieving hangouts notified setting.",b);return!1})})};d.VG=function(){return this.CG("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var Xi=function(){this.te=[];this.af=[]};d=Xi.prototype;d.S1=function(){0==this.te.length&&(this.te=this.af,this.te.reverse(),this.af=[])};d.enqueue=function(a){this.af.push(a)};d.nh=function(){this.S1();return this.te.pop()};d.V=function(){return this.te.length+this.af.length};d.yb=function(){return 0==this.te.length&&0==this.af.length};d.clear=function(){this.te=[];this.af=[]};d.contains=function(a){return fb(this.te,a)||fb(this.af,a)};
d.remove=function(a){var b;b=this.te;var c=Ya(b,a);0<=c?(jb(b,c),b=!0):b=!1;return b||kb(this.af,a)};d.H=function(){for(var a=[],b=this.te.length-1;0<=b;--b)a.push(this.te[b]);for(var c=this.af.length,b=0;b<c;++b)a.push(this.af[b]);return a};var Yi=function(){Ri.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.CloudSinkDiscoveryService",chrome.gcm.onMessage);this.a=C("mr.CloudGcmEventListener")};ja(Yi,Ri);Yi.prototype.Xu=function(a){a=oi(a,"data","notification");if(!a)return this.a.error("Notification json not found"),!1;try{var b=JSON.parse(a);return!!b&&Array.isArray(b.events)&&0<b.events.length}catch(c){return this.a.error("Invalid json: "+a),!1}};var $i=function(){Zi||(Zi=new Yi);return Zi},Zi=null;var aj=function(a,b,c){this.Eo=b||wi.sP;this.IT=c||0;this.at=40;this.Ee=1;this.Zj=0;this.mj=3;this.ht=this.zg=0;this.HN=this.LO=!1;this.kp=this.zj="";this.Lh="-";this.Rl="";this.$d=1;this.qj=!1;this.Wi=[];this.Vu=this.IE=!1;this.vn=0;this.BD=null;"number"==typeof a?this.uR(a):this.sk(a)};d=aj.prototype;d.V9=function(a){if(0<this.Zj&&0<a)throw Error("Can't combine significant digits and minimum fraction digits");this.zg=a;return this};d.Q9=function(a){this.mj=a;return this};
d.faa=function(a){if(0<this.zg&&0<=a)throw Error("Can't combine significant digits and minimum fraction digits");this.Zj=a;return this};d.sk=function(a){a.replace(/ /g,"\u00a0");var b=[0];this.zj=this.xt(a,b);var c=b[0];this.l5(a,b);c=b[0]-c;this.kp=this.xt(a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.$d&&(this.qj=!0),this.Lh=this.xt(a,b),b[0]+=c,this.Rl=this.xt(a,b)):(this.Lh=this.zj+this.Lh,this.Rl+=this.kp)};
d.uR=function(a){switch(a){case 1:this.sk(wi.CC);break;case 2:this.sk(wi.oQ);break;case 3:this.sk(wi.SP);break;case 4:this.sk(ui(wi.pP,this.Eo));break;case 5:this.rD(1);break;case 6:this.rD(2);break;default:throw Error("Unsupported pattern type.");}};d.rD=function(a){this.vn=a;this.sk(wi.CC);this.V9(0);this.Q9(2);this.faa(2)};
d.parse=function(a,b){b=b||[0];if(0!=this.vn)throw Error("Parsing of compact numbers is unimplemented");var c;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.zj,b[0])==b[0],f=a.indexOf(this.Lh,b[0])==b[0];e&&f&&(this.zj.length>this.Lh.length?f=!1:this.zj.length<this.Lh.length&&(e=!1));e?b[0]+=this.zj.length:f&&(b[0]+=this.Lh.length);a.indexOf(wi.nv,b[0])==b[0]?(b[0]+=wi.nv.length,c=Infinity):c=this.V4(a,b);if(e){if(a.indexOf(this.kp,b[0])!=b[0])return NaN;b[0]+=this.kp.length}else if(f){if(a.indexOf(this.Rl,
b[0])!=b[0])return NaN;b[0]+=this.Rl.length}return f?-c:c};
d.V4=function(a,b){var c=!1,e=!1,f=!1,g=1,k=wi.DC,p=wi.mv,q=wi.GC;if(0!=this.vn)throw Error("Parsing of compact style numbers is not implemented");for(var y="";b[0]<a.length;b[0]++){var G=a.charAt(b[0]),T=this.oG(G);if(0<=T&&9>=T)y+=T,f=!0;else if(G==k.charAt(0)){if(c||e)break;y+=".";c=!0}else if(G==p.charAt(0)&&("\u00a0"!=p.charAt(0)||b[0]+1<a.length&&0<=this.oG(a.charAt(b[0]+1)))){if(c||e)break}else if(G==q.charAt(0)){if(e)break;y+="E";e=!0}else if("+"==G||"-"==G)y+=G;else if(1==this.$d&&G==wi.IC.charAt(0)){if(1!=
g)break;g=100;if(f){b[0]++;break}}else if(1==this.$d&&G==wi.JC.charAt(0)){if(1!=g)break;g=1E3;if(f){b[0]++;break}}else break}1!=this.$d&&(g=this.$d);return parseFloat(y)/g};d.format=function(a){if(isNaN(a))return wi.PP;var b=[],c=this.RZ(null===this.BD?a:this.BD,a);a/=Math.pow(10,c.Nw);b.push(c.prefix);var e=0>a||0==a&&0>1/a;b.push(e?this.Lh:this.zj);isFinite(a)?(a=a*(e?-1:1)*this.$d,this.Vu?this.sba(a,b):this.LB(a,this.Ee,b)):b.push(wi.nv);b.push(e?this.Rl:this.kp);b.push(c.WN);return b.join("")};
d.BL=function(a){var b=Math.pow(10,this.mj),c=0>=this.Zj?Math.round(a*b):Math.round(this.C7(a*b,this.Zj,this.mj));isFinite(c)?(a=Math.floor(c/b),b=Math.floor(c-a*b)):b=0;return{tI:a,iV:b}};
d.LB=function(a,b,c){if(this.zg>this.mj)throw Error("Min value must be less than max value");c||(c=[]);a=this.BL(a);var e=Math.pow(10,this.mj),f=a.tI,g=a.iV,k=0==f?0:this.Bs(f)+1,p=0<this.zg||0<g||this.HN&&k<this.Zj;a=this.zg;p&&(a=this.HN&&0<this.Zj?this.Zj-k:this.zg);for(var q="",k=f;1E20<k;)q="0"+q,k=Math.round(k/10);var q=k+q,y=wi.DC,k=wi.vv.charCodeAt(0),G=q.length,T=0;if(0<f||0<b){for(f=G;f<b;f++)c.push(String.fromCharCode(k));if(2<=this.Wi.length)for(b=1;b<this.Wi.length;b++)T+=this.Wi[b];
b=G-T;if(0<b)for(var f=this.Wi,T=G=0,ua,re=wi.mv,nd=q.length,Ec=0;Ec<nd;Ec++){if(c.push(String.fromCharCode(k+1*Number(q.charAt(Ec)))),1<nd-Ec)if(ua=f[T],Ec<b){var xA=b-Ec;(1===ua||0<ua&&1===xA%ua)&&c.push(re)}else T<f.length&&(Ec===b?T+=1:ua===Ec-b-G+1&&(c.push(re),G+=ua,T+=1))}else{b=q;q=this.Wi;f=wi.mv;ua=b.length;re=[];for(G=q.length-1;0<=G&&0<ua;G--){T=q[G];for(nd=0;nd<T&&0<=ua-nd-1;nd++)re.push(String.fromCharCode(k+1*Number(b.charAt(ua-nd-1))));ua-=T;0<ua&&re.push(f)}c.push.apply(c,re.reverse())}}else p||
c.push(String.fromCharCode(k));(this.IE||p)&&c.push(y);e=""+(g+e);for(g=e.length;"0"==e.charAt(g-1)&&g>a+1;)g--;for(f=1;f<g;f++)c.push(String.fromCharCode(k+1*Number(e.charAt(f))))};d.ZC=function(a,b){b.push(wi.GC);0>a?(a=-a,b.push(wi.KP)):this.LO&&b.push(wi.TP);a=""+a;for(var c=wi.vv,e=a.length;e<this.ht;e++)b.push(c);b.push(a)};d.OX=function(a,b){var c=Math.pow(10,b);if(isFinite(c)&&0!==c)return a/c;c=Math.pow(10,Math.floor(b/2));a=a/c/c;1==b%2&&(a=0<b?a/10:10*a);return a};
d.sba=function(a,b){if(0==a)this.LB(a,this.Ee,b),this.ZC(0,b);else{var c=Math.floor(Math.log(a)/Math.log(10)+2E-15);a=this.OX(a,c);var e=this.Ee;if(1<this.at&&this.at>this.Ee){for(;0!=c%this.at;)a*=10,c--;e=1}else 1>this.Ee?(c++,a/=10):(c-=this.Ee-1,a*=Math.pow(10,this.Ee-1));this.LB(a,e,b);this.ZC(c,b)}};d.oG=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=wi.vv.charCodeAt(0);return b<=a&&a<b+10?a-b:-1};
d.xt=function(a,b){for(var c="",e=!1,f=a.length;b[0]<f;b[0]++){var g=a.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==a.charAt(b[0]+1)?(b[0]++,c+="'"):e=!e;else if(e)c+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return c;case "\u00a4":if(b[0]+1<f&&"\u00a4"==a.charAt(b[0]+1))b[0]++,c+=this.Eo;else switch(this.IT){case 0:c+=ti[this.Eo][1];break;case 2:var g=this.Eo,k=ti[g],c=c+(g==k[1]?g:g+" "+k[1]);break;case 1:c+=ti[this.Eo][2]}break;case "%":if(!this.qj&&1!=this.$d)throw Error("Too many percent/permill");
if(this.qj&&100!=this.$d)throw Error("Inconsistent use of percent/permill characters");this.$d=100;this.qj=!1;c+=wi.IC;break;case "\u2030":if(!this.qj&&1!=this.$d)throw Error("Too many percent/permill");if(this.qj&&1E3!=this.$d)throw Error("Inconsistent use of percent/permill characters");this.$d=1E3;this.qj=!1;c+=wi.JC;break;default:c+=g}}return c};
d.l5=function(a,b){for(var c=-1,e=0,f=0,g=0,k=-1,p=a.length,q=!0;b[0]<p&&q;b[0]++)switch(a.charAt(b[0])){case "#":0<f?g++:e++;0<=k&&0>c&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>c&&k++;break;case ",":0<k&&this.Wi.push(k);k=0;break;case ".":if(0<=c)throw Error('Multiple decimal separators in pattern "'+a+'"');c=e+f+g;break;case "E":if(this.Vu)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.Vu=!0;this.ht=0;b[0]+1<p&&"+"==a.charAt(b[0]+
1)&&(b[0]++,this.LO=!0);for(;b[0]+1<p&&"0"==a.charAt(b[0]+1);)b[0]++,this.ht++;if(1>e+f||1>this.ht)throw Error('Malformed exponential pattern "'+a+'"');q=!1;break;default:b[0]--,q=!1}0==f&&0<e&&0<=c&&(f=c,0==f&&f++,g=e-f,e=f-1,f=1);if(0>c&&0<g||0<=c&&(c<e||c>e+f)||0==k)throw Error('Malformed pattern "'+a+'"');a=e+f+g;this.mj=0<=c?a-c:0;0<=c&&(this.zg=e+f-c,0>this.zg&&(this.zg=0));this.Ee=(0<=c?c:a)-e;this.Vu&&(this.at=e+this.Ee,0==this.mj&&0==this.Ee&&(this.Ee=1));this.Wi.push(Math.max(0,k));this.IE=
0==c||c==a};var bj={prefix:"",WN:"",Nw:0};aj.prototype.FH=function(a,b){var c=1==this.vn?si.AC:si.oP;null==c&&(c=si.AC);if(3>a)return bj;a=Math.min(14,a);var e=c[Math.pow(10,a)];for(--a;!e&&3<=a;)e=c[Math.pow(10,a)],a--;if(!e)return bj;b=e[b];return b&&"0"!=b?(b=/([^0]*)(0+)(.*)/.exec(b))?{prefix:b[1],WN:b[3],Nw:a+1-(b[2].length-1)}:bj:bj};
aj.prototype.RZ=function(a,b){if(0==this.vn)return bj;a=Math.abs(a);b=this.FH(1>=a?0:this.Bs(a),"other").Nw;return this.FH(b+this.Bs(this.BL(a/Math.pow(10,b)).tI),"other")};aj.prototype.Bs=function(a){if(!isFinite(a))return 0<a?a:0;for(var b=0;1<=(a/=10);)b++;return b};aj.prototype.C7=function(a,b,c){if(!a)return a;b=b-this.Bs(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};var cj=!Wb&&!Ub||Ub&&9<=Number(pc)||Wb&&oc("1.9.1");Ub&&oc("9");var dj=function(a){this.Jl=[];this.Pz=[];this.mz=new aj(1);this.X4(a)},ej=/'([{}#].*?)'/g,fj=/''/g;d=dj.prototype;d.format=function(a){return this.Kr(a,!1)};d.Kr=function(a,b){if(0==this.Pz.length)return"";var c=[];this.gx(this.Pz,a,b,c);for(a=c.join("");0<this.Jl.length;)a=a.replace(this.bw(this.Jl),this.Jl.pop());return a};
d.gx=function(a,b,c,e){for(var f=0;f<a.length;f++)switch(a[f].type){case 4:e.push(a[f].value);break;case 3:var g=a[f].value;this.hV(g,b,e);break;case 2:g=a[f].value;this.gV(g,b,c,e);break;case 0:g=a[f].value;this.wF(g,b,Ai,c,e);break;case 1:g=a[f].value;this.wF(g,b,yi,c,e);break;default:Va("Unrecognized block type: "+a[f].type)}};d.hV=function(a,b,c){b=b[a];l(b)?(this.Jl.push(b),c.push(this.bw(this.Jl))):c.push("Undefined parameter - "+a)};
d.gV=function(a,b,c,e){var f=a.Gq;l(b[f])?(f=a[b[f]],l(f)||(f=a.other),this.gx(f,b,c,e)):e.push("Undefined parameter - "+f)};d.wF=function(a,b,c,e,f){var g=a.Gq,k=a.tD,p=+b[g];isNaN(p)?f.push("Undefined or invalid parameter - "+g):(k=p-k,g=a[b[g]],l(g)||(c=this.mz.eY?c(k,this.mz.eY()):c(k),g=a[c],l(g)||(g=a.other)),a=[],this.gx(g,b,e,a),b=a.join(""),e?f.push(b):(e=this.mz.format(k),f.push(b.replace(/#/g,e))))};d.X4=function(a){a&&(a=this.E0(a),this.Pz=this.yt(a))};
d.E0=function(a){var b=this.Jl,c=u(this.bw,this);a=a.replace(fj,function(){b.push("'");return c(b)});return a=a.replace(ej,function(a,f){b.push(f);return c(b)})};d.Dr=function(a){var b=0,c=[],e=[],f=/[{}]/g;f.lastIndex=0;for(var g;g=f.exec(a);){var k=g.index;"}"==g[0]?(c.pop(),0==c.length&&(g={type:1},g.value=a.substring(b,k),e.push(g),b=k+1)):(0==c.length&&(b=a.substring(b,k),""!=b&&e.push({type:0,value:b}),b=k+1),c.push("{"))}b=a.substring(b);""!=b&&e.push({type:0,value:b});return e};
var gj=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,hj=/^\s*(\w+)\s*,\s*selectordinal\s*,/,ij=/^\s*(\w+)\s*,\s*select\s*,/;d=dj.prototype;d.t4=function(a){return gj.test(a)?0:hj.test(a)?1:ij.test(a)?2:/^\s*\w+\s*/.test(a)?3:5};
d.yt=function(a){var b=[];a=this.Dr(a);for(var c=0;c<a.length;c++){var e={};if(0==a[c].type)e.type=4,e.value=a[c].value;else if(1==a[c].type)switch(this.t4(a[c].value)){case 2:e.type=2;e.value=this.d5(a[c].value);break;case 0:e.type=0;e.value=this.Y4(a[c].value);break;case 1:e.type=1;e.value=this.W4(a[c].value);break;case 3:e.type=3;e.value=a[c].value;break;default:Va("Unknown block type for pattern: "+a[c].value)}else Va("Unknown part of the pattern.");b.push(e)}return b};
d.d5=function(a){var b="";a=a.replace(ij,function(a,c){b=c;return""});var c={};c.Gq=b;a=this.Dr(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.yt(a[e].value);else Va("Expected block type.");c[f.replace(/\s/g,"")]=g;e++}return c};
d.Y4=function(a){var b="",c=0;a=a.replace(gj,function(a,e,f){b=e;f&&(c=parseInt(f,10));return""});var e={};e.Gq=b;e.tD=c;a=this.Dr(a);for(var f=0;f<a.length;){var g=a[f].value;f++;if(1==a[f].type)var k=this.yt(a[f].value);else Va("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e};
d.W4=function(a){var b="";a=a.replace(hj,function(a,c){b=c;return""});var c={};c.Gq=b;c.tD=0;a=this.Dr(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.yt(a[e].value);else Va("Expected block type.");c[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return c};d.bw=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var jj=chrome.i18n.getMessage("1522140683318860351"),kj=chrome.i18n.getMessage("4246483347873264186"),lj=chrome.i18n.getMessage("5991427458288444010"),mj=chrome.i18n.getMessage("6063910461797960050"),nj=chrome.i18n.getMessage("7735695102441495789"),oj=chrome.i18n.getMessage("4575332923598659024"),pj=chrome.i18n.getMessage("2297080986956220930"),qj=new dj(pj);var rj=null,sj=null,tj=null,uj=Wb||Xb&&!Wh||Tb||!Wh&&!Ub&&"function"==typeof h.atob,wj=function(a,b){vj();b=b?tj:rj;for(var c=[],e=0;e<a.length;e+=3){var f=a[e],g=e+1<a.length,k=g?a[e+1]:0,p=e+2<a.length,q=p?a[e+2]:0,y=f>>2,f=(f&3)<<4|k>>4,k=(k&15)<<2|q>>6,q=q&63;p||(q=64,g||(k=64));c.push(b[y],b[f],b[k],b[q])}return c.join("")},yj=function(a,b){if(uj&&!b)return h.atob(a);var c="";xj(a,function(a){c+=String.fromCharCode(a)});return c},xj=function(a,b){function c(b){for(;e<a.length;){var c=a.charAt(e++),
f=sj[c];if(null!=f)return f;if(!Fa(c))throw Error("Unknown base64 encoding at char: "+c);}return b}vj();for(var e=0;;){var f=c(-1),g=c(0),k=c(64),p=c(64);if(64===p&&-1===f)break;b(f<<2|g>>4);64!=k&&(b(g<<4&240|k>>2),64!=p&&b(k<<6&192|p))}},vj=function(){if(!rj){rj={};sj={};tj={};for(var a=0;65>a;a++)rj[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),sj[rj[a]]=a,tj[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a),62<=a&&(sj["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=
a)}};var zj={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},Aj=function(a){a=a.document;a="CSS1Compat"==a.compatMode?a.documentElement:a.body;return new Bi(a.clientWidth,a.clientHeight)},Bj=function(a){return a?a.parentWindow||a.defaultView:window},Dj=function(a,b,c,e){function f(c){c&&b.appendChild(r(c)?a.createTextNode(c):
c)}for(;e<c.length;e++){var g=c[e];!ra(g)||ta(g)&&0<g.nodeType?f(g):x(Cj(g)?A(g):g,f)}},Ej=function(a){return 9==a.nodeType?a:a.ownerDocument||a.document},Fj=function(a,b){if("textContent"in a)a.textContent=b;else if(3==a.nodeType)a.data=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(var c;c=a.firstChild;)a.removeChild(c);a.appendChild(Ej(a).createTextNode(String(b)))}},Cj=function(a){if(a&&"number"==typeof a.length){if(ta(a))return"function"==
typeof a.item||"string"==typeof a.item;if(sa(a))return"function"==typeof a.item}return!1},Gj=function(a){this.Kn=a||h.document||document};d=Gj.prototype;d.getElementsByTagName=function(a,b){return(b||this.Kn).getElementsByTagName(String(a))};d.setProperties=function(a,b){xb(b,function(b,e){"style"==e?a.style.cssText=b:"class"==e?a.className=b:"for"==e?a.htmlFor=b:zj.hasOwnProperty(e)?a.setAttribute(zj[e],b):Ca(e,"aria-")||Ca(e,"data-")?a.setAttribute(e,b):a[e]=b})};d.createElement=function(a){return this.Kn.createElement(String(a))};
d.createTextNode=function(a){return this.Kn.createTextNode(String(a))};d.getWindow=function(){var a=this.Kn;return a.parentWindow||a.defaultView};d.appendChild=function(a,b){a.appendChild(b)};d.append=function(a,b){Dj(Ej(a),a,arguments,1)};d.canHaveChildren=function(a){if(1!=a.nodeType)return!1;switch(a.tagName){case "APPLET":case "AREA":case "BASE":case "BR":case "COL":case "COMMAND":case "EMBED":case "FRAME":case "HR":case "IMG":case "INPUT":case "IFRAME":case "ISINDEX":case "KEYGEN":case "LINK":case "NOFRAMES":case "NOSCRIPT":case "META":case "OBJECT":case "PARAM":case "SCRIPT":case "SOURCE":case "STYLE":case "TRACK":case "WBR":return!1}return!0};
d.removeNode=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null};d.getChildren=function(a){return cj&&void 0!=a.children?a.children:$a(a.childNodes,function(a){return 1==a.nodeType})};d.isElement=function(a){return ta(a)&&1==a.nodeType};d.contains=function(a,b){if(!a||!b)return!1;if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||!!(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};var Hj=function(a,b){this.Wk=this.Pf=this.Jg="";this.Ia=null;this.Ji=this.Mc="";this.Wd=this.Z0=!1;var c;a instanceof Hj?(this.Wd=l(b)?b:a.Wd,this.nu(a.Jg),this.xB(a.xo()),this.pm(a.sh()),this.um(a.Va()),this.bi(a.Mc),this.ku(a.Cg.clone()),this.eu(a.Ji)):a&&(c=String(a).match(Ac))?(this.Wd=!!b,this.nu(c[1]||"",!0),this.xB(c[2]||"",!0),this.pm(c[3]||"",!0),this.um(c[4]),this.bi(c[5]||"",!0),this.ku(c[6]||"",!0),this.eu(c[7]||"",!0)):(this.Wd=!!b,this.Cg=new Ij(null,null,this.Wd))};d=Hj.prototype;
d.toString=function(){var a=[],b=this.Jg;b&&a.push(Jj(b,Kj,!0),":");var c=this.sh();if(c||"file"==b)a.push("//"),(b=this.xo())&&a.push(Jj(b,Kj,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.Va(),null!=c&&a.push(":",String(c));if(c=this.Mc)this.us()&&"/"!=c.charAt(0)&&a.push("/"),a.push(Jj(c,"/"==c.charAt(0)?Lj:Mj,!0));(c=this.MW())&&a.push("?",c);(c=this.Ji)&&a.push("#",Jj(c,Nj));return a.join("")};
d.resolve=function(a){var b=this.clone(),c=a.o0();c?b.nu(a.Jg):c=a.p0();c?b.xB(a.xo()):c=a.us();c?b.pm(a.sh()):c=a.hI();var e=a.Mc;if(c)b.um(a.Va());else if(c=a.gI()){if("/"!=e.charAt(0))if(this.us()&&!this.gI())e="/"+e;else{var f=b.Mc.lastIndexOf("/");-1!=f&&(e=b.Mc.substr(0,f+1)+e)}f=e;if(".."==f||"."==f)e="";else if(-1!=f.indexOf("./")||-1!=f.indexOf("/.")){for(var e=Ca(f,"/"),f=f.split("/"),g=[],k=0;k<f.length;){var p=f[k++];"."==p?e&&k==f.length&&g.push(""):".."==p?((1<g.length||1==g.length&&
""!=g[0])&&g.pop(),e&&k==f.length&&g.push("")):(g.push(p),e=!0)}e=g.join("/")}else e=f}c?b.bi(e):c=a.n0();c?b.ku(a.Cg.clone()):c=a.k0();c&&b.eu(a.Ji);return b};d.clone=function(){return new Hj(this)};d.nu=function(a,b){this.Gi();if(this.Jg=b?Oj(a,!0):a)this.Jg=this.Jg.replace(/:$/,"");return this};d.o0=function(){return!!this.Jg};d.xo=function(){return this.Pf};d.xB=function(a,b){this.Gi();this.Pf=b?Oj(a):a;return this};d.p0=function(){return!!this.Pf};d.sh=function(){return this.Wk};
d.pm=function(a,b){this.Gi();this.Wk=b?Oj(a,!0):a;return this};d.us=function(){return!!this.Wk};d.Va=function(){return this.Ia};d.um=function(a){this.Gi();if(a){a=Number(a);if(isNaN(a)||0>a)throw Error("Bad port number "+a);this.Ia=a}else this.Ia=null;return this};d.hI=function(){return null!=this.Ia};d.bi=function(a,b){this.Gi();this.Mc=b?Oj(a,!0):a;return this};d.gI=function(){return!!this.Mc};d.n0=function(){return""!==this.Cg.toString()};
d.ku=function(a,b){this.Gi();a instanceof Ij?(this.Cg=a,this.Cg.eB(this.Wd)):(b||(a=Jj(a,Pj)),this.Cg=new Ij(a,null,this.Wd));return this};d.MW=function(){return this.Cg.toString()};d.eu=function(a,b){this.Gi();this.Ji=b?Oj(a):a;return this};d.k0=function(){return!!this.Ji};d.Gi=function(){if(this.Z0)throw Error("Tried to modify a read-only Uri");};d.eB=function(a){this.Wd=a;this.Cg&&this.Cg.eB(a);return this};
var Oj=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Jj=function(a,b,c){return r(a)?(a=encodeURI(a).replace(b,Qj),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},Qj=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},Kj=/[#\/\?@]/g,Mj=/[\#\?:]/g,Lj=/[\#\?]/g,Pj=/[\#\?@]/g,Nj=/#/g,Ij=function(a,b,c){this.Ua=this.tb=null;this.ph=a||null;this.Wd=!!c};
Ij.prototype.gg=function(){if(!this.tb&&(this.tb=new H,this.Ua=0,this.ph)){var a=this;Cc(this.ph,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)})}};var Rj=function(a,b,c){b=le(a);if("undefined"==typeof b)throw Error("Keys are undefined");c=new Ij(null,null,c);a=ke(a);for(var e=0;e<b.length;e++){var f=b[e],g=a[e];qa(g)?c.CN(f,g):c.add(f,g)}return c};d=Ij.prototype;d.V=function(){this.gg();return this.Ua};
d.add=function(a,b){this.gg();this.yl();a=this.il(a);var c=this.tb.get(a);c||this.tb.set(a,c=[]);c.push(b);this.Ua+=1;return this};d.remove=function(a){this.gg();a=this.il(a);return this.tb.La(a)?(this.yl(),this.Ua-=this.tb.get(a).length,this.tb.remove(a)):!1};d.clear=function(){this.yl();this.tb=null;this.Ua=0};d.yb=function(){this.gg();return 0==this.Ua};d.La=function(a){this.gg();a=this.il(a);return this.tb.La(a)};d.Kk=function(a){var b=this.H();return fb(b,a)};
d.rb=function(){this.gg();for(var a=this.tb.H(),b=this.tb.rb(),c=[],e=0;e<b.length;e++)for(var f=a[e],g=0;g<f.length;g++)c.push(b[e]);return c};d.H=function(a){this.gg();var b=[];if(r(a))this.La(a)&&(b=nb(b,this.tb.get(this.il(a))));else{a=this.tb.H();for(var c=0;c<a.length;c++)b=nb(b,a[c])}return b};d.set=function(a,b){this.gg();this.yl();a=this.il(a);this.La(a)&&(this.Ua-=this.tb.get(a).length);this.tb.set(a,[b]);this.Ua+=1;return this};
d.get=function(a,b){a=a?this.H(a):[];return 0<a.length?String(a[0]):b};d.CN=function(a,b){this.remove(a);0<b.length&&(this.yl(),this.tb.set(this.il(a),A(b)),this.Ua+=b.length)};d.toString=function(){if(this.ph)return this.ph;if(!this.tb)return"";for(var a=[],b=this.tb.rb(),c=0;c<b.length;c++)for(var e=b[c],f=encodeURIComponent(String(e)),e=this.H(e),g=0;g<e.length;g++){var k=f;""!==e[g]&&(k+="="+encodeURIComponent(String(e[g])));a.push(k)}return this.ph=a.join("&")};d.yl=function(){this.ph=null};
d.clone=function(){var a=new Ij;a.ph=this.ph;this.tb&&(a.tb=this.tb.clone(),a.Ua=this.Ua);return a};d.il=function(a){a=String(a);this.Wd&&(a=a.toLowerCase());return a};d.eB=function(a){a&&!this.Wd&&(this.gg(),this.yl(),this.tb.forEach(function(a,c){var b=c.toLowerCase();c!=b&&(this.remove(c),this.CN(b,a))},this));this.Wd=a};d.extend=function(a){for(var b=0;b<arguments.length;b++)ne(arguments[b],function(a,b){this.add(b,a)},this)};var Sj=function(a){return(a=a.exec(Lb))?a[1]:""},Tj=function(){if(Rh)return Sj(/Firefox\/([0-9.]+)/);if(Ub||Vb||Tb)return mc;if(Vh)return Sj(/Chrome\/([0-9.]+)/);if(Wh&&!(Pb()||B("iPad")||B("iPod")))return Sj(/Version\/([0-9.]+)/);if(Sh||Th){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec(Lb);if(a)return a[1]+"."+a[2]}else if(Uh)return(a=Sj(/Android\s+([0-9.]+)/))?a:Sj(/Version\/([0-9.]+)/);return""}();var Uj=function(a,b){this.qb=a;this.Wc=b;this.a=C("mr.cloud.calendar.CalendarService")};d=Uj.prototype;d.$U=function(){var a=this;return this.jW(this.Wc.Se,9E5).then(function(b){a.a.info(a.CF(b.length)+" events discovered before filtering.");return a.mX(b)},function(b){a.a.l("Error getting Hangouts from calendar.",b);return[]})};d.CF=function(a){return 20<a?"20+":a.toString()};d.jW=function(a,b){var c=this,e=Date.now();return this.MV(a,new Date(e),new Date(e+b)).then(function(a){return a.filter(c.X0)})};
d.X0=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};d.MV=function(a,b,c){a=this.qb.Ii(di.Wg,["calendars",a,"events"],{timeMin:b.toJSON(),timeMax:c.toJSON(),singleEvents:!0});this.a.v("Retrieving Hangouts from Calendar: "+a);return this.qb.$g(a,"GET").then(function(a){return a.items?a.items:[]})};
d.mX=function(a){var b=this;a=a.reduce(function(a,e){if(e.hangoutLink){var c=new Hj(e.hangoutLink),g=b.N4(c.Mc);if(2==g.length){var c=g[0],g=g[1],k,p;-1!=c.indexOf(".")&&(k=g,p=c);a.push(new Oi(g,c,k,p,e.summary))}else b.a.l("Invalid hangout link from calendar event: "+e.hangoutLink)}return a},[]);this.a.info(this.CF(a.length)+" events discovered with Hangout links.");return a};d.N4=function(a){return a.substring(12).split("/")};var Vj=function(a){this.qb=a;this.a=C("mr.cloud.mesi.MesiService")};
Vj.prototype.XU=function(){var a=ei.Wg;.1>Math.random()&&(a=a.replace("v1","v1_preprod"));a=this.qb.Ii(a,["hangouts","search"]);this.a.info("Retrieving Hangouts from MESI: "+a);return this.qb.$g(a,"POST",Wj).then(function(a){var b=[];a.result&&(b=a.result.map(function(a){var b=a.hangout,c,e;b.external_key?(c=b.external_key.value.replace(/@.*/,""),e=b.external_key.service):b.sharing_url&&(e=b.sharing_url.split("/"),c=e[4],e=e[3]);var p=b.meeting_room_name,q;b.meeting_domain?(q=b.meeting_domain,p&&
(c=p,e=q)):"BUSINESS"==b.type&&b.company_title&&(q=b.company_title.toLowerCase());var y=qj.format({ORGANIZER:"",PARTICIPANTS:0});if((a=a.participant)&&0<a.length){var G=a[0].display_name;a=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(G=b.display_name);return a},new Set);y=qj.format({ORGANIZER:G,PARTICIPANTS:a.size})}return new Oi(c,e,p,q,y,b.hangout_id)}));return b})};var Wj={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var Yj=function(){this.iA=Qa();this.Fj=new Xj(null,null);this.Ej=new Xj(null,null);this.dx=[];this.Ls=this.Bk=0;Ih(this)};d=Yj.prototype;d.$k=function(a){a=a.toLowerCase();var b=new Di;b.update(a);b.update(this.iA);return"r"+wj(b.digest(),!0)};d.NY=function(){return this.Fj.model?this.Fj:this.Ej.model?this.Ej:new Xj(null,null)};d.oa=function(){return"SinkUtils"};
d.getData=function(){return[{recentLaunchedDevice:this.Fj,recentDiscoveredDevice:this.Ej},{receiverIdToken:this.iA,fixedIpList:this.dx.join(","),castControlPort:this.Bk,lastCloudSinkCheckTimeMillis:this.Ls}]};
d.Wa=function(){var a=Fh(this);a&&(this.Fj=a.recentLaunchedDevice||new Xj(null,null),this.Ej=a.recentDiscoveredDevice||new Xj(null,null));if(a=Gh(this))this.iA=a.receiverIdToken||Qa(),this.dx=a.fixedIpList&&a.fixedIpList.split(",")||[],this.Bk=a.castControlPort||0,this.Ls=a.lastCloudSinkCheckTimeMillis||0};na(Yj);var Xj=function(a,b){this.model=a;this.ip=b};var Zj=function(a,b,c,e,f,g,k,p){this.Td=null;this.fE=!1;this.eE=F();this.Ac=[];this.Tf=a?encodeURIComponent(String(a)):null;this.yF=null;!e&&b&&(this.yF=b);this.qR=c||null;this.Jq=!e;this.yr=null!=f?f:null;this.pt=g||null;this.zca=!!k;this.zF=p||null};w(Zj,Hc);var ak;var bk=Fe("https://apis.google.com/js/client.js");bk instanceof Ee&&bk.constructor===Ee&&bk.qQ===De?ak=bk.KB:(Va("expected object of type Const, got '"+bk+"'"),ak="type_error:Const");var ck=new Qe;ck.bA=ak;d=Zj.prototype;
d.init=function(){var a=u(function(a){this.Td=a;var b=ma("client.request",a),c=ma("auth",a);b&&c?this.RH():a.load("client",u(this.RH,this))},this),b=this.pF("gapi");b?a(b.gapi):this.E1(a);return this.eE.promise};d.pF=function(a){for(var b=window,c=ma(a,b);!c&&b!=window.top&&this.nS(b.parent,a);)b=b.parent,c=ma(a,b);return c?b:null};d.nS=function(a,b){try{return!!a&&null!=a.location.href&&Rb(a,b)}catch(c){return!1}};
d.E1=function(a){var b=this.pF("gapi_onload");if(b){var c=b.gapi_onload;b.gapi_onload=function(){c();a(b.gapi)}}else{window.gapi_onload=function(){a(window.gapi)};var e=document.createElement("script");e.src=Re(ck);this.zF&&Fj(e,Xe(this.zF));document.getElementsByTagName("head")[0].appendChild(e)}};d.RH=function(){for(var a=0;a<this.Ac.length;a++)this.Ac[a].nb.resolve(this.XL(this.Ac[a].c7));this.fE=!0;this.eE.resolve(this.Td)};
d.sendRequest=function(a){if(this.fE)return this.XL(a);var b=F();this.Ac.push({c7:a,nb:b});return b.promise};
d.XL=function(a){var b,c,e,f=ma("config.get",this.Td);this.Jq||(b=f("googleapis.config/auth/useFirstPartyAuth"),c=f("googleapis.config/auth/useOriginToken"));null!=this.yr&&(e=f("client/cors"));try{var g=ma("config.update",this.Td);this.Jq||(g("googleapis.config/auth/useFirstPartyAuth",!1),g("googleapis.config/auth/useOriginToken",!1));null!=this.yr&&g("client/cors",this.yr);var k=ma("client.request",this.Td),p=this.zV();a.headers&&Kb(p,a.headers);var q={headers:p,root:this.qR,path:a.path,method:a.method,
body:a.body},y=a.params||{};this.Tf&&!this.pt?Kb(y,{key:this.Tf}):this.pt&&Kb(y,{key:null});Db(y)||(q.params=y);var G=Nd(k(q));a.callback&&G.then(function(b){a.callback.apply(null,[b.result,b])},function(b){a.callback.apply(null,[b.result,b])});return G}finally{g=ma("config.update",this.Td),this.Jq||(g("googleapis.config/auth/useFirstPartyAuth",b),g("googleapis.config/auth/useOriginToken",c)),null!=this.yr&&g("client/cors",e)}};
d.zV=function(){if(this.Jq){if(this.pt)return{Authorization:"Bearer "+this.pt};var a=ma("auth.getAuthHeaderValueForFirstParty",this.Td);return{Authorization:this.zca?a([]):a(),"X-Goog-AuthUser":this.yF}}return{}};var dk=function(a,b,c,e,f,g,k){var p=Yj.W().$k(a);this.ab=new $h(p,b,g,k,f);this.deviceId=a;this.uba=c;this.model=e};dk.prototype.XN=function(a){return fb(this.uba,a)};var ek=function(a,b,c,e,f){dk.call(this,a,b,["cloud"],"Chrome Streaming Receiver",e);this.wv=c;this.isAvailable=f};ja(ek,dk);var fk=function(a){var b=a.getService();a.sh()&&(b=a.sh());var c;a.Nl&&a.rh()!=a.Nl&&(c=a.Nl);dk.call(this,a.getId(),a.rh(),["mesi"],"Hangout",b,"hangout",c);this.EA=a.Kj||""};ja(fk,dk);var gk=function(a){this.Wc=a};d=gk.prototype;d.Ii=function(a,b,c){var e="";b.forEach(function(a){e+="/"+encodeURIComponent(a)});a=new Hj(a+e);c&&(c=Rj(c),a.ku(c));return a};d.$g=function(a,b,c){var e=this;return this.Wc.getAuthToken().then(function(f){var g=e.AV(f);return e.jS(g,a,b,c).catch(function(g){if("INVALID_ACCESS_ERROR"==g)return e.KU(f,a,b,c);throw g;})})};d.KU=function(a,b,c,e){var f=this;return this.Wc.JU(a).then(function(){return f.$g(b,c,e)})};
d.jS=function(a,b,c,e){var f=this;return new Promise(function(g,k){a.sendRequest(f.fV(b,c,function(a){a&&!a.error?g(a):f.T0(a)?k("INVALID_ACCESS_ERROR"):k(f.J4(a))},e))})};d.T0=function(a){return!!a&&401==a.error.code};d.AV=function(a){a=new Zj(void 0,void 0,void 0,!1,!1,a);a.init();return a};d.J4=function(a){return a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a)};d.fV=function(a,b,c,e){a={callback:c,method:b,path:a.toString()};e&&(a.body=e);return a};var hk=function(a,b,c,e){this.lg=a;this.Wc=b;this.gq=c;this.Mb=e};d=hk.prototype;d.I_=function(a,b,c){var e=this;return this.V7(a,b,c).then(function(a){return e.q_(a,b.id)})};d.y_=function(a){var b=this;return this.gq.iW().then(function(c){b.Mb.zd(new xh("TURN_CREDENTIALS",{credentials:c}),a.id)})};
d.V7=function(a,b,c){b=c.deviceId;var e=this.Wc.Se,e=e?new gi(e):void 0;a=a.data;switch(c.wv){case "owner":Mi(0);break;case "manager":Mi(1);break;case "user":Mi(2);break;case "viewer":Mi(3)}return"viewer"==c.wv?this.lg.a8(b,a,e):this.lg.d8(b,a,e)};
d.q_=function(a,b){if("done"!=a.state)return Promise.reject(Error("Offer not executed by receiver. State: "+a.state));switch(a.type){case "__cloud_webrtc_session_message__":a=new xh("ANSWER",a.results.sessionDescription);this.Mb.zd(a,b);break;case "knocking_cloud_webrtc_session_message":Ji(0);a=new xh("KNOCK_ANSWER",a.results.sessionDescription);this.Mb.zd(a,b);break;case "knock_denied":Ji(1);this.SH(kj,b);break;case "knock_timeout":Ji(2);this.SH(lj,b);break;default:return Promise.reject(Error("Invalid message type: "+
a.type))}return Promise.resolve()};d.SH=function(a,b){a=new yg(a,"warning","dismiss");a.C9(!0);this.Mb.ng().send(a);this.Mb.zd(new xh("STOP"),b)};var ik=function(a,b){this.Wc=a;this.Mb=b};
ik.prototype.E_=function(a,b,c){var e=this,f,g;switch(a.type){case "REFRESH_AUTH":return f=c.deviceId,g=c.EA,this.Wc.t6().then(function(){e.Mb.zd(new xh("AUTH_READY",{hangoutId:f,resolvedId:g}),b.id)});case "LOCAL_PRESENT":return f=c.deviceId,g=c.EA,this.Mb.zd(new xh("AUTH_READY",{hangoutId:f,resolvedId:g,conferenceMode:!a.data.local}),b.id),Promise.resolve();case "STATUS_REQUEST":return this.Mb.zd(a,b.id),Promise.resolve();case "STATUS_RESPONSE":return this.Mb.zd(a,b.id,!0),a.data.routeDescription||
this.Mb.zd(a,b.id),Promise.resolve();case "HANGOUT_INACTIVE":return this.Mb.gk(b,4,new yg(nj,"warning","dismiss"));case "HANGOUT_INVALID":return this.Mb.gk(b,3,new yg(oj,"warning","dismiss"));default:return Promise.reject(Error("Unknown type: "+a.type))}};var jk=function(a,b,c){this.Gk=a;this.Bo=b;this.Mb=c};
jk.prototype.K5=function(a,b,c,e){var f=this;return new Promise(function(g){switch(a){case "cloud":case "mesi":break;default:throw Error("Unrecognized channel type");}if(!b.type)throw Error("Message has no type");switch(b.type){case "STOP":g(f.Mb.gk(c,1,null));return;case "SESSION_START_SUCCESS":Ki(0);break;case "SESSION_END":break;case "SESSION_FAILURE":Ki(1);g(f.Mb.gk(c,2,new yg(jj,"warning","dismiss")));return;case "__webrtc_stats__":break;case "PRESENTATION_CONNECTION_MESSAGE":f.Mb.zd(b.data,
c.id,!0);break;case "OFFER":g(f.Gk.I_(b,c,e));return;case "GET_TURN_CREDENTIALS":g(f.Gk.y_(c));return;case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":g(f.Bo.E_(b,c,e));return;case "new_session":f.Mb.zd(b,c.id,!0);break;case "remove_session":f.Mb.zd(b,c.id,!0);f.Mb.terminateRoute(c.id);break;default:throw Error("Unknown type: "+b.type);}g()})};var kk=function(a){Hc.call(this);this.A=a;this.Ca={}};w(kk,Hc);var lk=[];d=kk.prototype;d.listen=function(a,b,c,e){return this.jJ(a,b,c,e)};d.z1=function(a,b,c,e,f){return this.jJ(a,b,c,e,f)};d.jJ=function(a,b,c,e,f){qa(b)||(b&&(lk[0]=b.toString()),b=lk);for(var g=0;g<b.length;g++){var k=$c(a,b[g],c||this.handleEvent,e||!1,f||this.A||this);if(!k)break;this.Ca[k.key]=k}return this};d.Ro=function(a,b,c,e){return this.hJ(a,b,c,e)};
d.hJ=function(a,b,c,e,f){if(qa(b))for(var g=0;g<b.length;g++)this.hJ(a,b[g],c,e,f);else{a=gd(a,b,c||this.handleEvent,e,f||this.A||this);if(!a)return this;this.Ca[a.key]=a}return this};d.Fc=function(a,b,c,e,f){if(qa(b))for(var g=0;g<b.length;g++)this.Fc(a,b[g],c,e,f);else c=c||this.handleEvent,f=f||this.A||this,c=ad(c),e=!!e,b=Sc(a)?a.ho(b,c,e,f):a?(a=cd(a))?a.ho(b,c,e,f):null:null,b&&(id(b),delete this.Ca[b.key]);return this};
d.removeAll=function(){xb(this.Ca,function(a,b){this.Ca.hasOwnProperty(b)&&id(a)},this);this.Ca={}};d.U=function(){kk.T.U.call(this);this.removeAll()};d.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};var mk=function(a,b,c){this.nca=a;this.ad=b;this.Ng=new Map;this.ru=new Map;this.Gl=null;this.m2=c};d=mk.prototype;d.Ud=function(){this.pS()&&(this.Gl=Date.now(),this.Qn());return Array.from(this.Ng.values())};d.en=function(a){this.Ng.set(a.ab.id,a)};d.Ij=function(a){return this.Ng.delete(a)};d.aa=function(a){return this.Ng.get(a)||null};d.pS=function(){var a=this.Gl+this.m2;return null==this.Gl||a<Date.now()};d.Qn=function(){var a=this;return this.nca().then(function(b){a.mca(b)})};
d.mca=function(a){var b=new Map(this.Ng),c=new Map,e=new Map,f=[],g=[];a.forEach(function(a){var k=a.ab.id;c.set(k,a);e.set(k,a.deviceId);b.has(k)?b.has(k)&&JSON.stringify(b.get(k))!=JSON.stringify(a)&&g.push(a.ab):f.push(a.ab);b.delete(k)});a=[].concat(ka(b.values())).map(function(a){return a.ab});this.ru.clear();this.ru=e;this.Ng.clear();this.Ng=c;this.mS(f,g,a)};d.mS=function(a,b,c){0<a.length&&this.ad.Cz(a);0<b.length&&this.ad.be(b);0<c.length&&this.ad.Ge(c)};
d.b=function(){for(var a={},b=ia(this.Ng.entries()),c=b.next();!c.done;c=b.next()){var e=ia(c.value),c=e.next().value,e=e.next().value;a[c]=e}b={};c=ia(this.ru.entries());for(e=c.next();!e.done;e=c.next()){var f=ia(e.value),e=f.next().value,f=f.next().value;b[e]=f}return new nk(a,b,this.Gl)};
d.lJ=function(a){for(var b in a.sinks){var c=a.sinks[b],e=null;"Hangout"==c.model?(e=c.deviceId.split("@"),e=new fk(new Oi(e[0],e[1],c.ab.description,c.ab.domain,c.ab.friendlyName,c.EA))):"Chrome Streaming Receiver"==c.model&&(e=new ek(c.deviceId,c.ab.friendlyName,c.wv,c.ab.domain,c.isAvailable));this.Ng.set(b,e)}for(b in a.jE)this.ru.set(b,a.jE[b]);a.RI&&(this.Gl=a.RI)};d.fB=function(a){this.Gl=a};var nk=function(a,b,c){this.sinks=a;this.jE=b;this.RI=c};var ok=function(a){this.Lw=a;this.a=C("mr.cloud.messaging.GcmMessageHandler")};ok.prototype.onMessage=function(a){var b=this;a=JSON.parse(a.data.notification);var c=Yj.W();a.events.forEach(function(a){if(a.deviceId){var e=c.$k(a.deviceId);switch(a.type){case "deviceCreated":b.Z2(a,e);break;case "deviceUpdated":b.e3(a,e);break;case "deviceDeleted":b.b3(e);break;default:b.a.v(function(){return"[unhandled event] "+JSON.stringify(a)})}}else b.a.error("Device ID not provided")})};
ok.prototype.Z2=function(a,b){var c=oi(a,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof c?this.a.error("Receiver name not a string: "+c):(a=new ek(a.deviceId,c,"owner","default",!0),this.Lw.Y2({sinkId:b,cloudSink:a}))};ok.prototype.e3=function(a,b){a=oi(a,"statePatch","_cloudCast","appStatus");"string"!=typeof a?this.a.error("App status not a string: "+a):this.Lw.d3({sinkId:b,isAvailable:"available"==a})};ok.prototype.b3=function(a){this.Lw.a3({sinkId:a})};var pk=function(a,b){this.tw=a;this.ad=b;this.oe=new mk(this.Qn.bind(this),b,2E4);this.AF=new ok(this);$i().addListener();Ih(this);qh("mr.cloud.discovery.CloudSinkDiscoveryService",this)};ja(pk,gh);d=pk.prototype;d.Ud=function(){var a=this;this.tw.z6().then(function(b){a.tw.subscribe(b)},function(){});return this.oe.Ud().filter(function(a){return a.isAvailable})};d.aa=function(a){return this.oe.aa(a)};
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.gcm.onMessage)this.AF.onMessage.apply(this.AF,[].concat(ka(c)));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};d.Qn=function(){return this.tw.w1().then(function(a){return a.map(function(a){Sg("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var b=a.isAvailable()&&!a.Y0();return new ek(a.getId(),a.rh(),a.Eb.personalizedInfo.maxRole,"default",b)})})};d.oa=function(){return"CloudSinkDiscoveryService"};
d.getData=function(){return[{cache:this.oe.b()}]};d.Wa=function(){var a=Fh(this);a&&this.oe.lJ(a.cache)};d.Y2=function(a){a=a.Hja;this.oe.en(a);this.oe.fB(Date.now());this.ad.Cz([a.ab])};d.d3=function(a){var b=this.oe.aa(a.sinkId);b&&(b.isAvailable=a.isAvailable,this.oe.fB(Date.now()),this.ad.be([b.ab]))};d.a3=function(a){if(a=this.oe.aa(a.sinkId))this.oe.Ij(a.ab.id),this.oe.fB(Date.now()),this.ad.Ge([a.ab])};var sk=function(a,b,c){if(!qk){pf();var e=of;e.hu(mf);e.VQ(rk);qk=!0}this.iS=a;this.g2=b;this.tl=new mk(this.Qn.bind(this),c,2E4);this.Uo=new Map;Ih(this)},rk=function(a){vc({m:a.M1,level:yc(a.gj.value),time:a.Fba,message:a.getMessage(),ig:a.Yw})};sk.prototype.aD=function(a,b){a=new Oi(a,b,a,b);this.Uo.set(a.getId(),a);return a};sk.prototype.addManualHangout=sk.prototype.aD;sk.prototype.O6=function(a,b){this.$y(new Oi(a,b,a,b))};sk.prototype.removeManualHangout=sk.prototype.O6;d=sk.prototype;
d.Ud=function(){return this.tl.Ud()};d.aa=function(a){return this.tl.aa(a)};
d.Qn=function(){var a=this;this.a.info("Fetching hangouts");return pi([this.g2.XU(),this.iS.$U()]).then(function(b){var c=Array.from(a.Uo.values());b.forEach(function(b){b.Mr?c=c.concat(b.value):a.a.error("Error discovering Hangouts",b.reason)});var e=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(e).map(function(b){b=e[b];Sg("MediaRouter.Cloud.Hangout.Sink.Discovered");return a.$y(b)})})};d.$y=function(a){return new fk(a)};
d.YQ=function(a){a=this.aD(a.input,a.domain);a=this.$y(a);this.tl.en(a);return a.ab};d.N6=function(a){return this.Uo.delete(a.deviceId)?(this.tl.Ij(a.ab.id),!0):!1};d.oa=function(){return"HangoutSinkDiscoveryService"};d.getData=function(){for(var a={},b=ia(this.Uo.entries()),c=b.next();!c.done;c=b.next()){var e=ia(c.value),c=e.next().value,e=e.next().value;a[c]=e}return[{cache:this.tl.b(),manualHangouts:a}]};
d.Wa=function(){var a=Fh(this);if(a){this.tl.lJ(a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.Uo.set(b,new Oi(c.NI,c.Bd,c.Nl,c.Wk,c.Re,c.Kj))}}};d.a=C("mr.cloud.discovery.HangoutSinkDiscoveryService");var qk=!1;var tk=function(a){this.a=C("mr.cloud.CredentialService");this.qb=a};tk.prototype.iW=function(){var a=this,b=new zc,c=fi.Wg+"/iceconfig?key="+fi.Sba;this.a.info("Requesting TURN credentials from "+c);var e=Bf(c,function(){return a.l4(e,b)},"POST",void 0,{"Content-Type":"application/json"});return b.promise};tk.prototype.l4=function(a,b){a.Xd()?(this.a.info("Got TURN credentials: "+a.Pi()),b.resolve(this.h3(a.bZ()))):b.resolve(this.i3(null))};
tk.prototype.h3=function(a){try{var b=[];a.iceServers.forEach(function(a){a.urls.forEach(function(c){0==c.indexOf("turn:")&&b.push({url:c,credential:a.credential,username:a.username})})});return b}catch(c){return this.a.error("Error parsing TURN credentials.",c),[]}};tk.prototype.i3=function(a){this.a.error("XHR failed fetching TURN credentials.",a);return[]};var uk=function(){this.gq=this.Me=this.Ol=this.Bo=this.Gk=this.lg=this.gy=this.ew=this.ez=this.uw=this.sw=this.qb=this.Pv=null};d=uk.prototype;d.gl=function(){null==this.Pv&&(this.Pv=new Ui);return this.Pv};d.eo=function(){null==this.qb&&(this.qb=new gk(this.gl()));return this.qb};d.bW=function(){null==this.sw&&(this.sw=new Si(this.eo()));return this.sw};d.fW=function(a){null==this.uw&&(this.uw=new pk(this.bW(),a));return this.uw};d.bY=function(){null==this.ez&&(this.ez=new Vj(this.eo()));return this.ez};
d.NV=function(){null==this.ew&&(this.ew=new Uj(this.eo(),this.gl()));return this.ew};d.lX=function(a){null==this.gy&&(this.gy=new sk(this.NV(),this.bY(),a));return this.gy};d.tG=function(){null==this.lg&&(this.lg=new Qi(this.eo()));return this.lg};d.dW=function(a){null==this.Gk&&(this.Gk=new hk(this.tG(),this.gl(),this.OZ(),a));return this.Gk};d.eX=function(a){null==this.Bo&&(this.Bo=new ik(this.gl(),a));return this.Bo};d.dY=function(a){null==this.Ol&&(this.Ol=new jk(this.dW(a),this.eX(a),a));return this.Ol};
d.rZ=function(){null==this.Me&&(this.Me=new Wi);return this.Me};d.OZ=function(){null==this.gq&&(this.gq=new tk(this.eo()));return this.gq};na(uk);
