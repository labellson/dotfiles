'use strict';window.navigator.userAgent.match(/Chrome\/([0-9]+)/);var vk=function(a,b){this.type=a;this.entryPoint=b};m("castApp.frontEnd.ExtensionMessage",vk,void 0);var wk=function(a){return"urn:x-cast:com.google.cast."+a},xk=wk("tp.connection"),yk=wk("receiver"),zk=wk("media"),Ak=wk("webrtc"),Bk=wk("broadcast"),Ck=Ib({mha:xk,nha:wk("tp.heartbeat"),Aga:yk,MEDIA:zk,wfa:wk("media.universalRemote.optIn"),Hha:Ak,Cda:Bk});var Dk=function(a){return"available"==a||"available_rescan"==a};var Ek=function(a,b){this.wc=this.eg=this.oh=this.Ia=this.qa=null;this.Zd=new $h(Yj.W().$k(b),a);this.Rc={};this.Fq={};this.Fm=!1};d=Ek.prototype;d.wh=function(){return this.Zd};d.el=function(){return this.Zd.friendlyName};d.W9=function(a){this.wc=a;return this};d.getId=function(){return this.Zd.id};d.fu=function(a){this.Zd.id=a;return this};d.xN=function(a){this.Fm=a;return this};
d.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.Zd.friendlyName!=a.Zd.friendlyName&&(this.Zd.friendlyName=a.Zd.friendlyName,b=!0);this.oh!=a.oh&&(this.oh=a.oh,b=!0);this.eg!=a.eg&&(this.eg=a.eg,b=!0);this.qa!=a.qa&&(this.qa=a.qa,b=!0);this.Ia!=a.Ia&&(this.Ia=a.Ia,b=!0);return b};d.B9=function(a){this.qa=a;return this};d.Va=function(){return this.Ia};d.um=function(a){this.Ia=a;return this};d.a9=function(a){this.oh=a;return this};d.Z8=function(a){this.eg=a;return this};
d.ue=function(a){return this.Rc[a]||"unknown"};d.rV=function(a){return this.Fq[a]||null};d.Ep=function(a,b){this.Rc[a]=b;this.Fq[a]=Date.now();return this};d.eO=function(){return"name = "+this.Zd.friendlyName+(this.qa?", ip = "+this.qa:"")+(this.wc?", model = "+this.wc:"")+", apps = "+JSON.stringify(this.Rc)};var Fk=function(a){var b=new Ek(a.Zd.friendlyName,"");b.Zd.id=a.Zd.id;b.qa=a.qa;b.Ia=a.Ia;b.oh=a.oh;b.eg=a.eg;b.wc=a.wc;b.Rc=a.Rc;b.Fq=a.Fq;b.Fm=a.Fm;return b};var Gk=function(a,b,c,e,f,g){a=Yj.W().$k(a);this.Oe=new $h(a,b,this.tH(e));this.wc=c||null;this.kd=e||null;this.qa=f||null;this.Ia=g||null;this.Rc={};this.Sk=!1},Hk=function(a){if(!a.wc||!a.qa)return null;var b=new Gk(a.wh().id,a.wh().friendlyName,a.wc,void 0,a.qa,Yj.W().Bk||8009);b.Oe.id=a.wh().id;b.$A(!0);return b};d=Gk.prototype;d.cca=function(a){(a=this.update(a.el(),a.qa,a.Va(),a.kd))&&this.$A(!1);return a};
d.update=function(a,b,c,e){var f=!1;this.Oe.friendlyName!=a&&(this.Oe.friendlyName=a,f=!0);null!=b&&this.qa!=b&&(this.qa=b,f=!0);null!=c&&this.Ia!=c&&(this.Ia=c,f=!0);null!=e&&this.kd!=e&&(this.kd=e,f=!0);return f};d.wh=function(){return this.Oe};d.el=function(){return this.Oe.friendlyName};d.tH=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};d.G8=function(a){this.kd=a;this.Oe.iconType=this.tH(this.kd)};d.getId=function(){return this.Oe.id};
var Ik=function(a){var b=new Gk("",a.friendlyName,a.modelName,a.capabilities,a.ip,a.port);b.Oe.id=a.id;b.$A(a.discoveredByDial);b.Rc=a.appStatusMap;for(var c in b.Rc)"unavailable"==b.Rc[c]&&(b.Rc[c]="unavailable_rescan");return b};d=Gk.prototype;d.Va=function(){return this.Ia};d.ue=function(a){return this.Rc[a]||"unknown"};d.Ep=function(a,b){this.Rc[a]=b};
d.eO=function(){return"name = "+this.Oe.friendlyName+(this.qa?", ip = "+this.qa:"")+(this.wc?", model = "+this.wc:"")+", capabilities = "+this.kd+", apps = "+JSON.stringify(this.Rc)};d.$A=function(a){this.Sk=a};var Jk={ofa:0,ffa:1},Kk={Cha:0,fQ:1,Bga:2},Lk={DIAL:0,sfa:1,tfa:2,gea:3},Mk={Ufa:0,TIMEOUT:1,FAILED:2},Nk={RC:0,uda:1,Yda:2,Cea:3,Sda:4,Efa:5},Ok={yP:0,SUCCESS:1},Pk=function(a){Tg("MediaRouter.Cast.Session.Ended",a,Kk)},Qk=function(a){Tg("MediaRouter.Cast.Channel.ConnectResult",a,Ok)},Rk=function(a){Tg("MediaRouter.Cast.Discovery.Type",a,Lk)},Sk=function(a){Tg("MediaRouter.Cast.Session.Fail",a,Mk)};var Tk={serviceType:"_googlecast._tcp.local"},Uk=null,Vk=function(){Uk||(Uk=new Ri(7,"CastMdnsEventListener","mr.cast.SinkDiscoveryService",chrome.mdns.onServiceList,Tk));return Uk},Wk=null,Xk=function(){Wk||(Wk=Eg()?new Ri(9,"CastNetworkListChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworkListChanged):new Ri(8,"CastNetworksChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworksChanged));return Wk};var Yk=function(a,b){this.ad=b;this.QD=a;this.QD.aa=this.aa.bind(this);this.Oc=new H;this.Am=new H;this.Qh=new H;this.AJ=null;this.Jo=this.Mh="";this.Ok=null;this.ly=this.Co=!1;this.HE=[];this.a=C("mr.cast.SinkDiscoveryService");this.ur=new Set;this.gf={wk:0,Fl:0};this.zm=this.Os=0};ja(Yk,gh);d=Yk.prototype;d.init=function(){Ih(this);this.Co&&(this.iJ(),this.GF());qh("mr.cast.SinkDiscoveryService",this)};d.iJ=function(){this.a.info("Start listening to network changes");Xk().addListener()};
d.start=function(){var a=Date.now(),b=Vk();if(b.Bl()){if(6E4>a-this.AJ)return;this.a.info("Forcing mdns discovery");this.cV()}else this.a.info("Adding mdns listener"),b.addListener();this.AJ=a};d.cV=function(){chrome.mdns.forceDiscovery(n);var a=Vk();a.removeListener();a.addListener()};
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.mdns.onServiceList)this.cL.apply(this,[].concat(ka(c)));else if(a==chrome.networkingPrivate.onNetworksChanged||a==chrome.networkingPrivate.onNetworkListChanged)this.GF();else throw Error("Unhandled event");};
d.zT=function(a){if(-1==a.serviceName.indexOf("._googlecast."))return null;var b={};a.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(b[a.substring(0,2)]=a.substring(3))});var c=b.id;if(!c)return this.a.l("Missing ID"),null;Yj.W().$k(c);var e=Number(a.serviceHostPort.substring(a.serviceHostPort.indexOf(":")+1));if(isNaN(e)||0>e||65535<e)return this.a.l("Missing or invalid port"),null;var f=b.fn;if(!f||!a.ipAddress)return this.a.l("Missing friendly name or IP address"),null;var g=Number(b.ca);
return new Gk(c,f,b.md||"",isNaN(g)?0:g,a.ipAddress,e)};d.refresh=function(){this.a.v("Executing forceDiscovery.");chrome.mdns.forceDiscovery(n)};d.cL=function(a){var b=this;this.a.info("Registering "+a.length+" devices");0!=this.zm&&(clearTimeout(this.zm),this.zm=0);a=this.AT(a).map(function(a){return b.mw(a,!0)});pi(a).then(function(){b.gf={wk:b.Yx(),Fl:b.xX()};b.U1()})};d.U1=function(){var a=this;0!=this.zm||36E5>Date.now()-this.Os||(this.zm=setTimeout(function(){return a.fU()},5E3))};
d.fU=function(){var a=this.gf;Ug("MediaRouter.Cast.Discovery.KnownDevicesCount",a.Fl);Ug("MediaRouter.Cast.Discovery.ConnectedDevicesCount",a.wk);this.Os=Date.now();this.zm=0};d.xX=function(){var a=this,b=this.ur.size;ee(this.Si(),function(c){a.ur.has(c.getId())||b++});return b};d.x6=function(a){this.cL(a);this.HE=a};
d.mw=function(a,b){var c=this;if(this.Qh.La(a.getId()))return Promise.resolve();this.Qh.set(a.getId(),a);return this.tn(a).then(function(e){e?(e=c.Oc.get(a.getId()),b&&(e?e.Sk&&Rk(3):Rk(1)),c.en(a)):(c.a.info("Inaccessible sink: "+a.getId()),c.Ij(a.getId()));c.Qh.remove(a.getId())})};d.N0=function(a){return void 0!=this.HE.find(function(b){return b.ipAddress==a.ipAddress})};
d.AT=function(a){var b=this,c=[];this.ur.clear();a.forEach(function(a){if(!b.N0(a)&&(a=b.zT(a))){var e=a.getId();b.ur.add(e);if(b.Qh.La(e)){var g=b.Qh.get(e);if(g.qa==a.qa&&g.Va()==a.Va()){b.a.info("Sink has pending connection "+e);return}b.a.l("Pending sink changed ip "+e);b.Qh.remove(e)}(e=b.Oc.get(e))?e.cca(a)&&b.ad.wd(e):c.push(a)}});return c};
d.UE=function(a){var b=this.Oc.get(a.getId()),c=null,e=a.qa,f=a.Va();null!=e&&null!=f&&(c=this.Am.get(e+":"+f));if(b&&!c){var g=a.qa,k=a.Va();g&&k&&this.Am.remove(g+":"+k)}c&&!b&&this.Oc.remove(c.getId());this.Oc.set(a.getId(),a);null!=e&&null!=f&&this.Am.set(e+":"+f,a)};d.en=function(a){this.a.info("Adding sink "+a.getId());this.UE(a);this.Co||(this.Co=!0,this.iJ());this.ad.tj(a);Yj.W().Ej=new Xj(a.wc,a.qa)};d.pz=function(a){this.a.info("Channel error for sink "+a);this.Ij(a)};
d.Ij=function(a){var b=this.Oc.get(a);if(b){this.a.info("Removing sink "+a);this.Oc.remove(a);a=b.qa;var c=b.Va();null!=a&&null!=c&&this.Am.remove(a+":"+c);this.ad.ut(b)}};d.H6=function(){var a=this.Oc.H();this.Oc.clear();this.Am.clear();a.forEach(this.ad.ut,this.ad)};d.tn=function(a){this.a.v("Checking access to "+a.getId());return this.QD.Ik(a).then(function(b){if(a.Sk){var c=4;b.audioOnly||(c|=1);a.G8(c)}return!0},function(){return!1})};
d.Ft=function(){var a=this;this.a.info("Pruning inactive sinks.");ee(this.Si(),function(b){a.Qh.set(b.getId(),b);a.tn(b).then(function(c){c||a.Ij(b.getId());a.Qh.remove(b.getId())})})};d.aa=function(a){return this.Oc.get(a,null)};d.uZ=function(a,b){return this.Am.get(a+":"+b)};d.vZ=function(a){var b=[];ee(this.Si(),function(c){Dk(c.ue(a))&&b.push(c)});return b};d.Si=function(){return this.Oc.cy()};d.Yx=function(){return this.Oc.V()};d.wd=function(a){this.ad.wd(a)};d.Ud=function(){return this.Oc.H()};
d.oa=function(){return"cast.SinkDiscoveryService"};d.getData=function(){var a=this,b={};ee(this.Oc.EG(),function(c){var e;e=a.Oc.get(c);e={id:e.getId(),ip:e.qa,port:e.Va(),friendlyName:e.el(),modelName:e.wc,capabilities:e.kd,discoveredByDial:e.Sk,appStatusMap:e.Rc};b[c]=e});return[new Zk(b,this.Jo,this.gf),new $k(this.Co,this.Os)]};
d.Wa=function(){var a=Fh(this);a&&3==a.version&&(this.Jo=a.networkIds,this.gf=a.deviceCounts,this.z0(a.sinkMap));if(a=Gh(this))this.Co=a.hasSavedSinks,this.Os=a.lastSinkCountMetricRecordTime||0};d.z0=function(a){this.ly=0<Object.keys(a).length;for(var b in a){var c=Ik(a[b]);this.aa(c.getId())||this.UE(c)}this.Ft()};d.H1=function(a){this.ly=0<Object.keys(a).length;for(var b in a){var c=Ik(a[b]);this.aa(c.getId())||this.mw(c,!1)}};
d.GF=function(){var a=this;this.a.info("Fetching networks state");this.Ok&&Qh(this.Ok);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(b){for(var c=[],e=0;e<b.length;e++)"Connected"==b[e].ConnectionState&&c.push(b[e].GUID);a.$ba(c.sort().join(","))})};
d.$ba=function(a){this.a.info(function(){return"Update current network "+al(a)});a!=this.Mh&&(this.Ok&&(Hh.delete(this.Ok.oa()),this.Ok=null),a?(this.Jo&&a!=this.Jo?this.H6():this.Ft(),this.Jo=this.Mh=a,this.Ok=new bl(this,this.Mh)):this.Mh="")};
var al=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},Zk=function(a,b,c){this.sinkMap=a;this.networkIds=b;this.deviceCounts=c;this.version=3},$k=function(a,b){this.hasSavedSinks=a;this.lastSinkCountMetricRecordTime=b},bl=function(a,b){this.Bd=a;this.Mh=b;Ih(this)};bl.prototype.oa=function(){return"cast.NetworkSink."+this.Mh};
bl.prototype.getData=function(){var a=this,b=null,c=this.Bd.getData();c&&(this.Bd.ly||0<this.Bd.Yx())&&(b=c[0]);this.Bd.a.info(function(){return"Saving sink data for network "+al(a.Mh)});return[null,b]};bl.prototype.Wa=function(){var a=this;this.Bd.a.info(function(){return"Restoring sink data for network "+al(a.Mh)});var b=Gh(this);b&&3==b.version&&this.Bd.H1(b.sinkMap)};var cl={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var dl=function(){this.type="GET_STATUS";this.requestId=0};var el=function(a,b,c){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=b;this.message=c};var fl=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var gl=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var hl=function(a,b){this.requestId=a;this.Gba=b;this.cO=null};hl.prototype.sz=function(){};var il=function(){this.Wb=new H};il.prototype.eD=function(a){var b=this;this.Wb.set(a.requestId,a);a.cO=setTimeout(function(){return b.h4(a)},a.Gba)};il.prototype.rp=function(a){var b=this.Wb.get(a);if(!b)return null;clearTimeout(b.cO);this.Wb.remove(a);return b};il.prototype.Ah=function(a){return this.Wb.get(a,null)};il.prototype.h4=function(a){this.Wb.remove(a.requestId);a.sz()};var jl=function(a,b){this.Tc=a;this.Ad=b;this.yj=new il;this.sL=new Xh("cast.RequestIdGenerator")};d=jl.prototype;d.init=function(){this.sL.tU()};d.fD=function(a,b,c){var e=this.sL.ds();a.requestId=e;a=new zc;b=new kl(e,a,t(b)&&0<b?b:6E5,c);this.yj.eD(b);return b};d.sA=function(a){this.yj.rp(a.requestId)};d.rp=function(a){return this.yj.rp(a)};
d.sendRequest=function(a,b,c,e,f,g){var k=this;if(!Ck.hasOwnProperty(c))return Promise.reject(Error("Custom namespace is not supported"));var p=this.fD(a,l(e)?e:3E3,f),q=p.nb;this.Tc.Xt(b,c,a,f||this.Ad,g).then(null,function(){k.sA(p);q.reject(ll)});return q.promise};d.sendMessage=function(a,b,c,e,f,g){var k=this,p=this.fD(a,l(e)?e:3E3,f),q=p.nb;this.Tc.Xt(b,c,a,f||this.Ad,g).then(function(){k.sA(p);q.resolve(!0)},function(){k.sA(p);q.reject(ll)});return q.promise};
d.f7=function(a,b){var c=new fl(a.appId);c.language=a.language?a.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return this.sendRequest(c,b,yk,a.requestSessionTimeout)};d.g7=function(a,b){return this.sendRequest(new gl(a),b,yk)};d.T7=function(a,b){return this.sendMessage(a,b,Bk)};var ml=Error("Timeout"),ll=Error("Failed to send message"),kl=function(a,b,c,e){hl.call(this,a,c);this.nb=b;this.sourceId=e};ja(kl,hl);kl.prototype.sz=function(){this.nb.reject(ml)};var nl=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b;this.logRecord=this.deviceJustSetUp=void 0};m("castApp.eventPage.Message",nl,void 0);var ol=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};nl.DeviceData=ol;nl.DeviceJustSetUp=function(a,b,c,e){this.ipAddress=a;this.name=b;this.udn=c;this.modelName=e};nl.DeviceCapabilities=function(){};
nl.LogRecord=function(a,b,c,e){this.levelValue=a;this.msg=b;this.loggerName=c;this.time=e};var pl=function(a,b){this.Cc=a;this.ld=b;this.Rk=new H;this.Qk=new qe;this.XI=0;this.i2=new H("serviceCheck",this.R_.bind(this),"startDeviceMonitor",this.d0.bind(this),"releaseDeviceMonitor",this.L_.bind(this),"deviceJustSetUp",this.t_.bind(this),"logRecord",this.A_.bind(this));chrome.runtime.onMessage.addListener(this.F_.bind(this));chrome.runtime.onMessageExternal.addListener(this.w_.bind(this));this.Gf("serviceReady")};d=pl.prototype;d.a=C("castApp.eventPage.Service");d.LP=3E4;
d.X_=function(){if(this.WD()){var a=new qe;ee(this.Cc.Si(),function(b){var c=b.qa;a.add(c);this.Rk.La(c)||this.ld.sendRequest(new dl,b,yk)}.bind(this));var b=!1;this.Rk.rb().forEach(function(c){a.contains(c)||(this.Rk.remove(c),b=!0)}.bind(this));b&&this.Yv()}};
d.o_=function(a,b){if(this.WD()&&Ck.hasOwnProperty(b.namespace_)&&(a=a.qa)&&(b=JSON.parse(b.data),"RECEIVER_STATUS"===b.type)){var c=b.status&&b.status.applications&&b.status.applications[0],e=b=null;c&&(c.appId&&(b=c.appId),c.sessionId&&(e=c.sessionId));c=this.Rk.get(a);this.Rk.set(a,new ol(a,b,e));c&&c.appId===b||this.Yv()}};
d.WD=function(){if(0===this.Qk.V())return!1;var a=v();a-this.XI>this.LP&&(this.XI=a,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(a){0===a.length?(this.a.info("No tabs found. Clearing device monitor clients."),this.Qk.clear()):this.a.info(function(){return"Tab check found active tabs: "+a.map(function(a){return a.id})})}.bind(this)));a=this.Qk.V();this.a.info("Monitor client count: "+a);return 0<a};
d.F_=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var e=this.i2.get(a.subtype);if(!e)return!1;if(!a.originId)return Va("Missing origin ID in the incoming message."),!1;try{var f=e(a,b,c);f&&c(f)}catch(g){this.a.error("Error while handling request",g)}return!1};d.Gf=function(a,b){var c=new nl(a,b);this.a.v(function(){return"Sending message: "+JSON.stringify(c)});chrome.runtime.sendMessage(c)};d.R_=function(){this.Gf("serviceReady")};
d.d0=function(a){this.Qk.contains(a.originId)?this.a.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.a.info("Registering monitor client: "+a.originId),this.Qk.add(a.originId));this.Yv();this.s6()};d.L_=function(a){this.a.info("Unregistering monitor client: "+a.originId);this.Qk.remove(a.originId)};
d.t_=function(a){a=a.deviceJustSetUp;var b=a.udn.replace(/-/g,"").toLowerCase(),c;a.capabilities&&(c=(a.capabilities.audioOutSupported?4:0)|(a.capabilities.videoOutSupported?1:0));c=new Gk(b,a.name,a.modelName,c,a.ipAddress,Yj.W().Bk||8009);this.Cc.mw(c,!0)};d.A_=function(a){a=a.logRecord;vc({level:yc(a.levelValue),m:a.loggerName,time:a.time,message:a.msg})};d.Yv=function(){var a=this.Rk.H();this.Gf("devices",a)};
d.s6=function(){this.Cc.refresh();this.Cc.Ud().forEach(function(a){this.ld.sendRequest(new dl,a,yk)}.bind(this))};d.w_=function(a,b,c){switch(a.type){case "handshake":c(new vk("handshake"));break;case "launch":b=b.tab&&t(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.Rf={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};m("chrome.cast.AutoJoinPolicy",chrome.cast.Rf,void 0);chrome.cast.qq={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};m("chrome.cast.DefaultActionPolicy",chrome.cast.qq,void 0);chrome.cast.Ug={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
m("chrome.cast.Capability",chrome.cast.Ug,void 0);chrome.cast.Sf={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};m("chrome.cast.ErrorCode",chrome.cast.Sf,void 0);chrome.cast.gQ={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
m("chrome.cast.ReceiverAvailability",chrome.cast.gQ,void 0);chrome.cast.tQ={CHROME:"chrome",IOS:"ios",ANDROID:"android"};m("chrome.cast.SenderPlatform",chrome.cast.tQ,void 0);chrome.cast.sq={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};m("chrome.cast.ReceiverType",chrome.cast.sq,void 0);chrome.cast.tP={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};m("chrome.cast.DialAppState",chrome.cast.tP,void 0);chrome.cast.bn={CAST:"cast",STOP:"stop"};
m("chrome.cast.ReceiverAction",chrome.cast.bn,void 0);chrome.cast.NC={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};m("chrome.cast.SessionStatus",chrome.cast.NC,void 0);chrome.cast.lP=function(a,b,c,e,f){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=e||chrome.cast.Rf.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=f||chrome.cast.qq.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};m("chrome.cast.ApiConfig",chrome.cast.lP,void 0);chrome.cast.vP=function(a,b){this.appName=a;this.launchParameter=b||null};m("chrome.cast.DialRequest",chrome.cast.vP,void 0);
chrome.cast.FC=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};m("chrome.cast.DialLaunchData",chrome.cast.FC,void 0);chrome.cast.uP=function(a,b){this.doLaunch=a;this.launchParameter=b||null};m("chrome.cast.DialLaunchResponse",chrome.cast.uP,void 0);chrome.cast.MC=function(a,b,c){this.appId=a;this.capabilities=qa(b)?b:[chrome.cast.Ug.VIDEO_OUT,chrome.cast.Ug.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
m("chrome.cast.SessionRequest",chrome.cast.MC,void 0);
chrome.cast.qv=function(a,b,c,e){this.label=a;a=b;Na.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Ha,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Ia,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(Ja,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Ka,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(La,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Ma,"&#0;")));this.friendlyName=a;this.capabilities=c||[];this.volume=e||null;this.receiverType=chrome.cast.sq.CAST;this.displayStatus=this.isActiveInput=null};
m("chrome.cast.Receiver",chrome.cast.qv,void 0);chrome.cast.hQ=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};m("chrome.cast.ReceiverDisplayStatus",chrome.cast.hQ,void 0);chrome.cast.QC=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};m("chrome.cast.Timeout",chrome.cast.QC,void 0);chrome.cast.timeout=new chrome.cast.QC;m("chrome.cast.timeout",chrome.cast.timeout,void 0);chrome.cast.zC="auto-join";
chrome.cast.KC="cast-session_";chrome.cast.media.an={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};m("chrome.cast.media.MediaCommand",chrome.cast.media.an,void 0);chrome.cast.media.ne={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};m("chrome.cast.media.MetadataType",chrome.cast.media.ne,void 0);chrome.cast.media.rq={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};m("chrome.cast.media.PlayerState",chrome.cast.media.rq,void 0);
chrome.cast.media.rv={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};m("chrome.cast.media.RepeatMode",chrome.cast.media.rv,void 0);chrome.cast.media.iQ={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};m("chrome.cast.media.ResumeState",chrome.cast.media.iQ,void 0);chrome.cast.media.OC={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};m("chrome.cast.media.StreamType",chrome.cast.media.OC,void 0);
chrome.cast.media.DP={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};m("chrome.cast.media.IdleReason",chrome.cast.media.DP,void 0);chrome.cast.media.EQ={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};m("chrome.cast.media.TrackType",chrome.cast.media.EQ,void 0);chrome.cast.media.BQ={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};m("chrome.cast.media.TextTrackType",chrome.cast.media.BQ,void 0);
chrome.cast.media.xQ={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};m("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.xQ,void 0);chrome.cast.media.CQ={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};m("chrome.cast.media.TextTrackWindowType",chrome.cast.media.CQ,void 0);
chrome.cast.media.yQ={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};m("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.yQ,void 0);chrome.cast.media.zQ={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};m("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.zQ,void 0);chrome.cast.media.AP=function(){this.customData=null};m("chrome.cast.media.GetStatusRequest",chrome.cast.media.AP,void 0);chrome.cast.media.UP=function(){this.customData=null};m("chrome.cast.media.PauseRequest",chrome.cast.media.UP,void 0);chrome.cast.media.WP=function(){this.customData=null};m("chrome.cast.media.PlayRequest",chrome.cast.media.WP,void 0);chrome.cast.media.rQ=function(){this.customData=this.resumeState=this.currentTime=null};m("chrome.cast.media.SeekRequest",chrome.cast.media.rQ,void 0);
chrome.cast.media.uQ=function(){this.customData=null};m("chrome.cast.media.StopRequest",chrome.cast.media.uQ,void 0);chrome.cast.media.HQ=function(a){this.volume=a;this.customData=null};m("chrome.cast.media.VolumeRequest",chrome.cast.media.HQ,void 0);chrome.cast.media.GP=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};m("chrome.cast.media.LoadRequest",chrome.cast.media.GP,void 0);
chrome.cast.media.zga=function(a){this.type="PRECACHE";this.requestId=0;this.data=a};chrome.cast.media.xP=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};m("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.xP,void 0);chrome.cast.media.zP=function(){this.metadataType=this.type=chrome.cast.media.ne.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};m("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.zP,void 0);
chrome.cast.media.NP=function(){this.metadataType=this.type=chrome.cast.media.ne.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};m("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.NP,void 0);chrome.cast.media.FQ=function(){this.metadataType=this.type=chrome.cast.media.ne.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
m("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.FQ,void 0);chrome.cast.media.OP=function(){this.metadataType=this.type=chrome.cast.media.ne.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};m("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.OP,void 0);
chrome.cast.media.VP=function(){this.metadataType=this.type=chrome.cast.media.ne.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};m("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.VP,void 0);chrome.cast.media.MP=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.OC.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
m("chrome.cast.media.MediaInfo",chrome.cast.media.MP,void 0);chrome.cast.media.YP=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};m("chrome.cast.media.QueueItem",chrome.cast.media.YP,void 0);chrome.cast.media.rP="CC1AD845";m("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.rP,void 0);chrome.cast.media.timeout={};
m("chrome.cast.media.timeout",chrome.cast.media.timeout,void 0);chrome.cast.media.timeout.load=0;chrome.cast.media.timeout.load=chrome.cast.media.timeout.load;chrome.cast.media.timeout.Qa=0;chrome.cast.media.timeout.getStatus=chrome.cast.media.timeout.Qa;chrome.cast.media.timeout.play=0;chrome.cast.media.timeout.play=chrome.cast.media.timeout.play;chrome.cast.media.timeout.pause=0;chrome.cast.media.timeout.pause=chrome.cast.media.timeout.pause;chrome.cast.media.timeout.seek=0;
chrome.cast.media.timeout.seek=chrome.cast.media.timeout.seek;chrome.cast.media.timeout.stop=0;chrome.cast.media.timeout.stop=chrome.cast.media.timeout.stop;chrome.cast.media.timeout.wm=0;chrome.cast.media.timeout.setVolume=chrome.cast.media.timeout.wm;chrome.cast.media.timeout.Qw=0;chrome.cast.media.timeout.editTracksInfo=chrome.cast.media.timeout.Qw;chrome.cast.media.timeout.V5=0;chrome.cast.media.timeout.queue=chrome.cast.media.timeout.V5;
chrome.cast.media.DQ=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};m("chrome.cast.media.Track",chrome.cast.media.DQ,void 0);chrome.cast.media.AQ=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};
m("chrome.cast.media.TextTrackStyle",chrome.cast.media.AQ,void 0);chrome.cast.media.$P=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.rv.OFF;this.customData=null};m("chrome.cast.media.QueueLoadRequest",chrome.cast.media.$P,void 0);chrome.cast.media.XP=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};
m("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.XP,void 0);chrome.cast.media.dQ=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};m("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.dQ,void 0);chrome.cast.media.ZP=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueJumpRequest",chrome.cast.media.ZP,void 0);
chrome.cast.media.cQ=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.cQ,void 0);chrome.cast.media.aQ=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};m("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.aQ,void 0);
chrome.cast.media.bQ=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};m("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.bQ,void 0);chrome.cast.media.u=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.rq.IDLE;this.currentTime=0;this.OI=-1;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.rv.OFF};m("chrome.cast.media.Media",chrome.cast.media.u,void 0);
chrome.cast.media.u.prototype.Qa=function(){};chrome.cast.media.u.prototype.getStatus=chrome.cast.media.u.prototype.Qa;chrome.cast.media.u.prototype.play=function(){};chrome.cast.media.u.prototype.play=chrome.cast.media.u.prototype.play;chrome.cast.media.u.prototype.y5=function(){};chrome.cast.media.u.prototype.playWithContext=chrome.cast.media.u.prototype.y5;chrome.cast.media.u.prototype.pause=function(){};chrome.cast.media.u.prototype.pause=chrome.cast.media.u.prototype.pause;
chrome.cast.media.u.prototype.q5=function(){};chrome.cast.media.u.prototype.pauseWithContext=chrome.cast.media.u.prototype.q5;chrome.cast.media.u.prototype.seek=function(){};chrome.cast.media.u.prototype.seek=chrome.cast.media.u.prototype.seek;chrome.cast.media.u.prototype.stop=function(){};chrome.cast.media.u.prototype.stop=chrome.cast.media.u.prototype.stop;chrome.cast.media.u.prototype.wm=function(){};chrome.cast.media.u.prototype.setVolume=chrome.cast.media.u.prototype.wm;
chrome.cast.media.u.prototype.Qw=function(){};chrome.cast.media.u.prototype.editTracksInfo=chrome.cast.media.u.prototype.Qw;chrome.cast.media.u.prototype.Y5=function(){};chrome.cast.media.u.prototype.queueInsertItems=chrome.cast.media.u.prototype.Y5;chrome.cast.media.u.prototype.W5=function(){};chrome.cast.media.u.prototype.queueAppendItem=chrome.cast.media.u.prototype.W5;chrome.cast.media.u.prototype.i6=function(){};chrome.cast.media.u.prototype.queueUpdateItems=chrome.cast.media.u.prototype.i6;
chrome.cast.media.u.prototype.d6=function(){};chrome.cast.media.u.prototype.queuePrev=chrome.cast.media.u.prototype.d6;chrome.cast.media.u.prototype.c6=function(){};chrome.cast.media.u.prototype.queueNext=chrome.cast.media.u.prototype.c6;chrome.cast.media.u.prototype.Z5=function(a){this.Bx(a)};chrome.cast.media.u.prototype.queueJumpToItem=chrome.cast.media.u.prototype.Z5;chrome.cast.media.u.prototype.h6=function(){};chrome.cast.media.u.prototype.queueSetRepeatMode=chrome.cast.media.u.prototype.h6;
chrome.cast.media.u.prototype.f6=function(){};chrome.cast.media.u.prototype.queueRemoveItems=chrome.cast.media.u.prototype.f6;chrome.cast.media.u.prototype.e6=function(a){this.Bx(a)};chrome.cast.media.u.prototype.queueRemoveItem=chrome.cast.media.u.prototype.e6;chrome.cast.media.u.prototype.g6=function(){};chrome.cast.media.u.prototype.queueReorderItems=chrome.cast.media.u.prototype.g6;
chrome.cast.media.u.prototype.b6=function(a,b,c,e){a=this.Bx(a);0>a||(0>b?e&&e(new chrome.cast.Error(chrome.cast.Sf.INVALID_PARAMETER)):a==b&&c&&c())};chrome.cast.media.u.prototype.queueMoveItemToNewIndex=chrome.cast.media.u.prototype.b6;chrome.cast.media.u.prototype.wba=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.u.prototype.supportsCommand=chrome.cast.media.u.prototype.wba;
chrome.cast.media.u.prototype.OW=function(){if(this.playerState==chrome.cast.media.rq.PLAYING&&0<=this.OI){var a=this.currentTime+(Date.now()-this.OI)/1E3*this.playbackRate;this.media&&null!=this.media.duration&&a>this.media.duration&&(a=this.media.duration);0>a&&(a=0);return a}return this.currentTime};chrome.cast.media.u.prototype.getEstimatedTime=chrome.cast.media.u.prototype.OW;chrome.cast.media.u.prototype.Ev=function(){};chrome.cast.media.u.prototype.addUpdateListener=chrome.cast.media.u.prototype.Ev;
chrome.cast.media.u.prototype.Fv=function(){};chrome.cast.media.u.prototype.addUpdateListenerWithContext=chrome.cast.media.u.prototype.Fv;chrome.cast.media.u.prototype.tA=function(){};chrome.cast.media.u.prototype.removeUpdateListener=chrome.cast.media.u.prototype.tA;chrome.cast.media.u.prototype.uA=function(){};chrome.cast.media.u.prototype.removeUpdateListenerWithContext=chrome.cast.media.u.prototype.uA;
chrome.cast.media.u.prototype.Bx=function(a){return cb(this.items,function(b){return b.itemId==a})};var ql=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var rl=function(a){this.ld=a;this.a=C("mr.cast.ReceiverStatusQuerier")};rl.prototype.fba=function(a){var b=this;return(new te(u(this.U5,this,a),3500,5)).bu(2).start().then(null,function(c){b.a.info("Failed to get receiver status from "+a.getId());throw c;})};rl.prototype.U5=function(a){this.a.info("Query receiver status: "+a.getId());return this.ld.sendRequest(new dl,a,yk)};var sl=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.D=function(a,b,c,e,f){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=e;this.receiver=f;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.NC.CONNECTED;this.transportId=""};m("chrome.cast.Session",chrome.cast.D,void 0);chrome.cast.D.prototype.H$=function(a,b,c){this.hN(null,a,b,c)};chrome.cast.D.prototype.setReceiverVolumeLevel=chrome.cast.D.prototype.H$;
chrome.cast.D.prototype.hN=function(a,b,c,e){b=new sl(new chrome.cast.Volume(b,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,b,c,e)};chrome.cast.D.prototype.setReceiverVolumeLevelWithContext=chrome.cast.D.prototype.hN;chrome.cast.D.prototype.G$=function(a,b,c){this.gN(null,a,b,c)};chrome.cast.D.prototype.setReceiverMuted=chrome.cast.D.prototype.G$;
chrome.cast.D.prototype.gN=function(a,b,c,e){a=new sl(new chrome.cast.Volume(null,b),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,c,e)};chrome.cast.D.prototype.setReceiverMutedWithContext=chrome.cast.D.prototype.gN;chrome.cast.D.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.D.prototype.leave=chrome.cast.D.prototype.leave;chrome.cast.D.prototype.stop=function(){};chrome.cast.D.prototype.stop=chrome.cast.D.prototype.stop;
chrome.cast.D.prototype.oba=function(){};chrome.cast.D.prototype.stopWithContext=chrome.cast.D.prototype.oba;chrome.cast.D.prototype.sendMessage=function(){};chrome.cast.D.prototype.sendMessage=chrome.cast.D.prototype.sendMessage;chrome.cast.D.prototype.c8=function(){};chrome.cast.D.prototype.sendMessageWithContext=chrome.cast.D.prototype.c8;chrome.cast.D.prototype.Ev=function(){};chrome.cast.D.prototype.addUpdateListener=chrome.cast.D.prototype.Ev;chrome.cast.D.prototype.Fv=function(){};
chrome.cast.D.prototype.addUpdateListenerWithContext=chrome.cast.D.prototype.Fv;chrome.cast.D.prototype.tA=function(){};chrome.cast.D.prototype.removeUpdateListener=chrome.cast.D.prototype.tA;chrome.cast.D.prototype.uA=function(){};chrome.cast.D.prototype.removeUpdateListenerWithContext=chrome.cast.D.prototype.uA;chrome.cast.D.prototype.aR=function(){};chrome.cast.D.prototype.addMessageListener=chrome.cast.D.prototype.aR;chrome.cast.D.prototype.bR=function(){};
chrome.cast.D.prototype.addMessageListenerWithContext=chrome.cast.D.prototype.bR;chrome.cast.D.prototype.ZQ=function(){};chrome.cast.D.prototype.addMediaListener=chrome.cast.D.prototype.ZQ;chrome.cast.D.prototype.$Q=function(){};chrome.cast.D.prototype.addMediaListenerWithContext=chrome.cast.D.prototype.$Q;chrome.cast.D.prototype.R6=function(){};chrome.cast.D.prototype.removeMediaListener=chrome.cast.D.prototype.R6;chrome.cast.D.prototype.S6=function(){};
chrome.cast.D.prototype.removeMediaListenerWithContext=chrome.cast.D.prototype.S6;chrome.cast.D.prototype.T6=function(){};chrome.cast.D.prototype.removeMessageListener=chrome.cast.D.prototype.T6;chrome.cast.D.prototype.U6=function(){};chrome.cast.D.prototype.removeMessageListenerWithContext=chrome.cast.D.prototype.U6;chrome.cast.D.prototype.F1=function(a){a.sessionId=this.sessionId};chrome.cast.D.prototype.loadMedia=chrome.cast.D.prototype.F1;chrome.cast.D.prototype.a6=function(a){a.sessionId=this.sessionId};
chrome.cast.D.prototype.queueLoad=chrome.cast.D.prototype.a6;var vl=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=tl(a);a=new chrome.cast.D(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||ul(a)))return null;a.receiver.volume=b.volume;"boolean"==typeof b.isActiveInput&&(a.receiver.isActiveInput=b.isActiveInput);return a},wl=function(a){var b=
[];if(!a)return b;a&1&&b.push(chrome.cast.Ug.VIDEO_OUT);a&2&&b.push(chrome.cast.Ug.VIDEO_IN);a&4&&b.push(chrome.cast.Ug.AUDIO_OUT);a&8&&b.push(chrome.cast.Ug.AUDIO_IN);a&32&&b.push(chrome.cast.Ug.MULTIZONE_GROUP);return b},tl=function(a){return new chrome.cast.qv(a.getId(),a.el(),wl(a.kd))},xl=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],e=b.namespaces||[];if(c.length!=e.length)return!0;for(var f={index:0};f.index<c.length;f={index:f.index},f.index++)if(!e.some(function(a){return function(b){return b.name==
c[a.index].name}}(f)))return!0;return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},yl=function(a){qa(a)?a.forEach(yl):ta(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(ta(a[b])||qa(a[b]))&&yl(a[b])})},zl=function(a,b){return a.namespaces.some(function(a){return a.name==b})},Al=["MultizoneLeader","MultizoneFollower"],ul=function(a){return null!==a&&"MultizoneLeader"==a.appId},Bl=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==
a};var Cl=function(a){this.ld=a;this.a=C("mr.cast.SessionLauncher")};Cl.prototype.Ry=function(a,b){Tg("MediaRouter.Cast.Session.Type",0,Jk);return this.ld.f7(a,b).then(this.z_.bind(this,b),function(a){a&&ml==a?Sk(1):Sk(0);throw a;})};Cl.prototype.z_=function(a,b){this.a.v("Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw Sk(2),Error(b.reason);a=vl(a,b.status);this.a.info("Launched session: "+a.sessionId);return a};var Dl=function(a,b,c,e){this.type=a;this.message=b;this.sequenceNumber=l(c)?c:-1;this.timeoutMillis=e||0;this.clientId=""};var El=function(a,b){this.Rh=a;this.Fb=b;this.kJ=[];this.yj=new il};d=El.prototype;d.Sx=function(a){return(a=this.Fb.rd(a))?a.routeId:null};d.listen=function(a,b){this.kJ[a]=b};d.Yb=function(a,b,c){Fl.v("Sending to "+b);Fl.v(JSON.stringify(c));c.clientId=b;this.Rh.YT(a,c)};d.ai=function(a,b){var c=this,e=this.Fb.rd(a);e&&e.uy?this.Yb(e.routeId,a,b):this.connect(a).then(function(e){e?(e=c.Sx(a))?c.Yb(e,a,b):Fl.l("No route for "+a):Fl.l("No connected client "+a)},null)};
d.ap=function(a){Fl.v("App "+a);var b=this.Fb.rd(a);b?(b.uy=!0,(a=this.yj.rp(b.routeId))&&a.nb.resolve(!0)):Fl.l("Client not found "+a)};d.B2=function(a){Fl.v("Received: "+a);a=JSON.parse(a);var b=a.clientId;"client_connect"==a.type?this.ap(b):this.Sx(b)?(b=this.kJ[a.type])&&b(a):Fl.l("No route for "+b)};
d.connect=function(a){if(this.M0(a))return Promise.resolve(!0);var b=this.Sx(a);if(!b)return Fl.l("No route for client "+a),Promise.resolve(!1);if(a=this.yj.Ah(b))return a.nb.promise;a=new zc;this.yj.eD(new Gl(b,a));return a.promise};d.M0=function(a){a=this.Fb.rd(a);return null!=a&&a.uy};var Fl=C("mr.cast.ApiMessenger"),Gl=function(a,b){hl.call(this,a,3E4);this.nb=b};ja(Gl,hl);Gl.prototype.sz=function(){this.nb.resolve(!1)};var Hl=function(a,b,c,e,f,g,k,p,q,y){this.Kv=a;this.Md=b||null;this.Kq=c||null;this.pr=e||null;this.Ss=l(f)?f:null;this.Lv=g||null;this.QE=k||null;this.qy=p||!1;this.$v=q||null;this.Zv=y||null},Il=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},Kl=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:$a(z(a,function(a){a=Il(a,"__castAppId__");if(!a)return null;a=a.match(Jl);if(!a||0==a.length)return null;var b=[];3==a.length&&a[2]&&(b=a[2].split(","));return{appId:a[1],capabilities:b}}),
function(a){return null!=a})},Ll=function(a){return Il(a,"__castClientId__")};d=Hl.prototype;d.Un=function(){return z(this.Kv,function(a){return a.appId})};d.KF=function(){return this.Lv};d.oc=function(){return this.Md};d.lx=function(){return this.Kq?this.Kq:chrome.cast.Rf.TAB_AND_ORIGIN_SCOPED};d.nW=function(){return this.pr?this.pr:chrome.cast.qq.CREATE_SESSION};d.AX=function(){return null==this.Ss?chrome.cast.timeout.requestSession:this.Ss};
d.toString=function(){var a=new Hj;a.nu("https");a.pm("google.com");a.bi("/cast");var b=[];x(this.Kv,function(a){var c="__castAppId__="+a.appId;a.capabilities&&0<a.capabilities.length&&(c=c+"("+a.capabilities.join(","),c+=")");b.push(c)});this.Md&&b.push("__castClientId__="+this.Md);this.Kq&&b.push("__castAutoJoinPolicy__="+this.Kq);this.pr&&b.push("__castDefaultActionPolicy__="+this.pr);null!=this.Ss&&b.push("__castLaunchTimeout__="+this.Ss);this.Lv&&b.push("__dialAppName__="+this.Lv);this.QE&&b.push("__dialPostData__="+
this.QE);this.qy&&b.push("__castInvisibleSender__=true");this.$v&&(b.push("__castBroadcastNamespace__="+this.$v),b.push("__castBroadcastId__="+Math.random()));this.Zv&&b.push("__castBroadcastMessage__="+encodeURIComponent(JSON.stringify(this.Zv)));a.eu(b.join("/"));return a.toString()};d.e1=function(a){var b=this.Un(),c=Ml(a);return ab(b,function(a){return fb(c,a)})};
var Nl=function(a){a=new Hj(a);if("https"!=a.Jg||"google.com"!=a.sh()||"/cast"!=a.Mc)return null;var b=a.Ji;a=Kl(b);if(!a||0==a.length)return null;var c=Ll(b),e=Il(b,"__castAutoJoinPolicy__"),f=Il(b,"__castDefaultActionPolicy__"),g;g=Il(b,"__castLaunchTimeout__");null==g?g=null:(g=Number(g),g=!isNaN(g)&&0<=g?g:null);var k=Il(b,"__dialAppName__"),p=Il(b,"__dialPostData__"),q=Il(b,"__castInvisibleSender__"),q=null===q?null:"true"==q,y=Il(b,"__castBroadcastNamespace__"),b=(b=Il(b,"__castBroadcastMessage__"))?
JSON.parse(decodeURIComponent(b)):null;return new Hl(a,c,e,f,g,k,p,q,y,b)},Ml=function(a){return(a=Nl(a))?a.Un():null},Ol=function(a){return(a=Nl(a))?a.oc():null},Jl=/(^\w+)(?:\(([\w,\ ]*)\))?$/;var Pl=function(a,b,c,e,f,g){this.Gg=a;this.da=b;this.Fb=c;this.ua=e;this.Tc=f;this.Rh=g;this.Kd=new El(g,c);this.m6=new rl(this.Gg);this.o8=new Cl(this.Gg)};d=Pl.prototype;d.init=function(){this.Fb.init();this.Kd.listen("v2_message",this.k4.bind(this));this.Kd.listen("app_message",this.G2.bind(this));this.Kd.listen("leave_session",this.n3.bind(this))};d.Bf=function(a,b){this.Kd.B2(b)};d.SL=function(a,b,c){var e=this;this.ua.ZF(a).slice().forEach(function(a){a!=c&&e.JA(a,b)})};
d.JA=function(a,b){b.clientId=a;this.Kd.ai(a,b)};d.WL=function(a,b,c){b={receiver:tl(b),action:c};this.JA(a,new Dl("receiver_action",b))};
d.k4=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.ua.Vx(c);if(e)if(c=this.ua.uH(c))if(c=this.da.aa(c))switch(b.type){case "STOP":this.D2(a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":this.A2(a,c,e);break;case "SET_VOLUME":this.C2(a,c);break;default:Ql.l("Unknown request")}else this.lm(a,
chrome.cast.Sf.INVALID_PARAMETER,"No receiver");else this.lm(a,chrome.cast.Sf.INVALID_PARAMETER,"No sink ID");else this.lm(a,chrome.cast.Sf.INVALID_PARAMETER,"Unknown session ID")}else this.lm(a,chrome.cast.Sf.INVALID_PARAMETER,"No session ID")};d.lm=function(a,b,c){b=new chrome.cast.Error(b,c);this.IA(a,b)};d.IA=function(a,b){this.Kd.ai(a.clientId,new Dl("error",b,a.sequenceNumber))};
d.D2=function(a,b){var c=this,e=a.message;Sg("MediaRouter.Cast.Session.End");var f=e.sessionId,g=this.ua.Ae(f);g&&(g.Fs=!0);g=function(){c.fm(f,a)};this.Gg.sendRequest(e,b,yk,a.timeoutMillis,a.clientId).then(g,g)};d.A2=function(a,b,c){var e=this,f=a.message,g=f.type;g in cl&&(f.type=cl[g]);this.Gg.sendRequest(f,b,zk,a.timeoutMillis,a.clientId,c.transportId).then(function(b){e.SK(c,b);e.Kd.ai(a.clientId,new Dl("v2_message",b,a.sequenceNumber))},function(b){e.IA(a,b)})};
d.C2=function(a,b){var c=this,e=a.message;delete e.sessionId;this.Gg.sendRequest(e,b,yk,a.timeoutMillis,a.clientId).then(function(){c.Kd.ai(a.clientId,new Dl("v2_message",null,a.sequenceNumber))},function(b){c.IA(a,b)})};
d.G2=function(a){var b=this,c=a.message,e=c.sessionId;if(e){var f=this.ua.uH(e);f?(f=this.da.aa(f))?(e=this.ua.Vx(e),db(e.namespaces,function(a){return a.name==c.namespaceName})?this.Tc.Xt(f,c.namespaceName,c.message,a.clientId,e.transportId).then(function(){b.Kd.ai(a.clientId,new Dl("app_message",null,a.sequenceNumber))},function(){b.lm(a,chrome.cast.Sf.CHANNEL_ERROR,"Channel to receiver not available")}):this.lm(a,chrome.cast.Sf.INVALID_PARAMETER,"Invalid namespace")):Ql.l("No receiver from sinkId"):
Ql.l("No sinkId from sessionId")}else Ql.l("No sessionId")};d.ut=function(a){(a=this.ua.ro(a))&&a.session&&this.fm(a.session.sessionId)};
d.n3=function(a){var b=this;Ql.info("Leave session");var c=this.ua.Ae(a.message);if(c){var e=a.clientId,f=this.Fb.rd(e);if(f){var g=[],k=[],p=f.tabId,q=f.origin,y=f.autoJoinPolicy;c.Zf.forEach(function(a){var c=b.Fb.rd(a);y==chrome.cast.Rf.TAB_AND_ORIGIN_SCOPED&&p==c.tabId&&q==c.origin||y==chrome.cast.Rf.ORIGIN_SCOPED&&q==c.origin?(c.DI=!0,g.push(a)):k.push(a)});this.Kd.ai(e,new Dl("leave_session",null,a.sequenceNumber));g.forEach(function(a){(a=b.Fb.rd(a))&&b.Rh.Hj(a.routeId,!0,!0)});c.Zf=k}else Ql.l("No client record")}else Ql.l("No session")};
d.UK=function(a,b){zl(a,zk)&&this.Gg.sendRequest(new dl,b,zk,void 0,void 0,a.transportId).catch(n)};d.VK=function(a,b){var c=this,e=a.getId();Ql.info("Query status for "+e);this.m6.fba(a).then(function(f){c.qK(e,f);b&&(f=c.ua.hs(e))&&c.UK(f,a)},n)};d.S3=function(a,b){Ck.hasOwnProperty(b.namespace_)?this.P3(a,b):this.O3(a,b)};d.j1=function(a){if("*"==a.destinationId)return!0;a=a.destinationId;if(a==this.Tc.oH()||null!=this.Fb.rd(a))return!0;Ql.info("Invalid destination "+a);return!1};
d.P3=function(a,b){var c=this;Ql.v(function(){return"Cast message: "+JSON.stringify(b)});if(this.j1(b))if(b.namespace_==Ak)(a=this.ua.ro(a))&&a.ie.forEach(function(a){c.Rh.XT(a,b)});else{var e=JSON.parse(b.data),f=this.J_(e),f=f?f.sourceId:void 0;switch(e.type){case "RECEIVER_STATUS":this.qK(a,e);break;case "MEDIA_STATUS":this.R3(a,b,f)}}else this.Tc.hE(a,b.destinationId,b.sourceId,!1)};
d.J_=function(a){var b=this.Gg.rp(a.requestId);if(!b)return null;var c=b.nb;switch(a.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete a.requestId;c.reject(new chrome.cast.Error(chrome.cast.Sf.SESSION_ERROR,a.reason||a.type,a));break;default:c.resolve(a)}return b};
d.O3=function(a,b){var c=this;Ql.v(function(){return"App message: "+JSON.stringify(b)});if(a=this.ua.hs(a)){var e;e="*"==b.destinationId?this.ua.ZF(a.sessionId):[b.destinationId];var f=new ql(a.sessionId,b.namespace_,b.data);e.forEach(function(a){c.Kd.ai(a,new Dl("app_message",f))})}else Ql.l("No session for incoming app message")};
var Rl=function(a,b){a.forEach(function(a){a.sessionId=b;var c=a.supportedMediaCommands,f=[];c&1&&f.push(chrome.cast.media.an.PAUSE);c&2&&f.push(chrome.cast.media.an.SEEK);c&4&&f.push(chrome.cast.media.an.STREAM_VOLUME);c&8&&f.push(chrome.cast.media.an.STREAM_MUTE);a.supportedMediaCommands=f});return a};d=Pl.prototype;d.SK=function(a,b){a=a.sessionId;b.sessionId=a;this.ua.daa(a,Rl(b.status,a))};d.x3=function(a,b,c){this.Kd.ai(c,new Dl("new_session",a));this.UK(a,b)};
d.oL=function(a){if(a=this.ua.hs(a)){a=a.sessionId;var b=this.ua.Ae(a);b&&b.Fs||this.fm(a)}};d.fm=function(a,b){var c=this;b&&this.JA(b.clientId,b);(b=this.ua.Ae(a))&&b.ie.slice().forEach(function(a){c.Rh.Hj(a,!0)});this.ua.fm(a)};
d.qK=function(a,b){Ql.v("Receiver status for "+a);var c=b.status;if(c)if(b=this.da.aa(a)){var c=vl(b,c),e=this.ua.ro(a);e?c?c.sessionId==e.session.sessionId?this.W_(e,c):(this.YH(a),this.Rh.Ye(null,b,null,c)):this.YH(a):c&&this.Rh.Ye(null,b,null,c)}else Sg("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),Ql.l("Got message from receiver "+a+", but sink is no longer available.")};
d.W_=function(a,b){var c=a.session;xl(c,b)&&(Ql.v("Updating session "+b.sessionId),c.statusText=b.statusText,c.namespaces=b.namespaces,c.receiver.volume=b.receiver.volume,this.Rh.lca(a),this.SL(c.sessionId,new Dl("update_session",c)))};d.YH=function(a){this.oL(a);Pk(1)};d.R3=function(a,b,c){if(a=this.ua.hs(a))if(b=JSON.parse(b.data))this.SK(a,b),this.SL(b.sessionId,new Dl("v2_message",b),c)};
d.KS=function(a,b){var c=wl(b.kd);return(b=db(a.Kv,function(a){return bb(a.capabilities,function(a){return fb(c,a)})}))?b.appId:a.Un()[0]};d.Ry=function(a,b){var c=Nl(a);if(!c)return Promise.reject(Error("Invalid source "+a));a=this.KS(c,b);var e=new Kg("MediaRouter.Cast.Session.Launch");return this.o8.Ry(new chrome.cast.MC(a,void 0,c.AX()),b).then(function(a){e.end("Success");return a},function(a){e.end("Failure");throw a;})};var Ql=C("mr.cast.ApiHandler");var Sl=C("mr.RuntimeErrorUtils"),Tl=function(){chrome.runtime.lastError&&Sl.v(chrome.runtime.lastError.message||"unknown runtime error")};var Ul=function(){this.Tz=new H;this.Uz=new H;this.gp=new H};d=Ul.prototype;d.Ik=function(a,b){b=void 0===b?!1:b;var c=this,e=a.getId(),f=a.qa+":"+a.Va(),g=this.Tz.get(e);if(g){if(this.gp.get(e)==f)return Vl.v("Using pending creation to "+e),g;Vl.info("Device "+e+" IP changed from "+this.gp.get(a.getId())+" to "+f);this.JQ(a)}a=this.dU(a,b?15E3:1E4).then(function(a){c.ow(e);Qk(1);return a},function(a){f==c.gp.get(e)&&c.ow(e);Qk(0);return Promise.reject(a)});this.Tz.set(e,a);this.gp.set(e,f);return a};
d.JQ=function(a){a=a.getId();Vl.v("Aborting connection to device "+a);var b=this.Uz.get(a);b&&b.abort();this.ow(a)};d.ow=function(a){this.Tz.remove(a);this.Uz.remove(a);this.gp.remove(a)};d.dU=function(a,b){var c=this,e=new te(function(){return c.m4(a,b)},1E3,3);this.Uz.set(a.getId(),e);return e.bu(1.5).start().then(null,function(b){Vl.info("Failed to create channel to "+a.getId());return Promise.reject(b)})};
d.m4=function(a,b){var c=Wl++;Vl.info("Connecting to (id "+c+") "+a.getId());var e=new Kg("MediaRouter.Cast.Mdns.Channel.Open");return this.n4(a,b).then(function(a){Vl.info(function(){return"Channel opened (id "+c+"): "+JSON.stringify(a)});e.end("Success");return a},function(a){Vl.info("Channel did not open (id "+c+").");e.end("Failure");return Promise.reject(a)})};
d.n4=function(a,b){var c={ipAddress:a.qa,port:a.Va(),auth:"ssl_verified",timeout:1E4,livenessTimeout:b,pingInterval:5E3,capabilities:0};Vl.info(function(){return"Opening channel to "+JSON.stringify(c)});var e=new zc;chrome.cast.channel.open(c,function(a){Tl();"open"==a.readyState?e.resolve(a):(chrome.cast.channel.close(a,function(){chrome.runtime.lastError||Vl.v("Channel close success")}),e.reject(Error(a.errorState)))});return e.promise};var Vl=C("mr.cast.ChannelFactory"),Wl=0;var Xl=function(a,b,c,e){return{namespace_:a,data:r(b)?b:JSON.stringify(b),sourceId:c,destinationId:e}};var Yl=function(a){this.type="CLOSE";this.reasonCode=a};var $l=function(a){this.type="CONNECT";this.origin={};this.userAgent=Lb;var b=this.userAgent.indexOf("(")+1,b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:Tj,platform:Zl(),systemVersion:b,connectionType:1};this.connType=a?0:2},Zl=function(){switch(Gg()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var am=function(){this.Sg=new H};d=am.prototype;d.init=function(){Ih(this)};d.Hz=function(a,b,c,e){if(!this.jI(a,b,c)){var f=Xl(xk,new $l(e),b,c);chrome.cast.channel.send(a,f,Tl);this.Sg.set(this.Ay(a,b,c),e)}};d.WS=function(a,b,c,e){this.jI(a,b,c)&&(this.pL(a,b,c),b=Xl(xk,new Yl(e?5:0),b,c),chrome.cast.channel.send(a,b,Tl))};d.pL=function(a,b,c){this.Sg.remove(this.Ay(a,b,c))};d.X6=function(a){var b=this;this.Sg.rb().forEach(function(c){c.split("#")[0]==a.channelId.toString()&&b.Sg.remove(c)})};
d.s2=function(a,b){var c=this;this.Sg.forEach(function(e,f){var g=f.split("#");g[0]==a.channelId.toString()&&(c.Hz(b,g[1],g[2],e),c.Sg.remove(f))})};d.xU=function(a,b,c){this.Hz(a,b,c,0==c.indexOf("receiver-0"))};d.jI=function(a,b,c){return this.Sg.La(this.Ay(a,b,c))};d.Ay=function(a,b,c){return[a.channelId,b,c].join("#")};d.oa=function(){return"cast.VirtualConnectionManager"};d.getData=function(){var a=this.Sg.b();return[new bm(a)]};
d.Wa=function(){var a=Fh(this);if(a)for(var b in a.SO)this.Sg.set(b,a.SO[b])};na(am);var bm=function(a){this.SO=a};var cm=function(a,b){this.lw=b;this.Ad=a;this.Wh=new H;this.dh=new H;this.jk=am.W();this.zS=new Ul;this.aa=null};d=cm.prototype;d.init=function(){chrome.cast.channel.onMessage.addListener(this.O2.bind(this));chrome.cast.channel.onError.addListener(this.M2.bind(this));this.jk.init();Ih(this)};d.oH=function(){return this.Ad};d.Xt=function(a,b,c,e,f){var g=this,k=e||this.Ad,p=f||"receiver-0";return this.Ik(a).then(function(a){return g.h8(a,b,c,k,p)})};
d.o4=function(a,b,c,e){var f=this;return this.Ik(a).then(function(a){return f.jk.Hz(a,b,c,e)})};d.hE=function(a,b,c,e){(a=this.Wh.get(a))&&this.jk.WS(a,b,c,e)};
d.O2=function(a,b){$g(2);var c=this.dh.get(a.channelId);if(c){var e=this.aa(c);if(e){if(Ck.hasOwnProperty(b.namespace_)){c=JSON.parse(b.data);if("CLOSE"==c.type){this.jk.pL(a,b.destinationId,b.sourceId);return}dm.info("Got message "+(c.type||c.responseType)+" from "+e.getId())}else dm.info("Got message in "+b.namespace_+" from "+e.getId());this.lw.N2(e,b)}else dm.l("Receiver "+c+" not found.")}else dm.l("This message is from unknown receiver.")};
d.iE=function(a){chrome.cast.channel.close(a,function(){chrome.runtime.lastError||dm.v("Channel close success")});var b=this.dh.get(a.channelId);b&&(this.dh.remove(a.channelId),this.Wh.remove(b))};d.M2=function(a,b){$g(1);dm.l(function(){return"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):"")});b&&this.UQ(b.errorState,b);this.gE(a)};
d.UQ=function(a,b){switch(a){case "unknown":a=0;break;case "authentication_error":a=1;break;case "connect_error":a=2;break;default:return}if(b){if(-8192<=b.nssErrorCode&&-7192>b.nssErrorCode||2==b.challengeReplyErrorType||8==b.challengeReplyErrorType||9==b.challengeReplyErrorType||11==b.challengeReplyErrorType||-200>=b.netReturnValue&&-300<b.netReturnValue||30==b.eventType||31==b.eventType||32==b.eventType)a=3;if(26==b.eventType||-201==b.netReturnValue||-8181==b.nssErrorCode||-8162==b.nssErrorCode||
-8161==b.nssErrorCode)a=4;-138==b.netReturnValue&&(a=5);if(-8182==b.nssErrorCode||10==b.eventType||12==b.eventType)a=1}dm.l("Channel error code: "+a);Tg("MediaRouter.Cast.Channel.Error",a,Nk)};d.gE=function(a){var b=this,c=this.dh.get(a.channelId);this.iE(a);if(c){var e=this.aa(c);e&&this.Ik(e,!0).then(function(c){dm.info("Re-connected to receiver: "+e.getId());b.jk.s2(a,c);b.lw.P2(e)},function(){dm.info("Failed to re-connect to receiver: "+e.getId());b.jk.X6(a);b.lw.pz(e,a.errorState)})}};
d.Ik=function(a,b){b=void 0===b?!1:b;var c=this,e=a.getId(),f=this.Wh.get(e);return f&&"open"==f.readyState?Promise.resolve(f):this.zS.Ik(a,b).then(function(a){if(c.dh.La(a.channelId))return a;c.Wh.get(e)&&(dm.l("Duplicate channel to a receiver "+e),c.iE(c.Wh.get(e)));dm.info("Connected to: "+e);c.Wh.set(e,a);c.dh.set(a.channelId,e);return a},null)};
d.h8=function(a,b,c,e,f){var g=this;this.jk.xU(a,e,f);yl(c);var k=Xl(b,c,e,f);dm.info("Channel is sending message");dm.v(function(){return"....message was: "+JSON.stringify(k)});return new Promise(function(b,c){Tl();chrome.cast.channel.send(a,k,function(a){a.errorState?(c(Error("Failed to send message")),g.gE(a)):b(!0)})})};d.oa=function(){return"cast.ChannelService"};d.getData=function(){return[new em(this.Wh.b(),this.dh.b())]};d.Wa=function(){var a=Fh(this);a&&(this.Wh.addAll(a.l6),this.dh.addAll(a.AS))};
var dm=C("mr.cast.ChannelService"),em=function(a,b){this.l6=a;this.AS=b};var fm=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var gm=function(a,b){this.Gg=a;this.da=b;this.Wb=new qe;this.zc=new H};d=gm.prototype;d.init=function(){Ih(this)};d.lA=function(a){var b=this.zc.get(a);b?b.nA++:this.zc.set(a,{nA:1});this.P7()};d.VB=function(a){var b=this.zc.get(a);b&&(b.nA--,0<b.nA||(ee(this.da.Si(),function(b){switch(b.ue(a)){case "available":b.Ep(a,"available_rescan");break;case "unavailable":b.Ep(a,"unavailable_rescan")}}),this.zc.remove(a)))};
d.P7=function(){this.a.info("Scanning sinks for app availability");ee(this.da.Si(),this.zp,this)};
d.zp=function(a){var b=this;ee(this.zc.EG(),function(c){var e;a:{switch(a.ue(c)){case "unknown":case "available_rescan":case "unavailable_rescan":e=!0;break a}e=!1}if(e){var f=a.getId()+":"+c;b.Wb.contains(f)||(b.Wb.add(f),e=function(){b.Wb.remove(f)},(new te(b.DS.bind(b,a,c),5500,3)).bu(2).start().then(b.uO.bind(b,a,c),function(){b.a.error("Failed to get app availability response for "+a.getId()+", appId "+c+" after 3 attempts.");b.uO(a,c,"unknown")}).then(e,e))}})};
d.uO=function(a,b,c){c!=a.ue(b)&&(this.a.info(b+" on "+a.getId()+" is "+c),a.Ep(b,c),this.da.wd(a))};
d.DS=function(a,b){var c=this,e=new fm;e.appId=[b];var f=new Kg("MediaRouter.Cast.App.Availability");return this.Gg.sendRequest(e,a,yk,5E3).then(function(a){f.end("Success");c.a.v(function(){return"App availability response "+JSON.stringify(a)});for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(e){f.end("Failure");c.a.error("checkAppAvailability_ failed for "+a.getId()+", appId "+
b);throw e;})};d.oa=function(){return"cast.AppDiscoveryService"};d.getData=function(){return[new hm(this.zc.b())]};d.Wa=function(){var a=Fh(this);a&&this.zc.addAll(a.C6)};d.a=C("mr.cast.AppDiscoveryService");var hm=function(a){this.C6=a};var im=function(a,b,c){var e;e=Error.call(this);this.message=e.message;"stack"in e&&(this.stack=e.stack);this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,im);else if(b=Error().stack)this.stack=b;this.errorCode=a};ja(im,Error);var jm=function(a,b){this.sinks=a;this.origins=b||null},km=new jm([]);var lm=function(){},mm=function(a){if(!Ca(a,"urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;b=Ta(b,"/",2);if(3!=b.length)return null;var c=Ta(b[1],"-",1);if(2!=c.length)return null;var e=new lm;e.ora=a;e.MK=b[0];e.uqa=c[0];e.Rra=c[1];e.ci=b[2];return e};lm.prototype.M=function(){return this.ci};var nm=function(a,b,c,e,f,g){this.id=a;this.sinkId=b;this.mediaSource=c;this.isLocal=e;this.description=f;this.iconUrl=g;this.allowStop=!0;this.customControllerPath=null;this.forDisplay=!0;this.offTheRecord=!1;this.Nk=e;this.isOffscreenPresentation=!1},om=function(a,b,c,e,f,g,k){return new nm("urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+e,c,e,f,g,k)};var pm=function(a,b,c,e){return om(c,"cast",b.getId(),a,e,"",null)};var qm=function(a,b,c,e,f,g){this.routeId=a;this.clientId=b;this.appIds=c;this.autoJoinPolicy=e;this.origin=f;this.tabId=g;this.DI=this.uy=!1},rm=function(){this.Ab=[]};d=rm.prototype;d.init=function(){Ih(this)};d.V=function(){return this.Ab.length};d.rd=function(a){return db(this.Ab,function(b){return b.clientId==a})};d.zh=function(a){return db(this.Ab,function(b){return b.routeId==a})};d.zv=function(a,b,c,e,f,g){a=new qm(a,b,c,e,f,g);this.Ab.push(a);return a};
d.rA=function(a){this.Ab=$a(this.Ab,function(b){return b.clientId!=a})};d.oa=function(){return"cast.ClientRecords"};d.getData=function(){return[new sm(this.Ab)]};d.Wa=function(){var a=Fh(this);a&&(this.Ab=a.Ot)};var sm=function(a){this.Ot=a};var tm=function(a){this.da=a},um=function(a){var b=[];a.forEach(function(a){var c="Receiver-"+a.replace(/\./g,"_"),f=Yj.W().Bk||8009;b.push({serviceName:c+"._googlecast._tcp.local",serviceHostPort:c+":"+f,ipAddress:a,serviceData:["id=mdns:"+c,"ve=02","ca=5","st=1","fn="+c,"md=Chromecast"]})});return b};tm.prototype.init=function(){var a=um(Yj.W().dx);this.da.x6(a)};var vm=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var wm=function(a,b){this.Zf=[];this.ie=[];this.sinkId=a;this.session=b;this.Ts=this.Qo=null;this.offTheRecord=this.Fs=!1};d=wm.prototype;d.zv=function(a){if(fb(this.Zf,a))return!1;this.Zf.push(a);return!0};d.rA=function(a){return kb(this.Zf,a)};d.Ye=function(a){if(fb(this.ie,a))return!1;this.ie.push(a);return!0};d.Hj=function(a){return kb(this.ie,a)};d.i_=function(a,b){ul(a)?(this.Ts=a,this.Qo=b):ul(this.session)&&(this.Ts=this.session,this.Qo=this.sinkId,this.session=a,this.sinkId=b);return this};
var xm=function(){this.a=C("mr.cast.SessionRecords");this.Ab=[]};d=xm.prototype;d.init=function(){Ih(this)};d.gD=function(a,b){this.a.info("Adding new session: "+b+", "+a.sessionId);var c=this.Ae(a.sessionId);if(c)return c.i_(a,b);a=new wm(b,a);this.Ab.push(a);return a};d.fm=function(a){this.a.info("Removing session "+a);this.Ab=$a(this.Ab,function(b){return b.session.sessionId!=a})};d.ZF=function(a){return(a=this.Ae(a))?a.Zf:[]};d.hs=function(a){return(a=this.ro(a))?a.session:null};
d.rd=function(a){return db(this.Ab,function(b){return fb(b.Zf,a)})};d.zh=function(a){return db(this.Ab,function(b){return fb(b.ie,a)})};d.OY=function(a){return db(this.Ab,function(b){return null!=db(b.ie,function(b){return mm(b).MK==a})})};d.ro=function(a){return db(this.Ab,function(b){return b.sinkId==a||b.Qo==a})};d.Ae=function(a){return db(this.Ab,function(b){return b.session.sessionId==a})};d.uH=function(a){return(a=this.Ae(a))?a.sinkId:null};d.Vx=function(a){return(a=this.Ae(a))?a.session:null};
d.daa=function(a,b){var c=this.Vx(a);c&&(a=$a(b,function(a){return a.playerState!=chrome.cast.media.rq.IDLE}),a.forEach(function(a){if(!a.media){var b=db(c.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}}),c.media=a)};d.R5=function(a){for(var b=0;b<this.Ab.length;b++)this.Ab[b].rA(a)};d.oa=function(){return"cast.SessionRecords"};d.getData=function(){return[new ym(this.Ab)]};
d.Wa=function(){var a=Fh(this);if(a)for(var b=0;b<a.Ot.length;b++){var c=a.Ot[b],e=new wm(c.sinkId,c.session);e.Zf=c.Zf;e.ie=c.ie;e.Fs=c.Fs;e.Ts=c.Ts;e.Qo=c.Qo;this.Ab.push(e)}};var ym=function(a){this.Ot=a};var zm=function(a){this.Ad="sender-"+Qa();this.bb=new H;this.dj=null;Ih(this);this.B=a;this.Fb=new rm;this.ua=new xm;this.Tc=new cm(this.Ad,this);this.da=new Yk(this.Tc,this);this.KT=new tm(this.da);this.ld=new jl(this.Tc,this.Ad);this.hd=new gm(this.ld,this.da);this.Jd=new Pl(this.ld,this.da,this.Fb,this.ua,this.Tc,this);this.PD=new pl(this.da,this.ld);this.bba=this.da.start.bind(this.da)};d=zm.prototype;d.getName=function(){return"cast"};
d.uc=function(){this.ld.init();this.ua.init();this.Jd.init();this.Tc.init();this.da.init();this.KT.init();this.hd.init();this.B.mA(this.bba)};d.rg=function(){return this.bb.H()};d.Xn=function(a){var b=this;if(this.yI(a))return new jm([]);var c=new qe;this.Vn(a).forEach(function(a){b.da.vZ(a).map(function(a){return a.wh()}).forEach(function(a){c.add(a)})});return new jm(c.H(),-1!=a.indexOf("0F5096E8")?eh:null)};
d.startObservingMediaSinks=function(a){var b=this,c=this.OF(a);c?(this.a.info("Received broadcast request "+a),ee(this.da.Si(),function(a){b.ld.T7(c,a).catch(function(a){b.a.error("Broadcast failed "+a.message)})})):(this.Vn(a).forEach(function(a){b.hd.lA(a)}),this.B.wy()&&this.da.start())};d.stopObservingMediaSinks=function(a){var b=this;this.yI(a)||this.Vn(a).forEach(function(a){b.hd.VB(a)})};d.startObservingMediaRoutes=function(){};d.stopObservingMediaRoutes=function(){};
d.aa=function(a){return(a=this.da.aa(a))?a.wh():null};d.X7=function(a){var b=new yg(vm,"warning","dismiss");b.routeId=a;this.B.ng().send(b)};d.UH=function(a,b){this.a.error("Error launching.",b);this.Hj(a.id,!1,!0,"error");this.X7(a.id)};
d.wr=function(a,b,c,e,f,g,k){var p=this;Yj.W().Fj=new Xj(b.wc,b.qa);var q=pm(a,b,c,!0);q.forDisplay=!1;q.offTheRecord=e;this.bb.set(q.id,q);this.B.Wl(this,q);this.B.Yh(this.oa(),!0);(e=Nl(a))&&e.oc()&&this.WC(e,q.id,g,k);ch(a)||dh(a)?(q.Fe={tabId:k,sessionId:"",IN:b.qa||"",JN:b.wc||""},dh(a)&&(q.isOffscreenPresentation=!0),this.B.Up(this,q,c,function(e){return Cg(p.fJ(a,b,c,f,g,k,e))}).promise.then(function(){p.RM(q)},function(a){p.UH(q,a)})):this.fJ(a,b,c,f,g,k,q).then(null,function(a){p.UH(q,a)});
return Promise.resolve(q)};d.fJ=function(a,b,c,e,f,g,k){var p=this;return this.Jd.Ry(this.Zz(a,b,e),b).then(function(e){p.Ye(a,b,c,e,f,g,k);return k})};
d.createRoute=function(a,b,c,e,f,g,k){var p=this,q=this.da.aa(b);if(!q)return Bg(Error("No sink with ID "+b));var y=Ll(a);if(y){setTimeout(function(){p.Jd.WL(y,q,chrome.cast.bn.CAST)},0);var G=function(){return p.wr(a,q,c,e,f,g,k)},T=this.Fb.rd(y);if(T)return Cg(this.terminateRoute(T.routeId).then(G,G));if(g&&k&&(b=this.wE(a,g,k,e,f,b)))return b}return Cg(this.wr(a,q,c,e,f,g,k))};d.YT=function(a,b){this.B.Bf(this,a,b)};d.XT=function(a,b){var c=this.bb.get(a);c&&c.Nk&&this.B.rt(this,a,b)};
d.Hj=function(a,b,c,e){c=void 0===c?!1:c;e=void 0===e?"closed":e;this.a.info("Remove route "+a);var f=this.Fb.zh(a);if(f){b=b||f.DI;var g=f.clientId;this.a.info("Remove client "+g);this.ua.R5(g);this.Fb.rA(g)}if(g=this.ua.zh(a))g.Hj(a),this.pJ(g.ie);var k=this.bb.get(a);if(k)if(k.Nk&&g&&(this.Tc.hE(k.sinkId,f?f.clientId:this.Ad,g.session.transportId,b),k.forDisplay&&f&&(this.dj={Ek:f,aM:g})),this.bb.remove(a),this.B.sj(this,k),this.rg().some(function(a){return a.isLocal})||this.B.Yh(this.oa(),!1),
c)this.B.onPresentationConnectionClosed(a,e,"Remove route");else this.B.onPresentationConnectionStateChanged(a,"terminated")};d.lca=function(a){var b=this;a.ie.forEach(function(c){if(c=b.bb.get(c)){var e=a.session;c.Fe&&c.forDisplay?b.RM(c):(c.description=e.statusText||e.displayName,b.B.Nh(b,c))}})};
d.fca=function(a){var b=this;ab(a,function(a){a=b.bb.get(a,null);if(!a||!a.mediaSource)return!1;var c=Nl(a.mediaSource),c=c?c.qy:!1;return a.isLocal&&!c})&&x(a,function(a){if(a=b.bb.get(a,null))a.isLocal=!0})};
d.pJ=function(a){var b=this,c=[],e=[],f=null;a.forEach(function(a){if(a=b.bb.get(a)){a.forDisplay=!1;var g=Nl(a.mediaSource);g&&db(g.Un(),Bl)||(a.Nk?(g=g?g.lx():null,f||g==chrome.cast.Rf.CUSTOM_CONTROLLER_SCOPED||(c.push(a),f=a.sinkId)):f&&f!=a.sinkId?c.push(a):e.push(a))}});x(0<c.length?c:e,function(a){a.forDisplay=!0})};d.WC=function(a,b,c,e){var f=a.oc();f&&!this.Fb.rd(f)&&(this.a.info("Add client "+f),this.Fb.zv(b,f,a.Un(),a.lx(),c||null,l(e)?e:null))};
d.RM=function(a){var b=this.ua.zh(a.id);b&&(b=b.session,b.statusText=a.description||b.statusText)};
d.Ye=function(a,b,c,e,f,g,k){var p=this.ua.ro(b.getId());p||(p=this.ua.gD(e,b.getId()));var q=null!=a;if(!q&&Bl(e.appId))return null;var y;null==a?(y=new Hl([{appId:e.appId,capabilities:e.capabilities}]),a=y.toString()):y=Nl(a);var G=k;if(G){if(!this.bb.get(G.id))return this.a.l("Route "+G.id+" not added"),G}else G=pm(a,b,c||e.sessionId,q),this.bb.set(G.id,G);c=G.id;this.a.info("Add route "+c);a=null;y&&(a=y.oc(),this.WC(y,c,f,g));p.Ye(c);G.Nk&&this.Tc.o4(b,a||this.Ad,e.transportId,!(y&&y.qy));p.offTheRecord=
G.offTheRecord;f=p.ie;this.fca(f);this.pJ(f);f=G;g=e.sessionId;y=e.appId;("0F5096E8"==y||"85CDB22F"==y)&&g&&f.Fe&&(f.Fe.sessionId=g);!zl(e,zk)||null!==e&&fb(Al,e.appId)||(f.customControllerPath="cast_route_details.html?"+["sessionId="+g,"appId="+y].join("&"));f.description=e.statusText||e.displayName;k?this.B.Nh(this,G):(this.B.Wl(this,G),G.isLocal&&this.B.Yh(this.oa(),!0));a&&p.zv(a)&&this.Jd.x3(e,b,a);return G};
d.terminateRoute=function(a){var b=this,c=this.bb.get(a);if(!c)return Promise.reject(new im(3,"Route in Cast provider not found for routeId  "+a));var e=this.ua.zh(a);if(!e)return this.Hj(a,!0),Promise.resolve();var f=e.session.sessionId,g=this.da.aa(c.sinkId);if(!g)return this.Jd.fm(f),Promise.resolve();(a=this.Fb.zh(a))&&this.Jd.WL(a.clientId,g,chrome.cast.bn.STOP);Pk(0);return new Promise(function(a){var c=function(){b.Jd.oL(g.getId());a()};b.ld.g7(f,g).then(c,c)})};
d.YU=function(a){var b=this,c=null;fe(this.bb.cy(),function(e){if(!e.Nk)return!1;var f=b.da.aa(e.sinkId);if(!f||!a.e1(b.Zz(e.mediaSource,f)))return!1;c=e;return!0});if(!c||!c.mediaSource)return null;var e=Ol(c.mediaSource);if(!e)return null;var f=this.Fb.rd(e);return f?(e=this.ua.rd(e))?{Ek:f,aM:e}:null:null};
d.xR=function(a,b,c){var e=this.YU(a);if(!e){if(!this.dj||this.dj.Ek.origin!=b||this.dj.Ek.tabId!=c)return null;e=this.dj}switch(a.lx()){case chrome.cast.Rf.PAGE_SCOPED:return null;case chrome.cast.Rf.ORIGIN_SCOPED:if(b!=e.Ek.origin)return null;break;case chrome.cast.Rf.TAB_AND_ORIGIN_SCOPED:if(b!=e.Ek.origin||c!=e.Ek.tabId)return null}return this.ua.Ae(e.aM.session.sessionId)};
d.wE=function(a,b,c,e,f,g){var k=this,p=null;fe(this.bb.cy(),function(a){var b=a.Fe;return b&&null!=b.tabId&&b.tabId==c&&ah(a.mediaSource)?(p=a,!0):!1});if(!p)return null;var q=function(){return k.createRoute(a,g||p.sinkId,"",e,f,b,null==c?void 0:c)};return Cg(this.terminateRoute(p.id).then(q,q))};
d.connectRouteByRouteId=function(a,b,c,e,f){if(!Nl(a))return Bg(Error("Unsupported presentation URL"));b=mm(b);b=this.ua.Ae(b.MK);if(!b)return Bg(Error("No matching route"));var g=this.da.aa(b.sinkId);return g?(a=this.Ye(a,g,c,b.session,e,f))?Ag(a):Bg(Error("Failed to create route")):Bg(Error("No sink"))};
d.joinRoute=function(a,b,c,e,f,g){var k=Nl(a);if(!k)return Bg(Error("Unsupported presentation URL"));var p;if(b==chrome.cast.zC){if(p=this.xR(k,f,g),!p&&k.nW()!=chrome.cast.qq.CAST_THIS_TAB&&(e=this.wE(a,f,g,c,e)))return e}else p=this.gH(b);if(!p)return Bg(Error("No matching route"));if(p.offTheRecord!=c)return Bg(Error("Off the record mismatch"));e=this.da.aa(p.sinkId);if(!e)return Bg(Error("No sink"));a=this.Ye(a,e,b,p.session,f,g);a.offTheRecord=c;return Ag(a)};
d.detachRoute=function(a){this.Hj(a,!1,!0)};d.ml=function(a){var b=new wh,c=this.da.aa(a);if(!c)return null;c=c.kd;c&1||(b.shouldCaptureVideo=!1);c&4||(b.shouldCaptureAudio=!1);b.shouldCaptureAudio&&!b.shouldCaptureVideo&&(b.minLatencyMillis=b.maxLatencyMillis,b.animatedLatencyMillis=b.maxLatencyMillis);b.senderSideLetterboxing=!0;b.mJ();this.a.info(function(){return"Settings for "+a+": "+b.Ju()});return b.shouldCaptureAudio||b.shouldCaptureVideo?b:null};d.ll=function(){return"cast_streaming"};
d.sendRouteMessage=function(a,b,c){var e=this;if(!c)return this.Jd.Bf(a,b),Promise.resolve();var f=this.ua.zh(a);if(!f)return Promise.reject(Error("Not managing the route "+a));var g=this.da.aa(f.sinkId);if(!g)return Promise.reject(Error("Sink no longer accessible"));var k=(a=this.Fb.zh(a))?a.clientId:this.Ad;return new Promise(function(a){e.Tc.Xt(g,c.namespace,b,k,f.session.transportId).then(a,a)})};
d.rn=function(a,b){var c=this.da.aa(b);if(!c)return!1;a=this.Zz(a,c);return(a=Ml(a))&&0!=a.length?ab(a,function(a){return Dk(c.ue(a))}):!1};d.yk=function(a,b,c){var e=this.Vn(a);return e&&0!=e.length?b==chrome.cast.zC?!0:c&&c.mediaSource?(a=Ml(c.mediaSource),ab(a,function(a){return fb(e,a)})):void 0==b||this.gH(b)?!0:!1:!1};d.Zz=function(a,b,c){return ch(a)||dh(a)?(a={appId:0==(b.kd&1)?"85CDB22F":"0F5096E8",capabilities:wl(b.kd)},(new Hl([a],void 0,void 0,void 0,c)).toString()):a};
d.Vn=function(a){var b=[];if(ch(a)||dh(a)){var c=Gg();bh(a)&&"ChromeOS"!=c&&"Windows"!=c||b.push("85CDB22F");b.push("0F5096E8")}else(a=Ml(a))&&(b=nb(b,a));return b};d.yI=function(a){return null!=this.OF(a)};d.OF=function(a){var b=Nl(a);if(!b)return null;a=this.Vn(a);var c=b.$v||"",b=b.Zv;return c&&b?new el(a,c,JSON.stringify(b)):null};d.gH=function(a){return 0==a.indexOf(chrome.cast.KC)?this.ua.Ae(a.substr(chrome.cast.KC.length)):this.ua.OY(a)};d.pz=function(a){this.da.pz(a.getId());Pk(2)};
d.P2=function(a){this.Jd.VK(a,!0)};d.N2=function(a,b){this.PD.o_(a,b);this.Jd.S3(a.getId(),b)};d.tj=function(a){this.B.onSinkAvailabilityUpdated(this,1);this.wd(a);this.Jd.VK(a)};d.ut=function(a){if(0==this.da.Yx())this.B.onSinkAvailabilityUpdated(this,0);this.Jd.ut(a.getId());this.ZH()};d.wd=function(a){this.hd.zp(a);this.ZH()};d.ZH=function(){this.PD.X_();this.B.be()};d.oa=function(){return"cast.Provider"};d.getData=function(){return[new Am(this.Ad,this.bb.b(),this.dj)]};
d.Wa=function(){var a=Fh(this);a&&(this.Ad=a.ZL,this.bb.addAll(a.routes),this.dj=a.r1)};d.searchSinks=function(){return null};d.a=C("mr.CastProvider");var Am=function(a,b,c){this.ZL=a;this.routes=b;this.r1=c};var Bm=function(){if(!Ub)return!1;try{return new ActiveXObject("MSXML2.DOMDocument"),!0}catch(a){return!1}};Ub&&Bm();var Cm=function(a,b){Hc.call(this);this.HJ=a||0;this.kj=b||10;if(this.HJ>this.kj)throw Error("[goog.structs.Pool] Min can not be greater than max");this.hc=new Xi;this.Ch=new qe;this.Jw=0;this.Cy=null;this.zq()};w(Cm,Hc);d=Cm.prototype;d.getObject=function(){var a=v();if(!(null!=this.Cy&&a-this.Cy<this.Jw)){var b=this.M6();b&&(this.Cy=a,this.Ch.add(b));return b}};d.Gj=function(a){return this.Ch.remove(a)?(this.Av(a),!0):!1};
d.M6=function(){for(var a;0<this.sG()&&(a=this.hc.nh(),!this.nz(a));)this.zq();!a&&this.V()<this.kj&&(a=this.dg());return a};d.Av=function(a){this.Ch.remove(a);this.nz(a)&&this.V()<this.kj?this.hc.enqueue(a):this.Di(a)};d.zq=function(){for(var a=this.hc;this.V()<this.HJ;)a.enqueue(this.dg());for(;this.V()>this.kj&&0<this.sG();)this.Di(a.nh())};d.dg=function(){return{}};d.Di=function(a){if("function"==typeof a.Pa)a.Pa();else for(var b in a)a[b]=null};
d.nz=function(a){return"function"==typeof a.oS?a.oS():!0};d.contains=function(a){return this.hc.contains(a)||this.Ch.contains(a)};d.V=function(){return this.hc.V()+this.Ch.V()};d.sX=function(){return this.Ch.V()};d.sG=function(){return this.hc.V()};d.yb=function(){return this.hc.yb()&&this.Ch.yb()};d.U=function(){Cm.T.U.call(this);if(0<this.sX())throw Error("[goog.structs.Pool] Objects not released");delete this.Ch;for(var a=this.hc;!a.yb();)this.Di(a.nh());delete this.hc};var Dm=function(a,b){this.xf=a;this.Gd=b};Dm.prototype.getKey=function(){return this.xf};Dm.prototype.tc=function(){return this.Gd};Dm.prototype.clone=function(){return new Dm(this.xf,this.Gd)};var Em=function(a){this.ae=[];a&&this.D0(a)};d=Em.prototype;d.insert=function(a,b){var c=this.ae;c.push(new Dm(a,b));this.r2(c.length-1)};d.D0=function(a){var b;if(a instanceof Em){if(b=a.rb(),a=a.H(),0>=this.V()){for(var c=this.ae,e=0;e<b.length;e++)c.push(new Dm(b[e],a[e]));return}}else b=Ab(a),a=zb(a);for(e=0;e<b.length;e++)this.insert(b[e],a[e])};d.remove=function(){var a=this.ae,b=a.length,c=a[0];if(!(0>=b))return 1==b?gb(a):(a[0]=a.pop(),this.q2(0)),c.tc()};
d.q2=function(a){for(var b=this.ae,c=b.length,e=b[a];a<c>>1;){var f=this.BX(a),g=this.jZ(a),f=g<c&&b[g].getKey()<b[f].getKey()?g:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e};d.r2=function(a){for(var b=this.ae,c=b[a];0<a;){var e=this.uY(a);if(b[e].getKey()>c.getKey())b[a]=b[e],a=e;else break}b[a]=c};d.BX=function(a){return 2*a+1};d.jZ=function(a){return 2*a+2};d.uY=function(a){return a-1>>1};d.H=function(){for(var a=this.ae,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].tc());return b};
d.rb=function(){for(var a=this.ae,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].getKey());return b};d.Kk=function(a){return ab(this.ae,function(b){return b.tc()==a})};d.La=function(a){return ab(this.ae,function(b){return b.getKey()==a})};d.clone=function(){return new Em(this)};d.V=function(){return this.ae.length};d.yb=function(){return 0==this.ae.length};d.clear=function(){gb(this.ae)};var Fm=function(){Em.call(this)};w(Fm,Em);Fm.prototype.enqueue=function(a,b){this.insert(a,b)};Fm.prototype.nh=function(){return this.remove()};var Gm=function(a,b){this.KE=void 0;this.Rt=new Fm;Cm.call(this,a,b)};w(Gm,Cm);d=Gm.prototype;d.getObject=function(a,b){if(!a)return(a=Gm.T.getObject.call(this))&&this.Jw&&(this.KE=h.setTimeout(u(this.ts,this),this.Jw)),a;this.Rt.enqueue(l(b)?b:100,a);this.ts()};d.ts=function(){for(var a=this.Rt;0<a.V();){var b=this.getObject();if(b)a.nh().apply(this,[b]);else break}};d.Av=function(a){Gm.T.Av.call(this,a);this.ts()};d.zq=function(){Gm.T.zq.call(this);this.ts()};
d.U=function(){Gm.T.U.call(this);h.clearTimeout(this.KE);this.Rt.clear();this.Rt=null};var Hm=function(a,b,c,e){this.Zi=a;this.Tg=!!e;Gm.call(this,b,c)};w(Hm,Gm);Hm.prototype.dg=function(){var a=new xf,b=this.Zi;b&&b.forEach(function(b,e){a.headers.set(e,b)});this.Tg&&a.zB(!0);return a};Hm.prototype.nz=function(a){return!a.isDisposed()&&!a.ug()};var Im=function(a,b,c,e,f,g){E.call(this);this.yg=l(a)?a:1;this.Pg=l(f)?Math.max(0,f):0;this.Tg=!!g;this.Zm=new Hm(b,c,e,g);this.Ac=new H;this.Ha=new kk(this)};w(Im,E);var Jm="ready complete success error abort timeout".split(" ");d=Im.prototype;d.ou=function(a){this.Pg=Math.max(0,a)};
d.send=function(a,b,c,e,f,g,k,p,q,y){if(this.Ac.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new Km(b,u(this.v_,this,a),c,e,f,k,l(p)?p:this.yg,q,l(y)?y:this.Tg);this.Ac.set(a,b);a=u(this.l_,this,a);this.Zm.getObject(a,g);return b};d.abort=function(a,b){var c=this.Ac.get(a);if(c){var e=c.hv;c.q8(!0);b&&(e&&(this.qL(e,c.tC),gd(e,"ready",function(){this.Zm.Gj(e)},!1,this)),this.Ac.remove(a));e&&e.abort()}};
d.l_=function(a,b){var c=this.Ac.get(a);c&&!c.hv?(this.kR(b,c.tC),b.ou(this.Pg),b.nN(c.gm),b.zB(c.Tg),c.hv=b,this.dispatchEvent(new Lm("ready",this,a,b)),this.zL(a,b),c.SC&&b.abort()):this.Zm.Gj(b)};d.v_=function(a,b){var c=b.target;switch(b.type){case "ready":this.zL(a,c);break;case "complete":return this.r_(a,c,b);case "success":this.f0(a,c);break;case "timeout":case "error":this.zo(a,c);break;case "abort":this.j_(a,c)}return null};
d.zL=function(a,b){var c=this.Ac.get(a);!c||c.nE||c.ky()?(c&&(this.qL(b,c.tC),this.Ac.remove(a)),this.Zm.Gj(b)):(c.u0(),b.send(c.getUrl(),c.k2,c.Gb,c.Zr()))};d.r_=function(a,b,c){var e=this.Ac.get(a);if(7==b.Eh||b.Xd()||e.ky())if(this.dispatchEvent(new Lm("complete",this,a,b)),e&&(e.P8(!0),e.mE))return e.mE.call(b,c);return null};d.j_=function(a,b){this.dispatchEvent(new Lm("abort",this,a,b))};d.f0=function(a,b){this.dispatchEvent(new Lm("success",this,a,b))};
d.zo=function(a,b){this.Ac.get(a).ky()&&this.dispatchEvent(new Lm("error",this,a,b))};d.qL=function(a,b,c){this.Ha.Fc(a,c||Jm,b)};d.kR=function(a,b,c){this.Ha.listen(a,c||Jm,b)};d.U=function(){Im.T.U.call(this);this.Zm.Pa();this.Zm=null;this.Ha.Pa();this.Ha=null;this.Ac.clear();this.Ac=null};var Lm=function(a,b,c,e){D.call(this,a,b);this.id=c;this.hv=e};w(Lm,D);
var Km=function(a,b,c,e,f,g,k,p,q){this.Uu=a;this.k2=c||"GET";this.Gb=e;this.Zi=f||null;this.yg=l(k)?k:1;this.vD=0;this.SC=this.nE=!1;this.tC=b;this.mE=g;this.gm=p||"";this.Tg=!!q;this.hv=null};d=Km.prototype;d.getUrl=function(){return this.Uu};d.Zr=function(){return this.Zi};d.bs=function(){return this.yg};d.u0=function(){this.vD++};d.ky=function(){return this.vD>this.yg};d.P8=function(a){this.nE=a};d.q8=function(a){this.SC=a};var Mm=function(){this.name="unknown";this.state="error";this.H0=null;this.allowStop=!0;this.Hg=null;this.extraData={}},Nm=function(a,b){this.jP=a;this.Uf=b;this.M7=!!b&&"running"==b.state},Qm=function(a,b,c){void 0===b&&(Om||(Om=new Im(3,null,1,10,2E3)),b=Om);void 0===c&&(Pm||(Pm=new Im(0,null,1,10,15E3)),c=Pm);this.Oe=a;this.Ym=b;this.$m=[];this.kP=c;this.a=C("mr.dial.Client")};d=Qm.prototype;d.abort=function(){var a=this;this.$m.forEach(function(b){a.Ym.abort(b,!0);a.kP.abort(b,!0)})};
d.launchApp=function(a,b){var c=new zc,e=(++Rm).toString();this.$m.push(e);this.kP.send(e,this.kx(a),"POST",b,null,0,this.rF("launchApp","POST",e,c));return c.promise};d.QN=function(a){var b=new zc,c=(++Rm).toString();this.$m.push(c);this.Ym.send(c,this.kx(a),"DELETE",null,null,0,this.rF("stopApp","DELETE",c,b),0);return b.promise};d.jx=function(a){var b=this;return new Promise(function(c){var e=(++Rm).toString();b.$m.push(e);b.Ym.send(e,b.kx(a),"GET",null,null,0,u(b.g3,b,e,c))})};
d.g3=function(a,b,c){kb(this.$m,a);a=c.target;ue(this.a,"GetAppInfo","GET",a,!0);if(a.Xd())if(c=ve(a)){var e=c.getElementsByTagName("service");if(e&&1==e.length){c=new Mm;for(var f=0,g=e[0].childNodes.length;f<g;f++){var k=e[0].childNodes[f];if("state"==k.nodeName){a:switch(k.textContent){case "running":k="running";break a;case "stopped":k="stopped";break a;default:k="error"}c.state=k}else"name"==k.nodeName?c.name=k.textContent:"link"==k.nodeName?c.Hg=k.getAttribute("href"):"options"==k.nodeName?
c.allowStop="false"!=k.getAttribute("allowStop"):c.extraData[k.nodeName]=k.innerHTML}if("unknown"==c.name)this.a.info("GET response missing name value"),b(new Nm(a,null));else if("error"==c.state)this.a.info("GET response missing state value"),b(new Nm(a,null));else{if((e=/installable=(.+)/.exec(c.state))&&e[1])c.state="installable",c.H0=e[1];else if("running"!=c.state&&"stopped"!=c.state){this.a.info("GET response has invalid state value");b(new Nm(a,null));return}b(new Nm(a,c))}}else this.a.info("Invalid GET response (invalid service)"),
b(new Nm(a,null))}else this.a.info("Invalid or empty response"),b(new Nm(a,null));else this.a.info("Request to "+a.as()+" failed"),b(new Nm(a,null))};d.kx=function(a){var b=this.Oe.oh;"/"!=b.charAt(b.length-1)&&(b+="/");return b+a};d.rF=function(a,b,c,e){var f=this;return function(g){kb(f.$m,c);g=g.target;ue(f.a,a,b,g,!0);g.Xd()?e.resolve(void 0):e.reject(Error(Ve(g.Eh)))}};var Om=null,Pm=null,Rm=999;var Sm=function(a,b,c){this.appName=b;this.launchParameter=void 0===c?"":c},Um=function(a){if(a.startsWith("urn:dial-multiscreen-org:dial:application:")){var b=a.indexOf("?"),c=a.substring(42,0<b?b:void 0);a=c&&0<c.length?new Sm(a,c,0<b?a.substring(b+1):void 0):null}else a=Tm(a);return a},Tm=function(a){var b=(new Hj(a)).Ji;if(!b)return null;var c=Vm.exec(b),c=c?c[1]:null;if(!c)return null;c=decodeURIComponent(c);if(b=(b=Wm.exec(b))?b[1]:void 0)try{b=yj(b)}catch(e){return Xm.l("Invalid base64 encoded postData:"+
b),null}return new Sm(a,c,b)},Xm=C("mr.dial.MediaSource"),Vm=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,Wm=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var Ym=function(a,b){this.Ya=a;this.appName=b};var Zm=function(a){this.yd=new Map;this.xv=a};d=Zm.prototype;d.init=function(){Ih(this)};d.clear=function(){this.yd.clear()};d.add=function(a){this.QF(a.Ya.id)||(this.yd.set(a.Ya.id,a),this.xv.y2(a))};d.QF=function(a){return this.yd.get(a)||null};d.RF=function(a){for(var b=ia(this.yd),c=b.next();!c.done;c=b.next())if(c=ia(c.value),c.next(),c=c.next().value,c.Ya.sinkId==a)return c;return null};d.I6=function(a){if(a=this.RF(a))this.yd.delete(a.Ya.id),this.xv.TJ(a)};
d.kL=function(a){var b=this.yd.get(a);b&&(this.yd.delete(a),this.xv.TJ(b))};d.rg=function(){return Array.from(this.yd.values(),function(a){return a.Ya})};d.oV=function(){return Array.from(this.yd.values())};d.oa=function(){return"dial.ActivityRecords"};d.getData=function(){return[Array.from(this.yd)]};d.Wa=function(){var a=Fh(this);a&&(this.yd=new Map(a))};var $m={rea:0,Mga:1,Sfa:2,qea:3},an={ERROR:0,jga:1,EMPTY:2},bn=function(a){Tg("MediaRouter.Dial.Create.Route",a,$m)},cn=function(a){Tg("MediaRouter.Dial.Device.Description.Failure",a,an)};var dn=/^([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/,en=[4278190080,4293918720,4294901760],fn=[167772160,2886729728,3232235520],gn=function(a){var b=document.createElement("a");b.href=a;return b};var hn=function(){this.configId=this.modelName=this.deviceType=this.expireTimeMillis=this.fetchTimeMillis=this.appUrl=this.ipAddress=this.friendlyName=this.deviceLabel=this.uniqueId=null};
hn.prototype.QO=function(){var a;if(this.deviceLabel)if(this.uniqueId)if(this.friendlyName)if(this.ipAddress)if(this.appUrl)if(this.fetchTimeMillis)if(this.expireTimeMillis){a=this.ipAddress;var b=gn(this.appUrl);a="http:"==b.protocol&&b.hostname==a?null:"Invalid appUrl"}else a="Missing expireTimeMillis";else a="Missing fetchTimeMillis";else a="Missing appUrl";else a="Missing ipAddress";else a="Missing friendlyName";else a="Missing uniqueId";else a="Missing deviceLabel";return a};
hn.prototype.toString=function(){return JSON.stringify(this,function(a,b){return r(b)&&0==b.indexOf("uuid:")?"***":b})};
var jn=function(a){var b=new hn;b.uniqueId=a.uniqueId;b.deviceLabel=a.deviceLabel;b.friendlyName=a.friendlyName;b.ipAddress=a.ipAddress;b.appUrl=a.appUrl;b.fetchTimeMillis=a.fetchTimeMillis;b.expireTimeMillis=a.expireTimeMillis;b.deviceType=a.deviceType;b.modelName=a.modelName;b.configId=a.configId;return b},mn=function(a){this.qn=new Map;this.Wb=new Map;this.Sz=new Map;var b;(b=a)||(kn||(kn=new Im(3,null,1,10,2E3)),b=kn);this.Ym=b;a||(ln||(ln=new Im(2,null,1,10,3E3)),a=ln);this.LQ=a;this.a=C("mr.dial.DeviceDescriptionService");
Ih(this)};d=mn.prototype;d.oa=function(){return"mr.dial.DeviceDescriptionService"};d.getData=function(){return[Array.from(this.qn)]};d.Wa=function(){var a=Fh(this);if(a)for(var a=ia(a),b=a.next();!b.done;b=a.next()){var c=ia(b.value),b=c.next().value,c=c.next().value;null!=jn(c).QO()?this.a.error("Dropping invalid description "+b+" loaded from storage."):this.qn.set(b,jn(c))}};d.xW=function(a){var b=this.CS(a);return b?(Sg("MediaRouter.Dial.Device.Description.Cached"),Promise.resolve(b)):this.PU(a)};
d.KQ=function(a){var b=this.Wb.get(a);b&&(this.Ym.abort(a,!0),b.nb.reject(Error("Aborted")))};d.CS=function(a){var b=this.qn.get(a.deviceLabel);return b?b.configId!=a.configId||Date.now()>=b.expireTimeMillis?(this.a.v("Removing invalid entry "+b.toString()),this.qn.delete(a.deviceLabel),null):b:null};
d.PU=function(a){var b=this;if(!nn(a.deviceDescriptionUrl))return Promise.reject(Error("Invalid device description URL: "+a.deviceDescriptionUrl));var c=this.Wb.get(a.deviceLabel);if(c){if(c.deviceDescriptionUrl==a.deviceDescriptionUrl)return c.nb.promise;this.KQ(a.deviceLabel)}var e=new zc,c={deviceDescriptionUrl:a.deviceDescriptionUrl,nb:e};this.Wb.set(a.deviceLabel,c);this.Ym.send(a.deviceLabel,a.deviceDescriptionUrl,"GET",null,null,0,function(c){b.Wb.delete(a.deviceLabel);(c=b.I5(a,c))?e.resolve(c):
e.reject(Error("Failed to get device description"))});return e.promise};
d.I5=function(a,b){b=b.target;ue(this.a,"fetchDeviceDescription","GET",b);if(!b.Xd())return this.a.info("Request to "+b.as()+" failed"),cn(0),null;var c=ve(b);if(!c)return this.a.info("Invalid or empty response"),cn(2),null;b=this.I4(b,a,c);if(!b)return cn(1),this.a.info("Invalid device description"),null;this.a.info("Got device description for "+b.deviceLabel);this.a.v("... device description was: "+b.toString());null!=b.configId&&(this.a.v("Caching device description for "+b.deviceLabel),this.qn.set(a.deviceLabel,
b));return b};
d.I4=function(a,b,c){var e=new hn;e.fetchTimeMillis=Date.now();e.expireTimeMillis=e.fetchTimeMillis+18E5;e.deviceLabel=b.deviceLabel;e.configId=b.configId;e.appUrl=a.getResponseHeader("Application-URL")||null;a=gn(b.deviceDescriptionUrl);e.ipAddress=a.hostname;e.deviceType=on(c,"deviceType");e.modelName=on(c,"modelName");e.friendlyName=on(c,"friendlyName");e.uniqueId=on(c,"UDN");!e.friendlyName&&e.modelName&&(e.friendlyName=e.modelName,e.uniqueId&&(e.friendlyName+="["+e.uniqueId.slice(-4)+"]"),this.a.l("Fixed device description: created friendlyName from modelName."));
a=e.QO();this.a.v(function(){return"Device description: "+pn(c)});return a?(this.a.l(function(){return"Device description failed to validate: "+e},a),null):e};var on=function(a,b){return(a=a.getElementsByTagName(b))&&0!=a.length?a[0].textContent:null},pn=function(a){var b=function(a){for(var b=0,c=a.length;b<c;b++)a[b].textContent="***"};b(a.getElementsByTagName("UDN"));b(a.getElementsByTagName("serialNumber"));return(new XMLSerializer).serializeToString(a)};
mn.prototype.tn=function(a){var b=this,c=this.Sz.get(a);if(c)return c.promise;c=new zc;this.Sz.set(a,c);this.LQ.send(a,a,"GET",null,null,0,function(e){b.Sz.delete(a);e=e.target;ue(b.a,"checkAccess","GET",e,!1);c.resolve(e.Xd())});return c.promise};
var nn=function(a){a=gn(a);var b;if(b="http:"==a.protocol)a:{b:if((a=a.hostname.match(dn))&&5==a.length){b=[];for(var c=0;4>c;c++)if(b[c]=Number.parseInt(a[c+1],10),0>b[c]||255<b[c]){a=null;break b}a=b}else a=null;if(a)for(a=(a[0]<<24|a[1]<<16|a[2]<<8|a[0])>>>0,b=0;3>b;b++)if((a&en[b])>>>0==fn[b]){b=!0;break a}b=!1}return b},kn=null,ln=null;var qn=null,rn=null,sn=function(){qn||(qn=new Ri(3,"dial.DialOnDeviceListEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onDeviceList));rn||(rn=new Ri(4,"dial.DialOnErrorEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onError));return[qn,rn]};var tn=function(a,b){b=void 0===b?new mn:b;this.Np=a;this.OE=b;this.a=C("mr.dial.SinkDiscoveryService");this.Dc=new Map;this.nt=this.Uy=!1;this.gf={wk:0,Fl:0};this.sr=0};ja(tn,gh);d=tn.prototype;d.init=function(){Ih(this);qh("mr.dial.SinkDiscoveryService",this)};d.start=function(){this.Uy||(this.a.info("Starting..."),this.Uy=!0,sn().forEach(function(a){return a.addListener()}),this.refresh())};
d.refresh=function(){var a=this;this.Uy?chrome.dial.discoverNow(function(b){a.a.info("chrome.dial.discoverNow = "+b)}):this.a.info("Not started. Ignoring discover().")};
d.c3=function(a){var b=this;this.a.info("onDeviceList returned "+a.length+" devices");this.a.v(function(){return"....the list is: "+JSON.stringify(a)});this.nt=!1;var c=0,e=[],f=new Set;a.forEach(function(a){e.push(b.J5(a).then(function(a){f.add(a.getId());b.Q1(a)},function(){c++}))});pi(e).then(function(){b.nt||b.Ft(f).then(function(){var a=b.Dc.size;b.aL(a,a+c)})})};
d.aL=function(a,b){this.gf={wk:a,Fl:b};36E5>Date.now()-this.sr||(a=this.gf,Ug("MediaRouter.Dial.AvailableDevicesCount",a.wk),Ug("MediaRouter.Dial.KnownDevicesCount",a.Fl),this.sr=Date.now())};d.Q1=function(a){if(!this.nt){this.a.v("mayAddSink, id = "+a.getId());var b=this.Dc.get(a.getId());b?b.update(a)&&(this.a.v("Updated sink "+b.getId()),this.Np.wd(b)):(this.a.v(function(){return"Adding new sink "+a.getId()+": "+a.eO()}),this.Dc.set(a.getId(),a),this.Np.tj(a))}};
d.Ft=function(a){var b=this,c=[],e=[];this.Dc.forEach(function(f){a.has(f.getId())||e.push(b.BS(f).then(function(a){a||(b.Dc.delete(f.getId()),c.push(f))}))});return pi(e).then(function(){0<c.length&&b.Np.Ge(c)})};d.BS=function(a){return a.eg?this.OE.tn(a.eg):Promise.resolve(!1)};
d.J5=function(a){return this.OE.xW(a).then(function(b){var c;b.uniqueId?(c=b.uniqueId,0==c.indexOf("uuid:")&&(c=c.substr(5)),c=c.replace(/-/g,"").toLowerCase()):c="";var e=b.uniqueId?Yj.W().$k(c):a.deviceLabel,f=un.test(b.modelName);return(new Ek(b.friendlyName,c)).fu(e).B9(b.ipAddress).a9(b.appUrl).Z8(a.deviceDescriptionUrl).W9(b.modelName).xN(!f)})};
d.a4=function(a){switch(a.code){case "no_valid_network_interfaces":case "network_disconnected":this.a.l("DIAL error: "+a.code+". Clear device list now.");a=Array.from(this.Dc.values());this.Dc.clear();this.Np.Ge(a);this.aL(0,0);this.nt=!0;break;case "no_listeners":case "socket_error":case "cellular_network":case "unknown":this.a.l("DIAL error: "+a.code+". Keep device list.");break;default:this.a.l("Unhandled DIAL error: "+a.code)}};d.aa=function(a){return this.Dc.get(a)||null};
d.wZ=function(a){var b=[];this.Dc.forEach(function(c){"available"==c.ue(a)&&b.push(c.wh())});var c=vn[a];return new jm(b,c?[c]:void 0)};d.Ud=function(){return Array.from(this.Dc.values())};d.H2=function(a,b){this.Np.wd(b)};d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.dial.onDeviceList)this.c3.apply(this,[].concat(ka(c)));else if(a==chrome.dial.onError)this.a4.apply(this,[].concat(ka(c)));else throw Error("Unhandled event");};d.oa=function(){return"dial.DialSinkDiscoveryService"};
d.getData=function(){return[new wn(Array.from(this.Dc),this.gf),{deviceCountMetricsRecordTime:this.sr}]};d.Wa=function(){var a=Fh(this);if(a){for(var b=ia(a.sinks),c=b.next();!c.done;c=b.next())c=c.value,this.Dc.set(c[0],Fk(c[1]));this.gf=a.deviceCounts}if(a=Gh(this))this.sr=a.deviceCountMetricsRecordTime};
var vn={YouTube:"https://www.youtube.com",Netflix:"https://www.netflix.com",Pandora:"https://www.pandora.com",Radio:"https://www.pandora.com",Hulu:"https://www.hulu.com",Vimeo:"https://www.vimeo.com",Dailymotion:"https://www.dailymotion.com","com.dailymotion":"https://www.dailymotion.com"},un=/Eureka Dongle|Chromecast Audio/i,wn=function(a,b){this.sinks=a;this.deviceCounts=b};var xn=function(a,b){this.a=C("mr.dial.AppDiscoveryService");this.zc=new Set;this.da=a;this.fd=b;this.Wb=new Map;this.rw=new Map;this.Pe=null;this.km=!1};d=xn.prototype;d.init=function(){Ih(this)};d.start=function(){this.a.info("Starting periodic scanning.");this.km||(this.km=!0,this.YE())};d.stop=function(){this.a.info("Stopping periodic scanning.");this.km&&(this.km=!1,this.Pe&&(clearTimeout(this.Pe),this.Pe=null),this.Wb.clear(),this.rw.forEach(function(a){a.abort()}))};
d.lA=function(a){if(!this.zc.has(a)||this.pR(a))this.zc.add(a),0!=this.da.Dc.size&&(this.km?this.da.Ud().forEach(this.XE.bind(this,a)):this.start())};d.VB=function(a){this.zc.delete(a)};d.UY=function(){return Array.from(this.zc)};
d.YE=function(){var a=this;this.a.info("Start app status scan.");var b=[];this.da.Ud().forEach(function(c){b.push.apply(b,a.zp(c))});this.fd.oV().forEach(function(c){b.push(a.O7(c))});pi(b).then(function(){a.km&&!a.Pe&&(a.a.v("Scan complete; scheduling for next scan."),a.Pe=setTimeout(function(){a.gU()},6E4))})};d.gU=function(){this.a.v("Start app status scan (timer-based)");this.Pe=null;this.YE()};
d.zp=function(a){if(!a.Fm)return[];for(var b=[],c=ia(this.zc),e=c.next();!e.done;e=c.next())b.push(this.XE(e.value,a));return b};d.XE=function(a,b){if("unknown"!=b.ue(a)&&36E5>Date.now()-b.rV(a)||!b.Fm)return Promise.resolve();this.a.v("Querying "+b.getId()+" for "+a+" to update app status");return this.JF(b,a).then(this.X1.bind(this,b,a))};
d.O7=function(a){var b=this.da.aa(a.Ya.sinkId);if(!b)return this.a.l("Activity refers to nonexistent sink: "+a.Ya.id),Promise.resolve();if(!b.Fm)return Promise.resolve();a=a.appName;this.a.v("Querying "+b.getId()+" for "+a+" to update activity");return this.JF(b,a).then(this.W1.bind(this,b,a))};d.AW=function(a){var b=this.rw.get(a.getId());b||(b=new Qm(a),this.a.v("Created DIAL client for "+a.getId()),this.rw.set(a.getId(),b));return b};
d.JF=function(a,b){var c=this,e=yn(a,b),f=this.Wb.get(e);if(f)return f;f=this.AW(a).jx(b);this.Wb.set(e,f);a=function(){c.Wb.delete(e)};f.then(a,a);return f};d.BV=function(a,b){if(404==b.jP.Qa())return"unavailable";b=b.Uf;if("Netflix"==a)return this.qV(b);switch(b.state){case "running":case "stopped":return"available";default:return"unavailable"}};d.qV=function(a){return!a.extraData||"websocket"!=a.extraData.capabilities||"running"!=a.state&&"stopped"!=a.state?"unavailable":"available"};
var yn=function(a,b){return a.getId()+":"+b};d=xn.prototype;d.X1=function(a,b,c){if(404==c.jP.Qa()||c.Uf){c=this.BV(b,c);this.a.v("Got app status "+c+" from "+a.getId()+" for "+b);var e=a.ue(b);a.Ep(b,c);c!=e&&this.da.H2(b,a)}else this.a.l("Failed to process app availability; "+a.getId()+" does not support app availability"),a.xN(!1)};d.W1=function(a,b,c){(a=this.fd.RF(a.getId()))&&a.appName==b&&!c.M7&&this.fd.kL(a.Ya.id)};d.pR=function(a){return this.da.Ud().some(function(b){return"unknown"==b.ue(a)})};
d.oa=function(){return"dial.AppDiscoveryService"};d.getData=function(){return[this.UY()]};d.Wa=function(){var a=Fh(this);this.zc=new Set(a||[])};var zn=function(a,b,c){this.B=a;this.Cc=b||new tn(this);this.fd=new Zm(this);this.hd=c||new xn(this.Cc,this.fd);this.a=C("mr.DialProvider")};d=zn.prototype;d.getName=function(){return"dial"};d.uc=function(){this.fd.init();this.Cc.init();this.Cc.start();this.hd.init();this.Wo()};d.Xn=function(a){this.a.v("GetAvailableSinks for "+a);return(a=Um(a))?this.Cc.wZ(a.appName):km};d.startObservingMediaSinks=function(a){if(a=Um(a))this.hd.lA(a.appName),this.Wo()};
d.stopObservingMediaSinks=function(a){if(a=Um(a))this.hd.VB(a.appName),this.ct()};d.startObservingMediaRoutes=function(){this.Wo()};d.stopObservingMediaRoutes=function(){this.ct()};d.ct=function(){(0==this.Cc.Dc.size||0==this.hd.zc.size&&0==this.fd.yd.size)&&this.hd.stop()};d.Wo=function(){0<this.Cc.Dc.size&&(0<this.hd.zc.size||0<this.fd.yd.size)&&this.hd.start()};d.aa=function(a){return(a=this.Cc.aa(a))?a.wh():null};d.rg=function(){return this.fd.rg()};
d.createRoute=function(a,b,c,e){var f=this,g=this.Cc.aa(b);if(!g)return bn(0),Bg(Error("Unkown sink: "+b));Yj.W().Fj=new Xj(g.wc,g.qa);var k=Um(a);if(!k)return Bg(Error("No app name set."));var p=k.appName,q=this.LJ(g);return Cg(q.jx(p).then(function(a){if(!a.Uf)throw Error("Failed to get app info");if("running"==a.Uf.state)return q.QN(p)}).then(function(){return q.launchApp(p,k.launchParameter)}).then(function(){return f.Ye(b,a,!0,p,c,e)}).catch(function(a){bn(3);throw a;}))};d.joinRoute=function(){return Bg(Error("Not supported"))};
d.connectRouteByRouteId=function(){return Bg(Error("Not supported"))};d.detachRoute=function(){};d.Ye=function(a,b,c,e,f,g){bn(1);a=om(f,this.getName(),a,b,c,e,null);a.offTheRecord=g;this.fd.add(new Ym(a,e));return a};d.tj=function(a){this.B.onSinkAvailabilityUpdated(this,1);this.Wo();this.hd.zp(a);this.B.be();Yj.W().Ej=new Xj(a.wc,a.qa)};d.Ge=function(a){var b=this;if(0==this.Cc.Dc.size)this.B.onSinkAvailabilityUpdated(this,0);this.ct();a.forEach(function(a){b.fd.I6(a.getId())});this.B.be()};
d.wd=function(){this.B.be()};d.y2=function(a){this.Wo();this.B.Wl(this,a.Ya)};d.TJ=function(a){a=a.Ya;if(a.isLocal)this.B.onPresentationConnectionStateChanged(a.id,"terminated");this.ct();this.B.sj(this,a)};d.terminateRoute=function(a){var b=this.fd.QF(a);if(!b)return Promise.reject(new im(3,"Route in DIAL provider not found for routeId "+a));this.fd.kL(a);return(a=this.Cc.aa(b.Ya.sinkId))?this.LJ(a).QN(b.appName):Promise.reject(new im(3,"Sink in DIAL provider not found for sinkId "+b.Ya.sinkId))};
d.ml=function(){return null};d.ll=function(){return null};d.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending message is not supported"))};d.rn=function(a,b){b=this.Cc.aa(b);return!b||ch(a)?!1:(a=Um(a))?"available"==b.ue(a.appName):!1};d.yk=function(){return!1};d.searchSinks=function(){return null};d.LJ=function(a){return new Qm(a)};var An=function(a,b){this.xS=a;this.Mw=b;this.bh=this.xS.da;this.a=C("mr.cast.CastDialSinkDiscoveryCallbacks")};d=An.prototype;d.jU=function(a){return this.bh.tn(a)};d.sH=function(a){var b=this.bh.aa(a.getId());return b?b:(a=a.qa)?this.bh.uZ(a,Yj.W().Bk||8009):null};d.tj=function(a){this.sH(a)?Rk(2):this.qO(a);this.Mw.tj(a)};d.qO=function(a){var b=this,c=Hk(a);c&&this.jU(c).then(function(e){e?b.sH(a)?Rk(2):(b.bh.en(c),Rk(0)):Sg("MediaRouter.Dial.Sink.Discovered.NonCast")},n)};
d.Ge=function(a){var b=this;x(a,function(a){var c=b.bh.aa(a.getId());c&&c.Sk&&b.bh.Ij(a.getId())});this.Mw.Ge(a)};d.wd=function(a){var b=this.bh.aa(a.getId());b?b.Sk&&(b.update(a.el(),a.qa,b.Va(),b.kd)&&this.a.info("Updated Cast sink with DIAL sink: "+a.getId()),this.bh.wd(b)):this.qO(a);this.Mw.wd(a)};var Bn=function(a,b){this.da=new tn(new An(b,this));this.Nj=new H;this.B=a;this.Dp=this.Sj=0;this.Po=new qe;this.gb=new zn(this,this.da)};d=Bn.prototype;d.oa=function(){return"cast.DialProviderWrapper"};d.getData=function(){return[new Cn(this.Nj.b(),this.Sj,this.Dp,this.Po.H())]};d.Wa=function(){var a=Fh(this);a&&(this.Nj.addAll(a.E7),this.Sj=a.sequenceNumber,this.Dp=a.p8,this.Po.addAll(a.u1))};d.getName=function(){return this.gb.getName()};d.uc=function(){this.gb.uc();Ih(this)};d.rg=function(){return this.gb.rg()};
d.hK=function(){};d.Xn=function(a){return this.gb.Xn(a)};d.startObservingMediaSinks=function(a){this.gb.startObservingMediaSinks(a)};d.stopObservingMediaSinks=function(a){this.gb.stopObservingMediaSinks(a)};d.startObservingMediaRoutes=function(a){this.gb.startObservingMediaRoutes(a)};d.stopObservingMediaRoutes=function(a){this.gb.stopObservingMediaRoutes(a)};d.aa=function(a){return this.gb.aa(a)};d.Ur=function(a){return new Qm(a)};d.sx=function(a){return this.da.aa(a)};
d.eU=function(a,b,c,e){var f=this,g=Um(a),k=this.sx(b);if(!k)return Promise.reject(Error("Attempting custom launch with closed route"));var p=g.appName;if(!p)return Promise.reject(Error("No app name given"));var q=Ll(a);if(!q)return Promise.reject(Error("No client ID"));var y=null;return this.Ur(k).jx(p).then(function(a){if(!a.Uf)return Promise.reject(Error("Failed to get app info"));y=a.Uf}).then(function(){return f.gb.Ye(b,a,!0,p,e,c)}).then(function(a){var b={routeId:a.id,sinkId:k.getId(),appName:p,
Uf:y,launchParameter:g.launchParameter,session:null,clientId:null};f.Nj.set(a.id,b);f.tT(b,q);return a})};d.O0=function(a){return Dn.test(a)};d.createRoute=function(a,b,c,e,f,g,k){return this.O0(a)?Cg(this.eU(a,b,e,c)):this.gb.createRoute(a,b,c,e,f,g,k)};
d.terminateRoute=function(a){var b=this.Nj.get(a);if(b&&b.session&&b.clientId){var c={receiver:this.Aw(b.sinkId),action:chrome.cast.bn.STOP},c=new Dl("receiver_action",c);c.clientId=b.clientId;this.B.Bf(this,b.routeId,c);this.B.onPresentationConnectionStateChanged(b.routeId,"terminated")}return this.gb.terminateRoute(a)};
d.sendRouteMessage=function(a,b,c){var e=JSON.parse(b);switch(e.type){case "client_connect":return this.b7(a,e.clientId);case "custom_dial_launch":if(this.Po.contains(e.sequenceNumber))return this.T2(a,e);break;case "v2_message":if("STOP"==e.message.type)return this.terminateRoute(a),Promise.resolve()}return this.gb.sendRouteMessage(a,b,c)};d.oY=function(){var a=String(this.Dp);this.Dp=(this.Dp+1)%9007199254740992;return a};
d.tT=function(a,b){var c=this.Aw(a.sinkId),e=new Dl("receiver_action",{receiver:c,action:chrome.cast.bn.CAST});e.clientId=b;this.B.Bf(this,a.routeId,e);c=new chrome.cast.D(this.oY(),"",a.appName,[],c);a.session=c;a.clientId=b;c=new Dl("new_session",c);c.clientId=b;this.B.Bf(this,a.routeId,c)};
d.T2=function(a,b){this.Po.remove(b.sequenceNumber);b=b.message;a=this.Nj.get(a);if(!a)return Promise.reject(Error("Unknown route"));if(b&&!b.doLaunch)return Promise.resolve();var c=this.sx(a.sinkId);if(!c)return Promise.reject(Error("Custom launch response for sink that no longer exists"));var c=new Qm(c),e=a.launchParameter,e=(b?b.launchParameter:null)||e;return c.launchApp(a.appName,e)};
d.Aw=function(a){var b=this.sx(a);a=new chrome.cast.qv(a,b.el());a.ipAddress=b.qa;a.receiverType=chrome.cast.sq.DIAL;return a};d.nY=function(){var a=this.Sj;this.Sj=(this.Sj+1)%9007199254740992;return a};
d.b7=function(a,b){a=this.Nj.get(a);if(!a)return Promise.reject(Error("Unknown route"));var c=this.Aw(a.sinkId);c.receiverType=chrome.cast.sq.DIAL;c=new Dl("custom_dial_launch",new chrome.cast.FC(c,a.Uf.state,a.Uf.extraData));c.clientId=b;c.sequenceNumber=this.nY();this.Po.add(c.sequenceNumber);this.B.Bf(this,a.routeId,c);return Promise.resolve()};d.ml=function(a){return this.gb.ml(a)};d.ll=function(a){return this.gb.ll(a)};d.rn=function(a,b){return this.gb.rn(a,b)};
d.yk=function(a,b,c){return this.gb.yk(a,b,c)};d.connectRouteByRouteId=function(a,b,c,e,f){return this.gb.connectRouteByRouteId(a,b,c,e,f)};d.joinRoute=function(a,b,c,e,f,g){return this.gb.joinRoute(a,b,c,e,f,g)};d.detachRoute=function(a){this.Nj.remove(a);this.gb.detachRoute(a)};d.be=function(){this.B.be()};d.onSinkAvailabilityUpdated=function(a,b){this.B.onSinkAvailabilityUpdated(a,b)};d.Wl=function(a,b){this.B.Wl(this,b)};d.sj=function(a,b){this.B.sj(this,b)};
d.Nh=function(a,b){this.B.Nh(this,b)};d.Bf=function(a,b,c){this.B.Bf(this,b,c)};d.onPresentationConnectionStateChanged=function(a,b){this.B.onPresentationConnectionStateChanged(a,b)};d.onPresentationConnectionClosed=function(a,b,c){this.B.onPresentationConnectionClosed(a,b,c)};d.Ox=function(a){return this.B.Ox(a)};d.Tx=function(){return this.B.Tx()};d.ng=function(){return this.B.ng()};d.rt=function(a,b,c){this.B.rt(this,b,c)};d.xz=function(a){this.B.xz(a)};d.tj=function(a){this.gb.tj(a)};d.Ge=function(a){this.gb.Ge(a)};
d.wd=function(a){this.gb.wd(a)};d.Up=function(){};d.Qu=function(){};d.searchSinks=function(a,b){return this.gb.searchSinks(a,b)};d.mA=function(a){this.B.mA(a)};d.wy=function(){return this.B.wy()};d.Yh=function(a,b){return this.B.Yh(a,b)};var Cn=function(a,b,c,e){this.E7=a;this.sequenceNumber=b;this.p8=c;this.u1=e},Dn=/__dialAppName__/;var En=function(a,b){this.routeId=a;this.message=b},Fn=function(a){return"string"!=typeof a.message};var Gn=function(a){if(0>=a)throw Error("invalid buffer size");this.Vd=[];this.Hm=[];this.Ll=a};d=Gn.prototype;d.enqueue=function(a){this.V()>=this.Ll&&this.nh();this.Hm.push(a)};d.nh=function(){if(this.yb())throw Error("Empty queue");0==this.Vd.length&&(this.Vd=this.Hm,this.Vd.reverse(),this.Hm=[]);return this.Vd.pop()};d.ST=function(){var a=this.H();this.clear();return a};d.V=function(){return this.Vd.length+this.Hm.length};d.Q0=function(){return this.V()==this.Ll};d.yb=function(){return 0==this.V()};
d.H=function(){var a=this.Vd.slice();a.reverse();a.push.apply(a,[].concat(ka(this.Hm)));return a};d.clear=function(){this.Vd=[];this.Hm=[]};var Hn=function(a){this.ud=a;this.Qe=this.Ms=null};d=Hn.prototype;d.RS=function(){null!=this.Qe&&(clearTimeout(this.Qe),this.Qe=null)};d.LL=function(){if(null==this.Qe)if(null==this.Ms||Date.now()-this.Ms>=this.ud)this.Yb();else{var a=Math.max(this.Ms+this.ud-Date.now(),5);this.Qe=setTimeout(this.Yb.bind(this),a)}};d.QL=function(){this.Yb()};d.Yb=function(){this.RS();this.ZE();this.Ms=Date.now()};d.ZE=function(){};var In=function(a,b){Hn.call(this,20);this.Ff=new Map;this.Hh=new Set;this.KA=null;this.Oq=this.Qg=0;this.GN=!1;this.B=a;this.j2=b;this.a=C("mr.RouteMessageSender")};ja(In,Hn);d=In.prototype;d.init=function(a){this.KA=a;Ih(this)};d.x1=function(a){this.Hh.has(a)||(this.Hh.add(a),this.l0(a)&&this.LL())};d.stopListeningForRouteMessages=function(a){this.Hh.delete(a)};
d.send=function(a,b){var c=this.Ff.get(a);c||(c=new Gn(50),this.Ff.set(a,c));if(c.Q0()){this.a.l("Queue is full; dropping oldest message");this.a.v("   for route "+a);var e=c.nh();this.Qg-=Fn(e)?0:e.message.length;Fn(e)&&this.Oq--}b=new En(a,b);c.enqueue(b);this.Qg+=Fn(b)?0:b.message.length;Fn(b)&&this.Oq++;this.cC();this.Hh.has(a)&&this.LL()};d.sj=function(a){this.Hh.delete(a);var b=this.Ff.get(a);b&&(this.Ff.delete(a),this.gK(b.H()),this.cC())};
d.gK=function(a){if(0!=a.length){a=ia(a);for(var b=a.next();!b.done;b=a.next())b=b.value,this.Qg-=Fn(b)?0:b.message.length,Fn(b)&&this.Oq--}};d.l0=function(a){return this.Ff.has(a)&&!this.Ff.get(a).yb()};d.cC=function(){var a=0<this.Oq||this.Qg>this.j2;a!=this.GN&&(this.GN=a,this.B.Yh(this.oa(),a))};d.ZE=function(){if(this.KA){for(var a=ia(this.Hh),b=a.next();!b.done;b=a.next()){var b=b.value,c=this.Ff.get(b);c&&!c.yb()&&(c=c.ST(),this.KA(b,c),this.gK(c))}this.cC()}else this.a.error("sendMessagesCallback not set. Messages not delivered.")};
d.oa=function(){return"mr.RouteMessageSender"};d.getData=function(){var a=Array.from(this.Ff,function(a){return[a[0],a[1].H()]}),b=Array.from(this.Hh);return[new Jn(a,b,this.Qg)]};d.Wa=function(){var a=this,b=Fh(this);b&&(this.Ff=new Map,b.j6.forEach(function(b){var c=b[0];b=b[1];var f=new Gn(50);a.Ff.set(c,f);b.forEach(function(a){f.enqueue(a)})}),this.Hh=new Set(b.B1),this.Qg=b.Lba)};var Jn=function(a,b,c){this.j6=a;this.B1=b;this.Lba=c};var Kn=function(a,b,c){Hc.call(this);this.wg=null!=c?u(a,c):a;this.ud=b;this.ti=u(this.Ez,this);this.oi=[]};w(Kn,Hc);d=Kn.prototype;d.Ne=!1;d.He=0;d.Za=null;d.Sn=function(a){this.oi=arguments;this.Za||this.He?this.Ne=!0:this.Uk()};d.stop=function(){this.Za&&($d(this.Za),this.Za=null,this.Ne=!1,this.oi=[])};d.pause=function(){this.He++};d.resume=function(){this.He--;this.He||!this.Ne||this.Za||(this.Ne=!1,this.Uk())};d.U=function(){Kn.T.U.call(this);this.stop()};
d.Ez=function(){this.Za=null;this.Ne&&!this.He&&(this.Ne=!1,this.Uk())};d.Uk=function(){this.Za=Zd(this.ti,this.ud);this.wg.apply(null,this.oi)};var Ln=function(a){this.am=a;this.a=C("mr.ExternalMessageHandler")};
Ln.prototype.onMessage=function(a,b,c){this.a.info("Received a message from "+b.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,a=this.am.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new ai(a.meetingName,a.domain)),b="PresentationId"+b.id+Mn++,this.am.createRoute("urn:x-org.chromium.media:source:desktop",a,b).then(function(a){c(new Ff(e,"route",a.id))}).catch(function(a){c(new Ff(e,"error",a))})):"stop"==a.type?this.am.terminateRoute(a.message.routeId).then(function(){c(new Ff(e,
"stopped"))}):(c(new Ff(e,"error",Error("Unhandled message type"))),this.a.error("Unhandled message type "+a.type))};var Mn=0;var Nn=function(){this.Xf=new Gn(1E3);this.ei=Date.now()};d=Nn.prototype;d.init=function(){tc=1;var a=C("browser"),b=window.onerror;window.onerror=function(c,f,g,k,p){b&&b(c,f,g,k,p);a.error("Error: "+c+" ("+f+" @ Line: "+g+")",p)};uc.push(this.w3.bind(this));var c=window.localStorage["debug.logs"];c&&(tc=xc(c.toUpperCase(),0));window.localStorage["debug.console"]&&uc.push(this.Zy.bind(this))};d.w3=function(a){this.Xf.enqueue(this.xF(a,!1));a=a.ig;a instanceof Error&&a.stack&&this.Xf.enqueue(a.stack)};
d.Zy=function(a){var b=[this.xF(a,!0)];a.ig&&b.push(a.ig);switch(a.level){case 3:console.error.apply(console,[].concat(ka(b)));break;case 2:console.warn.apply(console,[].concat(ka(b)));break;case 1:console.log.apply(console,[].concat(ka(b)));break;default:console.debug.apply(console,[].concat(ka(b)))}};
d.xF=function(a,b){var c=["["];if(b)c.push(("       "+((Date.now()-this.ei)/1E3).toFixed(3)).slice(-7));else{var e=new Date(a.time),f=function(a){return 10>a?"0"+a:a};c.push(e.getFullYear().toString(),"-",f(e.getMonth()+1),"-",f(e.getDate())," ",f(e.getHours()),":",f(e.getMinutes()),":",f(e.getSeconds()),".",f(Math.floor(e.getMilliseconds()/10)))}c.push("][",wc[a.level],"][",a.m,"] ",a.message);if(!b&&null!=a.ig)if(c.push("\n"),a.ig instanceof Error)c.push(a.ig.message);else try{c.push(JSON.stringify(a.ig))}catch(g){c.push(a.ig.toString())}c.push("\n");
return c.join("")};d.getLogs=function(){return 0==this.Xf.V()?"NA":this.Xf.H().join("")};d.w6=function(){Ih(this)};d.oa=function(){return"LogManager"};d.getData=function(){return[this.Xf.H()]};d.Wa=function(){var a=this.Xf.H();this.Xf.clear();for(var b=ia(Fh(this)||[]),c=b.next();!c.done;c=b.next())this.Xf.enqueue(c.value);a=ia(a);for(c=a.next();!c.done;c=a.next())this.Xf.enqueue(c.value)};na(Nn);var On=function(a){this.am=a;this.a=C("mr.InternalMessageHandler")};
On.prototype.onMessage=function(a,b,c){var e=this;if("retrieve_log_data"!=a.type)c(new Ff(chrome.runtime.id,"error",Error("Unhandled message type")));else{var f={logs:Nn.W().getLogs(),device:Yj.W().NY()};b=[];var g=Kf(f.device.ip).then(function(a){a&&(f.device.version=a)});b.push(g);var k=this.am.No;k&&(a=this.G1(k,a.source).then(function(a){a&&(f.castStreamingLogs=a)},function(){e.a.error("Log upload failed for service: "+k)}),b.push(a));b.push(this.YC(f,"mr.cast.SinkDiscoveryService","castDeviceCounts"));
b.push(this.YC(f,"mr.dial.SinkDiscoveryService","dialDeviceCounts"));pi(b).then(function(){c(f)})}};On.prototype.YC=function(a,b,c){var e=this;return lh(b).then(function(b){b=b.gf;a[c]=b.Fl+"."+b.wk},function(){e.a.error("Failed to get device counts for "+c+".")})};On.prototype.G1=function(a,b){return this.am.cs(a).then(function(a){return a.Fg(b)})};var Pn=function(){this.vc=null;this.a=C("mr.IssueSenderImpl")};Pn.prototype.init=function(a){this.vc=a};Pn.prototype.send=function(a){if(this.vc)if(this.vc.onIssue)this.vc.onIssue(a);else this.a.error("MediaRouterService.onIssue not defined.");else this.a.error("MediaRouterService is not set.")};var Qn=function(a,b){D.call(this,"internal_message");this.routeId=a;this.message=b};ja(Qn,D);var Rn=function(a,b,c){this.CL=a;this.Gf=b;this.h2=c;this.onMessage=function(){};c.listen("internal_message",this.tt,!1,this)};Rn.prototype.sendMessage=function(a,b){return this.Gf(this.CL,a,b)};Rn.prototype.tt=function(a){if(a.routeId==this.CL)this.onMessage(a.message)};Rn.prototype.Pa=function(){this.onMessage=function(){};this.h2.Fc("internal_message",this.tt,!1,this)};var Sn=new Rn("",function(){return Promise.resolve()},new E),Tn=function(a){this.B=a};
Tn.prototype.$r=function(a){var b=this.B.Ox(a);return b?new Rn(a,b.sendRouteMessage.bind(b),this.B.Tx()):Sn};var Un=function(){this.a=C("mr.ProviderManager");this.de=[];this.he=new Map;this.hm=new Map;this.Mg=new Set;this.Oj=new Set;this.kt=new Map;this.vc=this.No=null;this.xm=!1;this.DL=new E;this.EL=new Kn(this.e8,500,this);this.Vaa=new Kn(this.GU,500,this);this.pj=new In(this,524288);this.Wz=0;this.LI=new Pn;this.ym=new Map;this.et=-1==window.navigator.userAgent.indexOf("Windows");this.dt=[];this.Js=[];this.uI=new On(this);this.kF=new Ln(this);this.onBeforeInvokeHandler=this.K2;this.createRoute=this.createRoute;
this.joinRoute=this.joinRoute;this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;this.startObservingMediaRoutes=
this.startObservingMediaRoutes;this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.onPresentationSessionDetached=this.detachRoute=this.detachRoute;this.enableMdnsDiscovery=this.enableMdnsDiscovery;this.searchSinksAndCreateRoute=this.searchSinksAndCreateRoute;this.searchSinks=this.searchSinks;this.updateMediaSinks=this.updateMediaSinks};ja(Un,gh);d=Un.prototype;
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.runtime.onMessage)this.uI.onMessage.apply(this.uI,[].concat(ka(c)));else if(a==chrome.runtime.onMessageExternal)this.kF.onMessage.apply(this.kF,[].concat(ka(c)));else throw Error("Unhandled event");};d.cs=function(a){var b=this;a=this.kt.get(a);return lh(a).then(function(a){a.uc(b);return a})};d.v6=function(a){a.forEach(this.A6,this)};
d.uc=function(a,b){this.kt.set("webrtc","mr.mirror.webrtc.WebRtcService");this.kt.set("cast_streaming","mr.mirror.cast.Service");this.kt.set("hangouts","mr.mirror.hangouts.HangoutsService");var c=new Tn(this);xg||(xg=c);this.vc=a;this.LI.init(a);this.pj.init(this.vc.onRouteMessagesReceived.bind(this.vc));this.v6(b);Ih(this);qh("mr.ProviderManager",this)};
d.A6=function(a){if(this.fs(a.getName()))this.a.l("Provider "+a.getName()+" already registered.");else try{a.uc(),this.de.push(a),this.ym.set(a.getName(),0)}catch(b){this.a.l("Provider "+a.getName()+" failed to initialize.",b)}};
d.xq=function(a,b){var c=this;return new Promise(function(e,f){var g=null;c.G5();var g=window.setTimeout(function(){g=null;a.cancel(new im(2,"timeout after "+b+" ms."))},b),k=function(){c.lR();null!=g&&window.clearTimeout(g)};a.promise.then(function(a){k();e(a)},function(a){k();f(a instanceof im?a:a instanceof Error?new im(0,a.message,a.stack):new im(0))})})};d.WQ=function(a,b){return this.xq(Cg(a),b)};d.G5=function(){this.Wz++;this.bz()};d.lR=function(){this.Wz--;this.bz()};d.K2=function(){$g(0)};
d.createRoute=function(a,b,c,e,f,g,k){var p=this,q=this.KY(a,b);if(!q)return Promise.reject(new im(7,"No provider supports createRoute with source: "+a+" and sink: "+b));g=g&&0<g?g:6E4;a=q.createRoute(a,b,c,k||!1,g,e,f);return this.xq(a,g).then(function(a){return a},function(a){p.a.error("Error creating route.",a);throw a;})};
d.connectRouteByRouteId=function(a,b,c,e,f,g){var k=this.he.get(b);if(!k)return Promise.reject(new im(7,"No provider supports join "+b));a=k.connectRouteByRouteId(a,b,c,e,f);return this.xq(a,g&&0<g?g:3E4)};d.joinRoute=function(a,b,c,e,f,g){var k=this.JY(a,b);if(!k)return Promise.reject(new im(7,"No provider supports join "+b));f=f&&0<f?f:3E4;a=k.joinRoute(a,b,g||!1,f,c,e);return this.xq(a,f)};
d.terminateRoute=function(a){var b=this.he.get(a);return b?this.wJ(a).then(function(){return b.terminateRoute(a)}):Promise.reject(new im(3,"Route not found for routeId "+a))};d.startObservingMediaSinks=function(a){this.Mg.has(a)||(this.Mg.add(a),this.de.forEach(function(b){b.startObservingMediaSinks(a)}));this.gA(a)};d.stopObservingMediaSinks=function(a){this.Mg.delete(a)?this.$E(a):this.a.info("No existing query "+a)};d.$E=function(a){this.de.forEach(function(b){b.stopObservingMediaSinks(a)})};
d.gA=function(a){var b=this;if("urn:x-org.chromium.media:source:tab:-1"==a)this.a.l("No sinks for sourceUrn: "+a);else{var c=new Map,e=[];this.de.forEach(function(f){var g=f.Xn(a);0<g.sinks.length&&(e=g.origins);g.sinks.forEach(function(a){c.has(a.id)?b.a.l("Detected duplicate sink "+a.id+" from provider: "+f.getName()):c.set(a.id,a)})});this.f8(a,Array.from(c.values()),e||[])}};d.f8=function(a,b,c){this.a.info("Sending "+b.length+" sinks to MR for "+a);this.vc.onSinksReceived(a,b,c)};
d.sendRouteMessage=function(a,b,c){var e=this.he.get(a);return e?this.WQ(e.sendRouteMessage(a,b,c),3E4):Promise.reject(Error("Invalid route ID "+a))};d.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data"))};d.startListeningForRouteMessages=function(a){this.pj.x1(a)};d.stopListeningForRouteMessages=function(a){this.pj.stopListeningForRouteMessages(a)};
d.detachRoute=function(a){var b=this.he.get(a);b?b.detachRoute(a):this.a.info("Route "+a+" does not exist.")};d.enableMdnsDiscovery=function(){this.et=!0;this.dt.forEach(function(a){a()});this.dt.length=0};d.KY=function(a,b){return this.de.find(function(c){return c.rn(a,b)})||null};d.JY=function(a,b){return this.de.find(function(c){return c.yk(a,b)})||null};d.GU=function(){var a=this;this.Mg.forEach(function(b){a.gA(b)})};d.bz=function(){this.vc.setKeepAlive(0<this.Wz||0<this.Js.length)};
d.startObservingMediaRoutes=function(a){this.Oj.has(a)||(this.xm=!0,this.Oj.add(a),this.de.forEach(function(b){b.startObservingMediaRoutes(a)}));this.EL.Sn()};d.stopObservingMediaRoutes=function(a){this.Oj.delete(a)?(0==this.Oj.size&&(this.xm=!1),this.de.forEach(function(b){b.stopObservingMediaRoutes(a)})):this.a.info("No existing route query "+a)};
d.e8=function(){var a=this;if(this.xm){var b=[];this.de.forEach(function(a){b=b.concat(a.rg())});this.Oj.forEach(function(c){var e=[];a.de.forEach(function(a){a.rg().forEach(function(b){!b.Nk&&a.yk(c,void 0,b)&&e.push(b.id)})});a.vc.onRoutesUpdated(b,c,e)})}};d.oa=function(){return"ProviderManager"};
d.getData=function(){return[new Vn(this.de.map(function(a){return a.getName()}),Array.from(this.Mg),Array.from(this.Oj),this.xm,Array.from(this.he,function(a){var b=ia(a);a=b.next().value;b=b.next().value;return[a,b.getName()]}),Array.from(this.ym),this.et,this.No)]};
d.Wa=function(){var a=Fh(this);if(a){this.Mg=new Set(a.Uaa);this.Oj=new Set(a.F7);this.xm=a.Raa;for(var b=ia(a.D7),c=b.next();!c.done;c=b.next()){var e=ia(c.value),c=e.next().value,e=e.next().value,e=this.fs(e);this.he.set(c,e)}this.ym=new Map(a.Taa);this.No=a.t1||null;a.Y1&&this.enableMdnsDiscovery()}};d.Ox=function(a){return this.he.get(a)};d.Wl=function(a,b){this.he.set(b.id,a);this.Nh(a,b)};d.sj=function(a,b){this.wJ(b.id);this.he.delete(b.id);this.pj.sj(b.id);this.Nh(a,b)};
d.Nh=function(){this.xm&&this.EL.Sn()};d.hK=function(a){var b=this.he.get(a.id);b&&this.Nh(b,a)};d.Bf=function(a,b,c){this.he.has(b)?("string"!=typeof c&&(c=JSON.stringify(c)),this.pj.send(b,c)):this.a.l("Got route message for closed route "+b)};d.onPresentationConnectionStateChanged=function(a,b){"terminated"==b&&this.pj.QL();this.vc.onPresentationConnectionStateChanged(a,b)};d.onPresentationConnectionClosed=function(a,b,c){this.pj.QL();this.vc.onPresentationConnectionClosed(a,b,c)};
d.xz=function(a){this.hm.delete(a);var b=this.he.get(a);b&&b.terminateRoute(a)};d.rt=function(a,b,c){this.DL.dispatchEvent(new Qn(b,c))};d.be=function(){this.Vaa.Sn()};d.onSinkAvailabilityUpdated=function(a,b){var c=this;if(this.ym.get(a.getName())!=b){var e=this.oE();this.ym.set(a.getName(),b);a=this.oE();e!=a&&(this.vc.onSinkAvailabilityUpdated(a),0==a&&(this.Mg.forEach(function(a){c.$E(a)}),this.Mg.clear()))}};
d.oE=function(){return Array.from(this.ym.values()).reduce(function(a,b){return Math.max(a,b)},0)};d.Tx=function(){return this.DL};d.ng=function(){return this.LI};d.wJ=function(a){var b=this;return this.hm.has(a)?this.cs(this.hm.get(a)).then(function(c){b.hm.delete(a);return c.RN()}):Promise.resolve(!1)};
d.Up=function(a,b,c,e){var f=this,g=a.ll(b.sinkId);this.a.info("Starting mirroring using service: "+g);this.hm.set(b.id,g);return Dg(this.cs(g),function(k){f.No=g;return k.Up(b,b.mediaSource,a.ml(b.sinkId),c,e).catch(function(a){if(a instanceof Wg&&3==a.reason)throw new im(8);throw a;})})};d.Qu=function(a,b,c,e,f,g){var k=this,p=this.hm.get(b.id);return p?Dg(this.cs(p),function(q){k.No=p;return q.Qu(b,c,a.ml(b.sinkId),e,f,g)}):Bg(Error("Route "+b.id+" is not mirroring"))};
d.mA=function(a){this.et?a():-1==this.dt.indexOf(a)&&this.dt.push(a)};d.wy=function(){return this.et};d.Yh=function(a,b){var c=this.Js.indexOf(a),e=0<=c;b&&!e?this.Js.push(a):!b&&e&&this.Js.splice(c,1);this.bz()};d.fs=function(a){return this.de.find(function(b){return b.getName()==a})||null};d.aH=function(a){return a.startsWith("pseudo:")?a.substring(7):null};
d.searchSinksAndCreateRoute=function(a,b,c,e,f,g,k,p){var q=this.aH(a),q=q?this.fs(q):null,y=null;q&&(y=q.searchSinks(b,c));if(y)return this.vc.onSearchSinkIdReceived(a,y.id),this.createRoute(b,y.id,e,f,g,k,p);this.vc.onSearchSinkIdReceived(a,"");return Promise.reject(new im(0,"No sink found for search input: "+c.input+" and source: "+b))};d.searchSinks=function(a,b,c){a=(a=this.aH(a))?this.fs(a):null;var e=null;a&&(e=a.searchSinks(b,c));return e?e.id:""};
d.updateMediaSinks=function(a){this.Mg.has(a)||this.gA(a)};var Vn=function(a,b,c,e,f,g,k,p){this.Uaa=b;this.F7=c;this.Raa=e;this.D7=f;this.Taa=g;this.Y1=k;this.t1=p};var Wn=function(a,b){this.Ya=a;this.Xaa=b;this.Bg=new zc;this.I=this.Bg.promise;this.Lc=xg.$r(a.id);this.va=new zc;this.bd=!1;this.Mp();this.uB();this.Bb(new xh("GET_TURN_CREDENTIALS"))};d=Wn.prototype;d.start=function(){var a=this;return this.I.then(function(b){if(b.Es())return Promise.reject(Error("Presentation already started"));b.start();return a.va.promise})};d.stop=function(){var a=this;this.bd=!1;return this.I.then(function(b){b.stop();a.I=Promise.reject(Error("Peer connection has already been stopped"))})};
d.Mp=function(){var a=this;this.Lc.onMessage=function(b){if(b.type)switch(b.type){case "TURN_CREDENTIALS":a.Bg.resolve(new Bh(a.Ya.id,b.data.credentials));break;case "ANSWER":a.I.then(function(a){a.setRemoteDescription(b.data)});break;case "STOP":a.va.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}else a.I.then(function(a){a.W7({type:"PRESENTATION_CONNECTION_MESSAGE",data:b})})}};
d.uB=function(){var a=this;this.I.then(function(b){b.YM(function(b){a.Bb(new xh("OFFER",new zh(b,null,null,a.Xaa)))});b.XM(function(b){b=yh(b);"STOP"==b.type&&a.stop();a.Bb(b)});b.WM(function(){a.bd=!0;a.Bb(new xh("SESSION_START_SUCCESS"));a.va.resolve(a)});b.UM(function(){a.Bb(new xh("SESSION_END"))});b.VM(function(b){a.bd||a.va.reject(b);a.Bb(new xh("SESSION_FAILURE"))})})};d.Bb=function(a){this.Lc.sendMessage(a,Xn)};var Xn={channelType:"cloud"};var Yn=function(a){this.B=a;this.bb=new Map;this.Ut=new Map;this.Op=[];this.Me=this.Ol=this.Wc=this.lg=this.sl=null;this.Ul=this.xi=this.fh=!1;this.Pp=new Map;this.Km=new Map;Ih(this)};d=Yn.prototype;d.getName=function(){return"cloud"};
d.uc=function(){var a=this;this.a.info("Initializing Cloud MRP");var b=uk.W(),c=b.fW(this);this.Op.push(c);this.sl=b.lX(this);this.Op.push(this.sl);this.lg=b.tG();this.Wc=b.gl();this.Ol=b.dY(this);this.Me=b.rZ();this.Me.cW().then(function(b){a.fh=b;a.a.info("Cloud enabled setting: "+a.fh)});this.Me.eW().then(function(b){a.xi=b;a.a.info("Cloud on setting: "+a.xi)});this.Me.k$(function(b){a.fh=b;a.a.info("Cloud enabled setting: "+a.fh);a.fh&&a.qI()});this.Me.rY().then(function(b){a.Ul=b;a.a.info("Privacy notified setting: "+
a.Ul)})};d.rg=function(){return Array.from(this.bb.values())};
d.Xn=function(a){if(!this.sy(a))return km;this.a.v("GetAvailableSinks for "+a);var b=[];if(this.xi||this.Paa())b=this.qI();this.Km.clear();for(var c={},e=ia(this.Pp.values()),f=e.next();!f.done;c={im:c.im,Lr:c.Lr},f=e.next())c.im=f.value,c.Lr=!1,b.forEach(function(a){return function(b){b.ab.id==a.im.ab.id&&(a.Lr=!0,b.ab.friendlyName=a.im.ab.friendlyName)}}(c)),c.Lr||this.Km.set(c.im.ab.id,c.im);b=b.concat.apply(b,[].concat(ka(this.Km.values())));this.a.v(function(){return"Available sinks are..."+
JSON.stringify(b)});c=b.map(function(a){return a.ab});this.sl&&(c=c.concat(Zn));return new jm(c,-1!=a.indexOf("0F5096E8")?eh:null)};d.qI=function(){var a=[];this.a.info("Checking cloud discovery services");Yj.W().Ls=v();this.Op.forEach(function(b){b=b.Ud();a=a.concat(b)});return a};d.startObservingMediaSinks=function(){};d.stopObservingMediaSinks=function(){};d.startObservingMediaRoutes=function(){};d.stopObservingMediaRoutes=function(){};d.aa=function(a){return(a=this.$n(a))?a.ab:null};
d.createRoute=function(a,b,c,e,f,g,k){var p=this;this.a.info("createRoute called");this.a.v("urn: "+a+" sinkId:"+b);if(f=this.Ut.get(b))return this.B.Qu(this,f,a,c,k,function(b){b.mediaSource=a;b.Fe.tabId=k;return Ag(b)}).jw(function(a){p.B.Nh(p,a);return a});f=this.$n(b);return this.wr(a,f,b,c,e,g,k)};
d.EE=function(a,b,c,e){a instanceof im&&2==a.errorCode?this.gk(b,6,null):(this.a.error("Error on start session",a instanceof Error?a:Error("Expected an Error value, got "+a)),this.gk(b,e,new yg(jj,"warning","dismiss")));this.sl&&this.sl.N6(c)&&this.Ge([c.ab])};
d.wr=function(a,b,c,e,f,g,k){var p=this;if(f)return Bg(Error("not supported"));f=!1;switch(this.Nx(b)){case "cloud":Li(1);break;case "mesi":f=!0,this.Ul||(this.Ul=!0,this.Me.j$(),g=new yg(mj,"notification","learn_more"),g.X$(["dismiss"]),g.w9(6320939),this.B.ng().send(g)),Li(0)}Yj.W().Fj=new Xj(b.model,null);var q=om(e,this.getName(),c,a,!0,"",null);f&&(q.customControllerPath="cloud_route_details/view.html?routeId="+q.id);this.bb.set(q.id,q);this.Ut.set(c,q);this.Pp.set(q.id,b);this.B.Wl(this,q);
this.B.Yh(this.oa(),!0);if(dh(a)&&!f)return this.a.info("starting presentation on route: "+q.id),this.eba(q,a).catch(function(a){p.EE(a,q,b,7);throw a;});this.a.info("starting mirroring on route: "+q.id);q.Fe={tabId:k,sessionId:"",IN:"",JN:b.model};dh(a)&&(q.isOffscreenPresentation=!0);return this.B.Up(this,q,e).catch(function(a){p.EE(a,q,b,5);throw a;})};
d.terminateRoute=function(a){var b=this.bb.get(a);return b?this.gk(b,0,null):Promise.reject(new im(3,"Route in cloud provider not found for routeId "+a))};
d.gk=function(a,b,c){this.a.info("terminating route: "+a.id);this.bb.delete(a.id);this.Ut.delete(a.sinkId);var e=this.Pp.get(a.id);this.Pp.delete(a.id);c&&this.ng().send(c);Tg("MediaRouter.Cloud.Session.End",b,Gi);switch(b){case 1:break;default:this.VS(e)}this.B.sj(this,a);0==this.bb.size&&this.B.Yh(this.oa(),!1);this.B.onPresentationConnectionStateChanged(a.id,"terminated");this.Km.has(a.sinkId)&&(b=this.Km.get(a.sinkId),this.Ge([b.ab]),this.Km.delete(a.sinkId));return Promise.resolve()};
d.sendRouteMessage=function(a,b,c){if(c&&c.channelType){c=c.channelType;var e=(a=this.bb.get(a)||void 0)?this.$n(a.sinkId):void 0;return this.Ol.K5(c,b,a,e)}return r(b)?(this.zd(b,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};d.ml=function(a){var b=new wh;"hangouts"!=this.ll(a)&&(b.senderSideLetterboxing=!0);b.mJ();this.a.info("Settings for "+a+": "+b.Ju());return b.shouldCaptureAudio||b.shouldCaptureVideo?b:null};
d.ll=function(a){var b=null;a=this.$n(a);switch(this.Nx(a)){case "cloud":b="webrtc";break;case "mesi":b="hangouts"}return b};d.rn=function(a,b){this.a.v("Checking canRoute: "+a+" for sinkId: "+b);return this.sy(a)&&!!this.aa(b)};d.yk=function(a,b){return"https://hangouts.google.com/cloudmrp-mirroring"==a&&this.bb.has(b)};d.joinRoute=function(a,b){return(a=this.bb.get(b))?Ag(a):Bg(Error("not supported"))};d.connectRouteByRouteId=function(){return Bg(Error("not supported"))};d.detachRoute=function(){};
d.Cz=function(a){this.a.info(a.length+" sinks added");0<a.length&&!this.xi&&(this.Me.Qba(),this.xi=!0);a=this.$n(a[0].id);Yj.W().Ej=new Xj(a.model,null);this.B.be();this.B.onSinkAvailabilityUpdated(this,2);this.a.info("sinkAvailability changed to AVAILABLE")};d.Ge=function(a){this.a.info(a.length+" sinks removed");this.Op.some(function(a){return 0<a.Ud().length})||(this.B.onSinkAvailabilityUpdated(this,0),this.a.info("sinkAvailability changed to UNAVAILABLE"));this.B.be()};
d.be=function(a){this.a.info(a.length+" sinks updated");this.B.be()};d.ng=function(){return this.B.ng()};d.zd=function(a,b,c){c?this.B.Bf(this,b,a):this.B.rt(this,b,a)};d.$n=function(a){var b=this.BW(a);b||(b=this.kZ(a));return b};d.BW=function(a){var b=null;this.Op.some(function(c){b=c.aa(a);return!!b});return b};d.kZ=function(a){var b=null;(a=this.Ut.get(a))&&(b=this.Pp.get(a.id));return b};d.VS=function(a){switch(this.Nx(a)){case "cloud":this.lg.g8(a.deviceId)}};
d.Nx=function(a){return a.XN("cloud")?"cloud":a.XN("mesi")?"mesi":null};d.Paa=function(){var a=Yj.W().Ls;return 3E5<=Date.now()-a};d.sy=function(a){var b=ch(a);a=dh(a);if(this.Wc.El&&!this.Wc.Lf&&b)return this.B.onSinkAvailabilityUpdated(this,2),!0;var c=!1;this.fh&&this.Wc.Lf&&(c=!0);return chrome.declarativeWebRequest||this.Wc.i1()||!a?c&&(b||a):!1};d.searchSinks=function(a,b){if(!this.sy(a))return null;(a=this.sl.YQ(b))&&this.Cz([a]);return a};d.oa=function(){return"CloudProvider"};
d.getData=function(){return[void 0,{cloudEnabled:this.fh,cloudOn:this.xi,notifiedHangoutsPrivacy:this.Ul}]};d.Wa=function(){var a=Gh(this);a&&(a.cloudEnabled&&(this.fh=a.cloudEnabled),a.cloudOn&&(this.xi=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.Ul=a.notifiedHangoutsPrivacy))};d.eba=function(a,b){a=new Wn(a,b);return Cg(a.start())};d.a=C("mr.CloudProvider");var Zn=new $h("pseudo:cloud","","hangout","Add a hangout","default");var $n=function(){Ri.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};ja($n,Ri);$n.prototype.Xu=function(a,b){return b.id&&-1!=ao.indexOf(b.id)?"start"==a.type||"stop"==a.type:!1};$n.prototype.Iw=function(){return!0};var co=function(){bo||(bo=new $n);return bo},bo=null,ao=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var eo=function(){Ri.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};ja(eo,Ri);eo.prototype.Xu=function(a,b){return"retrieve_log_data"==a.type&&b.id==chrome.runtime.id&&b.url=="chrome-extension://"+b.id+"/feedback.html"};eo.prototype.Iw=function(){return!0};var go=function(){fo||(fo=new eo);return fo},fo=null;var ho,io,jo=C("mr.Init"),ko=function(a){var b=new zm(a),c=new Bn(a,b),b=[b,c];b.push(new Yn(a));return b};Nn.W().init();ho=new Ng("MediaRouter.Provider.WakeDuration");io=new Un;
var lo=(new Promise(function(a,b){switch(window.location.host){case "enhhojjnijigcajfphajepfemndkmdlo":a();break;case "pkedcjkdefgpdelpbcmbmeomcjbeemfm":chrome.management.get("enhhojjnijigcajfphajepfemndkmdlo",function(c){chrome.runtime.lastError||!c.enabled?a():b(Error("Dev extension is enabled"))});break;default:b(Error("Unknown extension id"))}})).then(function(){return chrome.mojoPrivate&&chrome.mojoPrivate.requireAsync?new Promise(function(a){chrome.mojoPrivate.requireAsync("media_router_bindings").then(function(b){b.start().then(function(c){a({mrService:b,mrInstanceId:c})})})}):
Promise.reject(Error("No mojo service loaded"))}).then(function(a){if(!a.mrService)throw Error("Failed to get MR service");var b=a.mrInstanceId;if(!b)throw Error("Failed to get MR instance ID.");jo.info("MR instance ID: "+b);a=a.mrService;if(!io)throw Error("providerManager not initialized.");a.setHandlers(io);Kh(b)&&ho.sm("MediaRouter.Provider.FirstWakeDuration");chrome.runtime.onSuspend.addListener(ho.end.bind(ho));Oh(b);Nn.W().w6();b=ko(io);window.addEventListener("unhandledrejection",function(a){a=
a.reason;a.stack||(a=Error(a));jo.error("Unhandled promise rejection.",a)});io.uc(a,b)}).then(void 0,function(a){jo.l(a.message);throw a;});[].concat([co(),go()],ka(sn()),ka([Vk(),Xk()]),ka([$i()])).forEach(function(a){return a.cR()});co().addListener();go().addListener();lo.then(void 0,function(){return window.close()});
