!function(a,b){!function(){function a(a){var c=!1;return function(){if(c)throw new Error("Callback was already called.");c=!0,a.apply(b,arguments)}}var b,c,d={};b=this,null!=b&&(c=b.async),d.noConflict=function(){return b.async=c,d};var e=Object.prototype.toString,f=Array.isArray||function(a){return"[object Array]"===e.call(a)},g=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},h=function(a,b){if(a.map)return a.map(b);var c=[];return g(a,function(a,d,e){c.push(b(a,d,e))}),c},i=function(a,b,c){return a.reduce?a.reduce(b,c):(g(a,function(a,d,e){c=b(c,a,d,e)}),c)},j=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"!=typeof process&&process.nextTick?(d.nextTick=process.nextTick,"undefined"!=typeof setImmediate?d.setImmediate=function(a){setImmediate(a)}:d.setImmediate=d.nextTick):"function"==typeof setImmediate?(d.nextTick=function(a){setImmediate(a)},d.setImmediate=d.nextTick):(d.nextTick=function(a){setTimeout(a,0)},d.setImmediate=d.nextTick),d.each=function(b,c,d){function e(a){a?(d(a),d=function(){}):(f+=1,f>=b.length&&d())}if(d=d||function(){},!b.length)return d();var f=0;g(b,function(b){c(b,a(e))})},d.forEach=d.each,d.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})};e()},d.forEachSeries=d.eachSeries,d.eachLimit=function(a,b,c,d){var e=k(b);e.apply(null,[a,c,d])},d.forEachLimit=d.eachLimit;var k=function(a){return function(b,c,d){if(d=d||function(){},!b.length||a<=0)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;g<a&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},l=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.each].concat(b))}},m=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[k(a)].concat(c))}},n=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.eachSeries].concat(b))}},o=function(a,b,c,d){if(b=h(b,function(a,b){return{index:b,value:a}}),d){var e=[];a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})}else a(b,function(a,b){c(a.value,function(a){b(a)})})};d.map=l(o),d.mapSeries=n(o),d.mapLimit=function(a,b,c,d){return p(b)(a,c,d)};var p=function(a){return m(a,o)};d.reduce=function(a,b,c,e){d.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){e(a,b)})},d.inject=d.reduce,d.foldl=d.reduce,d.reduceRight=function(a,b,c,e){var f=h(a,function(a){return a}).reverse();d.reduce(f,b,c,e)},d.foldr=d.reduceRight;var q=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(a){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.filter=l(q),d.filterSeries=n(q),d.select=d.filter,d.selectSeries=d.filterSeries;var r=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(a){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.reject=l(r),d.rejectSeries=n(r);var s=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(a){d()})};d.detect=l(s),d.detectSeries=n(s),d.some=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(a){c(!1)})},d.any=d.some,d.every=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(a){c(!0)})},d.all=d.every,d.sortBy=function(a,b,c){d.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0};c(null,h(b.sort(d),function(a){return a.value}))})},d.auto=function(a,b){b=b||function(){};var c=j(a),e=c.length;if(!e)return b();var h={},k=[],l=function(a){k.unshift(a)},m=function(a){for(var b=0;b<k.length;b+=1)if(k[b]===a)return void k.splice(b,1)},n=function(){e--,g(k.slice(0),function(a){a()})};l(function(){if(!e){var a=b;b=function(){},a(null,h)}}),g(c,function(c){var e=f(a[c])?a[c]:[a[c]],k=function(a){var e=Array.prototype.slice.call(arguments,1);if(e.length<=1&&(e=e[0]),a){var f={};g(j(h),function(a){f[a]=h[a]}),f[c]=e,b(a,f),b=function(){}}else h[c]=e,d.setImmediate(n)},o=e.slice(0,Math.abs(e.length-1))||[],p=function(){return i(o,function(a,b){return a&&h.hasOwnProperty(b)},!0)&&!h.hasOwnProperty(c)};if(p())e[e.length-1](k,h);else{var q=function(){p()&&(m(q),e[e.length-1](k,h))};l(q)}})},d.retry=function(a,b,c){var e=5,f=[];"function"==typeof a&&(c=b,b=a,a=e),a=parseInt(a,10)||e;var g=function(e,g){for(var h=function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},g)}};a;)f.push(h(b,!(a-=1)));d.series(f,function(a,b){b=b[b.length-1],(e||c)(b.err,b.result)})};return c?g():g},d.waterfall=function(a,b){if(b=b||function(){},!f(a)){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();var e=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=a.next();g?f.push(e(g)):f.push(b),d.setImmediate(function(){a.apply(null,f)})}}};e(d.iterator(a))()};var t=function(a,b,c){if(c=c||function(){},f(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(j(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};d.parallel=function(a,b){t({map:d.map,each:d.each},a,b)},d.parallelLimit=function(a,b,c){t({map:p(b),each:k(b)},a,c)},d.series=function(a,b){if(b=b||function(){},f(a))d.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};d.eachSeries(j(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},d.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},d.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var u=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};d.concat=l(u),d.concatSeries=n(u),d.whilst=function(a,b,c){a()?b(function(e){return e?c(e):void d.whilst(a,b,c)}):c()},d.doWhilst=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?d.doWhilst(a,b,c):c()})},d.until=function(a,b,c){a()?c():b(function(e){return e?c(e):void d.until(a,b,c)})},d.doUntil=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?c():d.doUntil(a,b,c)})},d.queue=function(b,c){function e(a,b,c,e){return a.started||(a.started=!0),f(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void g(b,function(b){var f={data:b,callback:"function"==typeof e?e:null};c?a.tasks.unshift(f):a.tasks.push(f),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}void 0===c&&(c=1);var h=0,i={tasks:[],concurrency:c,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(a,b){e(i,a,!1,b)},kill:function(){i.drain=null,i.tasks=[]},unshift:function(a,b){e(i,a,!0,b)},process:function(){if(!i.paused&&h<i.concurrency&&i.tasks.length){var c=i.tasks.shift();i.empty&&0===i.tasks.length&&i.empty(),h+=1;var d=function(){h-=1,c.callback&&c.callback.apply(c,arguments),i.drain&&i.tasks.length+h===0&&i.drain(),i.process()},e=a(d);b(c.data,e)}},length:function(){return i.tasks.length},running:function(){return h},idle:function(){return i.tasks.length+h===0},pause:function(){i.paused!==!0&&(i.paused=!0,i.process())},resume:function(){i.paused!==!1&&(i.paused=!1,i.process())}};return i},d.priorityQueue=function(a,b){function c(a,b){return a.priority-b.priority}function e(a,b,c){for(var d=-1,e=a.length-1;d<e;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function h(a,b,h,i){return a.started||(a.started=!0),f(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void g(b,function(b){var f={data:b,priority:h,callback:"function"==typeof i?i:null};a.tasks.splice(e(a.tasks,f,c)+1,0,f),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}var i=d.queue(a,b);return i.push=function(a,b,c){h(i,a,b,c)},delete i.unshift,i},d.cargo=function(a,b){var c=!1,e=[],i={tasks:e,payload:b,saturated:null,empty:null,drain:null,drained:!0,push:function(a,c){f(a)||(a=[a]),g(a,function(a){e.push({data:a,callback:"function"==typeof c?c:null}),i.drained=!1,i.saturated&&e.length===b&&i.saturated()}),d.setImmediate(i.process)},process:function d(){if(!c){if(0===e.length)return i.drain&&!i.drained&&i.drain(),void(i.drained=!0);var f="number"==typeof b?e.splice(0,b):e.splice(0,e.length),j=h(f,function(a){return a.data});i.empty&&i.empty(),c=!0,a(j,function(){c=!1;var a=arguments;g(f,function(b){b.callback&&b.callback.apply(null,a)}),d()})}},length:function(){return e.length},running:function(){return c}};return i};var v=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&g(c,function(b){console[a](b)}))}]))}};d.log=v("log"),d.dir=v("dir"),d.memoize=function(a,b){var c={},e={};b=b||function(a){return a};var f=function(){var f=Array.prototype.slice.call(arguments),g=f.pop(),h=b.apply(null,f);h in c?d.nextTick(function(){g.apply(null,c[h])}):h in e?e[h].push(g):(e[h]=[g],a.apply(null,f.concat([function(){c[h]=arguments;var a=e[h];delete e[h];for(var b=0,d=a.length;b<d;b++)a[b].apply(null,arguments)}])))};return f.memo=c,f.unmemoized=a,f},d.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},d.times=function(a,b,c){for(var e=[],f=0;f<a;f++)e.push(f);return d.map(e,b,c)},d.timesSeries=function(a,b,c){for(var e=[],f=0;f<a;f++)e.push(f);return d.mapSeries(e,b,c)},d.seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),e=c.pop();d.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){e.apply(b,[a].concat(c))})}},d.compose=function(){return d.seq.apply(null,Array.prototype.reverse.call(arguments))};var w=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};d.applyEach=l(w),d.applyEachSeries=n(w),d.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},"undefined"!=typeof module&&module.exports?module.exports=d:"undefined"!=typeof define&&define.amd?define([],function(){return d}):b.async=d}(),function(){"use strict";function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&b(e[d],c)===-1&&(e[d].push(f?c:{listener:c,once:!1}),this.emit("listenerAdded",a,c.listener||c,c.once||!1));return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)if(f.hasOwnProperty(e)&&(d=b(f[e],c),d!==-1))var c=f[e].splice(d,1);return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof module&&module.exports?module.exports=a:e.EventEmitter=a}.call(this),function(b){var c=b.EventEmitter||require("lib/EventEmitter"),d=function(a){return c.call(this),d.instance?d.instance:(this._isBackground=a,this._cbList={},this._portList=[],this._initialize(),void(d.instance=this))};d.prototype=Object.create(c.prototype),d.prototype._initialize=function(){if(this._isBackground)a.runtime.onConnect.addListener(this._onPortConnect.bind(this));else{var b=a.runtime.connect();this._onPortConnect(b)}},d.prototype._onPortConnect=function(a){this._portList.push(a),a.onDisconnect.addListener(this._onPortDisconnect.bind(this,a)),a.onMessage.addListener(this._onMessage.bind(this)),this.emit("port-connected")},d.prototype._onPortDisconnect=function(a){this._portList.splice(this._portList.indexOf(a),1),this._isBackground||this._initialize()},d.prototype._onMessage=function(a){var b=a,c=b.args,d=b._cb,e=b.isCb;if(e){if(!this._cbList[d])return;return this._cbList[d].apply(null,c),void delete this._cbList[d]}if(d){var f=this,g=[].concat(c);g.push(function(){for(var a={args:[].slice.apply(arguments),_cb:d,isCb:!0},b=0;b<f._portList.length;b++){var c=f._portList[b];c.postMessage(a)}}),this.emit.apply(this,g)}else this.emit.apply(this,c)},d.prototype.send=d.prototype.postMessage=function(){var a=[].slice.apply(arguments),b=null;"function"==typeof a[a.length-1]&&(b=a.pop());var c={args:a};b&&(c._cb=Uuid.generate(),this._cbList[c._cb]=b);for(var d=0;d<this._portList.length;d++){var e=this._portList[d];e.postMessage(c)}},d.prototype._onError=function(){},d.prototype.postTo=function(){var a=[].slice.apply(arguments),b=null,c=a.shift();"function"==typeof a[a.length-1]&&(b=a.pop());var d={args:a,to:c};b&&(d._cb=Uuid.generate(),this._cbList[d._cb]=b),this.worker.port.postMessage(d)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=d:b.SuperWorker=d}(b),function(a){var b,c=a.EventEmitter||require("lib/EventEmitter"),d=a.SuperWorker||require("common/SuperWorker"),e=function(){c.call(this),this._proxy=new d((!1)),this._bindEvents()};e.getInstance=function(){return b||(b=new e),b},e._MESSAGE_PREFIX="MiniControls",e.prototype=Object.create(c.prototype),e.prototype._bindEvents=function(){this._proxy.on(e._MESSAGE_PREFIX+"deviceName",this._onDeviceName.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"pinned",this._onPinned.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"loaded",this._onLoaded.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"unloaded",this._onUnloaded.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"snap",this._onSnap.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"playing",this._onPlaying.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"paused",this._onPaused.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"title",this._onTitle.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"subtitle",this._onSubtitle.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"progress",this._onProgress.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"duration",this._onDuration.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"seek",this._onSeek.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"volume",this._onVolume.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"playlistPosition",this._onPlaylistPosition.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"playerReady",this._onPlayerReady.bind(this)),this._proxy.on(e._MESSAGE_PREFIX+"playerBusy",this._onPlayerBusy.bind(this))},e.prototype.send=function(){var a=[].slice.call(arguments);a[0]=e._MESSAGE_PREFIX+a[0],this._proxy.send.apply(this._proxy,a)},e.prototype.setup=function(){this.send("setup")},e.prototype.selectVideo=function(){this.send("selectVideo")},e.prototype.launchApp=function(){this.send("launchApp")},e.prototype.minimize=function(){this.send("minimize")},e.prototype.setPinned=function(a){this.send("setPinned",a)},e.prototype.close=function(){this.send("close")},e.prototype.play=function(){this.send("play")},e.prototype.pause=function(){this.send("pause")},e.prototype.skipBackward=function(a){this.send("skipBackward",a)},e.prototype.skipForward=function(a){this.send("skipForward",a)},e.prototype.playlistNext=function(){this.send("playlistNext")},e.prototype.playlistPrevious=function(){this.send("playlistPrevious")},e.prototype.mute=function(){this.send("mute")},e.prototype.unmute=function(){this.send("unmute")},e.prototype.seekSeconds=function(a){this.send("seekSeconds",a)},e.prototype.setVolume=function(a){this.send("setVolume",a)},e.prototype._onDeviceName=function(a){this.emit("device-name",a)},e.prototype._onPinned=function(a){this.emit("pinned",a)},e.prototype._onLoaded=function(){this.emit("loaded")},e.prototype._onUnloaded=function(){this.emit("unloaded")},e.prototype._onPlayerReady=function(){this.emit("player-ready")},e.prototype._onPlayerBusy=function(a){this.emit("player-busy",a)},e.prototype._onSnap=function(a){this.emit("snap",a)},e.prototype._onPlaying=function(){this.emit("playing")},e.prototype._onPaused=function(){this.emit("paused")},e.prototype._onTitle=function(a){this.emit("title",a)},e.prototype._onSubtitle=function(a){this.emit("subtitle",a)},e.prototype._onProgress=function(a){this.emit("progress",a)},e.prototype._onDuration=function(a){this.emit("duration",a)},e.prototype._onSeek=function(a){this.emit("progress",a)},e.prototype._onVolume=function(a,b){this.emit("volume",a,b)},e.prototype._onPlaylistPosition=function(a){this.emit("playlist-position",a)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:a.BackgroundCommunicator=e}(b),function(a){var b=a.EventEmitter||require("lib/EventEmitter"),c=function(a){b.call(this),this._el=document.querySelector(a),this._isShown=!0};c.prototype=Object.create(b.prototype),c.prototype.show=function(a){this._el.style.removeProperty("display"),this._isShown=!0,a||this.emit("show")},c.prototype.hide=function(a){this._el.style.display="none",this._isShown=!1,a||this.emit("hide")},c.prototype.querySelector=function(a){return null==this._el?null:this._el.querySelector(a)},c.prototype.querySelectorAll=function(a){return null==this._el?[]:this._el.querySelectorAll(a)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.ElementView=c}(b),function(a){var b=a.ElementView||require("common/ui/ElementView"),c=function(a){b.call(this,a),this._progressEl=this.querySelector(".seeker-progress"),this._thumbEl=this.querySelector(".seeker-thumb"),this._clickerEl=this.querySelector(".seeker-clicker"),this._progress=0,this._total=1,this._isBeingTouched=!1,this._startX=0,this._startPercent=0,this._bindControls()};c.prototype=Object.create(b.prototype),c.prototype._bindControls=function(){this._onThumbUpBind=this._onThumbUp.bind(this),this._onThumbDragBind=this._onThumbDrag.bind(this),this._clickerEl.addEventListener("click",this._onClick.bind(this)),this._thumbEl.addEventListener("mousedown",this._onThumbDown.bind(this))},c.prototype.setAltStyle=function(a){a?this._el.classList.add("alt-style"):this._el.classList.remove("alt-style")},c.prototype.setTotal=function(a){this._total=a,this._updateProgress(this._progress/this._total),this._isBeingTouched===!1&&this._updateThumb(this._progress/this._total)},c.prototype.getTotal=function(){return this._total},c.prototype.setProgress=function(a){this._progress=a,this._updateProgress(this._progress/this._total),this._isBeingTouched===!1&&this._updateThumb(this._progress/this._total)},c.prototype.getProgress=function(){return this._progress},c.prototype.isBeingTouched=function(){return this._isBeingTouched},c.prototype._updateProgress=function(a){isNaN(a)&&(a=0),a=100*Math.max(Math.min(a,1),0),this._progressEl.style.width=a+"%"},c.prototype._updateThumb=function(a){isNaN(a)&&(a=0),a=100*Math.max(Math.min(a,1),0),this._thumbEl.style.left=a+"%"},c.prototype._onClick=function(a){if(a.target!==this._thumbEl){var b=a.pageX-this._el.offsetLeft,c=b/this._el.clientWidth;this._lastPercentage=c,this._updateThumb(this._lastPercentage),this.emit("progress-changed",this._total*this._lastPercentage)}},c.prototype._onThumbDown=function(b){a.addEventListener("mouseup",this._onThumbUpBind),document.body.addEventListener("mousemove",this._onThumbDragBind),this._startX=b.pageX,this._startPercent=this._el.clientWidth-b.pageX,this._isBeingTouched=!0},c.prototype._onThumbDrag=function(a){var b=this._el.clientWidth,c=a.pageX-this._startX,d=this._startX-this._el.offsetLeft+c;this._lastPercentage=Math.max(Math.min(d/b,1),0),this._updateThumb(this._lastPercentage),this.emit("progress-changed",this._total*this._lastPercentage)},c.prototype._onThumbUp=function(){a.removeEventListener("mouseup",this._onThumbUpBind),document.body.removeEventListener("mousemove",this._onThumbDragBind),this._isBeingTouched=!1,this.emit("progress-changed",this._total*this._lastPercentage)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.SeekerView=c}(b),function(a){var b,c=a.ElementView||require("common/ui/ElementView"),d=a.SeekerView||require("common/ui/SeekerView"),e=a.BackgroundCommunicator||require("mini-controls/BackgroundCommunicator"),f=function(){c.call(this,"#playback-controls"),this._background=e.getInstance(),this._playButton=this.querySelector("#button-play"),this._pauseButton=this.querySelector("#button-pause"),this._back30Button=this.querySelector("#button-back-30"),this._forward30Button=this.querySelector("#button-forward-30"),this._playlistNextButton=this.querySelector("#button-next"),this._playlistPreviousButton=this.querySelector("#button-previous"),this._muteButton=this.querySelector("#button-mute"),this._unmuteButton=this.querySelector("#button-unmute"),this._progressSeeker=new d("#seeker-progress"),this._volumeSeeker=new d("#seeker-volume"),this._titleLabel=this.querySelector("#title"),this._subtitleLabel=this.querySelector("#subtitle"),this._deviceNameLabel=this.querySelector("#device-name"),this._timeElapsedLabel=this.querySelector("#time-elapsed"),this._timeRemainingLabel=this.querySelector("#time-duration"),this._bindEvents(),this._isLoaded=!1,this._playerReady=!0,this._playlistPosition=-1,this._renderPlaylistControls(),this._volumeSeeker.setTotal(1)};f.KEYCODE_CONTROL=17,f.KEYCODE_ESC=27,f.KEYCODE_SPACE=32,f.KEYCODE_LEFT=37,f.KEYCODE_UP=38,f.KEYCODE_RIGHT=39,f.KEYCODE_DOWN=40,f.KEYCODE_COMMAND=91,f.getInstance=function(){return b||(b=new f),b},f.prototype=Object.create(c.prototype),f.prototype._bindEvents=function(){this._background.on("loaded",this._onLoaded.bind(this)),this._background.on("unloaded",this._onUnloaded.bind(this)),this._background.on("player-ready",this._onPlayerReady.bind(this)),this._background.on("player-busy",this._onPlayerBusy.bind(this)),this._background.on("title",this._onTitle.bind(this)),this._background.on("subtitle",this._onSubtitle.bind(this)),this._background.on("device-name",this._onDeviceName.bind(this)),this._background.on("playing",this._onPlaying.bind(this)),this._background.on("paused",this._onPaused.bind(this)),this._background.on("progress",this._onProgress.bind(this)),this._background.on("duration",this._onDuration.bind(this)),this._background.on("volume",this._onVolume.bind(this)),this._background.on("snap",this._onSnap.bind(this)),this._background.on("unloaded",this._onSnap.bind(this,null)),this._playButton.addEventListener("click",this._onPlayButtonClick.bind(this)),this._pauseButton.addEventListener("click",this._onPauseButtonClick.bind(this)),this._back30Button.addEventListener("click",this._onBack30ButtonClick.bind(this)),this._forward30Button.addEventListener("click",this._onForward30ButtonClick.bind(this)),this._playlistNextButton.addEventListener("click",this._onPlaylistNextButtonClick.bind(this)),this._playlistPreviousButton.addEventListener("click",this._onPlaylistPreviousButtonClick.bind(this)),this._muteButton.addEventListener("click",this._onMuteButtonClick.bind(this)),this._unmuteButton.addEventListener("click",this._onUnmuteButtonClick.bind(this)),this._progressSeeker.on("progress-changed",this._onSeekerProgressChanged.bind(this)),this._volumeSeeker.on("progress-changed",this._onSeekerVolumeChanged.bind(this)),document.body.addEventListener("keydown",this._onKeyDown.bind(this)),document.body.addEventListener("keyup",this._onKeyUp.bind(this))},f.prototype._onLoaded=function(){this._isLoaded=!0,this._el.classList.add("loaded")},f.prototype._onUnloaded=function(){this._isLoaded=!0,this._el.classList.remove("loaded")},f.prototype._onPlayerReady=function(){this._playerReady=!0,this._el.classList.remove("busy")},f.prototype._onPlayerBusy=function(a){"PlayerBusy"===a&&(this._playerReady=!1,this._el.classList.add("busy"))},f.prototype._onTitle=function(a){this._titleLabel.innerHTML=a},f.prototype._onSubtitle=function(a){this._subtitleLabel.innerHTML=a},f.prototype._onDeviceName=function(a){this._deviceNameLabel.innerHTML=a},f.prototype._onPlaying=function(){this._playButton.style.display="none",this._pauseButton.style.removeProperty("display")},f.prototype._onPaused=function(){this._pauseButton.style.display="none",this._playButton.style.removeProperty("display")},f.prototype._onProgress=function(a){this._progress=a,this._progressSeeker.isBeingTouched()||(this._timeElapsedLabel.textContent=f._getPrettyOut(this._progress),this._progressSeeker.setProgress(this._progress))},f.prototype._onDuration=function(a){this._timeRemainingLabel.textContent=f._getPrettyOut(a),this._progressSeeker.setTotal(a)},f.prototype._onVolume=function(a,b){this._volumeSeeker.isBeingTouched()||this._volumeSeeker.setProgress(a),b?(this._muteButton.style.display="none",this._unmuteButton.style.removeProperty("display"),this._volumeSeeker.setAltStyle(!0)):(this._unmuteButton.style.display="none",this._muteButton.style.removeProperty("display"),this._volumeSeeker.setAltStyle(!1))},f.prototype._onPlaylistPosition=function(a){this._playlistPosition=a,this._renderPlaylistControls()},f.prototype._renderPlaylistControls=function(){this._playlistPosition>-1?(this._playlistNextButton.style.removeProperty("display"),this._playlistPreviousButton.style.removeProperty("display")):(this._playlistNextButton.style.display="none",this._playlistPreviousButton.style.display="none")},f.prototype._onSnap=function(a){a?this._el.style.backgroundImage='url("'+a+'")':this._el.style.removeProperty("background-image")},f.prototype._onPlayButtonClick=function(){this._background.play()},f.prototype._onPauseButtonClick=function(){this._background.pause()},f.prototype._onBack30ButtonClick=function(){this._background.skipBackward(30)},f.prototype._onForward30ButtonClick=function(){this._background.skipForward(30)},f.prototype._onPlaylistNextButtonClick=function(){this._background.playlistNext()},f.prototype._onPlaylistPreviousButtonClick=function(){this._background.playlistPrevious()},f.prototype._onMuteButtonClick=function(){this._background.mute()},f.prototype._onUnmuteButtonClick=function(){this._background.unmute()},f.prototype._onSeekerProgressChanged=function(a){this._progressSeeker.isBeingTouched()?this._timeElapsedLabel.textContent=f._getPrettyOut(a):(this._progressSeeker.setProgress(a),this._background.seekSeconds(a))},f.prototype._onVolumeDecrease=function(){var a=this._volumeSeeker.getProgress()-.1;a<0&&(a=0),this._onVolume(a)},f.prototype._onVolumeIncrease=function(){var a=this._volumeSeeker.getProgress()+.1;a>1&&(a=1),this._onVolume(a)},f.prototype._onSeekerVolumeChanged=function(a){this._volumeSeeker.isBeingTouched()||(this._onVolume(a),this._background.setVolume(a))},f.prototype._onKeyDown=function(a){},f.prototype._onKeyUp=function(a){if(this._isLoaded)switch(a.keyCode){case f.KEYCODE_SPACE:"none"===this._playButton.style.display?this._onPauseButtonClick():this._onPlayButtonClick(),a.preventDefault();break;case f.KEYCODE_LEFT:this._playerReady&&(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey?this._background.skipBackward(10):this._background.skipBackward(30));break;case f.KEYCODE_RIGHT:this._playerReady&&(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey?this._background.skipForward(10):this._background.skipForward(30));break;case f.KEYCODE_UP:this._playerReady&&this._onVolumeIncrease();break;case f.KEYCODE_DOWN:this._playerReady&&this._onVolumeDecrease()}},f._getPrettyOut=function(a){if(!Number.isNaN(a)){var b=Math.floor(a/3600),c=Math.floor(a/60-60*b),d=Math.floor(a-60*c-3600*b);return d<=9&&(d="0"+d),b>=1?(c<=9&&(c="0"+c),b+":"+c+":"+d):c+":"+d}},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=f:a.PlaybackControlsView=f}(b),function(a){var b,c=a.ElementView||require("common/ui/ElementView"),d=a.BackgroundCommunicator||require("mini-controls/BackgroundCommunicator"),e=a.PlaybackControlsView||require("mini-controls/ui/PlaybackControlsView"),f=function(){c.call(this,"#mini-controls"),this._background=d.getInstance(),this._playbackControlsView=e.getInstance(),this._minimizeButton=this.querySelector("#button-minimize"),this._pinButton=this.querySelector("#button-pin"),this._closeButton=this.querySelector("#button-close"),this._minimizeButton.addEventListener("click",this._onMinimizeButtonClick.bind(this)),this._pinButton.addEventListener("click",this._onPinButtonClick.bind(this)),this._closeButton.addEventListener("click",this._onCloseButtonClick.bind(this));for(var a=this.querySelectorAll(".return-button"),b=0;b<a.length;b++)a[b].addEventListener("click",this._onReturnButtonClick.bind(this));this._background.on("pinned",this._onBackgroundPinned.bind(this)),this._isPinned=!1,this._background.setup()};f.getInstance=function(){return b||(b=new f),b},f.prototype=Object.create(c.prototype),f.prototype._onBackgroundPinned=function(a){this._isPinned=a,this._isPinned?this._pinButton.classList.add("active"):this._pinButton.classList.remove("active")},f.prototype._onReturnButtonClick=function(){this._background.launchApp();
},f.prototype._onMinimizeButtonClick=function(){this._background.minimize()},f.prototype._onPinButtonClick=function(){this._background.setPinned(!this._isPinned)},f.prototype._onCloseButtonClick=function(){this._background.close()},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=f:a.MiniControlsView=f}(b),function(){var b=document.querySelectorAll("[data-localize]"),c=document.querySelectorAll("[data-localize-label]"),d=document.querySelectorAll("[data-localize-title]"),e=document.querySelectorAll("[data-localize-placeholder");!function(){for(var c=0;c<b.length;c++){var d=b[c],e=a.i18n.getMessage(d.getAttribute("data-localize"));e&&null!==e&&(d.innerHTML=e)}}(),function(){for(var b=0;b<c.length;b++){var d=c[b],e=a.i18n.getMessage(d.getAttribute("data-localize-label"));e&&null!==e&&(d.label=e)}}(),function(){for(var b=0;b<d.length;b++){var c=d[b],e=a.i18n.getMessage(c.getAttribute("data-localize-title"));e&&null!==e&&(c.title=e)}}(),function(){for(var b=0;b<e.length;b++){var c=e[b],d=a.i18n.getMessage(c.getAttribute("data-localize-placeholder"));d&&null!==d&&(c.placeholder=d)}}()}(),function(a){var b=a.MiniControlsView||require("MiniControlsView");a.app=b.getInstance()}(b)}(chrome,window);