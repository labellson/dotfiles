!function(a,b){!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var c;"undefined"!=typeof b?c=b:"undefined"!=typeof global?c=global:"undefined"!=typeof self&&(c=self),c.io=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports=a("./lib/")},{"./lib/":2}],2:[function(a,b,c){function d(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d=e(a),f=d.source,j=d.id;return b.forceNew||b["force new connection"]||!1===b.multiplex?(h("ignoring socket cache for %s",f),c=g(f,b)):(i[j]||(h("new io instance for %s",f),i[j]=g(f,b)),c=i[j]),c.socket(d.path)}var e=a("./url"),f=a("socket.io-parser"),g=a("./manager"),h=a("debug")("socket.io-client");b.exports=c=d;var i=c.managers={};c.protocol=f.protocol,c.connect=d,c.Manager=a("./manager"),c.Socket=a("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(a,b,c){function d(a,b){return this instanceof d?(a&&"object"==typeof a&&(b=a,a=void 0),b=b||{},b.path=b.path||"/socket.io",this.nsps={},this.subs=[],this.opts=b,this.reconnection(b.reconnection!==!1),this.reconnectionAttempts(b.reconnectionAttempts||1/0),this.reconnectionDelay(b.reconnectionDelay||1e3),this.reconnectionDelayMax(b.reconnectionDelayMax||5e3),this.randomizationFactor(b.randomizationFactor||.5),this.backoff=new m({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==b.timeout?2e4:b.timeout),this.readyState="closed",this.uri=a,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new h.Encoder,this.decoder=new h.Decoder,this.autoConnect=b.autoConnect!==!1,void(this.autoConnect&&this.open())):new d(a,b)}var e=a("engine.io-client"),f=a("./socket"),g=a("component-emitter"),h=a("socket.io-parser"),i=a("./on"),j=a("component-bind"),k=a("debug")("socket.io-client:manager"),l=a("indexof"),m=a("backo2");b.exports=d,d.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)this.nsps[a].emit.apply(this.nsps[a],arguments)},d.prototype.updateSocketIds=function(){for(var a in this.nsps)this.nsps[a].id=this.engine.id},g(d.prototype),d.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection},d.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(a){return arguments.length?(this._reconnectionDelay=a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(a){return arguments.length?(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax},d.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(a){if(k("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;k("opening %s",this.uri),this.engine=e(this.uri,this.opts);var b=this.engine,c=this;this.readyState="opening",this.skipReconnect=!1;var d=i(b,"open",function(){c.onopen(),a&&a()}),f=i(b,"error",function(b){if(k("connect_error"),c.cleanup(),c.readyState="closed",c.emitAll("connect_error",b),a){var d=new Error("Connection error");d.data=b,a(d)}else c.maybeReconnectOnOpen()});if(!1!==this._timeout){var g=this._timeout;k("connect attempt will timeout after %d",g);var h=setTimeout(function(){k("connect attempt timed out after %d",g),d.destroy(),b.close(),b.emit("error","timeout"),c.emitAll("connect_timeout",g)},g);this.subs.push({destroy:function(){clearTimeout(h)}})}return this.subs.push(d),this.subs.push(f),this},d.prototype.onopen=function(){k("open"),this.cleanup(),this.readyState="open",this.emit("open");var a=this.engine;this.subs.push(i(a,"data",j(this,"ondata"))),this.subs.push(i(this.decoder,"decoded",j(this,"ondecoded"))),this.subs.push(i(a,"error",j(this,"onerror"))),this.subs.push(i(a,"close",j(this,"onclose")))},d.prototype.ondata=function(a){this.decoder.add(a)},d.prototype.ondecoded=function(a){this.emit("packet",a)},d.prototype.onerror=function(a){k("error",a),this.emitAll("error",a)},d.prototype.socket=function(a){var b=this.nsps[a];if(!b){b=new f(this,a),this.nsps[a]=b;var c=this;b.on("connect",function(){b.id=c.engine.id,~l(c.connected,b)||c.connected.push(b)})}return b},d.prototype.destroy=function(a){var b=l(this.connected,a);~b&&this.connected.splice(b,1),this.connected.length||this.close()},d.prototype.packet=function(a){k("writing packet %j",a);var b=this;b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(a){for(var c=0;c<a.length;c++)b.engine.write(a[c]);b.encoding=!1,b.processPacketQueue()}))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}},d.prototype.cleanup=function(){for(var a;a=this.subs.shift();)a.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(a){k("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",a),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)k("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();k("will wait %dms before reconnect attempt",b),this.reconnecting=!0;var c=setTimeout(function(){a.skipReconnect||(k("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(k("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(k("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(c)}})}},d.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",a)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(a,b,c){function d(a,b,c){return a.on(b,c),{destroy:function(){a.removeListener(b,c)}}}b.exports=d},{}],5:[function(a,b,c){function d(a,b){this.io=a,this.nsp=b,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var e=a("socket.io-parser"),f=a("component-emitter"),g=a("to-array"),h=a("./on"),i=a("component-bind"),j=a("debug")("socket.io-client:socket"),k=a("has-binary");b.exports=c=d;var l={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},m=f.prototype.emit;f(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[h(a,"open",i(this,"onopen")),h(a,"packet",i(this,"onpacket")),h(a,"close",i(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},d.prototype.send=function(){var a=g(arguments);return a.unshift("message"),this.emit.apply(this,a),this},d.prototype.emit=function(a){if(l.hasOwnProperty(a))return m.apply(this,arguments),this;var b=g(arguments),c=e.EVENT;k(b)&&(c=e.BINARY_EVENT);var d={type:c,data:b};return"function"==typeof b[b.length-1]&&(j("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++),this.connected?this.packet(d):this.sendBuffer.push(d),this},d.prototype.packet=function(a){a.nsp=this.nsp,this.io.packet(a)},d.prototype.onopen=function(){j("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:e.CONNECT})},d.prototype.onclose=function(a){j("close (%s)",a),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",a)},d.prototype.onpacket=function(a){if(a.nsp==this.nsp)switch(a.type){case e.CONNECT:this.onconnect();break;case e.EVENT:this.onevent(a);break;case e.BINARY_EVENT:this.onevent(a);break;case e.ACK:this.onack(a);break;case e.BINARY_ACK:this.onack(a);break;case e.DISCONNECT:this.ondisconnect();break;case e.ERROR:this.emit("error",a.data)}},d.prototype.onevent=function(a){var b=a.data||[];j("emitting event %j",b),null!=a.id&&(j("attaching ack callback to event"),b.push(this.ack(a.id))),this.connected?m.apply(this,b):this.receiveBuffer.push(b)},d.prototype.ack=function(a){var b=this,c=!1;return function(){if(!c){c=!0;var d=g(arguments);j("sending ack %j",d);var f=k(d)?e.BINARY_ACK:e.ACK;b.packet({type:f,id:a,data:d})}}},d.prototype.onack=function(a){j("calling ack %s with %j",a.id,a.data);var b=this.acks[a.id];b.apply(this,a.data),delete this.acks[a.id]},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)m.apply(this,this.receiveBuffer[a]);for(this.receiveBuffer=[],a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){j("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(j("performing disconnect (%s)",this.nsp),this.packet({type:e.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(a,c,d){(function(b){function d(a,c){var d=a,c=c||b.location;return null==a&&(a=c.protocol+"//"+c.host),"string"==typeof a&&("/"==a.charAt(0)&&(a="/"==a.charAt(1)?c.protocol+a:c.hostname+a),/^(https?|wss?):\/\//.test(a)||(f("protocol-less url %s",a),a="undefined"!=typeof c?c.protocol+"//"+a:"https://"+a),f("parse %s",a),d=e(a)),d.port||(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443")),d.path=d.path||"/",d.id=d.protocol+"://"+d.host+":"+d.port,d.href=d.protocol+"://"+d.host+(c&&c.port==d.port?"":":"+d.port),d}var e=a("parseuri"),f=a("debug")("socket.io-client:url");c.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{debug:10,parseuri:44}],7:[function(a,b,c){function d(a){a=a||{},this.ms=a.min||100,this.max=a.max||1e4,this.factor=a.factor||2,this.jitter=a.jitter>0&&a.jitter<=1?a.jitter:0,this.attempts=0}b.exports=d,d.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=0==(1&Math.floor(10*b))?a-c:a+c}return 0|Math.min(a,this.max)},d.prototype.reset=function(){this.attempts=0},d.prototype.setMin=function(a){this.ms=a},d.prototype.setMax=function(a){this.max=a},d.prototype.setJitter=function(a){this.jitter=a}},{}],8:[function(a,b,c){var d=[].slice;b.exports=function(a,b){if("string"==typeof b&&(b=a[b]),"function"!=typeof b)throw new Error("bind() requires a function");var c=d.call(arguments,2);return function(){return b.apply(a,c.concat(d.call(arguments)))}}},{}],9:[function(a,b,c){function d(a){if(a)return e(a)}function e(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}b.exports=d,d.prototype.on=d.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},d.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},c.fn=b,this.on(a,c),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],10:[function(a,c,d){function e(a){return e.enabled(a)?function(c){c=f(c);var d=new Date,g=d-(e[a]||d);e[a]=d,c=a+" "+c+" +"+e.humanize(g),b.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function f(a){return a instanceof Error?a.stack||a.message:a}c.exports=e,e.names=[],e.skips=[],e.enable=function(a){try{}catch(a){}for(var b=(a||"").split(/[\s,]+/),c=b.length,d=0;d<c;d++)a=b[d].replace("*",".*?"),"-"===a[0]?e.skips.push(new RegExp("^"+a.substr(1)+"$")):e.names.push(new RegExp("^"+a+"$"))},e.disable=function(){e.enable("")},e.humanize=function(a){var b=1e3,c=6e4,d=60*c;return a>=d?(a/d).toFixed(1)+"h":a>=c?(a/c).toFixed(1)+"m":a>=b?(a/b|0)+"s":a+"ms"},e.enabled=function(a){for(var b=0,c=e.skips.length;b<c;b++)if(e.skips[b].test(a))return!1;for(var b=0,c=e.names.length;b<c;b++)if(e.names[b].test(a))return!0;return!1};try{}catch(a){}},{}],11:[function(a,b,c){b.exports=a("./lib/")},{"./lib/":12}],12:[function(a,b,c){b.exports=a("./socket"),b.exports.parser=a("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(a,c,d){(function(b){function d(a,c){if(!(this instanceof d))return new d(a,c);if(c=c||{},a&&"object"==typeof a&&(c=a,a=null),a&&(a=k(a),c.host=a.host,c.secure="https"==a.protocol||"wss"==a.protocol,c.port=a.port,a.query&&(c.query=a.query)),this.secure=null!=c.secure?c.secure:b.location&&"https:"==location.protocol,c.host){var e=c.host.split(":");c.hostname=e.shift(),e.length?c.port=e.pop():c.port||(c.port=this.secure?"443":"80")}this.agent=c.agent||!1,this.hostname=c.hostname||(b.location?location.hostname:"localhost"),this.port=c.port||(b.location&&location.port?location.port:this.secure?443:80),this.query=c.query||{},"string"==typeof this.query&&(this.query=m.decode(this.query)),this.upgrade=!1!==c.upgrade,this.path=(c.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!c.forceJSONP,this.jsonp=!1!==c.jsonp,this.forceBase64=!!c.forceBase64,this.enablesXDR=!!c.enablesXDR,this.timestampParam=c.timestampParam||"t",this.timestampRequests=c.timestampRequests,this.transports=c.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=c.policyPort||843,this.rememberUpgrade=c.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=c.onlyBinaryUpgrades,this.pfx=c.pfx||null,this.key=c.key||null,this.passphrase=c.passphrase||null,this.cert=c.cert||null,this.ca=c.ca||null,this.ciphers=c.ciphers||null,this.rejectUnauthorized=c.rejectUnauthorized||null,this.open()}function e(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var f=a("./transports"),g=a("component-emitter"),h=a("debug")("engine.io-client:socket"),i=a("indexof"),j=a("engine.io-parser"),k=a("parseuri"),l=a("parsejson"),m=a("parseqs");c.exports=d,d.priorWebsocketSuccess=!1,g(d.prototype),d.protocol=j.protocol,d.Socket=d,d.Transport=a("./transport"),d.transports=a("./transports"),d.parser=a("engine.io-parser"),d.prototype.createTransport=function(a){h('creating transport "%s"',a);var b=e(this.query);b.EIO=j.protocol,b.transport=a,this.id&&(b.sid=this.id);var c=new f[a]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:b,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return c},d.prototype.open=function(){var a;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1)a="websocket";else{if(0==this.transports.length){var b=this;return void setTimeout(function(){b.emit("error","No transports available")},0)}a=this.transports[0]}this.readyState="opening";var a;try{a=this.createTransport(a)}catch(a){return this.transports.shift(),void this.open()}a.open(),this.setTransport(a)},d.prototype.setTransport=function(a){h("setting transport %s",a.name);var b=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=a,a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})},d.prototype.probe=function(a){function b(){if(m.onlyBinaryUpgrades){var b=!this.supportsBinary&&m.transport.supportsBinary;l=l||b}l||(h('probe transport "%s" opened',a),k.send([{type:"ping",data:"probe"}]),k.once("packet",function(b){if(!l)if("pong"==b.type&&"probe"==b.data){if(h('probe transport "%s" pong',a),m.upgrading=!0,m.emit("upgrading",k),!k)return;d.priorWebsocketSuccess="websocket"==k.name,h('pausing current transport "%s"',m.transport.name),m.transport.pause(function(){l||"closed"!=m.readyState&&(h("changing transport and sending upgrade packet"),j(),m.setTransport(k),k.send([{type:"upgrade"}]),m.emit("upgrade",k),k=null,m.upgrading=!1,m.flush())})}else{h('probe transport "%s" failed',a);var c=new Error("probe error");c.transport=k.name,m.emit("upgradeError",c)}}))}function c(){l||(l=!0,j(),k.close(),k=null)}function e(b){var d=new Error("probe error: "+b);d.transport=k.name,c(),h('probe transport "%s" failed because of error: %s',a,b),m.emit("upgradeError",d)}function f(){e("transport closed")}function g(){e("socket closed")}function i(a){k&&a.name!=k.name&&(h('"%s" works - aborting "%s"',a.name,k.name),c())}function j(){k.removeListener("open",b),k.removeListener("error",e),k.removeListener("close",f),m.removeListener("close",g),m.removeListener("upgrading",i)}h('probing transport "%s"',a);var k=this.createTransport(a,{probe:1}),l=!1,m=this;d.priorWebsocketSuccess=!1,k.once("open",b),k.once("error",e),k.once("close",f),this.once("close",g),this.once("upgrading",i),k.open()},d.prototype.onOpen=function(){if(h("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){h("starting upgrade probes");for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}},d.prototype.onPacket=function(a){if("opening"==this.readyState||"open"==this.readyState)switch(h('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case"open":this.onHandshake(l(a.data));break;case"pong":this.setPing();break;case"error":var b=new Error("server error");b.code=a.data,this.emit("error",b);break;case"message":this.emit("data",a.data),this.emit("message",a.data)}else h('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(a){this.emit("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=this.filterUpgrades(a.upgrades),this.pingInterval=a.pingInterval,this.pingTimeout=a.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){"closed"!=b.readyState&&b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)},d.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer),a.pingIntervalTimer=setTimeout(function(){h("writing ping packet - expecting pong within %sms",a.pingTimeout),a.ping(),a.onHeartbeat(a.pingTimeout)},a.pingInterval)},d.prototype.ping=function(){this.sendPacket("ping")},d.prototype.onDrain=function(){for(var a=0;a<this.prevBufferLen;a++)this.callbackBuffer[a]&&this.callbackBuffer[a]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(a,b){return this.sendPacket("message",a,b),this},d.prototype.sendPacket=function(a,b,c){if("closing"!=this.readyState&&"closed"!=this.readyState){var d={type:a,data:b};this.emit("packetCreate",d),this.writeBuffer.push(d),this.callbackBuffer.push(c),this.flush()}},d.prototype.close=function(){function a(){d.onClose("forced close"),h("socket closing - telling transport to close"),d.transport.close()}function b(){d.removeListener("upgrade",b),d.removeListener("upgradeError",b),a()}function c(){d.once("upgrade",b),d.once("upgradeError",b)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var d=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?c():a()}):this.upgrading?c():a()}return this},d.prototype.onError=function(a){h("socket error %j",a),d.priorWebsocketSuccess=!1,this.emit("error",a),this.onClose("transport error",a)},d.prototype.onClose=function(a,b){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){h('socket close with reason: "%s"',a);var c=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){c.writeBuffer=[],c.callbackBuffer=[],c.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,b)}},d.prototype.filterUpgrades=function(a){for(var b=[],c=0,d=a.length;c<d;c++)~i(this.transports,a[c])&&b.push(a[c]);return b}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(a,b,c){function d(a){this.path=a.path,this.hostname=a.hostname,this.port=a.port,this.secure=a.secure,this.query=a.query,this.timestampParam=a.timestampParam,this.timestampRequests=a.timestampRequests,this.readyState="",this.agent=a.agent||!1,this.socket=a.socket,this.enablesXDR=a.enablesXDR,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized}var e=a("engine.io-parser"),f=a("component-emitter");b.exports=d,f(d.prototype),d.timestamps=0,d.prototype.onError=function(a,b){var c=new Error(a);return c.type="TransportError",c.description=b,this.emit("error",c),this},d.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},d.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},d.prototype.send=function(a){if("open"!=this.readyState)throw new Error("Transport not open");this.write(a)},d.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},d.prototype.onData=function(a){var b=e.decodePacket(a,this.socket.binaryType);this.onPacket(b)},d.prototype.onPacket=function(a){this.emit("packet",a)},d.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(a,c,d){(function(b){function c(a){var c,d=!1,h=!1,i=!1!==a.jsonp;if(b.location){var j="https:"==location.protocol,k=location.port;k||(k=j?443:80),d=a.hostname!=location.hostname||k!=a.port,h=a.secure!=j}if(a.xdomain=d,a.xscheme=h,c=new e(a),"open"in c&&!a.forceJSONP)return new f(a);if(!i)throw new Error("JSONP disabled");return new g(a)}var e=a("xmlhttprequest"),f=a("./polling-xhr"),g=a("./polling-jsonp"),h=a("./websocket");d.polling=c,d.websocket=h}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(a,c,d){(function(b){function d(a){e.call(this,a),this.query=this.query||{},g||(b.___eio||(b.___eio=[]),g=b.___eio),this.index=g.length;var c=this;g.push(function(a){c.onData(a)}),this.query.j=this.index,b.document&&b.addEventListener}var e=a("./polling"),f=a("component-inherit");c.exports=d;var g,h=/\n/g,i=/\\n/g;f(d,e),d.prototype.supportsBinary=!1,d.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),e.prototype.doClose.call(this)},d.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),b.async=!0,b.src=this.uri(),b.onerror=function(b){a.onError("jsonp poll error",b)};var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c),this.script=b;var d="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);d&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},d.prototype.doWrite=function(a,b){function c(){d(),b()}function d(){if(e.iframe)try{e.form.removeChild(e.iframe)}catch(a){e.onError("jsonp polling iframe removal error",a)}try{var a='<iframe src="javascript:0" name="'+e.iframeId+'">';f=document.createElement(a)}catch(a){f=document.createElement("iframe"),f.name=e.iframeId,f.src="javascript:0"}f.id=e.iframeId,e.form.appendChild(f),e.iframe=f}var e=this;if(!this.form){var f,g=document.createElement("form"),j=document.createElement("textarea"),k=this.iframeId="eio_iframe_"+this.index;g.className="socketio",g.style.position="absolute",g.style.top="-1000px",g.style.left="-1000px",g.target=k,g.method="POST",g.setAttribute("accept-charset","utf-8"),j.name="d",g.appendChild(j),document.body.appendChild(g),this.form=g,this.area=j}this.form.action=this.uri(),d(),a=a.replace(i,"\\\n"),this.area.value=a.replace(h,"\\n");try{this.form.submit()}catch(a){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==e.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{"./polling":18,"component-inherit":21}],17:[function(a,c,d){(function(b){function d(){}function e(a){if(i.call(this,a),b.location){var c="https:"==location.protocol,d=location.port;d||(d=c?443:80),this.xd=a.hostname!=b.location.hostname||d!=a.port,this.xs=a.secure!=c}}function f(a){this.method=a.method||"GET",this.uri=a.uri,this.xd=!!a.xd,this.xs=!!a.xs,this.async=!1!==a.async,this.data=void 0!=a.data?a.data:null,this.agent=a.agent,this.isBinary=a.isBinary,this.supportsBinary=a.supportsBinary,this.enablesXDR=a.enablesXDR,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized,this.create()}function g(){for(var a in f.requests)f.requests.hasOwnProperty(a)&&f.requests[a].abort()}var h=a("xmlhttprequest"),i=a("./polling"),j=a("component-emitter"),k=a("component-inherit"),l=a("debug")("engine.io-client:polling-xhr");c.exports=e,c.exports.Request=f,k(e,i),e.prototype.supportsBinary=!0,e.prototype.request=function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,new f(a)},e.prototype.doWrite=function(a,b){var c="string"!=typeof a&&void 0!==a,d=this.request({method:"POST",data:a,isBinary:c}),e=this;d.on("success",b),d.on("error",function(a){e.onError("xhr post error",a)}),this.sendXhr=d},e.prototype.doPoll=function(){l("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)}),a.on("error",function(a){b.onError("xhr poll error",a)}),this.pollXhr=a},j(f.prototype),f.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized;var c=this.xhr=new h(a),d=this;try{if(l("xhr open %s: %s",this.method,this.uri),c.open(this.method,this.uri,this.async),this.supportsBinary&&(c.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?c.setRequestHeader("Content-type","application/octet-stream"):c.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(a){}"withCredentials"in c&&(c.withCredentials=!0),this.hasXDR()?(c.onload=function(){d.onLoad()},c.onerror=function(){d.onError(c.responseText)}):c.onreadystatechange=function(){4==c.readyState&&(200==c.status||1223==c.status?d.onLoad():setTimeout(function(){d.onError(c.status)},0))},l("xhr data %s",this.data),c.send(this.data)}catch(a){return void setTimeout(function(){d.onError(a)},0)}b.document&&(this.index=f.requestsCount++,f.requests[this.index]=this)},f.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},f.prototype.onData=function(a){this.emit("data",a),this.onSuccess()},f.prototype.onError=function(a){this.emit("error",a),this.cleanup(!0)},f.prototype.cleanup=function(a){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=d,a)try{this.xhr.abort()}catch(a){}b.document&&delete f.requests[this.index],this.xhr=null}},f.prototype.onLoad=function(){var a;try{var b;try{b=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(a){}a="application/octet-stream"===b?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(a){this.onError(a)}null!=a&&this.onData(a)},f.prototype.hasXDR=function(){return"undefined"!=typeof b.XDomainRequest&&!this.xs&&this.enablesXDR},f.prototype.abort=function(){this.cleanup()},b.document&&(f.requestsCount=0,f.requests={},b.attachEvent?b.attachEvent("onunload",g):b.addEventListener)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(a,b,c){function d(a){var b=a&&a.forceBase64;j&&!b||(this.supportsBinary=!1),e.call(this,a)}var e=a("../transport"),f=a("parseqs"),g=a("engine.io-parser"),h=a("component-inherit"),i=a("debug")("engine.io-client:polling");b.exports=d;var j=function(){
var b=a("xmlhttprequest"),c=new b({xdomain:!1});return null!=c.responseType}();h(d,e),d.prototype.name="polling",d.prototype.doOpen=function(){this.poll()},d.prototype.pause=function(a){function b(){i("paused"),c.readyState="paused",a()}var c=this;if(this.readyState="pausing",this.polling||!this.writable){var d=0;this.polling&&(i("we are currently polling - waiting to pause"),d++,this.once("pollComplete",function(){i("pre-pause polling complete"),--d||b()})),this.writable||(i("we are currently writing - waiting to pause"),d++,this.once("drain",function(){i("pre-pause writing complete"),--d||b()}))}else b()},d.prototype.poll=function(){i("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},d.prototype.onData=function(a){var b=this;i("polling got data %s",a);var c=function(a,c,d){return"opening"==b.readyState&&b.onOpen(),"close"==a.type?(b.onClose(),!1):void b.onPacket(a)};g.decodePayload(a,this.socket.binaryType,c),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():i('ignoring poll - transport state "%s"',this.readyState))},d.prototype.doClose=function(){function a(){i("writing close packet"),b.write([{type:"close"}])}var b=this;"open"==this.readyState?(i("transport open - closing"),a()):(i("transport not open - deferring close"),this.once("open",a))},d.prototype.write=function(a){var b=this;this.writable=!1;var c=function(){b.writable=!0,b.emit("drain")},b=this;g.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,c)})},d.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";return!1!==this.timestampRequests&&(a[this.timestampParam]=+new Date+"-"+e.timestamps++),this.supportsBinary||a.sid||(a.b64=1),a=f.encode(a),this.port&&("https"==b&&443!=this.port||"http"==b&&80!=this.port)&&(c=":"+this.port),a.length&&(a="?"+a),b+"://"+this.hostname+c+this.path+a}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(a,b,c){function d(a){var b=a&&a.forceBase64;b&&(this.supportsBinary=!1),e.call(this,a)}var e=a("../transport"),f=a("engine.io-parser"),g=a("parseqs"),h=a("component-inherit"),i=a("debug")("engine.io-client:websocket"),j=a("ws");b.exports=d,h(d,e),d.prototype.name="websocket",d.prototype.supportsBinary=!0,d.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b=void 0,c={agent:this.agent};c.pfx=this.pfx,c.key=this.key,c.passphrase=this.passphrase,c.cert=this.cert,c.ca=this.ca,c.ciphers=this.ciphers,c.rejectUnauthorized=this.rejectUnauthorized,this.ws=new j(a,b,c),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},d.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()},this.ws.onclose=function(){a.onClose()},this.ws.onmessage=function(b){a.onData(b.data)},this.ws.onerror=function(b){a.onError("websocket error",b)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(a){var b=this;setTimeout(function(){e.prototype.onData.call(b,a)},0)}),d.prototype.write=function(a){function b(){c.writable=!0,c.emit("drain")}var c=this;this.writable=!1;for(var d=0,e=a.length;d<e;d++)f.encodePacket(a[d],this.supportsBinary,function(a){try{c.ws.send(a)}catch(a){i("websocket closed before onclose event")}});setTimeout(b,0)},d.prototype.onClose=function(){e.prototype.onClose.call(this)},d.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},d.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";return this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(c=":"+this.port),this.timestampRequests&&(a[this.timestampParam]=+new Date),this.supportsBinary||(a.b64=1),a=g.encode(a),a.length&&(a="?"+a),b+"://"+this.hostname+c+this.path+a},d.prototype.check=function(){return!(!j||"__initialize"in j&&this.name===d.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(a,b,c){var d=a("has-cors");b.exports=function(a){var b=a.xdomain,c=a.xscheme,e=a.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!b||d))return new XMLHttpRequest}catch(a){}try{if("undefined"!=typeof XDomainRequest&&!c&&e)return new XDomainRequest}catch(a){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}},{"has-cors":40}],21:[function(a,b,c){b.exports=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],22:[function(a,c,d){function e(){return"WebkitAppearance"in document.documentElement.style||b.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function f(){var a=arguments,b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+d.humanize(this.diff),!b)return a;var c="color: "+this.color;a=[a[0],c,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,c),a}function g(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function h(a){}function i(){var a;try{}catch(a){}return a}d=c.exports=a("./debug"),d.log=g,d.formatArgs=f,d.save=h,d.load=i,d.useColors=e,d.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],d.formatters.j=function(a){return JSON.stringify(a)},d.enable(i())},{"./debug":23}],23:[function(a,b,c){function d(){return c.colors[k++%c.colors.length]}function e(a){function b(){}function e(){var a=e,b=+new Date,f=b-(j||b);a.diff=f,a.prev=j,a.curr=b,j=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=c.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(b,d){if("%"===b)return b;h++;var e=c.formatters[d];if("function"==typeof e){var f=g[h];b=e.call(a,f),g.splice(h,1),h--}return b}),"function"==typeof c.formatArgs&&(g=c.formatArgs.apply(a,g));var i=e.log||c.log||console.log.bind(console);i.apply(a,g)}b.enabled=!1,e.enabled=!0;var f=c.enabled(a)?e:b;return f.namespace=a,f}function f(a){c.save(a);for(var b=(a||"").split(/[\s,]+/),d=b.length,e=0;e<d;e++)b[e]&&(a=b[e].replace(/\*/g,".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$")))}function g(){c.enable("")}function h(a){var b,d;for(b=0,d=c.skips.length;b<d;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;b<d;b++)if(c.names[b].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=e,c.coerce=i,c.disable=g,c.enable=f,c.enabled=h,c.humanize=a("ms"),c.names=[],c.skips=[],c.formatters={};var j,k=0},{ms:24}],24:[function(a,b,c){function d(a){var b=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"y":return c*l;case"days":case"day":case"d":return c*k;case"hours":case"hour":case"h":return c*j;case"minutes":case"minute":case"m":return c*i;case"seconds":case"second":case"s":return c*h;case"ms":return c}}}function e(a){return a>=k?Math.round(a/k)+"d":a>=j?Math.round(a/j)+"h":a>=i?Math.round(a/i)+"m":a>=h?Math.round(a/h)+"s":a+"ms"}function f(a){return g(a,k,"day")||g(a,j,"hour")||g(a,i,"minute")||g(a,h,"second")||a+" ms"}function g(a,b,c){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var h=1e3,i=60*h,j=60*i,k=24*j,l=365.25*k;b.exports=function(a,b){return b=b||{},"string"==typeof a?d(a):b.long?f(a):e(a)}},{}],25:[function(a,c,d){(function(b){function c(a,b){var c="b"+d.packets[a.type]+a.data.data;return b(c)}function e(a,b,c){if(!b)return d.encodeBase64Packet(a,c);var e=a.data,f=new Uint8Array(e),g=new Uint8Array(1+e.byteLength);g[0]=r[a.type];for(var h=0;h<f.length;h++)g[h+1]=f[h];return c(g.buffer)}function f(a,b,c){if(!b)return d.encodeBase64Packet(a,c);var e=new FileReader;return e.onload=function(){a.data=e.result,d.encodePacket(a,b,!0,c)},e.readAsArrayBuffer(a.data)}function g(a,b,c){if(!b)return d.encodeBase64Packet(a,c);if(q)return f(a,b,c);var e=new Uint8Array(1);e[0]=r[a.type];var g=new u([e.buffer,a.data]);return c(g)}function h(a,b,c){for(var d=new Array(a.length),e=m(a.length,c),f=function(a,c,e){b(c,function(b,c){d[a]=c,e(b,d)})},g=0;g<a.length;g++)f(g,a[g],e)}var i=a("./keys"),j=a("has-binary"),k=a("arraybuffer.slice"),l=a("base64-arraybuffer"),m=a("after"),n=a("utf8"),o=navigator.userAgent.match(/Android/i),p=/PhantomJS/i.test(navigator.userAgent),q=o||p;d.protocol=3;var r=d.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},s=i(r),t={type:"error",data:"parser error"},u=a("blob");d.encodePacket=function(a,d,f,h){"function"==typeof d&&(h=d,d=!1),"function"==typeof f&&(h=f,f=null);var i=void 0===a.data?void 0:a.data.buffer||a.data;if(b.ArrayBuffer&&i instanceof ArrayBuffer)return e(a,d,h);if(u&&i instanceof b.Blob)return g(a,d,h);if(i&&i.base64)return c(a,h);var j=r[a.type];return void 0!==a.data&&(j+=f?n.encode(String(a.data)):String(a.data)),h(""+j)},d.encodeBase64Packet=function(a,c){var e="b"+d.packets[a.type];if(u&&a.data instanceof u){var f=new FileReader;return f.onload=function(){var a=f.result.split(",")[1];c(e+a)},f.readAsDataURL(a.data)}var g;try{g=String.fromCharCode.apply(null,new Uint8Array(a.data))}catch(b){for(var h=new Uint8Array(a.data),i=new Array(h.length),j=0;j<h.length;j++)i[j]=h[j];g=String.fromCharCode.apply(null,i)}return e+=b.btoa(g),c(e)},d.decodePacket=function(a,b,c){if("string"==typeof a||void 0===a){if("b"==a.charAt(0))return d.decodeBase64Packet(a.substr(1),b);if(c)try{a=n.decode(a)}catch(a){return t}var e=a.charAt(0);return Number(e)==e&&s[e]?a.length>1?{type:s[e],data:a.substring(1)}:{type:s[e]}:t}var f=new Uint8Array(a),e=f[0],g=k(a,1);return u&&"blob"===b&&(g=new u([g])),{type:s[e],data:g}},d.decodeBase64Packet=function(a,c){var d=s[a.charAt(0)];if(!b.ArrayBuffer)return{type:d,data:{base64:!0,data:a.substr(1)}};var e=l.decode(a.substr(1));return"blob"===c&&u&&(e=new u([e])),{type:d,data:e}},d.encodePayload=function(a,b,c){function e(a){return a.length+":"+a}function f(a,c){d.encodePacket(a,!!g&&b,!0,function(a){c(null,e(a))})}"function"==typeof b&&(c=b,b=null);var g=j(a);return b&&g?u&&!q?d.encodePayloadAsBlob(a,c):d.encodePayloadAsArrayBuffer(a,c):a.length?void h(a,f,function(a,b){return c(b.join(""))}):c("0:")},d.decodePayload=function(a,b,c){if("string"!=typeof a)return d.decodePayloadAsBinary(a,b,c);"function"==typeof b&&(c=b,b=null);var e;if(""==a)return c(t,0,1);for(var f,g,h="",i=0,j=a.length;i<j;i++){var k=a.charAt(i);if(":"!=k)h+=k;else{if(""==h||h!=(f=Number(h)))return c(t,0,1);if(g=a.substr(i+1,f),h!=g.length)return c(t,0,1);if(g.length){if(e=d.decodePacket(g,b,!0),t.type==e.type&&t.data==e.data)return c(t,0,1);var l=c(e,i+f,j);if(!1===l)return}i+=f,h=""}}return""!=h?c(t,0,1):void 0},d.encodePayloadAsArrayBuffer=function(a,b){function c(a,b){d.encodePacket(a,!0,!0,function(a){return b(null,a)})}return a.length?void h(a,c,function(a,c){var d=c.reduce(function(a,b){var c;return c="string"==typeof b?b.length:b.byteLength,a+c.toString().length+c+2},0),e=new Uint8Array(d),f=0;return c.forEach(function(a){var b="string"==typeof a,c=a;if(b){for(var d=new Uint8Array(a.length),g=0;g<a.length;g++)d[g]=a.charCodeAt(g);c=d.buffer}b?e[f++]=0:e[f++]=1;for(var h=c.byteLength.toString(),g=0;g<h.length;g++)e[f++]=parseInt(h[g]);e[f++]=255;for(var d=new Uint8Array(c),g=0;g<d.length;g++)e[f++]=d[g]}),b(e.buffer)}):b(new ArrayBuffer(0))},d.encodePayloadAsBlob=function(a,b){function c(a,b){d.encodePacket(a,!0,!0,function(a){var c=new Uint8Array(1);if(c[0]=1,"string"==typeof a){for(var d=new Uint8Array(a.length),e=0;e<a.length;e++)d[e]=a.charCodeAt(e);a=d.buffer,c[0]=0}for(var f=a instanceof ArrayBuffer?a.byteLength:a.size,g=f.toString(),h=new Uint8Array(g.length+1),e=0;e<g.length;e++)h[e]=parseInt(g[e]);if(h[g.length]=255,u){var i=new u([c.buffer,h.buffer,a]);b(null,i)}})}h(a,c,function(a,c){return b(new u(c))})},d.decodePayloadAsBinary=function(a,b,c){"function"==typeof b&&(c=b,b=null);for(var e=a,f=[],g=!1;e.byteLength>0;){for(var h=new Uint8Array(e),i=0===h[0],j="",l=1;255!=h[l];l++){if(j.length>310){g=!0;break}j+=h[l]}if(g)return c(t,0,1);e=k(e,2+j.length),j=parseInt(j);var m=k(e,0,j);if(i)try{m=String.fromCharCode.apply(null,new Uint8Array(m))}catch(a){var n=new Uint8Array(m);m="";for(var l=0;l<n.length;l++)m+=String.fromCharCode(n[l])}f.push(m),e=k(e,j)}var o=f.length;f.forEach(function(a,e){c(d.decodePacket(a,b,!0),e,o)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(a,b,c){b.exports=Object.keys||function(a){var b=[],c=Object.prototype.hasOwnProperty;for(var d in a)c.call(a,d)&&b.push(d);return b}},{}],27:[function(a,b,c){function d(a,b,c){function d(a,e){if(d.count<=0)throw new Error("after called too many times");--d.count,a?(f=!0,b(a),b=c):0!==d.count||f||b(null,e)}var f=!1;return c=c||e,d.count=a,0===a?b():d}function e(){}b.exports=d},{}],28:[function(a,b,c){b.exports=function(a,b,c){var d=a.byteLength;if(b=b||0,c=c||d,a.slice)return a.slice(b,c);if(b<0&&(b+=d),c<0&&(c+=d),c>d&&(c=d),b>=d||b>=c||0===d)return new ArrayBuffer(0);for(var e=new Uint8Array(a),f=new Uint8Array(c-b),g=b,h=0;g<c;g++,h++)f[h]=e[g];return f.buffer}},{}],29:[function(a,b,c){!function(a){"use strict";c.encode=function(b){var c,d=new Uint8Array(b),e=d.length,f="";for(c=0;c<e;c+=3)f+=a[d[c]>>2],f+=a[(3&d[c])<<4|d[c+1]>>4],f+=a[(15&d[c+1])<<2|d[c+2]>>6],f+=a[63&d[c+2]];return e%3===2?f=f.substring(0,f.length-1)+"=":e%3===1&&(f=f.substring(0,f.length-2)+"=="),f},c.decode=function(b){var c,d,e,f,g,h=.75*b.length,i=b.length,j=0;"="===b[b.length-1]&&(h--,"="===b[b.length-2]&&h--);var k=new ArrayBuffer(h),l=new Uint8Array(k);for(c=0;c<i;c+=4)d=a.indexOf(b[c]),e=a.indexOf(b[c+1]),f=a.indexOf(b[c+2]),g=a.indexOf(b[c+3]),l[j++]=d<<2|e>>4,l[j++]=(15&e)<<4|f>>2,l[j++]=(3&f)<<6|63&g;return k}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(a,c,d){(function(a){function b(a,b){b=b||{};for(var c=new d,e=0;e<a.length;e++)c.append(a[e]);return b.type?c.getBlob(b.type):c.getBlob()}var d=a.BlobBuilder||a.WebKitBlobBuilder||a.MSBlobBuilder||a.MozBlobBuilder,e=function(){try{var a=new Blob(["hi"]);return 2==a.size}catch(a){return!1}}(),f=d&&d.prototype.append&&d.prototype.getBlob;c.exports=function(){return e?a.Blob:f?b:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{}],31:[function(a,c,d){(function(b){function d(a){function c(a){if(!a)return!1;if(b.Buffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer||b.Blob&&a instanceof Blob||b.File&&a instanceof File)return!0;if(e(a)){for(var d=0;d<a.length;d++)if(c(a[d]))return!0}else if(a&&"object"==typeof a){a.toJSON&&(a=a.toJSON());for(var f in a)if(a.hasOwnProperty(f)&&c(a[f]))return!0}return!1}return c(a)}var e=a("isarray");c.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{isarray:32}],32:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],33:[function(c,d,e){(function(b){!function(c){function f(a){for(var b,c,d=[],e=0,f=a.length;e<f;)b=a.charCodeAt(e++),b>=55296&&b<=56319&&e<f?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function g(a){for(var b,c=a.length,d=-1,e="";++d<c;)b=a[d],b>65535&&(b-=65536,e+=t(b>>>10&1023|55296),b=56320|1023&b),e+=t(b);return e}function h(a,b){return t(a>>b&63|128)}function i(a){if(0==(4294967168&a))return t(a);var b="";return 0==(4294965248&a)?b=t(a>>6&31|192):0==(4294901760&a)?(b=t(a>>12&15|224),b+=h(a,6)):0==(4292870144&a)&&(b=t(a>>18&7|240),b+=h(a,12),b+=h(a,6)),b+=t(63&a|128)}function j(a){for(var b,c=f(a),d=c.length,e=-1,g="";++e<d;)b=c[e],g+=i(b);return g}function k(){if(s>=r)throw Error("Invalid byte index");var a=255&q[s];if(s++,128==(192&a))return 63&a;throw Error("Invalid continuation byte")}function l(){var a,b,c,d,e;if(s>r)throw Error("Invalid byte index");if(s==r)return!1;if(a=255&q[s],s++,0==(128&a))return a;if(192==(224&a)){var b=k();if(e=(31&a)<<6|b,e>=128)return e;throw Error("Invalid continuation byte")}if(224==(240&a)){if(b=k(),c=k(),e=(15&a)<<12|b<<6|c,e>=2048)return e;throw Error("Invalid continuation byte")}if(240==(248&a)&&(b=k(),c=k(),d=k(),e=(15&a)<<18|b<<12|c<<6|d,e>=65536&&e<=1114111))return e;throw Error("Invalid UTF-8 detected")}function m(a){q=f(a),r=q.length,s=0;for(var b,c=[];(b=l())!==!1;)c.push(b);return g(c)}var n="object"==typeof e&&e,o="object"==typeof d&&d&&d.exports==n&&d,p="object"==typeof b&&b;p.global!==p&&p.window!==p||(c=p);var q,r,s,t=String.fromCharCode,u={version:"2.0.0",encode:j,decode:m};if("function"==typeof a&&"object"==typeof a.amd&&a.amd)a(function(){return u});else if(n&&!n.nodeType)if(o)o.exports=u;else{var v={},w=v.hasOwnProperty;for(var x in u)w.call(u,x)&&(n[x]=u[x])}else c.utf8=u}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{}],34:[function(a,c,d){(function(a){var b=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,e=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,f=/(?:^|:|,)(?:\s*\[)+/g,g=/^\s+/,h=/\s+$/;c.exports=function(c){return"string"==typeof c&&c?(c=c.replace(g,"").replace(h,""),a.JSON&&JSON.parse?JSON.parse(c):b.test(c.replace(d,"@").replace(e,"]").replace(f,""))?new Function("return "+c)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{}],35:[function(a,b,c){c.encode=function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b},c.decode=function(a){for(var b={},c=a.split("&"),d=0,e=c.length;d<e;d++){var f=c[d].split("=");b[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return b}},{}],36:[function(a,b,c){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];b.exports=function(a){var b=a,c=a.indexOf("["),f=a.indexOf("]");c!=-1&&f!=-1&&(a=a.substring(0,c)+a.substring(c,f).replace(/:/g,";")+a.substring(f,a.length));for(var g=d.exec(a||""),h={},i=14;i--;)h[e[i]]=g[i]||"";return c!=-1&&f!=-1&&(h.source=b,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h}},{}],37:[function(a,b,c){function d(a,b,c){var d;return d=b?new f(a,b):new f(a)}var e=function(){return this}(),f=e.WebSocket||e.MozWebSocket;b.exports=f?d:null,f&&(d.prototype=f.prototype)},{}],38:[function(a,c,d){(function(b){function d(a){function c(a){if(!a)return!1;if(b.Buffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer||b.Blob&&a instanceof Blob||b.File&&a instanceof File)return!0;if(e(a)){for(var d=0;d<a.length;d++)if(c(a[d]))return!0}else if(a&&"object"==typeof a){a.toJSON&&(a=a.toJSON());for(var f in a)if(Object.prototype.hasOwnProperty.call(a,f)&&c(a[f]))return!0}return!1}return c(a)}var e=a("isarray");c.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{isarray:39}],39:[function(a,b,c){b.exports=a(32)},{}],40:[function(a,b,c){var d=a("global");try{b.exports="XMLHttpRequest"in d&&"withCredentials"in new d.XMLHttpRequest}catch(a){b.exports=!1}},{global:41}],41:[function(a,b,c){b.exports=function(){return this}()},{}],42:[function(a,b,c){var d=[].indexOf;b.exports=function(a,b){if(d)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}},{}],43:[function(a,b,c){var d=Object.prototype.hasOwnProperty;c.keys=Object.keys||function(a){var b=[];for(var c in a)d.call(a,c)&&b.push(c);return b},c.values=function(a){var b=[];for(var c in a)d.call(a,c)&&b.push(a[c]);return b},c.merge=function(a,b){for(var c in b)d.call(b,c)&&(a[c]=b[c]);return a},c.length=function(a){return c.keys(a).length},c.isEmpty=function(a){return 0==c.length(a)}},{}],44:[function(a,b,c){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];b.exports=function(a){for(var b=d.exec(a||""),c={},f=14;f--;)c[e[f]]=b[f]||"";return c}},{}],45:[function(a,c,d){(function(b){var c=a("isarray"),e=a("./is-buffer");d.deconstructPacket=function(a){function b(a){if(!a)return a;if(e(a)){var f={_placeholder:!0,num:d.length};return d.push(a),f}if(c(a)){for(var g=new Array(a.length),h=0;h<a.length;h++)g[h]=b(a[h]);return g}if("object"==typeof a&&!(a instanceof Date)){var g={};for(var i in a)g[i]=b(a[i]);return g}return a}var d=[],f=a.data,g=a;return g.data=b(f),g.attachments=d.length,{packet:g,buffers:d}},d.reconstructPacket=function(a,b){function d(a){if(a&&a._placeholder){var e=b[a.num];return e}if(c(a)){for(var f=0;f<a.length;f++)a[f]=d(a[f]);return a}if(a&&"object"==typeof a){for(var g in a)a[g]=d(a[g]);return a}return a}return a.data=d(a.data),a.attachments=void 0,a},d.removeBlobs=function(a,d){function f(a,i,j){if(!a)return a;if(b.Blob&&a instanceof Blob||b.File&&a instanceof File){g++;var k=new FileReader;k.onload=function(){j?j[i]=this.result:h=this.result,--g||d(h)},k.readAsArrayBuffer(a)}else if(c(a))for(var l=0;l<a.length;l++)f(a[l],l,a);else if(a&&"object"==typeof a&&!e(a))for(var m in a)f(a[m],m,a)}var g=0,h=a;f(h),g||d(h)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{"./is-buffer":47,isarray:48}],46:[function(a,b,c){function d(){}function e(a){var b="",d=!1;return b+=a.type,c.BINARY_EVENT!=a.type&&c.BINARY_ACK!=a.type||(b+=a.attachments,b+="-"),a.nsp&&"/"!=a.nsp&&(d=!0,b+=a.nsp),null!=a.id&&(d&&(b+=",",d=!1),b+=a.id),null!=a.data&&(d&&(b+=","),b+=l.stringify(a.data)),k("encoded %j as %s",a,b),b}function f(a,b){function c(a){var c=n.deconstructPacket(a),d=e(c.packet),f=c.buffers;f.unshift(d),b(f)}n.removeBlobs(a,c)}function g(){this.reconstructor=null}function h(a){var b={},d=0;if(b.type=Number(a.charAt(0)),null==c.types[b.type])return j();if(c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type){for(var e="";"-"!=a.charAt(++d)&&(e+=a.charAt(d),d!=a.length););if(e!=Number(e)||"-"!=a.charAt(d))throw new Error("Illegal attachments");b.attachments=Number(e)}if("/"==a.charAt(d+1))for(b.nsp="";++d;){var f=a.charAt(d);if(","==f)break;if(b.nsp+=f,d==a.length)break}else b.nsp="/";var g=a.charAt(d+1);if(""!==g&&Number(g)==g){for(b.id="";++d;){var f=a.charAt(d);if(null==f||Number(f)!=f){--d;break}if(b.id+=a.charAt(d),d==a.length)break}b.id=Number(b.id)}if(a.charAt(++d))try{b.data=l.parse(a.substr(d))}catch(a){return j()}return k("decoded %s as %j",a,b),b}function i(a){this.reconPack=a,this.buffers=[]}function j(a){return{type:c.ERROR,data:"parser error"}}var k=a("debug")("socket.io-parser"),l=a("json3"),m=a("component-emitter"),n=a("./binary"),o=a("./is-buffer");c.protocol=4,c.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],c.CONNECT=0,c.DISCONNECT=1,c.EVENT=2,c.ACK=3,c.ERROR=4,c.BINARY_EVENT=5,c.BINARY_ACK=6,c.Encoder=d,c.Decoder=g,d.prototype.encode=function(a,b){if(k("encoding packet %j",a),c.BINARY_EVENT==a.type||c.BINARY_ACK==a.type)f(a,b);else{var d=e(a);b([d])}},m(g.prototype),g.prototype.add=function(a){var b;if("string"==typeof a)b=h(a),c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type?(this.reconstructor=new i(b),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",b)):this.emit("decoded",b);else{if(!o(a)&&!a.base64)throw new Error("Unknown type: "+a);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");b=this.reconstructor.takeBinaryData(a),b&&(this.reconstructor=null,this.emit("decoded",b))}},g.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},i.prototype.takeBinaryData=function(a){if(this.buffers.push(a),this.buffers.length==this.reconPack.attachments){var b=n.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),b}return null},i.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(a,c,d){(function(a){function b(b){return a.Buffer&&a.Buffer.isBuffer(b)||a.ArrayBuffer&&b instanceof ArrayBuffer}c.exports=b}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof b?b:{})},{}],48:[function(a,b,c){b.exports=a(32)},{}],49:[function(b,c,d){!function(b){function c(a){if(c[a]!==g)return c[a];var b;if("bug-string-char-index"==a)b="a"!="a"[0];else if("json"==a)b=c("json-stringify")&&c("json-parse");else{var d,e='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==a){var f=k.stringify,i="function"==typeof f&&l;if(i){(d=function(){return 1}).toJSON=d;try{i="0"===f(0)&&"0"===f(new Number)&&'""'==f(new String)&&f(h)===g&&f(g)===g&&f()===g&&"1"===f(d)&&"[1]"==f([d])&&"[null]"==f([g])&&"null"==f(null)&&"[null,null,null]"==f([g,h,null])&&f({a:[d,!0,!1,null,"\0\b\n\f\r\t"]})==e&&"1"===f(null,d)&&"[\n 1,\n 2\n]"==f([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==f(new Date((-864e13)))&&'"+275760-09-13T00:00:00.000Z"'==f(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==f(new Date((-621987552e5)))&&'"1969-12-31T23:59:59.999Z"'==f(new Date((-1)))}catch(a){i=!1}}b=i}if("json-parse"==a){var j=k.parse;if("function"==typeof j)try{if(0===j("0")&&!j(!1)){d=j(e);var m=5==d.a.length&&1===d.a[0];if(m){try{m=!j('"\t"')}catch(a){}if(m)try{m=1!==j("01")}catch(a){}if(m)try{m=1!==j("1.")}catch(a){}}}}catch(a){m=!1}b=m}}return c[a]=!!b}var e,f,g,h={}.toString,i="function"==typeof a&&a.amd,j="object"==typeof JSON&&JSON,k="object"==typeof d&&d&&!d.nodeType&&d;k&&j?(k.stringify=j.stringify,k.parse=j.parse):k=b.JSON=j||{};var l=new Date((-0xc782b5b800cec));try{l=l.getUTCFullYear()==-109252&&0===l.getUTCMonth()&&1===l.getUTCDate()&&10==l.getUTCHours()&&37==l.getUTCMinutes()&&6==l.getUTCSeconds()&&708==l.getUTCMilliseconds()}catch(a){}if(!c("json")){var m="[object Function]",n="[object Date]",o="[object Number]",p="[object String]",q="[object Array]",r="[object Boolean]",s=c("bug-string-char-index");if(!l)var t=Math.floor,u=[0,31,59,90,120,151,181,212,243,273,304,334],v=function(a,b){return u[b]+365*(a-1970)+t((a-1969+(b=+(b>1)))/4)-t((a-1901+b)/100)+t((a-1601+b)/400)};(e={}.hasOwnProperty)||(e=function(a){var b,c={};return(c.__proto__=null,c.__proto__={toString:1},c).toString!=h?e=function(a){var b=this.__proto__,c=a in(this.__proto__=null,this);return this.__proto__=b,c}:(b=c.constructor,e=function(a){var c=(this.constructor||b).prototype;return a in this&&!(a in c&&this[a]===c[a])}),c=null,e.call(this,a)});var w={boolean:1,number:1,string:1,undefined:1},x=function(a,b){var c=typeof a[b];return"object"==c?!!a[b]:!w[c]};if(f=function(a,b){var c,d,g,i=0;(c=function(){this.valueOf=0}).prototype.valueOf=0,d=new c;for(g in d)e.call(d,g)&&i++;return c=d=null,i?f=2==i?function(a,b){var c,d={},f=h.call(a)==m;for(c in a)f&&"prototype"==c||e.call(d,c)||!(d[c]=1)||!e.call(a,c)||b(c)}:function(a,b){var c,d,f=h.call(a)==m;for(c in a)f&&"prototype"==c||!e.call(a,c)||(d="constructor"===c)||b(c);(d||e.call(a,c="constructor"))&&b(c)}:(d=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(a,b){var c,f,g=h.call(a)==m,i=!g&&"function"!=typeof a.constructor&&x(a,"hasOwnProperty")?a.hasOwnProperty:e;for(c in a)g&&"prototype"==c||!i.call(a,c)||b(c);for(f=d.length;c=d[--f];i.call(a,c)&&b(c));}),f(a,b)},!c("json-stringify")){var y={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},z="000000",A=function(a,b){return(z+(b||0)).slice(-a)},B="\\u00",C=function(a){var b,c='"',d=0,e=a.length,f=e>10&&s;for(f&&(b=a.split(""));d<e;d++){var g=a.charCodeAt(d);switch(g){case 8:case 9:case 10:case 12:case 13:case 34:case 92:c+=y[g];break;default:if(g<32){c+=B+A(2,g.toString(16));break}c+=f?b[d]:s?a.charAt(d):a[d]}}return c+'"'},D=function(a,b,c,d,i,j,k){var l,m,s,u,w,x,y,z,B,E,F,G,H,I,J,K;try{l=b[a]}catch(a){}if("object"==typeof l&&l)if(m=h.call(l),m!=n||e.call(l,"toJSON"))"function"==typeof l.toJSON&&(m!=o&&m!=p&&m!=q||e.call(l,"toJSON"))&&(l=l.toJSON(a));else if(l>-1/0&&l<1/0){if(v){for(w=t(l/864e5),s=t(w/365.2425)+1970-1;v(s+1,0)<=w;s++);for(u=t((w-v(s,0))/30.42);v(s,u+1)<=w;u++);w=1+w-v(s,u),x=(l%864e5+864e5)%864e5,y=t(x/36e5)%24,z=t(x/6e4)%60,B=t(x/1e3)%60,E=x%1e3}else s=l.getUTCFullYear(),u=l.getUTCMonth(),w=l.getUTCDate(),y=l.getUTCHours(),z=l.getUTCMinutes(),B=l.getUTCSeconds(),E=l.getUTCMilliseconds();l=(s<=0||s>=1e4?(s<0?"-":"+")+A(6,s<0?-s:s):A(4,s))+"-"+A(2,u+1)+"-"+A(2,w)+"T"+A(2,y)+":"+A(2,z)+":"+A(2,B)+"."+A(3,E)+"Z"}else l=null;if(c&&(l=c.call(b,a,l)),null===l)return"null";if(m=h.call(l),m==r)return""+l;if(m==o)return l>-1/0&&l<1/0?""+l:"null";if(m==p)return C(""+l);if("object"==typeof l){for(I=k.length;I--;)if(k[I]===l)throw TypeError();if(k.push(l),F=[],J=j,j+=i,m==q){for(H=0,I=l.length;H<I;H++)G=D(H,l,c,d,i,j,k),F.push(G===g?"null":G);K=F.length?i?"[\n"+j+F.join(",\n"+j)+"\n"+J+"]":"["+F.join(",")+"]":"[]"}else f(d||l,function(a){var b=D(a,l,c,d,i,j,k);b!==g&&F.push(C(a)+":"+(i?" ":"")+b)}),K=F.length?i?"{\n"+j+F.join(",\n"+j)+"\n"+J+"}":"{"+F.join(",")+"}":"{}";return k.pop(),K}};k.stringify=function(a,b,c){var d,e,f,g;if("function"==typeof b||"object"==typeof b&&b)if((g=h.call(b))==m)e=b;else if(g==q){f={};for(var i,j=0,k=b.length;j<k;i=b[j++],g=h.call(i),(g==p||g==o)&&(f[i]=1));}if(c)if((g=h.call(c))==o){if((c-=c%1)>0)for(d="",c>10&&(c=10);d.length<c;d+=" ");}else g==p&&(d=c.length<=10?c:c.slice(0,10));return D("",(i={},i[""]=a,i),e,f,d,"",[])}}if(!c("json-parse")){var E,F,G=String.fromCharCode,H={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},I=function(){throw E=F=null,SyntaxError()},J=function(){for(var a,b,c,d,e,f=F,g=f.length;E<g;)switch(e=f.charCodeAt(E)){case 9:case 10:case 13:case 32:E++;break;case 123:case 125:case 91:case 93:case 58:case 44:return a=s?f.charAt(E):f[E],E++,a;case 34:for(a="@",E++;E<g;)if(e=f.charCodeAt(E),e<32)I();else if(92==e)switch(e=f.charCodeAt(++E)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:a+=H[e],E++;break;case 117:for(b=++E,c=E+4;E<c;E++)e=f.charCodeAt(E),e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70||I();a+=G("0x"+f.slice(b,E));break;default:I()}else{if(34==e)break;for(e=f.charCodeAt(E),b=E;e>=32&&92!=e&&34!=e;)e=f.charCodeAt(++E);a+=f.slice(b,E)}if(34==f.charCodeAt(E))return E++,a;I();default:if(b=E,45==e&&(d=!0,e=f.charCodeAt(++E)),e>=48&&e<=57){for(48==e&&(e=f.charCodeAt(E+1),e>=48&&e<=57)&&I(),d=!1;E<g&&(e=f.charCodeAt(E),e>=48&&e<=57);E++);if(46==f.charCodeAt(E)){for(c=++E;c<g&&(e=f.charCodeAt(c),e>=48&&e<=57);c++);c==E&&I(),E=c}if(e=f.charCodeAt(E),101==e||69==e){for(e=f.charCodeAt(++E),43!=e&&45!=e||E++,c=E;c<g&&(e=f.charCodeAt(c),e>=48&&e<=57);c++);c==E&&I(),E=c}return+f.slice(b,E)}if(d&&I(),"true"==f.slice(E,E+4))return E+=4,!0;if("false"==f.slice(E,E+5))return E+=5,!1;if("null"==f.slice(E,E+4))return E+=4,null;I()}return"$"},K=function(a){var b,c;if("$"==a&&I(),"string"==typeof a){if("@"==(s?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];a=J(),"]"!=a;c||(c=!0))c&&(","==a?(a=J(),"]"==a&&I()):I()),","==a&&I(),b.push(K(a));return b}if("{"==a){for(b={};a=J(),"}"!=a;c||(c=!0))c&&(","==a?(a=J(),"}"==a&&I()):I()),
","!=a&&"string"==typeof a&&"@"==(s?a.charAt(0):a[0])&&":"==J()||I(),b[a.slice(1)]=K(J());return b}I()}return a},L=function(a,b,c){var d=M(a,b,c);d===g?delete a[b]:a[b]=d},M=function(a,b,c){var d,e=a[b];if("object"==typeof e&&e)if(h.call(e)==q)for(d=e.length;d--;)L(e,d,c);else f(e,function(a){L(e,a,c)});return c.call(a,b,e)};k.parse=function(a,b){var c,d;return E=0,F=""+a,c=K(J()),"$"!=J()&&I(),E=F=null,b&&h.call(b)==m?M((d={},d[""]=c,d),"",b):c}}}i&&a(function(){return k})}(this)},{}],50:[function(a,b,c){function d(a,b){var c=[];b=b||0;for(var d=b||0;d<a.length;d++)c[d-b]=a[d];return c}b.exports=d},{}]},{},[1])(1)}),b.Slip=function(){"use strict";function a(c,d){if("string"==typeof c&&(c=document.querySelector(c)),!c||!c.addEventListener)throw new Error("Please specify DOM node to attach to");return this&&this!==b?(this.options=d,this.cancel=this.setState.bind(this,this.states.idle),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onSelection=this.onSelection.bind(this),this.setState(this.states.idle),void this.attach(c)):new a(c,d)}function c(a){var c=a.style[i];if(c)return{value:c,original:c};if(b.getComputedStyle){var d=b.getComputedStyle(a).getPropertyValue(j);if(d&&"none"!==d)return{value:d,original:""}}return{value:"",original:""}}var d=/Chrome\/[34]/.test(navigator.userAgent),e=d,f=d,g=document.createElement("div"),h="webkitTransition"in g.style?"webkitTransition":"transition",i="webkitTransform"in g.style?"webkitTransform":"transform",j="webkitTransform"===i?"-webkit-transform":"transform",k="webkitUserSelect"in g.style?"webkitUserSelect":"userSelect";g.style[i]="translateZ(0)";var l=g.style[i]?"translateZ(0) ":"",m=g.style[i]?"translateZ(1px) ":"";g=null;var n=0,o=!1,p=function(){};return a.prototype={container:null,options:{},state:null,target:null,usingTouch:!1,mouseHandlersAttached:!1,startPosition:null,latestPosition:null,previousPosition:null,canPreventScrolling:!1,states:{idle:function(){return this.target=null,this.usingTouch=!1,this.removeMouseHandlers(),{allowTextSelection:!0}},undecided:function(){if(this.target.height=this.target.node.offsetHeight,this.target.node.style[h]="",this.dispatch(this.target.originalTarget,"beforewait"))var a=setTimeout(function(){var a=this.getAbsoluteMovement();this.canPreventScrolling&&a.x<15&&a.y<25&&this.dispatch(this.target.originalTarget,"beforereorder")&&this.setState(this.states.reorder)}.bind(this),300);else this.dispatch(this.target.originalTarget,"beforereorder")&&this.setState(this.states.reorder);return{leaveState:function(){clearTimeout(a)},onMove:function(){var a=this.getAbsoluteMovement();if(a.x>20&&a.y<Math.max(100,this.target.height)){if(this.dispatch(this.target.originalTarget,"beforeswipe"))return this.setState(this.states.swipe),!1;this.setState(this.states.idle)}if(a.y>20&&this.setState(this.states.idle),a.x>1.2*a.y)return!1},onLeave:function(){this.setState(this.states.idle)},onEnd:function(){var a=this.dispatch(this.target.originalTarget,"tap");return this.setState(this.states.idle),a}}},swipe:function(){function a(){c.className=c.className.replace(/(?:^| )slip-swiping-container/,"")}var b=!1,c=this.container;return c.className+=" slip-swiping-container",this.target.height=this.target.node.offsetHeight,{leaveState:function(){b?this.animateSwipe(function(b){return b.node.style[i]=b.baseTransform.original,b.node.style[h]="",this.dispatch(b.node,"afterswipe")?(a(),!0):void this.animateToZero(void 0,b)}.bind(this)):(this.animateToZero(a),this.dispatch(this.target.node,"cancelswipe"))},onMove:function(){var a=this.getTotalMovement();return Math.abs(a.y)<this.target.height+20?(this.target.node.style[i]="translate("+a.x+"px,0) "+l+this.target.baseTransform.value,!1):void this.setState(this.states.idle)},onLeave:function(){this.state.onEnd.call(this)},onEnd:function(){var a,c=this.latestPosition.x-this.previousPosition.x,d=this.latestPosition.y-this.previousPosition.y,e=Math.sqrt(c*c+d*d)/(this.latestPosition.time-this.previousPosition.time+1),f=this.getAbsoluteMovement(),g=e>.6&&f.time>110;return a=c>0?"right":"left",g&&this.dispatch(this.target.node,"swipe",{direction:a})&&(b=!0),this.setState(this.states.idle),!g}}},reorder:function(){function a(){b&&(clearTimeout(b),b=null);var a=this.getTotalMovement();this.target.node.style[i]="translate(0,"+a.y+"px) "+m+this.target.baseTransform.value;var c=this.target.height;return n.forEach(function(b){var d=0;b.pos<0&&a.y<0&&b.pos>a.y?d=c:b.pos>0&&a.y>0&&b.pos<a.y&&(d=-c),b.node.style[i]=d?"translate(0,"+d+"px) "+l+b.baseTransform.value:b.baseTransform.original}),!1}this.target.height=this.target.node.offsetHeight;for(var b,d=0,e=0,g=this.target.node.offsetTop+this.target.height/2,n=[],o=this.container.childNodes,p=0;p<o.length;p++)if(1===o[p].nodeType&&(e++,o[p]===this.target.node&&(d=e-1)),1==o[p].nodeType&&o[p]!==this.target.node){var q=o[p].offsetTop;o[p].style[h]=j+" 0.2s ease-in-out",n.push({node:o[p],baseTransform:c(o[p]),pos:q+(q<g?o[p].offsetHeight:0)-g})}return this.target.node.className+=" slip-reordering",this.target.node.style.zIndex="99999",this.target.node.style[k]="none",f&&(this.container.style.webkitTransformStyle="preserve-3d"),a.call(this),{leaveState:function(){b&&clearTimeout(b),f&&(this.container.style.webkitTransformStyle=""),this.target.node.className=this.target.node.className.replace(/(?:^| )slip-reordering/,""),this.target.node.style[k]="",this.animateToZero(function(a){a.node.style.zIndex=""}),n.forEach(function(a){a.node.style[i]=a.baseTransform.original,a.node.style[h]=""})},onMove:a,onLeave:function(){b&&clearTimeout(b),b=setTimeout(function(){b=null,this.cancel()}.bind(this),700)},onEnd:function(){var a=this.getTotalMovement();if(a.y<0){for(var b=0;b<n.length;b++)if(n[b].pos>a.y){this.dispatch(this.target.node,"reorder",{spliceIndex:b,insertBefore:n[b].node,originalIndex:d});break}}else for(var b=n.length-1;b>=0;b--)if(n[b].pos<a.y){var c=b+1;c!==d&&this.dispatch(this.target.node,"reorder",{spliceIndex:b+1,insertBefore:n[b+1]?n[b+1].node:null,originalIndex:d});break}return this.setState(this.states.idle),!1}}}},attach:function(a){n++,this.container&&this.detach(),!o&&e&&(o=!0,document.body.addEventListener("touchstart",p,!1)),this.container=a,this.otherNodes=[],document.addEventListener("selectionchange",this.onSelection,!1),this.container.addEventListener("touchcancel",this.cancel,!1),this.container.addEventListener("touchstart",this.onTouchStart,!1),this.container.addEventListener("touchmove",this.onTouchMove,!1),this.container.addEventListener("touchend",this.onTouchEnd,!1),this.container.addEventListener("mousedown",this.onMouseDown,!1)},detach:function(){this.cancel(),this.container.removeEventListener("mousedown",this.onMouseDown,!1),this.container.removeEventListener("touchend",this.onTouchEnd,!1),this.container.removeEventListener("touchmove",this.onTouchMove,!1),this.container.removeEventListener("touchstart",this.onTouchStart,!1),this.container.removeEventListener("touchcancel",this.cancel,!1),document.removeEventListener("selectionchange",this.onSelection,!1),n--,!n&&o&&(o=!1,document.body.removeEventListener("touchstart",p,!1))},setState:function(a){if(this.state){if(this.state.ctor===a)return;this.state.leaveState&&this.state.leaveState.call(this)}var b=this.state,c=a.call(this);this.state===b&&(c.ctor=a,this.state=c)},findTargetNode:function(a){for(;a&&a.parentNode!==this.container;)a=a.parentNode;return a},onSelection:function(a){var b=a.target===document||this.findTargetNode(a);b&&(a.cancelable||a.defaultPrevented?this.state.allowTextSelection||a.preventDefault():this.setState(this.states.idle))},addMouseHandlers:function(){this.mouseHandlersAttached||(this.mouseHandlersAttached=!0,document.documentElement.addEventListener("mouseleave",this.onMouseLeave,!1),b.addEventListener("mousemove",this.onMouseMove,!0),b.addEventListener("mouseup",this.onMouseUp,!0),b.addEventListener("blur",this.cancel,!1))},removeMouseHandlers:function(){this.mouseHandlersAttached&&(this.mouseHandlersAttached=!1,document.documentElement.removeEventListener("mouseleave",this.onMouseLeave,!1),b.removeEventListener("mousemove",this.onMouseMove,!0),b.removeEventListener("mouseup",this.onMouseUp,!0),b.removeEventListener("blur",this.cancel,!1))},onMouseLeave:function(a){this.usingTouch||a.target!==document.documentElement&&a.relatedTarget!==document.documentElement||this.state.onLeave&&this.state.onLeave.call(this)},onMouseDown:function(a){!this.usingTouch&&0==a.button&&this.setTarget(a)&&(this.addMouseHandlers(),this.canPreventScrolling=!0,this.startAtPosition({x:a.clientX,y:a.clientY,time:a.timeStamp}))},onTouchStart:function(a){return this.usingTouch=!0,this.canPreventScrolling=!0,a.touches.length>1?void this.setState(this.states.idle):void(this.setTarget(a)&&this.startAtPosition({x:a.touches[0].clientX,y:a.touches[0].clientY-b.scrollY,time:a.timeStamp}))},setTarget:function(a){var d=this.findTargetNode(a.target);if(!d)return this.setState(this.states.idle),!1;for(var e=d.parentNode;e&&!(e.scrollHeight>e.clientHeight&&"visible"!=b.getComputedStyle(e)["overflow-y"]);)e=e.parentNode;return this.target={originalTarget:a.target,node:d,scrollContainer:e,baseTransform:c(d)},!0},startAtPosition:function(a){this.startPosition=this.previousPosition=this.latestPosition=a,this.setState(this.states.undecided)},updatePosition:function(a,c){this.latestPosition=c;var d=40,e=0,f=this.target.scrollContainer||document.body,g=f.getBoundingClientRect(),h=this.target.node.getBoundingClientRect(),i=Math.min(g.bottom,b.innerHeight)-h.bottom,j=h.top-Math.max(g.top,0);i<d?e=d-i:j<d&&(e=j-d);var k=f.scrollTop;f.scrollTop+=e,k!=f.scrollTop&&(this.startPosition.y+=k-f.scrollTop),this.state.onMove&&this.state.onMove.call(this)===!1&&a.preventDefault(),this.latestPosition.time-this.previousPosition.time>100&&(this.previousPosition=this.latestPosition)},onMouseMove:function(a){this.updatePosition(a,{x:a.clientX,y:a.clientY,time:a.timeStamp})},onTouchMove:function(a){this.updatePosition(a,{x:a.touches[0].clientX,y:a.touches[0].clientY-b.scrollY,time:a.timeStamp}),this.canPreventScrolling=!1},onMouseUp:function(a){this.usingTouch||0!==a.button||this.state.onEnd&&!1===this.state.onEnd.call(this)&&a.preventDefault()},onTouchEnd:function(a){a.touches.length>1?this.cancel():this.state.onEnd&&!1===this.state.onEnd.call(this)&&a.preventDefault()},getTotalMovement:function(){return{x:this.latestPosition.x-this.startPosition.x,y:this.latestPosition.y-this.startPosition.y}},getAbsoluteMovement:function(){return{x:Math.abs(this.latestPosition.x-this.startPosition.x),y:Math.abs(this.latestPosition.y-this.startPosition.y),time:this.latestPosition.time-this.startPosition.time}},dispatch:function(a,b,c){var d=document.createEvent("CustomEvent");return d&&d.initCustomEvent?d.initCustomEvent("slip:"+b,!0,!0,c):(d=document.createEvent("Event"),d.initEvent("slip:"+b,!0,!0),d.detail=c),a.dispatchEvent(d)},getSiblings:function(a){for(var b=[],d=a.node.nextSibling;d;)1==d.nodeType&&b.push({node:d,baseTransform:c(d)}),d=d.nextSibling;return b},animateToZero:function(a,b){b=b||this.target,b.node.style[h]=j+" 0.1s ease-out",b.node.style[i]="translate(0,0) "+l+b.baseTransform.value,setTimeout(function(){b.node.style[h]="",b.node.style[i]=b.baseTransform.original,a&&a.call(this,b)}.bind(this),101)},animateSwipe:function(a){var b=this.target,c=this.getSiblings(b),d="translate(0,"+this.target.height+"px) "+l+" ";b.node.style[h]="all 0.1s linear",b.node.style[i]=" translate("+(this.getTotalMovement().x>0?"":"-")+"100%,0) "+l+b.baseTransform.value,setTimeout(function(){a.call(this,b)&&(c.forEach(function(a){a.node.style[h]="",a.node.style[i]=d+a.baseTransform.value}),setTimeout(function(){c.forEach(function(a){a.node.style[h]=j+" 0.1s ease-in-out",a.node.style[i]="translate(0,0) "+l+a.baseTransform.value}),setTimeout(function(){c.forEach(function(a){a.node.style[h]="",a.node.style[i]=a.baseTransform.original})},101)},1))}.bind(this),101)}},"function"==typeof define&&define.amd&&define(function(){return a}),a}(),function(){"use strict";function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&b(e[d],c)===-1&&(e[d].push(f?c:{listener:c,once:!1}),this.emit("listenerAdded",a,c.listener||c,c.once||!1));return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)if(f.hasOwnProperty(e)&&(d=b(f[e],c),d!==-1))var c=f[e].splice(d,1);return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof module&&module.exports?module.exports=a:e.EventEmitter=a}.call(this),function(){function a(){var a=b.navigator.userAgent.match(/Chrome\/([0-9]+)/);return a?parseInt(a[1],10):0}var c=0,d=b.chrome||{};d.cast=d.cast||{},d.cast.media=d.cast.media||{},d.cast.ApiBootstrap_=function(){},d.cast.ApiBootstrap_.CAST_EXTENSION_IDS_="boadgeojelhgndaghljhdicfkmllpafd dliochdbjfkdbacpmhlcpmleaejidimm enhhojjnijigcajfphajepfemndkmdlo fmfcbgogabcbclcofgocippekhfcmgfj".split(" "),d.cast.ApiBootstrap_.MR_EXTENSION_IDS_=["pkedcjkdefgpdelpbcmbmeomcjbeemfm","fjhoaacokmgbjemoflkofnenfaiekifl"],a()>=50?d.cast.ApiBootstrap_.EXTENSION_IDS=d.cast.ApiBootstrap_.MR_EXTENSION_IDS_.concat(d.cast.ApiBootstrap_.CAST_EXTENSION_IDS_):d.cast.ApiBootstrap_.EXTENSION_IDS=d.cast.ApiBootstrap_.CAST_EXTENSION_IDS_.concat(d.cast.ApiBootstrap_.MR_EXTENSION_IDS_),d.cast.ApiBootstrap_.findInstalledExtension_=function(a){d.cast.ApiBootstrap_.findInstalledExtensionHelper_(0,a)},d.cast.ApiBootstrap_.findInstalledExtensionHelper_=function(a,b){a==d.cast.ApiBootstrap_.EXTENSION_IDS.length?b(null):d.cast.ApiBootstrap_.isExtensionInstalled_(d.cast.ApiBootstrap_.EXTENSION_IDS[a],function(c){c?b(d.cast.ApiBootstrap_.EXTENSION_IDS[a]):d.cast.ApiBootstrap_.findInstalledExtensionHelper_(a+1,b)})},d.cast.ApiBootstrap_.getCastSenderUrl_=function(a){return"chrome-extension://"+a+"/cast_sender.js"},d.cast.ApiBootstrap_.isExtensionInstalled_=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status&&b&&b(!0)},c.onerror=function(){b&&b(!1)},c.open("GET",d.cast.ApiBootstrap_.getCastSenderUrl_(a),!0),c.send()},d.storage.castDevExtensionId&&d.cast.ApiBootstrap_.EXTENSION_IDS.splice(1,0,d.storage.castDevExtensionId),d.cast.ApiBootstrap_.findAndAttachInstalledExtension_=function(a,b){d.cast.ApiBootstrap_.findInstalledExtension_(function(e){if(++c,e){console.log("Found cast extension: "+e),d.cast.extensionId=e;var f=document.createElement("script");f.src=d.cast.ApiBootstrap_.getCastSenderUrl_(e);var g=!1;b||(g=c>1),f.addEventListener("load",function(){g?setTimeout(function(){a&&a(!0)},1e4):a&&a(!0)}),(document.head||document.documentElement).appendChild(f)}else console.log("No cast extension found"),a&&a(null)})}}(),function(a){a.chrome.alarmsExtended={};var b=function(b,c){EventEmitter.call(this),this.name=b,this.realName=this.name+"-"+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)}),this.alarmInfo=c,a.chrome.alarms.create(this.realName,this.alarmInfo)};b.prototype=Object.create(EventEmitter.prototype),b.prototype.clear=function(){a.chrome.alarmsExtended.clear(this.realName)};var c={};a.chrome.alarms.onAlarm.addListener(function(a){c[a.name]&&(clearTimeout(c[a.name].otherTimeout),c[a.name].emit("alarm"))}),a.chrome.alarmsExtended.create=function(a,d,e){var f=new b(a,d);return c[f.realName]=f,e&&(f.otherTimeout=setTimeout(function(){f.clear(),f.emit("alarm")},e)),f},a.chrome.alarmsExtended.createWithCallback=function(b,c,d,e){var f=a.chrome.alarmsExtended.create(b,c,e);return f.on("alarm",d),f},a.chrome.alarmsExtended.setTimeout=function(b,c){var d=a.chrome.alarmsExtended.createWithCallback("timeout",{when:Date.now()+c},function(){b(),d.clear()},c);return d},a.chrome.alarmsExtended.clear=function(b){a.chrome.alarms.clear(b),c[b]&&(clearTimeout(c[b].otherTimeout),delete c[b])}}(b),function(){"use strict";var c,d=d||{},e=this,f=function(a){return void 0!==a},g=function(){},h=function(a){var b=typeof a;if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==b&&"undefined"==typeof a.call)return"object";return b},i=function(a){return"array"==h(a)},j=function(a){var b=h(a);return"array"==b||"object"==b&&"number"==typeof a.length},k=function(a){return"string"==typeof a},l=function(a){return"number"==typeof a},m=function(a){return"function"==h(a)},n=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b},o=function(a,b,c){return a.call.apply(a.bind,arguments)},p=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}},q=function(a,b,c){return q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:p,q.apply(null,arguments)},r=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();return b.push.apply(b,arguments),a.apply(this,b)}},s=Date.now||function(){return+new Date},t=function(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var g;c.length&&(g=c.shift());)!c.length&&f(b)?d[g]=b:d=d[g]?d[g]:d[g]={}},u=function(a,b){function c(){}c.prototype=b.prototype,a.P=b.prototype,a.prototype=new c,a.ie=function(a,c,d){for(var e=Array(arguments.length-2),f=2;f<arguments.length;f++)e[f-2]=arguments[f];return b.prototype[c].apply(a,e)}};Function.prototype.bind=Function.prototype.bind||function(a,b){if(1<arguments.length){var c=Array.prototype.slice.call(arguments,1);return c.unshift(this,a),q.apply(null,c)}return q(this,a)};var v=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,v);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))};u(v,Error),v.prototype.name="CustomError";var w=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},x=function(a,b){return a<b?-1:a>b?1:0},y=Array.prototype,z=y.indexOf?function(a,b,c){return y.indexOf.call(a,b,c)}:function(a,b,c){if(c=null==c?0:0>c?Math.max(0,a.length+c):c,k(a))return k(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},A=y.forEach?function(a,b,c){y.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=k(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},B=y.some?function(a,b,c){return y.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=k(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},C=y.every?function(a,b,c){return y.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=k(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0},D=function(a){var b;a:{b=Bd;for(var c=a.length,d=k(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:k(a)?a.charAt(b):a[b]},E=function(a,b){var c,d=z(a,b);return(c=0<=d)&&y.splice.call(a,d,1),c},F=function(a){return y.concat.apply(y,arguments)},G=function(a,b,c){return 2>=arguments.length?y.slice.call(a,b):y.slice.call(a,b,c)},H="StopIteration"in e?e.StopIteration:Error("StopIteration"),I=function(){};I.prototype.next=function(){throw H},I.prototype.Sb=function(){return this};var J=function(a,b,c){for(var d in a)b.call(c,a[d],d,a)},K=function(a){var b,c=[],d=0;for(b in a)c[d++]=a[b];return c},L=function(a){var b,c=[],d=0;for(b in a)c[d++]=b;return c},M=function(a,b){var c;a:{for(c in a)if(b.call(void 0,a[c],c,a))break a;c=void 0}return c&&a[c]},N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),O=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<N.length;f++)c=N[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}},P=function(a){var b=arguments.length;if(1==b&&i(arguments[0]))return P.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c},Q=function(a,b){this.p={},this.b=[],this.Ja=this.j=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.ha(a)};Q.prototype.t=function(){R(this);for(var a=[],b=0;b<this.b.length;b++)a.push(this.p[this.b[b]]);return a},Q.prototype.H=function(){return R(this),this.b.concat()},Q.prototype.T=function(a){return U(this.p,a)},Q.prototype.remove=function(a){return!!U(this.p,a)&&(delete this.p[a],this.j--,this.Ja++,this.b.length>2*this.j&&R(this),!0)};var R=function(a){if(a.j!=a.b.length){for(var b=0,c=0;b<a.b.length;){var d=a.b[b];U(a.p,d)&&(a.b[c++]=d),b++}a.b.length=c}if(a.j!=a.b.length){for(var e={},c=b=0;b<a.b.length;)d=a.b[b],U(e,d)||(a.b[c++]=d,e[d]=1),b++;a.b.length=c}};c=Q.prototype,c.get=function(a,b){return U(this.p,a)?this.p[a]:b},c.set=function(a,b){U(this.p,a)||(this.j++,this.b.push(a),this.Ja++),this.p[a]=b},c.ha=function(a){var b;a instanceof Q?(b=a.H(),a=a.t()):(b=L(a),a=K(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])},c.forEach=function(a,b){for(var c=this.H(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}},c.clone=function(){return new Q(this)},c.Nb=function(){R(this);for(var a={},b=0;b<this.b.length;b++){var c=this.b[b];a[c]=this.p[c]}return a},c.Sb=function(a){R(this);var b=0,c=this.b,d=this.p,e=this.Ja,f=this,g=new I;return g.next=function(){for(;;){if(e!=f.Ja)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw H;var g=c[b++];return a?g:d[g]}},g};var S,T,U=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},V={id:"hitType",name:"t",valueType:"text",maxLength:void 0,defaultValue:void 0},W={id:"sessionControl",name:"sc",valueType:"text",maxLength:void 0,defaultValue:void 0},X={id:"description",name:"cd",valueType:"text",maxLength:2048,defaultValue:void 0},Y={id:"eventCategory",name:"ec",valueType:"text",maxLength:150,defaultValue:void 0},Z={id:"eventAction",name:"ea",valueType:"text",maxLength:500,defaultValue:void 0},$={id:"eventLabel",name:"el",valueType:"text",maxLength:500,defaultValue:void 0},_={id:"eventValue",name:"ev",valueType:"integer",maxLength:void 0,defaultValue:void 0},aa={zd:V,$c:{id:"anonymizeIp",name:"aip",valueType:"boolean",maxLength:void 0,defaultValue:void 0},Kd:{id:"queueTime",name:"qt",valueType:"integer",maxLength:void 0,defaultValue:void 0},fd:{id:"cacheBuster",name:"z",valueType:"text",maxLength:void 0,defaultValue:void 0},Qd:W,Rd:{id:"sessionGroup",name:"sg",valueType:"text",maxLength:void 0,defaultValue:void 0},ge:{id:"userId",name:"uid",valueType:"text",maxLength:void 0,defaultValue:void 0},Hd:{id:"nonInteraction",name:"ni",valueType:"boolean",maxLength:void 0,defaultValue:void 0},qd:X,$d:{id:"title",name:"dt",valueType:"text",maxLength:1500,defaultValue:void 0},bd:{id:"appId",name:"aid",valueType:"text",maxLength:150,defaultValue:void 0},cd:{id:"appInstallerId",name:"aiid",valueType:"text",maxLength:150,defaultValue:void 0},td:Y,sd:Z,ud:$,vd:_,Td:{id:"socialNetwork",name:"sn",valueType:"text",maxLength:50,defaultValue:void 0},Sd:{id:"socialAction",name:"sa",valueType:"text",maxLength:50,defaultValue:void 0},Ud:{id:"socialTarget",name:"st",valueType:"text",maxLength:2048,defaultValue:void 0},ce:{id:"transactionId",name:"ti",valueType:"text",maxLength:500,defaultValue:void 0},be:{id:"transactionAffiliation",name:"ta",valueType:"text",maxLength:500,defaultValue:void 0},de:{id:"transactionRevenue",name:"tr",valueType:"currency",maxLength:void 0,defaultValue:void 0},ee:{id:"transactionShipping",name:"ts",valueType:"currency",maxLength:void 0,defaultValue:void 0},fe:{id:"transactionTax",name:"tt",valueType:"currency",maxLength:void 0,defaultValue:void 0},od:{id:"currencyCode",name:"cu",valueType:"text",maxLength:10,defaultValue:void 0},Dd:{id:"itemPrice",name:"ip",valueType:"currency",maxLength:void 0,defaultValue:void 0},Ed:{id:"itemQuantity",name:"iq",valueType:"integer",maxLength:void 0,defaultValue:void 0},Bd:{id:"itemCode",name:"ic",valueType:"text",maxLength:500,defaultValue:void 0},Cd:{id:"itemName",name:"in",valueType:"text",maxLength:500,defaultValue:void 0},Ad:{id:"itemCategory",name:"iv",valueType:"text",maxLength:500,defaultValue:void 0},md:{id:"campaignSource",name:"cs",valueType:"text",maxLength:100,defaultValue:void 0},kd:{id:"campaignMedium",name:"cm",valueType:"text",maxLength:50,defaultValue:void 0},ld:{id:"campaignName",name:"cn",valueType:"text",maxLength:100,defaultValue:void 0},jd:{id:"campaignKeyword",name:"ck",valueType:"text",maxLength:500,defaultValue:void 0},gd:{id:"campaignContent",name:"cc",valueType:"text",maxLength:500,defaultValue:void 0},hd:{id:"campaignId",name:"ci",valueType:"text",maxLength:100,defaultValue:void 0},yd:{id:"gclid",name:"gclid",valueType:"text",maxLength:void 0,defaultValue:void 0},pd:{id:"dclid",name:"dclid",valueType:"text",maxLength:void 0,defaultValue:void 0},Jd:{id:"pageLoadTime",name:"plt",valueType:"integer",maxLength:void 0,defaultValue:void 0},rd:{id:"dnsTime",name:"dns",valueType:"integer",maxLength:void 0,defaultValue:void 0},Vd:{id:"tcpConnectTime",name:"tcp",valueType:"integer",maxLength:void 0,defaultValue:void 0},Pd:{id:"serverResponseTime",name:"srt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Id:{id:"pageDownloadTime",name:"pdt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Ld:{id:"redirectResponseTime",name:"rrt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Wd:{id:"timingCategory",name:"utc",valueType:"text",maxLength:150,defaultValue:void 0},Zd:{id:"timingVar",name:"utv",valueType:"text",maxLength:500,defaultValue:void 0},Yd:{id:"timingValue",name:"utt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Xd:{id:"timingLabel",name:"utl",valueType:"text",maxLength:500,defaultValue:void 0},wd:{id:"exDescription",name:"exd",valueType:"text",maxLength:150,defaultValue:void 0},xd:{id:"exFatal",name:"exf",valueType:"boolean",maxLength:void 0,defaultValue:"1"}},ba=function(a){if(1>a||200<a)throw Error("Expected dimension index range 1-200, but was : "+a);return{id:"dimension"+a,name:"cd"+a,valueType:"text",maxLength:150,defaultValue:void 0}},ca=function(a){if(1>a||200<a)throw Error("Expected metric index range 1-200, but was : "+a);return{id:"metric"+a,name:"cm"+a,valueType:"integer",maxLength:void 0,defaultValue:void 0}},da=function(a){return 1>a?"0":3>a?"1-2":(a=Math.floor(Math.log(a-1)/Math.log(2)),Math.pow(2,a)+1+"-"+Math.pow(2,a+1))},ea=function(a,b){for(var c=0,d=a.length-1,e=0;c<=d;){var f=Math.floor((c+d)/2),e=a[f];if(b<=e){if(d=0==f?0:a[f-1],b>d)return(d+1).toString()+"-"+e.toString();d=f-1}else if(b>e){if(f>=a.length-1)return(a[a.length-1]+1).toString()+"+";c=f+1}}return"<= 0"},fa=function(){this.gb=[]},ga=function(){return new fa};c=fa.prototype,c.when=function(a){return this.gb.push(a),this},c.Rb=function(a){var b=arguments;return this.when(function(a){return 0<=z(b,a.ub())}),this},c.Yc=function(a,b){var c=G(arguments,1);return this.when(function(b){return b=b.V().get(a),0<=z(c,b)}),this},c.mb=function(a,b){if(n(this.e))throw Error("Filter has already been set.");return this.e=n(b)?q(a,b):a,this},c.ia=function(){if(0==this.gb.length)throw Error("Must specify at least one predicate using #when or a helper method.");if(!n(this.e))throw Error("Must specify a delegate filter using #applyFilter.");return q(function(a){C(this.gb,function(b){return b(a)})&&this.e(a)},this)};var ha=function(){this.lb=!1,this.zb="",this.Kb=!1,this.ya=null};ha.prototype.Wb=function(a){return this.lb=!0,this.zb=a||" - ",this},ha.prototype.Sc=function(){return this.Kb=!0,this},ha.prototype.Dc=function(){return ia(this,da)},ha.prototype.Ec=function(a){return ia(this,r(ea,a))};var ia=function(a,b){if(null!=a.ya)throw Error("LabelerBuilder: Only one labeling strategy may be used.");return a.ya=q(function(a){var c=a.V().get(_),d=a.V().get($);l(c)&&(c=b(c),null!=d&&this.lb&&(c=d+this.zb+c),a.V().set($,c))},a),a};ha.prototype.ia=function(){if(null==this.ya)throw Error("LabelerBuilder: a labeling strategy must be specified prior to calling build().");return ga().Rb("event").mb(q(function(a){this.ya(a),this.Kb&&a.V().remove(_)},this)).ia()};var ja=function(a,b){var c=Array.prototype.slice.call(arguments),d=c.shift();if("undefined"==typeof d)throw Error("[goog.string.format] Template required");return d.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(a,b,d,e,f,g,h,i){if("%"==g)return"%";var j=c.shift();if("undefined"==typeof j)throw Error("[goog.string.format] Not enough arguments");return arguments[0]=j,ka[g].apply(null,arguments)})},ka={s:function(a,b,c){return isNaN(c)||""==c||a.length>=c?a:a=-1<b.indexOf("-",0)?a+Array(c-a.length+1).join(" "):Array(c-a.length+1).join(" ")+a},f:function(a,b,c,d,e){d=a.toString(),isNaN(e)||""==e||(d=parseFloat(a).toFixed(e));var f;return f=0>a?"-":0<=b.indexOf("+")?"+":0<=b.indexOf(" ")?" ":"",0<=a&&(d=f+d),isNaN(c)||d.length>=c?d:(d=isNaN(e)?Math.abs(a).toString():Math.abs(a).toFixed(e),
a=c-d.length-f.length,d=0<=b.indexOf("-",0)?f+d+Array(a+1).join(" "):f+Array(a+1).join(0<=b.indexOf("0",0)?"0":" ")+d)},d:function(a,b,c,d,e,f,g,h){return ka.f(parseInt(a,10),b,c,d,0,f,g,h)}};ka.i=ka.d,ka.u=ka.d;var la=function(a){if("function"==typeof a.t)return a.t();if(k(a))return a.split("");if(j(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return K(a)},ma=function(a,b){if("function"==typeof a.forEach)a.forEach(b,void 0);else if(j(a)||k(a))A(a,b,void 0);else{var c;if("function"==typeof a.H)c=a.H();else if("function"!=typeof a.t)if(j(a)||k(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=L(a);else c=void 0;for(var d=la(a),e=d.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}},na=function(a){if(this.w=new Q,0<arguments.length%2)throw Error("Uneven number of arguments to ParameterMap constructor.");for(var b=arguments,c=0;c<b.length;c+=2)this.set(b[c],b[c+1])};na.prototype.set=function(a,b){if(null==b)throw Error("undefined-or-null value for key: "+a.name);this.w.set(a.name,{key:a,value:b})},na.prototype.remove=function(a){this.w.remove(a.name)},na.prototype.get=function(a){return a=this.w.get(a.name,null),null===a?null:a.value},na.prototype.ha=function(a){this.w.ha(a.w)};var oa=function(a,b){A(a.w.t(),function(a){b(a.key,a.value)})};na.prototype.Nb=function(){var a={};return oa(this,function(b,c){a[b.id]=c}),a},na.prototype.clone=function(){var a=new na;return a.w=this.w.clone(),a},na.prototype.toString=function(){var a={};return oa(this,function(b,c){a[b.id]=c}),JSON.stringify(a)};var pa=function(a){this.e=a};c=pa.prototype,c.Yb=function(a){var b=new pa(q(this.M,this));return b.I=Y,b.Q=a,b},c.action=function(a){var b=new pa(q(this.M,this));return b.I=Z,b.Q=a,b},c.label=function(a){var b=new pa(q(this.M,this));return b.I=$,b.Q=a,b},c.value=function(a){var b=new pa(q(this.M,this));return b.I=_,b.Q=a,b},c.fc=function(a){var b=new pa(q(this.M,this));return b.I=ba(a.index),b.Q=a.value,b},c.vc=function(a){var b=new pa(q(this.M,this));return b.I=ca(a.index),b.Q=a.value,b},c.send=function(a){var b=new na;return this.M(b),a.send("event",b)},c.M=function(a){null!=this.I&&null!=this.Q&&!a.w.T(this.I.name)&&a.set(this.I,this.Q),n(this.e)&&this.e(a)};var qa=new pa(g),ra=function(){this.aa=this.aa,this.Ca=this.Ca};ra.prototype.aa=!1,ra.prototype.ma=function(){this.aa||(this.aa=!0,this.o())},ra.prototype.o=function(){if(this.Ca)for(;this.Ca.length;)this.Ca.shift()()};var sa=function(a,b){this.type=a,this.currentTarget=this.target=b,this.defaultPrevented=this.X=!1,this.Hb=!0};sa.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Hb=!1};var ta=function(a){return ta[" "](a),a};ta[" "]=g;var ua;a:{var va=e.navigator;if(va){var wa=va.userAgent;if(wa){ua=wa;break a}}ua=""}var xa=function(){return-1!=ua.indexOf("Edge")||-1!=ua.indexOf("Trident")||-1!=ua.indexOf("MSIE")},ya=function(){return-1!=ua.indexOf("Edge")},za=-1!=ua.indexOf("Opera")||-1!=ua.indexOf("OPR"),Aa=xa(),Ba=!(-1==ua.indexOf("Gecko")||-1!=ua.toLowerCase().indexOf("webkit")&&!ya()||-1!=ua.indexOf("Trident")||-1!=ua.indexOf("MSIE")||ya()),Ca=-1!=ua.toLowerCase().indexOf("webkit")&&!ya(),Da=function(){var a=ua;return Ba?/rv\:([^\);]+)(\)|;)/.exec(a):Aa&&ya()?/Edge\/([\d\.]+)/.exec(a):Aa?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):Ca?/WebKit\/(\S+)/.exec(a):void 0},Ea=function(){var a=e.document;return a?a.documentMode:void 0},Fa=function(){if(za&&e.opera){var a=e.opera.version;return m(a)?a():a}var a="",b=Da();return b&&(a=b?b[1]:""),Aa&&!ya()&&(b=Ea(),b>parseFloat(a))?String(b):a}(),Ga={},Ha=function(a){var b;if(!(b=Ga[a])){b=0;for(var c=w(String(Fa)).split("."),d=w(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",i=/(\d*)(\D*)/g,j=/(\d*)(\D*)/g;do{var k=i.exec(g)||["","",""],l=j.exec(h)||["","",""];if(0==k[0].length&&0==l[0].length)break;b=x(0==k[1].length?0:parseInt(k[1],10),0==l[1].length?0:parseInt(l[1],10))||x(0==k[2].length,0==l[2].length)||x(k[2],l[2])}while(0==b)}b=Ga[a]=0<=b}return b},Ia=e.document,Ja=Ea(),Ka=!Ia||!Aa||!Ja&&ya()?void 0:Ja||("CSS1Compat"==Ia.compatMode?parseInt(Fa,10):5),La=!Aa||Aa&&(ya()||9<=Ka),Ma=Aa&&!Ha("9"),Na=!Ca||Ha("528"),Oa=Ba&&Ha("1.9b")||Aa&&Ha("8")||za&&Ha("9.5")||Ca&&Ha("528"),Pa=Ba&&!Ha("8")||Aa&&!Ha("9"),Qa=function(a,b){if(sa.call(this,a?a.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.charCode=this.keyCode=this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.sb=this.state=null,a){var c=this.type=a.type;this.target=a.target||a.srcElement,this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ba){var e;a:{try{ta(d.nodeName),e=!0;break a}catch(a){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d,this.offsetX=Ca||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=Ca||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0,this.button=a.button,this.keyCode=a.keyCode||0,this.charCode=a.charCode||("keypress"==c?a.keyCode:0),this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.state=a.state,this.sb=a,a.defaultPrevented&&this.preventDefault()}};u(Qa,sa),Qa.prototype.preventDefault=function(){Qa.P.preventDefault.call(this);var a=this.sb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Ma)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(a){}};var Ra="closure_listenable_"+(1e6*Math.random()|0),Sa=function(a){return!(!a||!a[Ra])},Ta=0,Ua=function(a,b,c,d,e){this.O=a,this.proxy=null,this.src=b,this.type=c,this.ka=!!d,this.sa=e,this.key=++Ta,this.removed=this.ja=!1},Va=function(a){a.removed=!0,a.O=null,a.proxy=null,a.src=null,a.sa=null},Wa=function(a){this.src=a,this.k={},this.fa=0};Wa.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.k[f],a||(a=this.k[f]=[],this.fa++);var g=Ya(a,b,d,e);return-1<g?(b=a[g],c||(b.ja=!1)):(b=new Ua(b,this.src,f,(!!d),e),b.ja=c,a.push(b)),b},Wa.prototype.remove=function(a,b,c,d){if(a=a.toString(),!(a in this.k))return!1;var e=this.k[a];return b=Ya(e,b,c,d),-1<b&&(Va(e[b]),y.splice.call(e,b,1),0==e.length&&(delete this.k[a],this.fa--),!0)};var Xa=function(a,b){var c=b.type;if(!(c in a.k))return!1;var d=E(a.k[c],b);return d&&(Va(b),0==a.k[c].length&&(delete a.k[c],a.fa--)),d};Wa.prototype.removeAll=function(a){a=a&&a.toString();var b,c=0;for(b in this.k)if(!a||b==a){for(var d=this.k[b],e=0;e<d.length;e++)++c,Va(d[e]);delete this.k[b],this.fa--}return c},Wa.prototype.ba=function(a,b,c,d){a=this.k[a.toString()];var e=-1;return a&&(e=Ya(a,b,c,d)),-1<e?a[e]:null};var Ya=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.O==b&&f.ka==!!c&&f.sa==d)return e}return-1},Za="closure_lm_"+(1e6*Math.random()|0),$a={},_a=0,ab=function(a,b,c,d,e){if(i(b)){for(var f=0;f<b.length;f++)ab(a,b[f],c,d,e);return null}return c=mb(c),Sa(a)?a.listen(b,c,d,e):bb(a,b,c,!1,d,e)},bb=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,h=kb(a);return h||(a[Za]=h=new Wa(a)),c=h.add(b,c,d,e,f),c.proxy?c:(d=cb(),c.proxy=d,d.src=a,d.O=c,a.addEventListener?a.addEventListener(b.toString(),d,g):a.attachEvent(gb(b.toString()),d),_a++,c)},cb=function(){var a=jb,b=La?function(c){return a.call(b.src,b.O,c)}:function(c){if(c=a.call(b.src,b.O,c),!c)return c};return b},db=function(a,b,c,d,e){if(i(b)){for(var f=0;f<b.length;f++)db(a,b[f],c,d,e);return null}return c=mb(c),Sa(a)?a.cb(b,c,d,e):bb(a,b,c,!0,d,e)},eb=function(a,b,c,d,e){if(i(b))for(var f=0;f<b.length;f++)eb(a,b[f],c,d,e);else c=mb(c),Sa(a)?a.jb(b,c,d,e):a&&(a=kb(a))&&(b=a.ba(b,c,!!d,e))&&fb(b)},fb=function(a){if(l(a)||!a||a.removed)return!1;var b=a.src;if(Sa(b))return Xa(b.B,a);var c=a.type,d=a.proxy;return b.removeEventListener?b.removeEventListener(c,d,a.ka):b.detachEvent&&b.detachEvent(gb(c),d),_a--,(c=kb(b))?(Xa(c,a),0==c.fa&&(c.src=null,b[Za]=null)):Va(a),!0},gb=function(a){return a in $a?$a[a]:$a[a]="on"+a},hb=function(a,b,c,d){var e=!0;if((a=kb(a))&&(b=a.k[b.toString()]))for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.ka==c&&!f.removed&&(f=ib(f,d),e=e&&!1!==f)}return e},ib=function(a,b){var c=a.O,d=a.sa||a.src;return a.ja&&fb(a),c.call(d,b)},jb=function(a,b){if(a.removed)return!0;if(!La){var c;if(!(c=b))a:{c=["window","event"];for(var d,f=e;d=c.shift();){if(null==f[d]){c=null;break a}f=f[d]}c=f}if(d=c,c=new Qa(d,this),f=!0,!(0>d.keyCode||void 0!=d.returnValue)){a:{var g=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(a){g=!0}(g||void 0==d.returnValue)&&(d.returnValue=!0)}for(d=[],g=c.currentTarget;g;g=g.parentNode)d.push(g);for(var g=a.type,h=d.length-1;!c.X&&0<=h;h--){c.currentTarget=d[h];var i=hb(d[h],g,!0,c),f=f&&i}for(h=0;!c.X&&h<d.length;h++)c.currentTarget=d[h],i=hb(d[h],g,!1,c),f=f&&i}return f}return ib(a,new Qa(b,this))},kb=function(a){return a=a[Za],a instanceof Wa?a:null},lb="__closure_events_fn_"+(1e9*Math.random()>>>0),mb=function(a){return m(a)?a:(a[lb]||(a[lb]=function(b){return a.handleEvent(b)}),a[lb])},nb=function(){ra.call(this),this.B=new Wa(this),this.Tb=this,this.fb=null};u(nb,ra),nb.prototype[Ra]=!0,c=nb.prototype,c.addEventListener=function(a,b,c,d){ab(this,a,b,c,d)},c.removeEventListener=function(a,b,c,d){eb(this,a,b,c,d)},c.dispatchEvent=function(a){var b,c=this.fb;if(c){b=[];for(var d=1;c;c=c.fb)b.push(c),++d}if(c=this.Tb,d=a.type||a,k(a))a=new sa(a,c);else if(a instanceof sa)a.target=a.target||c;else{var e=a;a=new sa(d,c),O(a,e)}var f,e=!0;if(b)for(var g=b.length-1;!a.X&&0<=g;g--)f=a.currentTarget=b[g],e=ob(f,d,!0,a)&&e;if(a.X||(f=a.currentTarget=c,e=ob(f,d,!0,a)&&e,a.X||(e=ob(f,d,!1,a)&&e)),b)for(g=0;!a.X&&g<b.length;g++)f=a.currentTarget=b[g],e=ob(f,d,!1,a)&&e;return e},c.o=function(){nb.P.o.call(this),this.B&&this.B.removeAll(void 0),this.fb=null},c.listen=function(a,b,c,d){return this.B.add(String(a),b,!1,c,d)},c.cb=function(a,b,c,d){return this.B.add(String(a),b,!0,c,d)},c.jb=function(a,b,c,d){return this.B.remove(String(a),b,c,d)};var ob=function(a,b,c,d){if(b=a.B.k[String(b)],!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.removed&&g.ka==c){var h=g.O,i=g.sa||g.src;g.ja&&Xa(a.B,g),e=!1!==h.call(i,d)&&e}}return e&&0!=d.Hb};nb.prototype.ba=function(a,b,c,d){return this.B.ba(String(a),b,c,d)};var pb=function(a,b,c){this.tc=c,this.dc=a,this.Gc=b,this.Ba=0,this.ta=null};pb.prototype.get=function(){var a;return 0<this.Ba?(this.Ba--,a=this.ta,this.ta=a.next,a.next=null):a=this.dc(),a},pb.prototype.put=function(a){this.Gc(a),this.Ba<this.tc&&(this.Ba++,a.next=this.ta,this.ta=a)};var qb,rb=function(a){e.setTimeout(function(){throw a},0)},sb=function(){var a=e.MessageChannel;if("undefined"==typeof a&&"undefined"!=typeof b&&b.postMessage&&b.addEventListener&&-1==ua.indexOf("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none",a.src="",document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open(),a.write(""),a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=q(function(a){"*"!=d&&a.origin!=d||a.data!=c||this.port1.onmessage()},this);b.addEventListener("message",a,!1),this.port1={},this.port2={postMessage:function(){b.postMessage(c,d)}}}),"undefined"!=typeof a&&!xa()){var c=new a,d={},g=d;return c.port1.onmessage=function(){if(f(d.next)){d=d.next;var a=d.ob;d.ob=null,a()}},function(a){g.next={ob:a},g=g.next,c.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null,b.parentNode.removeChild(b),b=null,a(),a=null},document.documentElement.appendChild(b)}:function(a){e.setTimeout(a,0)}},tb=function(){this.Ka=this.Z=null},ub=new pb(function(){return new vb},function(a){a.reset()},100);tb.prototype.add=function(a,b){var c=ub.get();c.set(a,b),this.Ka?this.Ka.next=c:this.Z=c,this.Ka=c},tb.prototype.remove=function(){var a=null;return this.Z&&(a=this.Z,this.Z=this.Z.next,this.Z||(this.Ka=null),a.next=null),a};var vb=function(){this.next=this.scope=this.Wa=null};vb.prototype.set=function(a,b){this.Wa=a,this.scope=b,this.next=null},vb.prototype.reset=function(){this.next=this.scope=this.Wa=null};var wb,xb=function(a,b){wb||yb(),zb||(wb(),zb=!0),Ab.add(a,b)},yb=function(){if(e.Promise&&e.Promise.resolve){var a=e.Promise.resolve();wb=function(){a.then(Bb)}}else wb=function(){var a=Bb;!m(e.setImmediate)||e.Window&&e.Window.prototype&&e.Window.prototype.setImmediate==e.setImmediate?(qb||(qb=sb()),qb(a)):e.setImmediate(a)}},zb=!1,Ab=new tb,Bb=function(){for(var a=null;a=Ab.remove();){try{a.Wa.call(a.scope)}catch(a){rb(a)}ub.put(a)}zb=!1},Cb=function(a){a.prototype.then=a.prototype.then,a.prototype.$goog_Thenable=!0},Db=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(a){return!1}},Eb=function(a,b){if(this.m=0,this.D=void 0,this.S=this.G=this.l=null,this.ra=this.Va=!1,a==Ib)Mb(this,2,b);else try{var c=this;a.call(b,function(a){Mb(c,2,a)},function(a){Mb(c,3,a)})}catch(a){Mb(this,3,a)}},Fb=function(){this.next=this.context=this.da=this.Da=this.L=null,this.Na=!1};Fb.prototype.reset=function(){this.context=this.da=this.Da=this.L=null,this.Na=!1};var Gb=new pb(function(){return new Fb},function(a){a.reset()},100),Hb=function(a,b,c){var d=Gb.get();return d.Da=a,d.da=b,d.context=c,d},Ib=function(){};Eb.prototype.then=function(a,b,c){return Lb(this,m(a)?a:null,m(b)?b:null,c)},Cb(Eb),Eb.prototype.cancel=function(a){0==this.m&&xb(function(){var b=new Tb(a);Jb(this,b)},this)};var Jb=function(a,b){if(0==a.m)if(a.l){var c=a.l;if(c.G){for(var d=0,e=null,f=null,g=c.G;g&&(g.Na||(d++,g.L==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==c.m&&1==d?Jb(c,b):(f?(d=f,d.next==c.S&&(c.S=d),d.next=d.next.next):Pb(c),Qb(c,e,3,b)))}a.l=null}else Mb(a,3,b)},Kb=function(a,b){a.G||2!=a.m&&3!=a.m||Ob(a),a.S?a.S.next=b:a.G=b,a.S=b},Lb=function(a,b,c,d){var e=Hb(null,null,null);return e.L=new Eb(function(a,g){e.Da=b?function(c){try{var e=b.call(d,c);a(e)}catch(a){g(a)}}:a,e.da=c?function(b){try{var e=c.call(d,b);!f(e)&&b instanceof Tb?g(b):a(e)}catch(a){g(a)}}:g}),e.L.l=a,Kb(a,e),e.L};Eb.prototype.Pb=function(a){this.m=0,Mb(this,2,a)},Eb.prototype.Qb=function(a){this.m=0,Mb(this,3,a)};var Mb=function(a,b,c){if(0==a.m){if(a==c)b=3,c=new TypeError("Promise cannot resolve to itself");else{if(Db(c)){a.m=1,b=c,c=a.Pb;var d=a.Qb;return void(b instanceof Eb?Kb(b,Hb(c||g,d||null,a)):b.then(c,d,a))}if(n(c))try{if(d=c.then,m(d))return void Nb(a,c,d)}catch(a){b=3,c=a}}a.D=c,a.m=b,a.l=null,Ob(a),3!=b||c instanceof Tb||Rb(a,c)}},Nb=function(a,b,c){a.m=1;var d=!1,e=function(b){d||(d=!0,a.Pb(b))},f=function(b){d||(d=!0,a.Qb(b))};try{c.call(b,e,f)}catch(a){f(a)}},Ob=function(a){a.Va||(a.Va=!0,xb(a.gc,a))},Pb=function(a){var b=null;return a.G&&(b=a.G,a.G=b.next,b.next=null),a.G||(a.S=null),b};Eb.prototype.gc=function(){for(var a=null;a=Pb(this);)Qb(this,a,this.m,this.D);this.Va=!1};var Qb=function(a,b,c,d){if(b.L&&(b.L.l=null),2==c)b.Da.call(b.context,d);else if(null!=b.da){if(!b.Na)for(;a&&a.ra;a=a.l)a.ra=!1;b.da.call(b.context,d)}Gb.put(b)},Rb=function(a,b){a.ra=!0,xb(function(){a.ra&&Sb.call(null,b)})},Sb=rb,Tb=function(a){v.call(this,a)};u(Tb,v),Tb.prototype.name="cancel";var Ub=function(a,b){this.Fa=[],this.Cb=a,this.rb=b||null,this.ca=this.C=!1,this.D=void 0,this.hb=this.Xb=this.Oa=!1,this.Ia=0,this.l=null,this.Qa=0};Ub.prototype.cancel=function(a){if(this.C)this.D instanceof Ub&&this.D.cancel();else{if(this.l){var b=this.l;delete this.l,a?b.cancel(a):(b.Qa--,0>=b.Qa&&b.cancel())}this.Cb?this.Cb.call(this.rb,this):this.hb=!0,this.C||this.A(new cc)}},Ub.prototype.qb=function(a,b){this.Oa=!1,Vb(this,a,b)};var Vb=function(a,b,c){a.C=!0,a.D=c,a.ca=!b,$b(a)},Wb=function(a){if(a.C){if(!a.hb)throw new bc;a.hb=!1}};Ub.prototype.v=function(a){Wb(this),Vb(this,!0,a)},Ub.prototype.A=function(a){Wb(this),Vb(this,!1,a)},Ub.prototype.n=function(a,b){return Xb(this,a,null,b)};var Xb=function(a,b,c,d){return a.Fa.push([b,c,d]),a.C&&$b(a),a};Ub.prototype.then=function(a,b,c){var d,e,f=new Eb(function(a,b){d=a,e=b});return Xb(this,d,function(a){a instanceof cc?f.cancel():e(a)}),f.then(a,b,c)},Cb(Ub);var Yb=function(a){var b=new Ub;return Xb(a,b.v,b.A,b),b},Zb=function(a){return B(a.Fa,function(a){return m(a[1])})},$b=function(a){if(a.Ia&&a.C&&Zb(a)){var b=a.Ia,c=ec[b];c&&(e.clearTimeout(c.ua),delete ec[b]),a.Ia=0}a.l&&(a.l.Qa--,delete a.l);for(var b=a.D,d=c=!1;a.Fa.length&&!a.Oa;){var g=a.Fa.shift(),h=g[0],i=g[1],g=g[2];if(h=a.ca?i:h)try{var j=h.call(g||a.rb,b);f(j)&&(a.ca=a.ca&&(j==b||j instanceof Error),a.D=b=j),Db(b)&&(d=!0,a.Oa=!0)}catch(d){b=d,a.ca=!0,Zb(a)||(c=!0)}}a.D=b,d&&(j=q(a.qb,a,!0),d=q(a.qb,a,!1),b instanceof Ub?(Xb(b,j,d),b.Xb=!0):b.then(j,d)),c&&(b=new dc(b),ec[b.ua]=b,a.Ia=b.ua)},_b=function(a){var b=new Ub;return b.v(a),b},ac=function(){var a=ed,b=new Ub;return b.A(a),b},bc=function(){v.call(this)};u(bc,v),bc.prototype.message="Deferred has already fired",bc.prototype.name="AlreadyCalledError";var cc=function(){v.call(this)};u(cc,v),cc.prototype.message="Deferred was canceled",cc.prototype.name="CanceledError";var dc=function(a){this.ua=e.setTimeout(q(this.Tc,this),0),this.na=a};dc.prototype.Tc=function(){throw delete ec[this.ua],this.na};var ec={},fc=function(a){this.qa=[],this.e=a};fc.prototype.R=function(a){if(!m(a))throw Error("Invalid filter. Must be a function.");this.qa.push(a)},fc.prototype.send=function(a,b){if(0==this.qa.length)return this.e.send(a,b);var c=new hc(a,b);return gc(this,0,c).n(function(){if(!c.Sa)return this.e.send(a,b)},this)};var gc=function(a,b,c){return _b().n(function(){return this.qa[b](c)},a).n(function(){if(++b<this.qa.length&&!c.Sa)return gc(this,b,c)},a)},hc=function(a,b){this.Wc=a,this.Cc=b,this.Sa=!1};hc.prototype.ub=function(){return this.Wc},hc.prototype.V=function(){return this.Cc},hc.prototype.cancel=function(){this.Sa=!0},P("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));var ic=function(a,b){this.width=a,this.height=b};ic.prototype.clone=function(){return new ic(this.width,this.height)},ic.prototype.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},!Ba&&!Aa||Aa&&Aa&&(ya()||9<=Ka)||Ba&&Ha("1.9.1"),Aa&&Ha("9");var jc={id:"apiVersion",name:"v",valueType:"text",maxLength:void 0,defaultValue:void 0},kc={id:"appName",name:"an",valueType:"text",maxLength:100,defaultValue:void 0},lc={id:"appVersion",name:"av",valueType:"text",maxLength:100,defaultValue:void 0},mc={id:"clientId",name:"cid",valueType:"text",maxLength:void 0,defaultValue:void 0},nc={id:"language",name:"ul",valueType:"text",maxLength:20,defaultValue:void 0},oc={id:"libVersion",name:"_v",valueType:"text",maxLength:void 0,defaultValue:void 0},pc={id:"sampleRateOverride",name:"usro",valueType:"integer",maxLength:void 0,defaultValue:void 0},qc={id:"screenColors",name:"sd",valueType:"text",maxLength:20,defaultValue:void 0},rc={id:"screenResolution",name:"sr",valueType:"text",maxLength:20,defaultValue:void 0},sc={id:"trackingId",name:"tid",valueType:"text",maxLength:void 0,defaultValue:void 0},tc={id:"viewportSize",name:"vp",valueType:"text",maxLength:20,defaultValue:void 0},uc={ad:jc,dd:kc,ed:lc,nd:mc,Fd:nc,Gd:oc,Md:pc,Nd:qc,Od:rc,ae:sc,he:tc},vc=function(a){if(!k(a))return a;var b=wc(a,aa);if(n(b))return b;if(b=wc(a,uc),n(b))return b;if(b=/^dimension(\d+)$/.exec(a),null!==b)return ba(parseInt(b[1],10));if(b=/^metric(\d+)$/.exec(a),null!==b)return ca(parseInt(b[1],10));throw Error(a+" is not a valid parameter name.")},wc=function(a,b){var c=M(b,function(b){return b.id==a&&"metric"!=a&&"dimension"!=a});return n(c)?c:null},xc=function(a,b){this.ac=b,this.q=b.Xa(),this.Fb=new na,this.ib=!1};c=xc.prototype,c.set=function(a,b){if(null==b)throw Error("Value must be defined and not null. Parameter="+a.id);var c=vc(a);this.Fb.set(c,b)},c.R=function(a){this.ac.R(a)},c.send=function(a,b){if(a instanceof pa)return a.send(this);var c=this.Fb.clone();return b instanceof na?c.ha(b):n(b)&&J(b,function(a,b){null!=a&&c.set(vc(b),a)},this),this.ib&&(this.ib=!1,c.set(W,"start")),this.q.send(a,c)},c.Hc=function(a){var b={description:a};return this.set(X,a),this.send("appview",b)},c.Ic=function(a,b,c,d){return this.send("event",{eventCategory:a,eventAction:b,eventLabel:c,eventValue:d})},c.Kc=function(a,b,c){return this.send("social",{socialNetwork:a,socialAction:b,socialTarget:c})},c.Jc=function(a,b){return this.send("exception",{exDescription:a,exFatal:b})},c.Ib=function(a,b,c,d,e){return this.send("timing",{timingCategory:a,timingVar:b,timingLabel:d,timingValue:c,sampleRateOverride:e})},c.jc=function(){this.ib=!0},c.Rc=function(a,b,c,d){return new yc(this,a,b,c,d)};var yc=function(a,b,c,d,e){this.Ob=a,this.Zb=b,this.Xc=c,this.rc=d,this.Ea=e,this.Qc=s()};yc.prototype.send=function(){var a=this.Ob.Ib(this.Zb,this.Xc,s()-this.Qc,this.rc,this.Ea);return this.Ob=null,a};var zc=function(a,b,c,d,e){this.sc=a,this.Ub=b,this.Vb=c,this.g=d,this.$b=e};zc.prototype.mc=function(a){var c=new xc(0,this.$b.create());return c.set(oc,this.sc),c.set(jc,1),c.set(kc,this.Ub),c.set(lc,this.Vb),c.set(sc,a),(a=navigator.language||navigator.browserLanguage)&&c.set(nc,a),(a=screen.colorDepth+"-bit")&&c.set(qc,a),(a=[screen.width,screen.height].join("x"))&&c.set(rc,a),a=b.document,a="CSS1Compat"==a.compatMode?a.documentElement:a.body,a=new ic(a.clientWidth,a.clientHeight),(a=[a.width,a.height].join("x"))&&c.set(tc,a),c},zc.prototype.kc=function(){return Yb(this.g.ea)};var Ac=function(a,b,c,d,e,f){for(Ub.call(this,e,f),this.bb=a,this.Ta=[],this.tb=!!b,this.ic=!!c,this.cc=!!d,b=this.Bb=0;b<a.length;b++)Xb(a[b],q(this.vb,this,b,!0),q(this.vb,this,b,!1));0!=a.length||this.tb||this.v(this.Ta)};u(Ac,Ub),Ac.prototype.vb=function(a,b,c){return this.Bb++,this.Ta[a]=[b,c],this.C||(this.tb&&b?this.v([a,c]):this.ic&&!b?this.A(c):this.Bb==this.bb.length&&this.v(this.Ta)),this.cc&&!b&&(c=null),c},Ac.prototype.A=function(a){for(Ac.P.A.call(this,a),a=0;a<this.bb.length;a++)this.bb[a].cancel()};var Bc=function(a){return new Ac(a,(!1),(!0)).n(function(a){for(var b=[],c=0;c<a.length;c++)b[c]=a[c][1];return b})},Cc=function(){for(var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split(""),b=0,c=a.length;b<c;b++)switch(a[b]){case"x":a[b]=Math.floor(16*Math.random()).toString(16);break;case"y":a[b]=(Math.floor(4*Math.random())+8).toString(16)}return a.join("")},Dc=function(a){this.J=a,this.Ea=100,this.pb=[],this.W=this.ga=null,this.ea=Ec(this),this.ea.n(function(){this.Jb=ab(this.J,"a",q(this.nc,this))},this)},Ec=function(a){return Fc(a).n(function(){return this},a)},Fc=function(a){return Bc([Hc(a),Jc(a)])};Dc.prototype.nc=function(){Nc(this);var a=Ic(this),b=this.xa();Fc(this).n(function(){a!=Ic(this)&&Mc(this,"analytics.user-id"),b!=this.xa()&&Mc(this,"analytics.tracking-permitted")},this)};var Gc=function(a,b){Nc(a),a.pb.push(b)};Dc.prototype.Oc=function(a){Nc(this);var b=this.W!=a;this.W=a,this.J.set("analytics.tracking-permitted",a.toString()),b&&Mc(this,"analytics.tracking-permitted")},Dc.prototype.xa=function(){Nc(this);var a;return(a=this.W)&&(a=e._gaUserPrefs,a=!(a&&a.ioo&&a.ioo())),a};var Hc=function(a){return a.J.get("analytics.tracking-permitted").n(function(a){if(this.W=!0,f(a))switch(a){case"true":this.W=!0;break;case"false":this.W=!1}},a)},Ic=function(a){if(Nc(a),!k(a.ga))throw Error("Invalid state. UserID is not a string.");return a.ga},Jc=function(a){return a.J.get("analytics.user-id").n(function(a){f(a)?this.ga=a:Kc(this)},a)},Kc=function(a){return a.ga=Cc(),a.J.set("analytics.user-id",a.ga).n(function(){Mc(this,"analytics.user-id")},a)};Dc.prototype.Nc=function(a){Nc(this),this.Ea=a};var Lc=function(a){return Nc(a),a.Ea};Dc.prototype.Fc=function(){return Kc(this)};var Mc=function(a,b){A(a.pb,function(a){a(b)})};Dc.prototype.ma=function(){null!=this.Jb&&fb(this.Jb)};var Nc=function(a){if(!Yb(a.ea).C)throw Error("Settings object accessed prior to entering ready state.")},Oc=function(){nb.call(this),this.eb="google-analytics",this.J=a.storage.local,a.storage.onChanged.addListener(q(this.Ac,this))};u(Oc,nb),Oc.prototype.Ac=function(a){Pc(this,a)&&this.dispatchEvent("a")};var Pc=function(a,b){return B(L(b),function(a){return 0==a.lastIndexOf(this.eb,0)},a)};Oc.prototype.get=function(b){var c=new Ub,d=this.eb+"."+b;return this.J.get(d,function(b){a.runtime.lastError?c.A(a.runtime.lastError):(b=b[d],c.v(null!=b?b.toString():void 0))}),c},Oc.prototype.set=function(b,c){var d=new Ub,e={};return e[this.eb+"."+b]=c,this.J.set(e,function(){a.runtime.lastError?d.A(a.runtime.lastError):d.v()}),d};var Qc=function(){};Qc.lc=function(){return Qc.yb?Qc.yb:Qc.yb=new Qc},Qc.prototype.send=function(){return _b()};var Rc=function(a){this.ec=a};Rc.prototype.send=function(a,b){return this.ec.push({pc:a,Bc:b}),_b()};var Sc=function(a,b,c){this.g=a,this.U=[],this.K={enabled:new Rc(this.U),disabled:c},this.q=this.K.enabled,Xb(Yb(this.g.ea),r(this.zc,b),this.yc,this)};Sc.prototype.zc=function(a){if(null===this.U)throw Error("Channel setup already completed.");this.K.enabled=a(),Tc(this),A(this.U,function(a){this.send(a.pc,a.Bc)},this),this.U=null,Gc(this.g,q(this.xc,this))},Sc.prototype.yc=function(){if(null===this.U)throw Error("Channel setup already completed.");this.q=this.K.enabled=this.K.disabled,this.U=null},Sc.prototype.send=function(a,b){return this.q.send(a,b)};var Tc=function(a){a.q=a.g.xa()?a.K.enabled:a.K.disabled};Sc.prototype.xc=function(a){switch(a){case"analytics.tracking-permitted":Tc(this)}};var Uc=function(a,b){this.Ra=[];var c=q(function(){return this.pa=new fc(b.Xa()),A(this.Ra,function(a){this.pa.R(a)},this),this.Ra=null,this.pa},this);this.q=new Sc(a,c,Qc.lc())};Uc.prototype.Xa=function(){return this.q},Uc.prototype.R=function(a){this.pa?this.pa.R(a):this.Ra.push(a)};var Vc=function(a,b){this.g=a,this.Pc=b};Vc.prototype.create=function(){return new Uc(this.g,this.Pc)};var Wc=function(a,b){nb.call(this),this.wa=a||1,this.Y=b||e,this.Pa=q(this.Uc,this),this.ab=s()};u(Wc,nb),c=Wc.prototype,c.enabled=!1,c.h=null,c.Uc=function(){if(this.enabled){var a=s()-this.ab;0<a&&a<.8*this.wa?this.h=this.Y.setTimeout(this.Pa,this.wa-a):(this.h&&(this.Y.clearTimeout(this.h),this.h=null),this.dispatchEvent("tick"),this.enabled&&(this.h=this.Y.setTimeout(this.Pa,this.wa),this.ab=s()))}},c.start=function(){this.enabled=!0,this.h||(this.h=this.Y.setTimeout(this.Pa,this.wa),this.ab=s())},c.stop=function(){this.enabled=!1,this.h&&(this.Y.clearTimeout(this.h),this.h=null)},c.o=function(){Wc.P.o.call(this),this.stop(),delete this.Y};var Xc=function(a,b,c){if(m(a))c&&(a=q(a,c));else{if(!a||"function"!=typeof a.handleEvent)throw Error("Invalid listener argument");a=q(a.handleEvent,a)}return 2147483647<b?-1:e.setTimeout(a,b||0)},Yc=function(a){ra.call(this),this.Ya=a,this.b={}};u(Yc,ra);var Zc=[];Yc.prototype.listen=function(a,b,c,d){i(b)||(b&&(Zc[0]=b.toString()),b=Zc);for(var e=0;e<b.length;e++){var f=ab(a,b[e],c||this.handleEvent,d||!1,this.Ya||this);if(!f)break;this.b[f.key]=f}return this},Yc.prototype.cb=function(a,b,c,d){return $c(this,a,b,c,d)};var $c=function(a,b,c,d,e,f){if(i(c))for(var g=0;g<c.length;g++)$c(a,b,c[g],d,e,f);else{if(b=db(b,c,d||a.handleEvent,e,f||a.Ya||a),!b)return a;a.b[b.key]=b}return a};Yc.prototype.jb=function(a,b,c,d,e){if(i(b))for(var f=0;f<b.length;f++)this.jb(a,b[f],c,d,e);else c=c||this.handleEvent,e=e||this.Ya||this,c=mb(c),d=!!d,b=Sa(a)?a.ba(b,c,d,e):a&&(a=kb(a))?a.ba(b,c,d,e):null,b&&(fb(b),delete this.b[b.key]);return this},Yc.prototype.removeAll=function(){J(this.b,fb),this.b={}},Yc.prototype.o=function(){Yc.P.o.call(this),this.removeAll()},Yc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _c=function(){nb.call(this),this.oa=new Yc(this),Na&&(Oa?this.oa.listen(Pa?document.body:b,["online","offline"],this.wb):(this.Eb=!Na||navigator.onLine,this.h=new Wc(250),this.oa.listen(this.h,"tick",this.oc),this.h.start()))};u(_c,nb),_c.prototype.oc=function(){var a=!Na||navigator.onLine;a!=this.Eb&&(this.Eb=a,this.wb())},_c.prototype.wb=function(){this.dispatchEvent((Na?navigator.onLine:1)?"online":"offline")},_c.prototype.o=function(){_c.P.o.call(this),this.oa.ma(),this.oa=null,this.h&&(this.h.ma(),this.h=null)};var ad=function(a,b){this.g=a,this.e=b};ad.prototype.send=function(a,b){return b.set(mc,Ic(this.g)),this.e.send(a,b)};var bd=function(a){this.e=a};bd.prototype.send=function(a,b){return cd(b),dd(b),this.e.send(a,b)};var cd=function(a){oa(a,function(b,c){f(b.maxLength)&&"text"==b.valueType&&0<b.maxLength&&c.length>b.maxLength&&a.set(b,c.substring(0,b.maxLength))})},dd=function(a){oa(a,function(b,c){f(b.defaultValue)&&c==b.defaultValue&&a.remove(b)})},ed={status:"device-offline",la:void 0},fd={status:"rate-limited",la:void 0},gd={status:"sampled-out",la:void 0},hd={status:"sent",la:void 0},id=function(a,b){this.Vc=a,this.e=b};id.prototype.send=function(a,b){var c;c=this.Vc;var d=c.Lb(),e=Math.floor((d-c.Ab)*c.hc);return 0<e&&(c.$=Math.min(c.$+e,c.uc),c.Ab=d),1>c.$?c=!1:(--c.$,c=!0),c||"item"==a||"transaction"==a?this.e.send(a,b):_b(fd)};var jd=function(){this.$=60,this.uc=500,this.hc=5e-4,this.Lb=function(){return(new Date).getTime()},this.Ab=this.Lb()},kd=function(a,b){this.g=a,this.e=b};kd.prototype.send=function(a,b){var c,d=b.get(mc),d=parseInt(d.split("-")[1],16);return"timing"!=a?c=Lc(this.g):((c=b.get(pc))&&b.remove(pc),c=c||Lc(this.g)),d<655.36*c?this.e.send(a,b):_b(gd)};var ld=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/,md=function(a){if(nd){nd=!1;var b=e.location;if(b){var c=b.href;if(c&&(c=(c=md(c)[3]||null)?decodeURI(c):c)&&c!=b.hostname)throw nd=!0,Error()}}return a.match(ld)},nd=Ca,od=function(a,b){for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f=null,g=null;0<=e?(f=c[d].substring(0,e),g=c[d].substring(e+1)):f=c[d],b(f,g?decodeURIComponent(g.replace(/\+/g," ")):"")}},pd=function(){};pd.prototype.nb=null;var qd,rd=function(a){var b;return(b=a.nb)||(b={},ud(a)&&(b[0]=!0,b[1]=!0),b=a.nb=b),b},sd=function(){};u(sd,pd);var td=function(a){return(a=ud(a))?new ActiveXObject(a):new XMLHttpRequest},ud=function(a){if(!a.xb&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.xb=d}catch(a){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return a.xb};qd=new sd;var vd=function(a){nb.call(this),this.headers=new Q,this.Ma=a||null,this.F=!1,this.La=this.a=null,this.za=this.$a="",this.N=this.Za=this.va=this.Ua=!1,this.Ha=0,this.Ga=null,this.Gb="",this.kb=this.Zc=!1};u(vd,nb);var wd=/^https?$/i,xd=["POST","PUT"],yd=[],zd=function(a,b,c){var d=new vd;yd.push(d),b&&d.listen("complete",b),d.cb("ready",d.bc),d.send(a,"POST",c,void 0)};vd.prototype.bc=function(){this.ma(),E(yd,this)},vd.prototype.send=function(a,b,c,d){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.$a+"; newUri="+a);b=b?b.toUpperCase():"GET",this.$a=a,this.za="",this.Ua=!1,this.F=!0,this.a=td(this.Ma?this.Ma:qd),this.La=rd(this.Ma?this.Ma:qd),this.a.onreadystatechange=q(this.Db,this);try{this.Za=!0,this.a.open(b,String(a),!0),this.Za=!1}catch(a){return void this.na(5,a)}a=c||"";var f=this.headers.clone();d&&ma(d,function(a,b){f.set(b,a)}),d=D(f.H()),c=e.FormData&&a instanceof e.FormData,!(0<=z(xd,b))||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),f.forEach(function(a,b){this.a.setRequestHeader(b,a)},this),this.Gb&&(this.a.responseType=this.Gb),"withCredentials"in this.a&&(this.a.withCredentials=this.Zc);try{Fd(this),0<this.Ha&&((this.kb=Ad(this.a))?(this.a.timeout=this.Ha,this.a.ontimeout=q(this.Mb,this)):this.Ga=Xc(this.Mb,this.Ha,this)),
this.va=!0,this.a.send(a),this.va=!1}catch(a){this.na(5,a)}};var Ad=function(a){return Aa&&Ha(9)&&l(a.timeout)&&f(a.ontimeout)},Bd=function(a){return"content-type"==a.toLowerCase()};vd.prototype.Mb=function(){"undefined"!=typeof d&&this.a&&(this.za="Timed out after "+this.Ha+"ms, aborting",this.dispatchEvent("timeout"),this.abort(8))},vd.prototype.na=function(a,b){this.F=!1,this.a&&(this.N=!0,this.a.abort(),this.N=!1),this.za=b,Cd(this),Ed(this)};var Cd=function(a){a.Ua||(a.Ua=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))};vd.prototype.abort=function(){this.a&&this.F&&(this.F=!1,this.N=!0,this.a.abort(),this.N=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ed(this))},vd.prototype.o=function(){this.a&&(this.F&&(this.F=!1,this.N=!0,this.a.abort(),this.N=!1),Ed(this,!0)),vd.P.o.call(this)},vd.prototype.Db=function(){this.aa||(this.Za||this.va||this.N?Dd(this):this.wc())},vd.prototype.wc=function(){Dd(this)};var Dd=function(a){if(a.F&&"undefined"!=typeof d&&(!a.La[1]||4!=Gd(a)||2!=Hd(a)))if(a.va&&4==Gd(a))Xc(a.Db,0,a);else if(a.dispatchEvent("readystatechange"),4==Gd(a)){a.F=!1;try{var b,c=Hd(a);a:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:b=!0;break a;default:b=!1}var e;if(!(e=b)){var f;if(f=0===c){var g=md(String(a.$a))[1]||null;if(!g&&self.location)var h=self.location.protocol,g=h.substr(0,h.length-1);f=!wd.test(g?g.toLowerCase():"")}e=f}if(e)a.dispatchEvent("complete"),a.dispatchEvent("success");else{var i;try{i=2<Gd(a)?a.a.statusText:""}catch(a){i=""}a.za=i+" ["+Hd(a)+"]",Cd(a)}}finally{Ed(a)}}},Ed=function(a,b){if(a.a){Fd(a);var c=a.a,d=a.La[0]?g:null;a.a=null,a.La=null,b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(a){}}},Fd=function(a){a.a&&a.kb&&(a.a.ontimeout=null),l(a.Ga)&&(e.clearTimeout(a.Ga),a.Ga=null)},Gd=function(a){return a.a?a.a.readyState:0},Hd=function(a){try{return 2<Gd(a)?a.a.status:-1}catch(a){return-1}},Id=function(a,b,c){this.r=a||null,this.qc=!!c},Jd=function(a){a.c||(a.c=new Q,a.j=0,a.r&&od(a.r,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))};c=Id.prototype,c.c=null,c.j=null,c.add=function(a,b){Jd(this),this.r=null,a=Kd(this,a);var c=this.c.get(a);return c||this.c.set(a,c=[]),c.push(b),this.j++,this},c.remove=function(a){return Jd(this),a=Kd(this,a),!!this.c.T(a)&&(this.r=null,this.j-=this.c.get(a).length,this.c.remove(a))},c.T=function(a){return Jd(this),a=Kd(this,a),this.c.T(a)},c.H=function(){Jd(this);for(var a=this.c.t(),b=this.c.H(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c},c.t=function(a){Jd(this);var b=[];if(k(a))this.T(a)&&(b=F(b,this.c.get(Kd(this,a))));else{a=this.c.t();for(var c=0;c<a.length;c++)b=F(b,a[c])}return b},c.set=function(a,b){return Jd(this),this.r=null,a=Kd(this,a),this.T(a)&&(this.j-=this.c.get(a).length),this.c.set(a,[b]),this.j++,this},c.get=function(a,b){var c=a?this.t(a):[];return 0<c.length?String(c[0]):b},c.toString=function(){if(this.r)return this.r;if(!this.c)return"";for(var a=[],b=this.c.H(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.t(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f]))),a.push(g)}return this.r=a.join("&")},c.clone=function(){var a=new Id;return a.r=this.r,this.c&&(a.c=this.c.clone(),a.j=this.j),a};var Kd=function(a,b){var c=String(b);return a.qc&&(c=c.toLowerCase()),c},Ld=function(a,b){this.Mc=a,this.Aa=b};Ld.prototype.send=function(a,b){if(Na&&!navigator.onLine)return ac();var c=new Ub,d=Md(a,b);return d.length>this.Aa?c.A({status:"payload-too-big",la:ja("Encoded hit length == %s, but should be <= %s.",d.length,this.Aa)}):zd(this.Mc,function(){c.v(hd)},d),c};var Md=function(a,b){var c=new Id;return c.add(V.name,a),oa(b,function(a,b){c.add(a.name,b.toString())}),c.toString()},Nd=function(a,b,c){this.g=a,this.Lc=b,this.Aa=c};Nd.prototype.Xa=function(){if(!this.q){if(!Yb(this.g.ea).C)throw Error("Cannot construct shared channel prior to settings being ready.");new _c;var a=new bd(new Ld(this.Lc,this.Aa)),b=new jd;this.q=new ad(this.g,new kd(this.g,new id(b,a)))}return this.q};var Od=new Q,Pd=function(){return S||(S=new Dc(new Oc)),S};t("goog.async.Deferred",Ub),t("goog.async.Deferred.prototype.addCallback",Ub.prototype.n),t("goog.async.Deferred.prototype.callback",Ub.prototype.v),t("goog.async.Deferred.prototype.then",Ub.prototype.then),t("goog.events.EventTarget",nb),t("goog.events.EventTarget.prototype.listen",nb.prototype.listen),t("analytics.getService",function(b,c){var d=Od.get(b,null),e=c||a.runtime.getManifest().version;if(null===d){if(d=Pd(),!T){var f=Pd();T=new Vc(f,new Nd(f,"https://www.google-analytics.com/collect",8192))}d=new zc("ca1.6.0",b,e,d,T),Od.set(b,d)}return d}),t("analytics.internal.GoogleAnalyticsService",zc),t("analytics.internal.GoogleAnalyticsService.prototype.getTracker",zc.prototype.mc),t("analytics.internal.GoogleAnalyticsService.prototype.getConfig",zc.prototype.kc),t("analytics.internal.ServiceSettings",Dc),t("analytics.internal.ServiceSettings.prototype.setTrackingPermitted",Dc.prototype.Oc),t("analytics.internal.ServiceSettings.prototype.isTrackingPermitted",Dc.prototype.xa),t("analytics.internal.ServiceSettings.prototype.setSampleRate",Dc.prototype.Nc),t("analytics.internal.ServiceSettings.prototype.resetUserId",Dc.prototype.Fc),t("analytics.internal.ServiceTracker",xc),t("analytics.internal.ServiceTracker.prototype.send",xc.prototype.send),t("analytics.internal.ServiceTracker.prototype.sendAppView",xc.prototype.Hc),t("analytics.internal.ServiceTracker.prototype.sendEvent",xc.prototype.Ic),t("analytics.internal.ServiceTracker.prototype.sendSocial",xc.prototype.Kc),t("analytics.internal.ServiceTracker.prototype.sendException",xc.prototype.Jc),t("analytics.internal.ServiceTracker.prototype.sendTiming",xc.prototype.Ib),t("analytics.internal.ServiceTracker.prototype.startTiming",xc.prototype.Rc),t("analytics.internal.ServiceTracker.Timing",yc),t("analytics.internal.ServiceTracker.Timing.prototype.send",yc.prototype.send),t("analytics.internal.ServiceTracker.prototype.forceSessionStart",xc.prototype.jc),t("analytics.internal.ServiceTracker.prototype.addFilter",xc.prototype.R),t("analytics.internal.FilterChannel.Hit",hc),t("analytics.internal.FilterChannel.Hit.prototype.getHitType",hc.prototype.ub),t("analytics.internal.FilterChannel.Hit.prototype.getParameters",hc.prototype.V),t("analytics.internal.FilterChannel.Hit.prototype.cancel",hc.prototype.cancel),t("analytics.ParameterMap",na),t("analytics.ParameterMap.Entry",na.Entry),t("analytics.ParameterMap.prototype.set",na.prototype.set),t("analytics.ParameterMap.prototype.get",na.prototype.get),t("analytics.ParameterMap.prototype.remove",na.prototype.remove),t("analytics.ParameterMap.prototype.toObject",na.prototype.Nb),t("analytics.HitTypes.APPVIEW","appview"),t("analytics.HitTypes.EVENT","event"),t("analytics.HitTypes.SOCIAL","social"),t("analytics.HitTypes.TRANSACTION","transaction"),t("analytics.HitTypes.ITEM","item"),t("analytics.HitTypes.TIMING","timing"),t("analytics.HitTypes.EXCEPTION","exception"),J(aa,function(a){var b=a.id.replace(/[A-Z]/,"_$&").toUpperCase();t("analytics.Parameters."+b,a)}),t("analytics.filters.EventLabelerBuilder",ha),t("analytics.filters.EventLabelerBuilder.prototype.appendToExistingLabel",ha.prototype.Wb),t("analytics.filters.EventLabelerBuilder.prototype.stripValue",ha.prototype.Sc),t("analytics.filters.EventLabelerBuilder.prototype.powersOfTwo",ha.prototype.Dc),t("analytics.filters.EventLabelerBuilder.prototype.rangeBounds",ha.prototype.Ec),t("analytics.filters.EventLabelerBuilder.prototype.build",ha.prototype.ia),t("analytics.filters.FilterBuilder",fa),t("analytics.filters.FilterBuilder.builder",ga),t("analytics.filters.FilterBuilder.prototype.when",fa.prototype.when),t("analytics.filters.FilterBuilder.prototype.whenHitType",fa.prototype.Rb),t("analytics.filters.FilterBuilder.prototype.whenValue",fa.prototype.Yc),t("analytics.filters.FilterBuilder.prototype.applyFilter",fa.prototype.mb),t("analytics.filters.FilterBuilder.prototype.build",fa.prototype.ia),t("analytics.EventBuilder",pa),t("analytics.EventBuilder.builder",function(){return qa}),t("analytics.EventBuilder.prototype.category",pa.prototype.Yb),t("analytics.EventBuilder.prototype.action",pa.prototype.action),t("analytics.EventBuilder.prototype.label",pa.prototype.label),t("analytics.EventBuilder.prototype.value",pa.prototype.value),t("analytics.EventBuilder.prototype.dimension",pa.prototype.fc),t("analytics.EventBuilder.prototype.metric",pa.prototype.vc),t("analytics.EventBuilder.prototype.send",pa.prototype.send)}.call(this),function(){var c=this,d=function(a,d){var e=a.split("."),f=b||c;e[0]in f||!f.execScript||f.execScript("var "+e[0]);for(var g;e.length&&(g=e.shift());)e.length||void 0===d?f=f[g]?f[g]:f[g]={}:f[g]=d},e=function(b){var c=a.runtime.connect("nmmhkkegccagdldgiimedpiccmgmieda",{}),d=!1;c.onMessage.addListener(function(a){d=!0,"response"in a&&!("errorType"in a.response)?b.success&&b.success(a):b.failure&&b.failure(a)}),c.onDisconnect.addListener(function(){!d&&b.failure&&b.failure({request:{},response:{errorType:"INTERNAL_SERVER_ERROR"}})}),c.postMessage(b)};d("google.payments.inapp.buy",function(a){a.method="buy",e(a)}),d("google.payments.inapp.getPurchases",function(a){a.method="getPurchases",e(a)}),d("google.payments.inapp.getSkuDetails",function(a){a.method="getSkuDetails",e(a)})}(),function(){function a(a){var c=!1;return function(){if(c)throw new Error("Callback was already called.");c=!0,a.apply(b,arguments)}}var b,c,d={};b=this,null!=b&&(c=b.async),d.noConflict=function(){return b.async=c,d};var e=Object.prototype.toString,f=Array.isArray||function(a){return"[object Array]"===e.call(a)},g=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},h=function(a,b){if(a.map)return a.map(b);var c=[];return g(a,function(a,d,e){c.push(b(a,d,e))}),c},i=function(a,b,c){return a.reduce?a.reduce(b,c):(g(a,function(a,d,e){c=b(c,a,d,e)}),c)},j=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"!=typeof process&&process.nextTick?(d.nextTick=process.nextTick,"undefined"!=typeof setImmediate?d.setImmediate=function(a){setImmediate(a)}:d.setImmediate=d.nextTick):"function"==typeof setImmediate?(d.nextTick=function(a){setImmediate(a)},d.setImmediate=d.nextTick):(d.nextTick=function(a){setTimeout(a,0)},d.setImmediate=d.nextTick),d.each=function(b,c,d){function e(a){a?(d(a),d=function(){}):(f+=1,f>=b.length&&d())}if(d=d||function(){},!b.length)return d();var f=0;g(b,function(b){c(b,a(e))})},d.forEach=d.each,d.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})};e()},d.forEachSeries=d.eachSeries,d.eachLimit=function(a,b,c,d){var e=k(b);e.apply(null,[a,c,d])},d.forEachLimit=d.eachLimit;var k=function(a){return function(b,c,d){if(d=d||function(){},!b.length||a<=0)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;g<a&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},l=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.each].concat(b))}},m=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[k(a)].concat(c))}},n=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.eachSeries].concat(b))}},o=function(a,b,c,d){if(b=h(b,function(a,b){return{index:b,value:a}}),d){var e=[];a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})}else a(b,function(a,b){c(a.value,function(a){b(a)})})};d.map=l(o),d.mapSeries=n(o),d.mapLimit=function(a,b,c,d){return p(b)(a,c,d)};var p=function(a){return m(a,o)};d.reduce=function(a,b,c,e){d.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){e(a,b)})},d.inject=d.reduce,d.foldl=d.reduce,d.reduceRight=function(a,b,c,e){var f=h(a,function(a){return a}).reverse();d.reduce(f,b,c,e)},d.foldr=d.reduceRight;var q=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(a){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.filter=l(q),d.filterSeries=n(q),d.select=d.filter,d.selectSeries=d.filterSeries;var r=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(a){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.reject=l(r),d.rejectSeries=n(r);var s=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(a){d()})};d.detect=l(s),d.detectSeries=n(s),d.some=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(a){c(!1)})},d.any=d.some,d.every=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(a){c(!0)})},d.all=d.every,d.sortBy=function(a,b,c){d.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0};c(null,h(b.sort(d),function(a){return a.value}))})},d.auto=function(a,b){b=b||function(){};var c=j(a),e=c.length;if(!e)return b();var h={},k=[],l=function(a){k.unshift(a)},m=function(a){for(var b=0;b<k.length;b+=1)if(k[b]===a)return void k.splice(b,1)},n=function(){e--,g(k.slice(0),function(a){a()})};l(function(){if(!e){var a=b;b=function(){},a(null,h)}}),g(c,function(c){var e=f(a[c])?a[c]:[a[c]],k=function(a){var e=Array.prototype.slice.call(arguments,1);if(e.length<=1&&(e=e[0]),a){var f={};g(j(h),function(a){f[a]=h[a]}),f[c]=e,b(a,f),b=function(){}}else h[c]=e,d.setImmediate(n)},o=e.slice(0,Math.abs(e.length-1))||[],p=function(){return i(o,function(a,b){return a&&h.hasOwnProperty(b)},!0)&&!h.hasOwnProperty(c)};if(p())e[e.length-1](k,h);else{var q=function(){p()&&(m(q),e[e.length-1](k,h))};l(q)}})},d.retry=function(a,b,c){var e=5,f=[];"function"==typeof a&&(c=b,b=a,a=e),a=parseInt(a,10)||e;var g=function(e,g){for(var h=function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},g)}};a;)f.push(h(b,!(a-=1)));d.series(f,function(a,b){b=b[b.length-1],(e||c)(b.err,b.result)})};return c?g():g},d.waterfall=function(a,b){if(b=b||function(){},!f(a)){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();var e=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=a.next();g?f.push(e(g)):f.push(b),d.setImmediate(function(){a.apply(null,f)})}}};e(d.iterator(a))()};var t=function(a,b,c){if(c=c||function(){},f(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(j(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};d.parallel=function(a,b){t({map:d.map,each:d.each},a,b)},d.parallelLimit=function(a,b,c){t({map:p(b),each:k(b)},a,c)},d.series=function(a,b){if(b=b||function(){},f(a))d.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};d.eachSeries(j(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},d.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},d.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var u=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};d.concat=l(u),d.concatSeries=n(u),d.whilst=function(a,b,c){a()?b(function(e){return e?c(e):void d.whilst(a,b,c)}):c()},d.doWhilst=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?d.doWhilst(a,b,c):c()})},d.until=function(a,b,c){a()?c():b(function(e){return e?c(e):void d.until(a,b,c)})},d.doUntil=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?c():d.doUntil(a,b,c)})},d.queue=function(b,c){function e(a,b,c,e){return a.started||(a.started=!0),f(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void g(b,function(b){var f={data:b,callback:"function"==typeof e?e:null};c?a.tasks.unshift(f):a.tasks.push(f),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}void 0===c&&(c=1);var h=0,i={tasks:[],concurrency:c,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(a,b){e(i,a,!1,b)},kill:function(){i.drain=null,i.tasks=[]},unshift:function(a,b){e(i,a,!0,b)},process:function(){if(!i.paused&&h<i.concurrency&&i.tasks.length){var c=i.tasks.shift();i.empty&&0===i.tasks.length&&i.empty(),h+=1;var d=function(){h-=1,c.callback&&c.callback.apply(c,arguments),i.drain&&i.tasks.length+h===0&&i.drain(),i.process()},e=a(d);b(c.data,e)}},length:function(){return i.tasks.length},running:function(){return h},idle:function(){return i.tasks.length+h===0},pause:function(){i.paused!==!0&&(i.paused=!0,i.process())},resume:function(){i.paused!==!1&&(i.paused=!1,i.process())}};return i},d.priorityQueue=function(a,b){function c(a,b){return a.priority-b.priority}function e(a,b,c){for(var d=-1,e=a.length-1;d<e;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function h(a,b,h,i){return a.started||(a.started=!0),f(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void g(b,function(b){var f={data:b,priority:h,callback:"function"==typeof i?i:null};a.tasks.splice(e(a.tasks,f,c)+1,0,f),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}var i=d.queue(a,b);return i.push=function(a,b,c){h(i,a,b,c)},delete i.unshift,i},d.cargo=function(a,b){var c=!1,e=[],i={tasks:e,payload:b,saturated:null,empty:null,drain:null,drained:!0,push:function(a,c){f(a)||(a=[a]),g(a,function(a){e.push({data:a,callback:"function"==typeof c?c:null}),i.drained=!1,i.saturated&&e.length===b&&i.saturated()}),d.setImmediate(i.process)},process:function d(){if(!c){if(0===e.length)return i.drain&&!i.drained&&i.drain(),void(i.drained=!0);var f="number"==typeof b?e.splice(0,b):e.splice(0,e.length),j=h(f,function(a){return a.data});i.empty&&i.empty(),c=!0,a(j,function(){c=!1;var a=arguments;g(f,function(b){b.callback&&b.callback.apply(null,a)}),d()})}},length:function(){return e.length},running:function(){return c}};return i};var v=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&g(c,function(b){console[a](b)}))}]))}};d.log=v("log"),d.dir=v("dir"),d.memoize=function(a,b){var c={},e={};b=b||function(a){return a};var f=function(){var f=Array.prototype.slice.call(arguments),g=f.pop(),h=b.apply(null,f);h in c?d.nextTick(function(){g.apply(null,c[h])}):h in e?e[h].push(g):(e[h]=[g],a.apply(null,f.concat([function(){c[h]=arguments;var a=e[h];delete e[h];for(var b=0,d=a.length;b<d;b++)a[b].apply(null,arguments)}])))};return f.memo=c,f.unmemoized=a,f},d.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},d.times=function(a,b,c){for(var e=[],f=0;f<a;f++)e.push(f);return d.map(e,b,c)},d.timesSeries=function(a,b,c){for(var e=[],f=0;f<a;f++)e.push(f);return d.mapSeries(e,b,c)},d.seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),e=c.pop();d.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){e.apply(b,[a].concat(c))})}},d.compose=function(){return d.seq.apply(null,Array.prototype.reverse.call(arguments))};var w=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};d.applyEach=l(w),d.applyEachSeries=n(w),d.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},"undefined"!=typeof module&&module.exports?module.exports=d:"undefined"!=typeof define&&define.amd?define([],function(){return d}):b.async=d}(),function(a){var b=function(a,c){var d=[].slice.call(arguments),e=!1;a&&d.shift(),c&&d.shift();var f=!1,g=function(){clearTimeout(h),f?console.trace("TimedCallback: Callback already called."):(f=!0,a.apply(null,[].slice.call(arguments)))},h=setTimeout(function(){e=!0,console.trace("TimedCallback: Callback timeout."),d.splice(0,0,b.TIMEOUT),g.apply(null,d)},c||b.DEFAULT_TIMEOUT);return g};b.DEFAULT_TIMEOUT=3e4,b.TIMEOUT="timeout","undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=b:a.TimedCallback=b}(b),function(){var b=document.querySelectorAll("[data-localize]"),c=document.querySelectorAll("[data-localize-label]"),d=document.querySelectorAll("[data-localize-title]"),e=document.querySelectorAll("[data-localize-placeholder");!function(){for(var c=0;c<b.length;c++){var d=b[c],e=a.i18n.getMessage(d.getAttribute("data-localize"));e&&null!==e&&(d.innerHTML=e)}}(),function(){for(var b=0;b<c.length;b++){var d=c[b],e=a.i18n.getMessage(d.getAttribute("data-localize-label"));e&&null!==e&&(d.label=e)}}(),function(){for(var b=0;b<d.length;b++){var c=d[b],e=a.i18n.getMessage(c.getAttribute("data-localize-title"));e&&null!==e&&(c.title=e)}}(),function(){for(var b=0;b<e.length;b++){var c=e[b],d=a.i18n.getMessage(c.getAttribute("data-localize-placeholder"));d&&null!==d&&(c.placeholder=d)}}()}(),function(a){var b=function(){};b.generate=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=b:a.Uuid=b}(b),function(a){var b=function(){};b.CODES={abk:"Abkhazian",ab:"Abkhazian",aar:"Afar",aa:"Afar",afr:"Afrikaans",af:"Afrikaans",alb:"Albanian",sqi:"Albanian",sq:"Albanian",amh:"Amharic",am:"Amharic",ara:"Arabic",ar:"Arabic",arg:"Aragonese",an:"Aragonese",arm:"Armenian",hye:"Armenian",hy:"Armenian",asm:"Assamese",as:"Assamese",ave:"Avestan",ae:"Avestan",aym:"Aymara",ay:"Aymara",aze:"Azerbaijani",az:"Azerbaijani",bak:"Bashkir",ba:"Bashkir",baq:"Basque",eus:"Basque",eu:"Basque",bel:"Belarusian",be:"Belarusian",ben:"Bengali",bn:"Bengali",bih:"Bihari",bh:"Bihari",bis:"Bislama",bi:"Bislama",bos:"Bosnian",bs:"Bosnian",bre:"Breton",br:"Breton",bul:"Bulgarian",bg:"Bulgarian",bur:"Burmese",mya:"Burmese",my:"Burmese",cat:"Catalan",ca:"Catalan",cha:"Chamorro",ch:"Chamorro",che:"Chechen",ce:"Chechen",chi:"Chinese",zho:"Chinese",zh:"Chinese",chu:"Church Slavic;Slavonic;Old Bulgarian",cu:"Church Slavic;Slavonic;Old Bulgarian",chv:"Chuvash",cv:"Chuvash",cor:"Cornish",kw:"Cornish",cos:"Corsican",co:"Corsican",scr:"Croatian",hrv:"Croatian",hr:"Croatian",cze:"Czech",ces:"Czech",cs:"Czech",dan:"Danish",da:"Danish",div:"Divehi;Dhivehi;Maldivian",dv:"Divehi;Dhivehi;Maldivian",dut:"Dutch",nld:"Dutch",nl:"Dutch",dzo:"Dzongkha",dz:"Dzongkha",eng:"English",en:"English",epo:"Esperanto",eo:"Esperanto",est:"Estonian",et:"Estonian",fao:"Faroese",fo:"Faroese",fij:"Fijian",fj:"Fijian",fin:"Finnish",fi:"Finnish",fre:"French",fra:"French",fr:"French",gla:"Gaelic;Scottish Gaelic",gd:"Gaelic;Scottish Gaelic",glg:"Galician",gl:"Galician",geo:"Georgian",kat:"Georgian",ka:"Georgian",ger:"German",deu:"German",de:"German",gre:"Greek",ell:"Greek",el:"Greek",grn:"Guarani",gn:"Guarani",guj:"Gujarati",gu:"Gujarati",hat:"Haitian;Haitian Creole",ht:"Haitian;Haitian Creole",hau:"Hausa",ha:"Hausa",heb:"Hebrew",he:"Hebrew",her:"Herero",hz:"Herero",hin:"Hindi",hi:"Hindi",hmo:"Hiri Motu",ho:"Hiri Motu",hun:"Hungarian",hu:"Hungarian",ice:"Icelandic",isl:"Icelandic",is:"Icelandic",ido:"Ido",io:"Ido",ind:"Indonesian",id:"Indonesian",ina:"Interlingua (International Auxiliary Language Association)",ia:"Interlingua (International Auxiliary Language Association)",ile:"Interlingue",ie:"Interlingue",iku:"Inuktitut",iu:"Inuktitut",ipk:"Inupiaq",ik:"Inupiaq",gle:"Irish",ga:"Irish",ita:"Italian",it:"Italian",jpn:"Japanese",ja:"Japanese",jav:"Javanese",jv:"Javanese",kal:"Kalaallisut",kl:"Kalaallisut",kan:"Kannada",kn:"Kannada",kas:"Kashmiri",ks:"Kashmiri",kaz:"Kazakh",kk:"Kazakh",khm:"Khmer",km:"Khmer",kik:"Kikuyu;Gikuyu",ki:"Kikuyu;Gikuyu",kin:"Kinyarwanda",rw:"Kinyarwanda",kir:"Kirghiz",ky:"Kirghiz",kom:"Komi",kv:"Komi",kor:"Korean",ko:"Korean",kr:"Korean",kua:"Kuanyama;Kwanyama",kj:"Kuanyama;Kwanyama",kur:"Kurdish",ku:"Kurdish",lao:"Lao",lo:"Lao",lat:"Latin",la:"Latin",lav:"Latvian",lv:"Latvian",lim:"Limburgan;Limburger;Limburgish",li:"Limburgan;Limburger;Limburgish",lin:"Lingala",ln:"Lingala",lit:"Lithuanian",lt:"Lithuanian",ltz:"Luxembourgish",lb:"Luxembourgish",mac:"Macedonian",mk:"Macedonian",mkd:"Macedonian",mlg:"Malagasy",mg:"Malagasy",may:"Malay",ms:"Malay",msa:"Malay",mal:"Malayalam",ml:"Malayalam",mlt:"Maltese",mt:"Maltese",mni:"Manipuri",ma:"Manipuri",glv:"Manx",gv:"Manx",mao:"Maori",mi:"Maori",mri:"Maori",mar:"Marathi",mr:"Marathi",mah:"Marshallese",mh:"Marshallese",mol:"Moldavian",mo:"Moldavian",mon:"Mongolian",mn:"Mongolian",mne:"Montenegrin",me:"Montenegrin",nau:"Nauru",na:"Nauru",nav:"Navaho, Navajo",nv:"Navaho, Navajo",nde:"Ndebele, North",nd:"Ndebele, North",nbl:"Ndebele, South",nr:"Ndebele, South",ndo:"Ndonga",ng:"Ndonga",nep:"Nepali",ne:"Nepali",sme:"Northern Sami",se:"Northern Sami",nor:"Norwegian",no:"Norwegian",nob:"Norwegian",nb:"Norwegian",nno:"Norwegian",nn:"Norwegian",nya:"Nyanja;Chichewa;Chewa",ny:"Nyanja;Chichewa;Chewa",oci:"Occitan",oc:"Occitan",ori:"Oriya",or:"Oriya",orm:"Oromo",om:"Oromo",oss:"Ossetian;Ossetic",os:"Ossetian;Ossetic",pli:"Pali",pi:"Pali",pan:"Panjabi",pa:"Panjabi",per:"Persian",fa:"Persian",fas:"Persian",pol:"Polish",pl:"Polish",por:"Portuguese",pt:"Portuguese",pob:"PortugueseBR",pb:"PortugueseBR",pus:"Pushto",ps:"Pushto",que:"Quechua",qu:"Quechua",roh:"Raeto-Romance",rm:"Raeto-Romance",rum:"Romanian",ro:"Romanian",ron:"Romanian",run:"Rundi",rn:"Rundi",rus:"Russian",ru:"Russian",smo:"Samoan",sm:"Samoan",sag:"Sango",sg:"Sango",san:"Sanskrit",sa:"Sanskrit",srd:"Sardinian",sc:"Sardinian",scc:"Serbian",sr:"Serbian",srp:"Serbian",sna:"Shona",sn:"Shona",iii:"Sichuan Yi",ii:"Sichuan Yi",snd:"Sindhi",sd:"Sindhi",sin:"Sinhalese",si:"Sinhalese",slo:"Slovak",sk:"Slovak",slk:"Slovak",slv:"Slovenian",sl:"Slovenian",som:"Somali",so:"Somali",sot:"Sotho, Southern",st:"Sotho, Southern",spa:"Spanish",es:"Spanish",sun:"Sundanese",su:"Sundanese",swa:"Swahili",sw:"Swahili",ssw:"Swati",ss:"Swati",swe:"Swedish",sv:"Swedish",syr:"Syriac",sy:"Syriac",tgl:"Tagalog",tl:"Tagalog",tah:"Tahitian",ty:"Tahitian",tgk:"Tajik",tg:"Tajik",tam:"Tamil",ta:"Tamil",tat:"Tatar",tt:"Tatar",tel:"Telugu",te:"Telugu",tha:"Thai",th:"Thai",tib:"Tibetan",bo:"Tibetan",bod:"Tibetan",tir:"Tigrinya",ti:"Tigrinya",ton:"Tonga (Tonga Islands)",to:"Tonga (Tonga Islands)",tso:"Tsonga",ts:"Tsonga",tsn:"Tswana",tn:"Tswana",tur:"Turkish",tr:"Turkish",tuk:"Turkmen",tk:"Turkmen",twi:"Twi",tw:"Twi",uig:"Uighur",ug:"Uighur",ukr:"Ukrainian",uk:"Ukrainian",urd:"Urdu",ur:"Urdu",uzb:"Uzbek",uz:"Uzbek",vie:"Vietnamese",vi:"Vietnamese",vol:"Volapuk",vo:"Volapuk",wln:"Walloon",wa:"Walloon",wel:"Welsh",cy:"Welsh",cym:"Welsh",fry:"Western Frisian",fy:"Western Frisian",wol:"Wolof",wo:"Wolof",xho:"Xhosa",xh:"Xhosa",yid:"Yiddish",yi:"Yiddish",yor:"Yoruba",yo:"Yoruba",zha:"Zhuang;Chuang",za:"Zhuang;Chuang",zul:"Zulu",zu:"Zulu"},b._OPENSUB_CODES={Afrikaans:"afr",Albanian:"alb",Arabic:"ara",Armenian:"arm",Basque:"baq",Belarusian:"bel",Bengali:"ben",Bosnian:"bos",Breton:"bre",Bulgarian:"bul",Burmese:"bur",Catalan:"cat",Chinese:"chi",Czech:"cze",Danish:"dan",Dutch:"dut",English:"eng",Esperanto:"epo",Estonian:"est",Finnish:"fin",French:"fre",Georgian:"geo",German:"ger",Galician:"glg",Greek:"ell",Hebrew:"heb",Hindi:"hin",Croatian:"hrv",Hungarian:"hun",Icelandic:"ice",Indonesian:"ind",Italian:"ita",Japanese:"jpn",Kazakh:"kaz",Khmer:"khm",Korean:"kor",Latvian:"lav",Lithuanian:"lit",Luxembourgish:"ltz",Macedonian:"mac",Malayalam:"mal",Malay:"may",Montenegrin:"mne",Manipuri:"mni",Mongolian:"mon",Norwegian:"nor",Occitan:"oci",Persian:"per",Polish:"pol",Portuguese:"por",PortugueseBR:"pob",Romanian:"rum",Russian:"rus",Serbian:"scc",Sinhalese:"sin",Slovak:"slo",Slovenian:"slv",Spanish:"spa",Swahili:"swa",Swedish:"swe",Syriac:"syr",Tamil:"tam",Telugu:"tel",Tagalog:"tgl",Thai:"tha",Turkish:"tur",Ukrainian:"ukr",Urdu:"urd",Vietnamese:"vie"},b.getOpensubLangID=function(a){return b._OPENSUB_CODES[b.CODES[a]]},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=b:a.Languages=b}(b),function(a){var b=a.EventEmitter||require("lib/EventEmitter"),c=function(){b.call(this)};c.prototype=Object.create(b.prototype),c.ERROR_TIMEOUT="Timeout",c.ERROR_COMMUNICATION_BLOCKED="CommunicationBlocked",c.ERROR_UNKNOWN="Unknown",c.ERROR_NO_SESSION="NoSession",c.ERROR_NO_DEVICE="NoDevice",c.ERROR_NO_NETWORK="NoNetwork",c.ERROR_CANCELLED="Cancelled",c.prototype.openSession=function(a){throw new Error("Not implemented.")},c.prototype.openSessionById=function(a,b){throw new Error("Not implemented.")},c.prototype.closeSession=function(a){throw new Error("Not implemented.")},c.prototype.getValidIPRoute=function(a){throw new Error("Not implemented.")},c.prototype.getIPRoute=function(){throw new Error("Not implemented.")},c.prototype.loadMedia=function(a,b,c){throw new Error("Not implemented.")},c.prototype.play=function(a){throw new Error("Not implemented.")},c.prototype.pause=function(a){throw new Error("Not implemented.")},c.prototype.stop=function(a){throw new Error("Not implemented.")},c.prototype.seekSeconds=function(a,b){throw new Error("Not implemented.")},c.prototype.getDuration=function(a){throw new Error("Not implemented.")},c.prototype.getCurrentTime=function(a){throw new Error("Not implemented.")},c.prototype.isMuted=function(a){throw new Error("Not implemented.")},c.prototype.setMuted=function(a){throw new Error("Not implemented.")},c.prototype.getVolume=function(a){throw new Error("Not implemented.")},c.prototype.setVolume=function(a){throw new Error("Not implemented.")},c.prototype.isPlaying=function(a){throw new Error("Not implemented.")},c.prototype.uploadSubtitles=function(a,b){throw new Error("Not implemented.")},c.prototype.uploadSubtitleStyles=function(a,b){throw new Error("Not implemented.")},c.prototype.uploadInlineStyles=function(a,b){throw new Error("Not implemented.")},c.prototype.uploadSubtitleFonts=function(a,b,c){throw new Error("Not implemented.")},c.prototype.clearTracks=function(){throw new Error("Not implemented.")},c.prototype.trackAdded=function(a,b){throw new Error("Not implemented.")},c.prototype.trackRemoved=function(a,b){throw new Error("Not implemented.")},c.prototype.trackSelected=function(a,b){throw new Error("Not implemented.")},c.prototype.setScale=function(a,b){throw new Error("Not implemented.")},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.CastInterface=c}(b),function(b){var c,d=b.EventEmitter||require("lib/EventEmitter"),e=function(){d.call(this)};e.prototype=Object.create(d.prototype),e.getInstance=function(){return c||(c=new e((!0))),c},e.prototype.set=function(b,c,d){var e={};e[b]=c,a.storage.local.set(e,d),this.emit("localchange",b,c),this.emit("change",b,c),this.emit(b+"-changed",c)},e.prototype.remoteSettingChanged=function(a,b){
this.emit("change",a,b),this.emit(a+"-changed",b)},e.prototype.onChanged=function(a,b){d.prototype.on.call(this,a+"-changed",b),this.get(a,function(a){b(a)})},e.prototype.removeChangedListener=function(a,b){d.prototype.removeListener.call(this,a+"-changed",b)},e.prototype.get=function(b,c){a.storage.local.get(b,function(a){c&&c(a[b])})},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:b.SettingsStore=e}(b),function(a){var b,c=a.EventEmitter||require("lib/EventEmitter"),d=a.SettingsStore||require("common/SettingsStore"),e=function(){c.call(this),this.settingsStore=d.getInstance()};e.getInstance=function(){return b||(b=new e),b},e.prototype=Object.create(c.prototype),e.prototype.set=function(a,b,c,d){this.settingsStore.set(a,{expiry:c,value:b},d)},e.prototype.get=function(a,b){var c=this;this.settingsStore.get(a,function(d){d&&Date.now()>=d.expiry?(c.settingsStore.set(a,null),b&&b(null)):d?b&&b(d.value):b&&b(d)})},e.prototype.expire=function(a,b,c){var d=this;this.settingsStore.get(a,function(e){d.settingsStore.set(a,e.value,b,c)})},e.prototype.unset=function(a,b){this.settingsStore.set(a,null,b)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:a.SettingsCache=e}(b),function(b){var c,d=b.EventEmitter||require("lib/EventEmitter"),e=function(){d.call(this)};e.getInstance=function(){return c||(c=new e),c},e.prototype=Object.create(d.prototype),e.prototype.set=function(b,c,d){var e={};e[b]=c,a.storage.sync.set(e,d),this.emit("change",b,c)},e.prototype.get=function(b,c){a.storage.sync.get(b,function(a){c&&c(a[b])})},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:b.SyncdSettingsStore=e}(b),function(a){var b,c=a.SettingsCache||require("common/SettingsCache"),d=a.SettingsStore||require("common/SettingsStore"),e=function(){this._settingsCache=c.getInstance(),this._settingsStore=d.getInstance()};e.getInstance=function(){return b||(b=new e),b},e.prototype.on=function(a,b){switch(a){case"registrationIdChanged":this.getRegistrationId(b);break;case"fivePointOnePolicyChanged":this.getFivePointOnePolicy(b);break;case"scaleSettingChanged":this.getScaleSetting(b);break;case"playlistRepeatModeChanged":this.getPlaylistRepeatMode(b);break;case"transcodeQualityChanged":this.getTranscodeQuality(b);break;case"lastPlaylistItemChanged":this.lastPlaylistItem(b);break;case"defaultEncodingChanged":this.getDefaultEncoding(b);break;case"defaultAudioLanguageChanged":this.getDefaultAudioLanguage(b);break;case"defaultSubtitleLanguageChanged":this.getDefaultSubtitleLanguage(b);break;case"subtitleLoadingChanged":this.getSubtitleLoading(b);break;case"remoteSubtitlesEnabledChanged":this.getRemoteSubtitlesEnabled(b);break;case"analyticsOptInChanged":this.getAnalyticsOptIn(b);break;case"resumeOptInChanged":this.getResumeOptIn(b);break;case"localMediaContentSuggestionsOptInChanged":this.getLocalMediaContentSuggestionsOptIn(b);break;case"recentlyDownloadedContentSuggestionsOptInChanged":this.getRecentlyDownloadedContentSuggestionsOptIn(b);break;case"isPlaylistEnabledChanged":this.getPlaylistEnabled(b);break;case"subtitleStylesChanged":this.getSubtitleStyles(b);break;case"libraryRescanDatesChanged":this.getLibraryRescanDates(b);break;case"libraryEntriesChanged":this.getLibraryEntryIds(b);break;case"computerNameChanged":this.getComputerName(b);break;case"portfixStateChanged":this.getPortfixState(b);break;case"watchedFirstVideoChanged":this.getWatchedFirstVideo(b);break;case"launchCountChanged":this.getLaunchCount(b);break;case"receiverVersionChanged":this.getReceiverVersion(b);break;case"stripeSubscriptionCancellationDateChanged":this.getStripeSubscriptionCancellationDate(b);break;case"x264PresetChanged":this.getX264Preset(b);break;case"userHasViewedAuthScreenChanged":this.getUserHasViewedAuthScreen(b);break;case"splashContentImagesOptInChanged":this.getSplashContentImagesOptIn(b);break;case"contentScreenshotOptInChanged":this.getContentScreenshotOptIn(b);break;case"continueWatchingListChanged":this.getContinueWatchingList(b);break;case"libraryVideosChanged":break;case"librarySubtitlesChanged":break;default:this._settingsStore.get(a,b)}a=a.replace("Changed","-changed"),this._settingsStore.on(a,b)},e.prototype.removeListener=function(a,b){a=a.replace("Changed","-changed"),this._settingsStore.removeListener(a,b)},e.prototype.getKeystoneId=function(a){var b=this;return b._keystoneId?void a(b._keystoneId):void this._settingsStore.get("keystoneId",function(c){null==c&&null==b._keystoneId?(c=Uuid.generate()+":"+Uuid.generate(),b._settingsStore.set("keystoneId",c)):null!=b._keystoneId&&(c=b._keystoneId),b._keystoneId=c,a(c)})},e.prototype.getRegistrationId=function(a){this._settingsStore.get("registrationId",a)},e.prototype.setRegistrationId=function(a,b){this._settingsStore.set("registrationId",a,b)},e.prototype.setFivePointOnePolicy=function(a,b){this._settingsStore.set("fivePointOnePolicy",a,b)},e.prototype.getFivePointOnePolicy=function(a){this._settingsStore.get("fivePointOnePolicy",function(b){a&&a(b||MediaSourceFactory.FIVEPOINTONE_DISABLED_PASSTHROUGH)})},e.prototype.setScaleSetting=function(a,b){this._settingsStore.set("scaleSetting",a,b)},e.prototype.getScaleSetting=function(a){this._settingsStore.get("scaleSetting",function(b){a&&a(b||"fit")})},e.prototype.setPlaylistRepeatMode=function(a,b){this._settingsStore.set("playlistRepeatMode",a,b)},e.prototype.getPlaylistRepeatMode=function(a){this._settingsStore.get("playlistRepeatMode",function(b){a&&a(b||"off")})},e.prototype.setTranscodeQuality=function(a,b){this._settingsStore.set("transcodeQuality",a,b)},e.prototype.getTranscodeQuality=function(a){this._settingsStore.get("transcodeQuality",function(b){a&&a(b||"high")})},e.prototype.lastPlaylistItem=function(a){this._settingsStore.get("lastPlaylistItem",a)},e.prototype.setLastPlaylistItem=function(a,b){this._settingsStore.set("lastPlaylistItem",a,b)},e.prototype.setInstallDate=function(a,b){this._settingsStore.set("installDate",a,b)},e.prototype.getInstallDate=function(a){this._settingsStore.get("installDate",a)},e.prototype.setInstalledVersion=function(a,b){this._settingsStore.set("installedVersion",a,b)},e.prototype.getInstalledVersion=function(a){this._settingsStore.get("installedVersion",a)},e.prototype.getDefaultEncoding=function(a){this._settingsStore.get("defaultEncoding",function(b){a&&a(b||"windows-1252")})},e.prototype.setDefaultEncoding=function(a,b){this._settingsStore.set("defaultEncoding",a,b)},e.prototype.setDefaultAudioLanguage=function(a,b){this._settingsStore.set("defaultAudioLanguage",a,b)},e.prototype.setDefaultSubtitleLanguage=function(a,b){this._settingsStore.set("defaultSubtitleLanguage",a,b)},e.prototype.getDefaultAudioLanguage=function(a){this._settingsStore.get("defaultAudioLanguage",function(b){var c=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;c=c.substr(0,2),a&&a(b||c)})},e.prototype.getDefaultSubtitleLanguage=function(a){this._settingsStore.get("defaultSubtitleLanguage",function(b){var c=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;c=c.substr(0,2),a&&a(b||c)})},e.prototype.setSubtitleLoading=function(a,b){this._settingsStore.set("subtitleLoading",a,b)},e.prototype.getSubtitleLoading=function(a){var b=this;this._settingsStore.get("subtitleLoading",function(c){b.getDefaultSubtitleLanguage(function(d){c!==!0&&c!==!1&&(c="en"!==d,b.setSubtitleLoading(c)),a&&a(c)})})},e.prototype.getRemoteSubtitlesEnabled=function(a){this._settingsStore.get("remoteSubtitlesEnabled",function(b){null==b&&(b=!0),a&&a(b)})},e.prototype.setRemoteSubtitlesEnabled=function(a,b){this._settingsStore.set("remoteSubtitlesEnabled",a,b)},e.prototype.getAnalyticsOptIn=function(a){this._settingsStore.get("analyticsOptIn",function(b){null==b&&(b=!0),a(b)})},e.prototype.setAnalyticsOptIn=function(a,b){this._settingsStore.set("analyticsOptIn",a,b)},e.prototype.getResumeOptIn=function(a){this._settingsStore.get("resumeOptIn",function(b){null==b&&(b=!0),a(b)})},e.prototype.setResumeOptIn=function(a,b){this._settingsStore.set("resumeOptIn",a,b)},e.prototype.getLocalMediaContentSuggestionsOptIn=function(a){this._settingsStore.get("localMediaContentSuggestionsOptIn",function(b){null==b&&(b=!0),a(b)})},e.prototype.getRecentlyDownloadedContentSuggestionsOptIn=function(a){this._settingsStore.get("recentlyDownloadedContentSuggestionsOptIn",function(b){null==b&&(b=!0),a(b)})},e.prototype.setLocalMediaContentSuggestionsOptIn=function(a,b){this._settingsStore.set("localMediaContentSuggestionsOptIn",a,b)},e.prototype.setRecentlyDownloadedContentSuggestionsOptIn=function(a,b){this._settingsStore.set("recentlyDownloadedContentSuggestionsOptIn",a,b)},e.prototype.getPlaylistEnabled=function(a){this._settingsStore.get("isPlaylistEnabled",a)},e.prototype.setPlaylistEnabled=function(a,b){this._settingsStore.set("isPlaylistEnabled",a,b)},e.prototype.setSubtitleStyles=function(a,b){this._settingsStore.set("subtitleStyles",a,b)},e.prototype.getSubtitleStyles=function(a){this._settingsStore.get("subtitleStyles",function(b){b||(b={size:"small",position:"bottom",color:"1"}),a&&a(b)})},e.prototype.getLibraryRescanDates=function(a){this._settingsStore.get("libraryRescanDates",function(b){if(!b){var c=+Date.now();b={},b[FileSystemScanner.DirectoryPriority.VERY_LIKELY]=c-2e3,b[FileSystemScanner.DirectoryPriority.LIKELY]=c-2e3,b[FileSystemScanner.DirectoryPriority.PROBABLE]=c-2e3,b[FileSystemScanner.DirectoryPriority.UNLIKELY]=c-2e3}a&&a(b)})},e.prototype.setLibraryRescanDates=function(a,b){this._settingsStore.set("libraryRescanDates",a,b)},e.prototype.setLibraryLastScanDate=function(a,b){this._settingsStore.set("libraryLastRescanDate",+a,b)},e.prototype.getLibraryLastScanDate=function(a){this._settingsStore.get("libraryLastRescanDate",function(b){b||(b=+Date.now()-2e3),a&&a(new Date(b))})},e.prototype.getLibraryEntryIds=function(a){this._settingsStore.get("libraryEntries",function(b){b||(b=[]),a&&a(b)})},e.prototype.setLibraryEntries=function(a,b){this._settingsStore.set("libraryEntries",a,b)},e.prototype.addLibraryEntryId=function(a,b){var c=this;this._settingsStore.get("libraryEntries",function(d){d.push(a),c.setLibraryEntries(d,b)})},e.prototype.getUniqueId=function(a){var b=this;this._settingsStore.get("uniqueId",function(c){null==c&&(c=Uuid.generate(),b._settingsStore.set("uniqueId",c)),a&&a(c)})},e.prototype.getComputerName=function(a){var b=this;this._settingsStore.get("computerName",function(c){if(!c){var d="What?";navigator.appVersion.indexOf("Win")!=-1&&(d="Windows"),navigator.appVersion.indexOf("Mac")!=-1&&(d="Mac"),navigator.appVersion.indexOf("Linux")!=-1&&(d="Linux"),c="Videostream for "+d,b.setComputerName(c)}a(c)})},e.prototype.setComputerName=function(a,b){this._settingsStore.set("computerName",a,b)},e.prototype.getTrialInformation=function(a){var b=this;this._settingsStore.get("trialInformation",function(c){var d=!1;c||(c={},d=!0),void 0===c.remainingDownloadNotifications&&(c.remainingDownloadNotifications=10,d=!0),d&&b.setTrialInformation(c),a&&a(c)})},e.prototype.setTrialInformation=function(a,b){this._settingsStore.set("trialInformation",a,b)},e.prototype.getPortfixState=function(a){var b=this;this._settingsStore.get("portfixState",function(c){null==c&&(c=!1,b._settingsStore.set("portfixState",c)),a&&a(c)})},e.prototype.setPortfixState=function(a,b){this._settingsStore.set("portfixState",a,b)},e.prototype.getTotalWatchedTime=function(a){var b=this;this._settingsStore.get("totalWatchedTime",function(c){null==c&&(c=0,b._settingsStore.set("totalWatchedTime",0)),a&&a(c)})},e.prototype.incrementTotalWatchedTime=function(a,b){var c=this;this._settingsStore.get("totalWatchedTime",function(d){null==d?(d=0,c._settingsStore.set("totalWatchedTime",0)):(d+=a,c._settingsStore.set("totalWatchedTime",d)),b&&b(d)})},e.prototype.getWatchedFirstVideo=function(a){this._settingsStore.get("watchedFirstVideo",function(b){a&&a(b===!0)})},e.prototype.setWatchedFirstVideo=function(a){var b=this;this.getWatchedFirstVideo(function(c){c?a&&a():b._settingsStore.set("watchedFirstVideo",!0,function(){a&&a()})})},e.prototype.getLaunchCount=function(a){var b=this;this._settingsStore.get("launchCount",function(c){null==c&&(c=0,b._settingsStore.set("launchCount",c)),a&&a(c)})},e.prototype.setLaunchCount=function(a,b){this._settingsStore.set("launchCount",a,b)},e.prototype.getReceiverVersion=function(a){this._settingsStore.get("receiverVersion",function(b){a&&a(b)})},e.prototype.setReceiverVersion=function(a,b){this._settingsStore.set("receiverVersion",a,b)},e.prototype.getStripeSubscriptionCancellationDate=function(a){this._settingsStore.get("stripeSubscriptionCancellationDate",function(b){a&&a(b)})},e.prototype.setStripeSubscriptionCancellationDate=function(a,b){this._settingsStore.set("stripeSubscriptionCancellationDate",a,b)},e.prototype.getPaypalSubscriptionCancellationDate=function(a){this._settingsStore.get("paypalSubscriptionCancellationDate",function(b){a&&a(b)})},e.prototype.setPaypalSubscriptionCancellationDate=function(a,b){this._settingsStore.set("paypalSubscriptionCancellationDate",a,b)},e.prototype.getLocationCached=function(a){var b="VideoStreamSettingsLocationOfIp",c=this;this._settingsCache.get(b,function(b){b?c._parseLocation(b,a):a("NotCached",null)})},e.prototype.getLocation=function(a){var b="VideoStreamSettingsLocationOfIp",c=this;this._settingsCache.get(b,function(d){if(d)c._parseLocation(d,a);else{var e="https://identity.getvideostream.com/location",f=new XMLHttpRequest;f.open("GET",e,!0),f.onreadystatechange=function(){if(4==this.readyState){var d=null;try{d=JSON.parse(this.response)}catch(b){return a("error parsing responseFromWebsite",null),void console.error("VideostreamSettings.getLocation: Error parsing response from website.")}if(d&&d.success){var e=d.result.slice(1,-1),f=18144e5,g=Date.now()+f;c._settingsCache.set(b,e,g,null),c._parseLocation(e,a)}else a("error parsing responseFromWebsite",null),console.error("VideostreamSettings.getLocation: IP returned error: "+d.reason)}},f.send()}})},e.prototype._parseLocation=function(a,b){var c=null;if(a){var d=JSON.parse(a);c={city:d[0],state:d[1],country:d[2],latitude:d[4],longitude:d[5],countryAbbrev:d[6]}}else console.error("VIDEOSTREAMSETTINGS","_parseLocation error: no location object");b&&b(null,c)},e.prototype.setLastChatRequestDate=function(a){this._settingsStore.set("lastChatRequestDate",a)},e.prototype.getLastChatRequestDate=function(a){this._settingsStore.get("lastChatRequestDate",function(b){a&&a(b||null)})},e.prototype.setHasSubmittedEmail=function(a){this._settingsStore.set("hasSubmittedEmail",a)},e.prototype.getHasSubmittedEmail=function(a){this._settingsStore.get("hasSubmittedEmail",function(b){a&&a(b||!1)})},e.prototype.setLastEmailRequest=function(a){this._settingsStore.set("lastEmailRequest",a)},e.prototype.getLastEmailRequest=function(a){this._settingsStore.get("lastEmailRequest",function(b){a&&a(b||0)})},e.prototype.setSeenPremiumDialogue=function(a){this._settingsStore.set("seenPremiumNotificationDialogue",a)},e.prototype.getSeenPremiumDialogue=function(a){this._settingsStore.get("seenPremiumNotificationDialogue",function(b){a&&a(b||0)})},e.prototype.saveProgress=function(a,b){var c="SAVELASTPROGRESS."+a,d=12096e5,e=Date.now()+d;this._settingsCache.set(c,b,e,null)},e.prototype.getProgress=function(a,b){var c="SAVELASTPROGRESS."+a;this._settingsCache.get(c,function(a){b(a?a:0)})},e.prototype.saveNonResumeProgress=function(a,b){var c="SAVELASTNONRESUMEPROGRESS."+a,d=12096e5,e=Date.now()+d;this._settingsCache.set(c,b,e,null)},e.prototype.getNonResumeProgress=function(a,b){var c="SAVELASTNONRESUMEPROGRESS."+a;this._settingsCache.get(c,function(a){b(a?a:0)})},e.prototype.deleteProgress=function(a){var b="SAVELASTPROGRESS."+a;this._settingsCache.unset(b,null)},e.prototype.setX264Preset=function(a){this._settingsStore.set("x264Preset",a)},e.prototype.getX264Preset=function(a){this._settingsStore.get("x264Preset",function(b){a&&a(b||"ultrafast")})},e.prototype.saveBitString=function(a,b){var c="BITSTRING."+a,d=12096e5,e=Date.now()+d;this._settingsCache.set(c,b,e,null)},e.prototype.getBitString=function(a,b){var c="BITSTRING."+a;this._settingsCache.get(c,function(a){b(a?a:null)})},e.prototype.setLastUsed=function(a,b){this._settingsStore.set("lastUsed",a,b)},e.prototype.getLastChangeLogVersion=function(a){this._settingsStore.get("lastChangeLogVersion",function(b){a(b||0)})},e.prototype.setLastChangeLogVersion=function(a,b){this._settingsStore.set("lastChangeLogVersion",a,b)},e.prototype.incrementTotalPaused=function(a){function b(a){e._settingsStore.get("totalPauses",function(b){b=b||0,e._settingsStore.set("totalPauses",++b,a)})}function c(a){e._settingsStore.set("dateLastPause",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalBufferingTime=function(a,b){function c(a){f._settingsStore.get("totalBufferingEvents",function(b){b=b||0,f._settingsStore.set("totalBufferingEvents",++b,a)})}function d(b){f._settingsStore.get("totalBufferingTime",function(c){c=c||0,c+=a,f._settingsStore.set("totalBufferingTime",c,b)})}function e(){b&&b()}var f=this;async.parallel([c,d],e)},e.prototype.incrementTotalPlaylistPlays=function(a){function b(a){e._settingsStore.get("totalPlaylistPlays",function(b){b=b||0,e._settingsStore.set("totalPlaylistPlays",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastPlaylistPlay",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalLibraryPlays=function(a){function b(a){e._settingsStore.get("totalLibraryPlays",function(b){b=b||0,e._settingsStore.set("totalLibraryPlays",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastLibraryPlay",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalButtonPlays=function(a){function b(a){e._settingsStore.get("totalButtonPlays",function(b){b=b||0,e._settingsStore.set("totalButtonPlays",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastButtonPlay",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalVideosLoaded=function(a){function b(a){e._settingsStore.get("totalVideosLoaded",function(b){b=b||0,e._settingsStore.set("totalVideosLoaded",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastVideoLoaded",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalLoadSuccesses=function(a){function b(a){e._settingsStore.get("totalLoadSuccesses",function(b){b=b||0,e._settingsStore.set("totalLoadSuccesses",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastLoadSuccess",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalLoadFailures=function(a){function b(a){e._settingsStore.get("totalLoadFailures",function(b){b=b||0,e._settingsStore.set("totalLoadFailures",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastLoadFailure",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalSubtitlesLoaded=function(a){function b(a){e._settingsStore.get("totalSubtitlesLoaded",function(b){b=b||0,e._settingsStore.set("totalSubtitlesLoaded",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastSubtitleLoaded",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalVideoTranscodes=function(a){function b(a){e._settingsStore.get("totalVideoTranscodes",function(b){b=b||0,e._settingsStore.set("totalVideoTranscodes",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastVideoTranscode",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.setDateUserLoggedIn=function(a,b){this._settingsStore.set("dateUserLoggedIn",a,b)},e.prototype.setUserHasViewedAuthScreen=function(a,b){this._settingsStore.set("userHasViewedAuthScreen",a,b)},e.prototype.getUserHasViewedAuthScreen=function(a){this._settingsStore.get("userHasViewedAuthScreen",function(b){a&&a(b||!1)})},e.prototype.setLastCrawlTime=function(a,b){this._settingsStore.set("lastCrawlTime",a,b)},e.prototype.getLastCrawlTime=function(a){this._settingsStore.get("lastCrawlTime",function(b){a&&a(b||0)})},e.prototype.setSplashContentImagesOptIn=function(a,b){this._settingsStore.set("splashContentImagesOptIn",a,b)},e.prototype.getSplashContentImagesOptIn=function(a){this._settingsStore.get("splashContentImagesOptIn",function(b){null==b&&(b=!0),a&&a(b)})},e.prototype.setContentScreenshotOptIn=function(a,b){this._settingsStore.set("contentScreenshotOptIn",a,b)},e.prototype.getContentScreenshotOptIn=function(a){this._settingsStore.get("contentScreenshotOptIn",function(b){null==b&&(b=!0),a&&a(b)})},e.prototype.updateContinueWatchingList=function(a,b){this._settingsStore.set("continueWatchingList",a,b)},e.prototype.getContinueWatchingList=function(a){this._settingsStore.get("continueWatchingList",function(b){a&&a(b||[])})},e.prototype.getClientUUID=function(a){var b=this;this._settingsStore.get("clientUUID",function(c){c||(c=uuid.v4(),b._settingsStore.set("clientUUID",c)),a&&a(c)})},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:a.VideostreamSettings=e}(b),function(a){var b=a.SettingsCache||require("common/SettingsCache"),c=function(){};c._PREFIX="CachedRemoteFile:",c.NO_CACHE=0,c.ERRORS={FETCH_ERROR:"fetch_error",PARSE_ERROR:"parse_error",CACHE_ERROR:"cache_error"},c._setCache=function(a,b,d,e,f){a.set(c._PREFIX+b,d,Date.now()+e,f)},c._getCache=function(a,b,d){a.get(c._PREFIX+b,d)},c._fetch=function(a,b){a+=a.indexOf("?")>-1?"&":"?",a+="rand="+Date.now();var d=new XMLHttpRequest;d.open("GET",a),d.onload=function(){if(200==d.status){var a=null;try{a=JSON.parse(d.responseText)}catch(a){}a?b&&b(null,a):b&&b(c.ERRORS.PARSE_ERROR),b=null}else b&&b(c.ERRORS.FETCH_ERROR),b=null},d.onerror=function(){b&&b(c.ERRORS.FETCH_ERROR),b=null},d.send()},c.fetch=function(a,d,e){function f(b){function d(a){a?b&&b(null,a):g(b)}c._getCache(h,a,d)}function g(b){function e(e,f){function g(){b&&b(null,f)}!e&&f?d===c.NO_CACHE?g():c._setCache(h,a,f,d,g):b&&b(e)}c._fetch(a,e)}var h=b.getInstance();d===c.NO_CACHE?g(e):f(e)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.CachedRemoteFile=c}(b),function(a){var b=a.CachedRemoteFile||require("common/CachedRemoteFile"),c=null,d=function(){};d.URL="http://getvideostream.com/settings/videostream-settings.json",d.CACHE_DURATION=432e5,d.fetch=function(a){function e(a,b){!a&&b?d._callbackAll(b):d._callbackAll(null)}c?c.push(a):(c=[a],b.fetch(d.URL,d.CACHE_DURATION,e))},d._callbackAll=function(a){for(var b=0;b<c.length;b++)c[b].call(null,a);c=null},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=d:a.RemoteSettings=d}(b),function(a){var b=a.CachedRemoteFile||require("common/CachedRemoteFile"),c=function(){};c.URL="http://getvideostream.com/settings/changelog.json",c.CACHE_DURATION=2592e5,c.fetch=function(a){function d(b,c){a(!b&&c?c:null)}b.fetch(c.URL,c.CACHE_DURATION,d)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.ChangeLogRemoteFile=c}(b),function(b){var c=b.EventEmitter||require("lib/EventEmitter"),d=function(a){c.call(this),this._appId=a};d.prototype=Object.create(c.prototype),d.CHROMECAST_APP_ID="0A11BFA7",d.ERROR_NO_CHROMECAST_API="NoChromecastAPI",d.ERROR_CANCELLED="Cancelled",d.ERROR_COMMUNICATION="CommunicationError",d.ERROR_NO_EXTENSION="NoExtension",d.ERROR_EXTENSION_NOT_COMPATIBLE="IncompatibleExtension",d.ERROR_INVALID_PARAMETER="InvalidParameter",d.ERROR_LOAD_MEDIA_FAILED="LoadMediaFailed",d.ERROR_LOAD_MEDIA_NETWORK_ERROR="LoadMediaNetworkError",d.ERROR_RECEIVER_UNAVAILABLE="ReceiverUnavailable",d.ERROR_SESSION="SessionError",d.ERROR_TIMED_OUT="Timeout",d.ERROR_NO_MEDIA="NoMedia",d.prototype.getAppId=function(){return this._appId},d.prototype.isNewApi=function(){return a.cast.ApiBootstrap_.MR_EXTENSION_IDS_.indexOf(a.cast.extensionId)>-1},d.prototype.isNewApiAsync=function(b){a.cast&&a.cast.isAvailable?b(null,this.isNewApi()):setTimeout(this.isNewApiAsync.bind(this,b),500)},d.checkAPIExists=function(b){function c(a){a?b&&b(!0):b&&b(!1)}a.cast?a.cast&&a.cast.isAvailable?b&&b(!0):a.cast&&!a.cast.isAvailable&&a.cast.ApiBootstrap_.findAndAttachInstalledExtension_(c):b&&b(!1)},d.waitForAPI=function(b,c){function e(e){e?(d._ERRORS={},d._ERRORS[a.cast.ErrorCode.API_NOT_INITIALIZED]=d.ERROR_NO_CHROMECAST_API,d._ERRORS[a.cast.ErrorCode.CANCEL]=d.ERROR_CANCELLED,d._ERRORS[a.cast.ErrorCode.CHANNEL_ERROR]=d.ERROR_COMMUNICATION,d._ERRORS[a.cast.ErrorCode.EXTENSION_MISSING]=d.ERROR_NO_EXTENSION,d._ERRORS[a.cast.ErrorCode.EXTENSION_NOT_COMPATIBLE]=d.ERROR_EXTENSION_NOT_COMPATIBLE,d._ERRORS[a.cast.ErrorCode.INVALID_PARAMETER]=d.ERROR_INVALID_PARAMETER,d._ERRORS[a.cast.ErrorCode.LOAD_MEDIA_FAILED]=d.ERROR_LOAD_MEDIA_FAILED,d._ERRORS[a.cast.ErrorCode.RECEIVER_UNAVAILABLE]=d.ERROR_RECEIVER_UNAVAILABLE,d._ERRORS[a.cast.ErrorCode.SESSION_ERROR]=d.ERROR_SESSION,d._ERRORS[a.cast.ErrorCode.TIMEOUT]=d.ERROR_TIMED_OUT,c&&c()):(Date.now()-g>=3e3&&b&&b(),setTimeout(f,500))}function f(){d.checkAPIExists(e)}var g=Date.now();f()},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=d:b.ChromecastBase=d}(b);var c=function(a){ChromecastBase.call(this,a),this._receiverActionListenerBind=this._receiverActionListener.bind(this),this._session=null,this._receiverUpdate=null,this._hasLostSession=0,this._hasLostSessionBeforeTwoMinutes=0,this._hasEmittedError=!1,this._hasLostSessionBlock=!1,this._currentTime=0};c.prototype=Object.create(ChromecastBase.prototype),c.waitForAPI=ChromecastBase.waitForAPI,c.checkAPIExists=ChromecastBase.checkAPIExists,c.prototype.initialize=function(b,c){function d(){function b(){console.log("Chromecast.initialize: Successfully initialized Chromecast API."),a.cast.addReceiverActionListener(e._receiverActionListenerBind),c&&c(null)}function d(a){console.warn("Chromecast.initialize: Failed to initialize Chromecast API.",a.description),c&&c(ChromecastBase._ERRORS[a.code])}a.cast.initialize(g,b,d)}var e=this,f=new a.cast.SessionRequest(this.getAppId());this._onSessionStatusUpdateBind=this._onSessionStatusUpdate.bind(this);var g=new a.cast.ApiConfig(f,this._sessionListener.bind(this),this._receiverListener.bind(this),a.cast.AutoJoinPolicy.PAGE_SCOPED,a.cast.DefaultActionPolicy.CREATE_SESSION);d()},c.prototype.reinitialize=function(b){a.cast.removeReceiverActionListener(this._receiverActionListenerBind);var c=this;a.cast.ApiBootstrap_.findAndAttachInstalledExtension_(function(){c.initialize(c.getAppId(),b)},!0)},c.prototype._receiverActionListener=function(a,b){"stop"===b&&(inject("AnalyticsInterface").triggerCastApiActionStop(),this._hasLostSessionBlock=!0)},c.prototype.hasSession=function(a){a(this._hasSession())},c.prototype._hasSession=function(){return this._session&&this._session.status===a.cast.SessionStatus.CONNECTED},c.prototype.openSession=function(b){function c(a){inject("BackgroundCommunicator").triggerWallFunnel(8,"Chose Chromecast"),e._setSession(a),b&&b(null)}function d(c){"extension_missing"===c.code?e.reinitialize(function(){e.openSession(b)}):(e._hasReceivers()||(c=c||{},c.code=c.code||a.cast.ErrorCode.RECEIVER_UNAVAILABLE,c.description=c.description||a.cast.ErrorCode.RECEIVER_UNAVAILABLE,e._doReceiverStatusBroadcast(),inject("AnalyticsInterface").triggerAppLauncherUnavailableError()),console.warn("Chromecast.requestSession: Failed to obtain session. ",c.description),b&&b(ChromecastBase._ERRORS[c.code])),!e._session&&e.isNewApi()&&e.emit("session",null)}var e=this;this._doReceiverStatusBroadcast(),this.emit("request-session"),a.cast.requestSession(c,d)},c.prototype.openSessionById=function(b,c){function d(){a.cast.requestSessionById(b),c&&c()}this._doReceiverStatusBroadcast(),this._hasSession()?this._session.sessionId!==b?(console.log("Chromecast.requestSessionById: Leaving existing session..."),d()):c&&c():d()},c.prototype.leaveSession=function(a){function b(){console.log("Chromecast.leaveSession: Successfully left session."),d._unsetSession(),a&&a(null)}function c(b){console.warn("Chromecast.leaveSession: Failed to leave session.",b.description),a&&a(ChromecastBase._ERRORS[b.code])}var d=this;this._hasSession()?this._session.leave(b,c):b()},c.prototype._unsetSession=function(){this._session&&(this._session.removeUpdateListener(this._onSessionStatusUpdateBind),this._session=null,this.emit("session",null))},c.prototype._setSession=function(a){var b=null;this._session&&(b=this._session.sessionId,this._session.removeUpdateListener(this._onSessionStatusUpdateBind)),a.addUpdateListener(this._onSessionStatusUpdateBind),this._session=a,b!==a.sessionId&&this.emit("session",a.sessionId,a.receiver.friendlyName)},c.prototype._onSessionStatusUpdate=function(a){if(a?inject("AnalyticsInterface").triggerCastApiStatusTrue():inject("AnalyticsInterface").triggerCastApiStatusFalse(),a)this._hasLostSessionBlock=!1;else if(this._hasLostSessionBlock)this._hasLostSessionBlock=!1;else if(this._hasLostSession++,inject("AnalyticsInterface").triggerCastApiUnwarrantedDisconnect(this._hasLostSession),this._currentTime<120&&(this._hasLostSessionBeforeTwoMinutes++,inject("AnalyticsInterface").triggerCastApiUnwarrantedDisconnectUnderTwoMinutes(this._hasLostSessionBeforeTwoMinutes)),this._hasLostSessionBeforeTwoMinutes>3&&!this._hasEmittedError){this._hasEmittedError=!0;var b=new DialogView("#help-dialog-drop",{dismissElements:".dismiss"});b.show()}},c.prototype.setCurrentTime=function(a){this._currentTime=a},c.prototype._sessionListener=function(a){function b(){c._setSession(a)}var c=this;this._hasSession()&&this._session.sessionId!==a.sessionId?this.leaveSession(b):b()},c.prototype._receiverListener=function(a){this._receiverUpdate=a,this._hasReceivers()&&this.emit("receivers-available")},c.prototype._doReceiverStatusBroadcast=function(){var a=this;setTimeout(function(){a._hasReceivers()?(inject("BackgroundCommunicator").triggerWallFunnel(7,"Has Receivers"),a.emit("receivers-available")):a.emit("receivers-unavailable")},2500)},c.prototype._hasReceivers=function(){return this._receiverUpdate===a.cast.ReceiverAvailability.AVAILABLE},function(b){var c=b.EventEmitter||require("lib/EventEmitter"),d=function(a){return c.call(this),d.instance?d.instance:(this._isBackground=a,this._cbList={},this._portList=[],this._initialize(),void(d.instance=this))};d.prototype=Object.create(c.prototype),d.prototype._initialize=function(){if(this._isBackground)a.runtime.onConnect.addListener(this._onPortConnect.bind(this));else{var b=a.runtime.connect();this._onPortConnect(b)}},d.prototype._onPortConnect=function(a){this._portList.push(a),a.onDisconnect.addListener(this._onPortDisconnect.bind(this,a)),a.onMessage.addListener(this._onMessage.bind(this)),this.emit("port-connected")},d.prototype._onPortDisconnect=function(a){this._portList.splice(this._portList.indexOf(a),1),this._isBackground||this._initialize()},d.prototype._onMessage=function(a){var b=a,c=b.args,d=b._cb,e=b.isCb;if(e){if(!this._cbList[d])return;return this._cbList[d].apply(null,c),void delete this._cbList[d]}if(d){var f=this,g=[].concat(c);g.push(function(){for(var a={args:[].slice.apply(arguments),_cb:d,isCb:!0},b=0;b<f._portList.length;b++){var c=f._portList[b];c.postMessage(a)}}),this.emit.apply(this,g)}else this.emit.apply(this,c)},d.prototype.send=d.prototype.postMessage=function(){var a=[].slice.apply(arguments),b=null;"function"==typeof a[a.length-1]&&(b=a.pop());var c={args:a};b&&(c._cb=Uuid.generate(),this._cbList[c._cb]=b);for(var d=0;d<this._portList.length;d++){var e=this._portList[d];e.postMessage(c)}},d.prototype._onError=function(){},d.prototype.postTo=function(){var a=[].slice.apply(arguments),b=null,c=a.shift();"function"==typeof a[a.length-1]&&(b=a.pop());var d={args:a,to:c};b&&(d._cb=Uuid.generate(),this._cbList[d._cb]=b),this.worker.port.postMessage(d)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=d:b.SuperWorker=d;
}(b);var d=function(a){EventEmitter.call(this),this._analytics=inject("AnalyticsInterface"),this._settingsStore=inject("SettingsStore"),this._proxy=new SuperWorker((!1)),this._bindEvents()};d.prototype=Object.create(EventEmitter.prototype),d.prototype._bindEvents=function(){this._settingsStore.on("localchange",this._onLocalSettingChanged.bind(this)),this._proxy.on("settingChanged",this._onRemoteSettingChanged.bind(this)),this._proxy.on("setupComplete",this._onProxySetupComplete.bind(this)),this._proxy.on("snap",this._onSnap.bind(this)),this._proxy.on("resumeVideoPrompt",this._onResumeVideoPrompt.bind(this)),this._proxy.on("downloadUrl",this._onDownloadUrl.bind(this)),this._proxy.on("loadingMedia",this._onLoadingMedia.bind(this)),this._proxy.on("premium",this._onPremium.bind(this)),this._proxy.on("standard",this._onStandard.bind(this)),this._proxy.on("playing",this._onPlaying.bind(this)),this._proxy.on("paused",this._onPaused.bind(this)),this._proxy.on("title",this._onTitle.bind(this)),this._proxy.on("subtitle",this._onSubtitle.bind(this)),this._proxy.on("progress",this._onProgress.bind(this)),this._proxy.on("duration",this._onDuration.bind(this)),this._proxy.on("seek",this._onSeek.bind(this)),this._proxy.on("volume",this._onVolume.bind(this)),this._proxy.on("probing",this._onProbing.bind(this)),this._proxy.on("probeComplete",this._onProbeComplete.bind(this)),this._proxy.on("loaded",this._onLoaded.bind(this)),this._proxy.on("unloaded",this._onUnloaded.bind(this)),this._proxy.on("qualityPresetSelected",this._onQualityPresetSelected.bind(this)),this._proxy.on("audioTrackAdded",this._onAudioTrackAdded.bind(this)),this._proxy.on("audioTrackRemoved",this._onAudioTrackRemoved.bind(this)),this._proxy.on("audioTrackSelected",this._onAudioTrackSelected.bind(this)),this._proxy.on("subtitleTrackAdded",this._onSubtitleTrackAdded.bind(this)),this._proxy.on("subtitleTrackRemoved",this._onSubtitleTrackRemoved.bind(this)),this._proxy.on("subtitleTrackSelected",this._onSubtitleTrackSelected.bind(this)),this._proxy.on("subtitleOffsetSet",this._onSubtitleOffsetSet.bind(this)),this._proxy.on("subtitleFormatUnsupported",this._onSubtitleFormatUnsupported.bind(this)),this._proxy.on("subtitleTooLarge",this._onSubtitleTooLarge.bind(this)),this._proxy.on("remoteSubsMessage",this._onRemoteSubsMessage.bind(this)),this._proxy.on("loaderIncompatibleFilePrompt",this._onLoaderIncompatibleFilePrompt.bind(this)),this._proxy.on("loader-cancel",this._onLoaderCancel.bind(this)),this._proxy.on("select-chromecast-animation",this._onSelectChromecastAnimation.bind(this)),this._proxy.on("computerNameChange",this._onComputerNameChange.bind(this)),this._proxy.on("subtitleStylesChange",this._onSubtitleStylesChange.bind(this)),this._proxy.on("externalSubtitleEncodingChange",this._onExternalSubtitleEncodingChange.bind(this)),this._proxy.on("defaultAudioLanguageChange",this._onDefaultAudioLanguageChange.bind(this)),this._proxy.on("defaultSubtitleLanguageChange",this._onDefaultSubtitleLanguageChange.bind(this)),this._proxy.on("subtitleLoadingChanged",this._onSubtitleLoadingChange.bind(this)),this._proxy.on("portfixStateChanged",this._onPortfixStateChanged.bind(this)),this._proxy.on("videoQualityChange",this._onVideoQualityChange.bind(this)),this._proxy.on("fivePointOnePolicyChange",this._onFivePointOnePolicyChange.bind(this)),this._proxy.on("x264PresetChange",this._onX264PresetChange.bind(this)),this._proxy.on("castDeviceAdded",this._onCastDeviceAdded.bind(this)),this._proxy.on("castDeviceRemoved",this._onCastDeviceRemoved.bind(this)),this._proxy.on("castDeviceUpdated",this._onCastDeviceUpdated.bind(this)),this._proxy.on("castSessionRequested",this._onCastSessionRequested.bind(this)),this._proxy.on("castSessionRequestCancelled",this._onCastSessionRequestCancelled.bind(this)),this._proxy.on("castSessionConnected",this._onCastSessionConnected.bind(this)),this._proxy.on("castSessionReconnected",this._onCastSessionReconnected.bind(this)),this._proxy.on("castSessionDisconnected",this._onCastSessionDisconnected.bind(this)),this._proxy.on("castMediaLoadError",this._onCastMediaLoadError.bind(this)),this._proxy.on("castMediaLoadSuccess",this._onCastMediaLoadSuccess.bind(this)),this._proxy.on("castBuffering",this._onCastBuffering.bind(this)),this._proxy.on("castSupportsScale",this._onCastSupportsScale.bind(this)),this._proxy.on("scaleSettingChanged",this._onScaleSettingChanged.bind(this)),this._proxy.on("videoCanScale",this._onVideoCanScale.bind(this)),this._proxy.on("triggerChromecastConnectTimeout",this._onTriggerChromecastConnectTimeout.bind(this)),this._proxy.on("playerBusy",this._onPlayerBusy.bind(this)),this._proxy.on("playerReady",this._onPlayerReady.bind(this)),this._proxy.on("playerComplete",this._onPlayerComplete.bind(this)),this._proxy.on("buffering",this._onBackgroundBuffering.bind(this)),this._proxy.on("bufferingStable",this._onBackgroundBufferingStable.bind(this)),this._proxy.on("load-media-offline",this._onBackgroundLoadMediaOffline.bind(this)),this._proxy.on("load-media-online",this._onBackgroundLoadMediaOnline.bind(this)),this._proxy.on("load-media-loading",this._onLoadMediaLoading.bind(this)),this._proxy.on("network-detect-failure",this._onNetworkDetectFail.bind(this)),this._proxy.on("network-detect-success",this._onNetworkDetectSuccess.bind(this)),this._proxy.on("native-client-crashed",this._onNativeClientCrashed.bind(this)),this._proxy.on("native-client-loaded",this._onNativeClientLoaded.bind(this)),this._proxy.on("native-client-plugin-missing",this._onNativeClientMissingPlugin.bind(this)),this._proxy.on("playlistList",this._onPlaylistList.bind(this)),this._proxy.on("playlistLoaded",this._onPlaylistLoaded.bind(this)),this._proxy.on("playlistAdded",this._onPlaylistAdded.bind(this)),this._proxy.on("playlistRemoved",this._onPlaylistRemoved.bind(this)),this._proxy.on("playlistUpdated",this._onPlaylistUpdated.bind(this)),this._proxy.on("playlistRepeatModeChange",this._onPlaylistRepeatModeChange.bind(this)),this._proxy.on("playlistFileAdded",this._onPlaylistFileAdded.bind(this)),this._proxy.on("playlistFileRemoved",this._onPlaylistFileRemoved.bind(this)),this._proxy.on("playlistFileUpdate",this._onPlaylistFileUpdate.bind(this)),this._proxy.on("playlistFileList",this._onPlaylistFileList.bind(this)),this._proxy.on("playlistPosition",this._onPlaylistPosition.bind(this)),this._proxy.on("playlistFileNotFound",this._onPlaylistFileNotFound.bind(this)),this._proxy.on("playlistComplete",this._onPlaylistComplete.bind(this)),this._proxy.on("library-setup",this._onLibrarySetup.bind(this)),this._proxy.on("library-directories-list",this._onLibraryDirectoriesList.bind(this)),this._proxy.on("library-directories-added",this._onLibraryDirectoriesAdded.bind(this)),this._proxy.on("library-directories-added-duplicate",this._onLibraryDirectoriesAddedDuplicate.bind(this)),this._proxy.on("library-directories-removed",this._onLibraryDirectoriesRemoved.bind(this)),this._proxy.on("library-scan-begin",this._onLibraryScanBegin.bind(this)),this._proxy.on("library-scan-end",this._onLibraryScanEnd.bind(this)),this._proxy.on("library-recently-added-videos",this._onLibraryRecentlyAddedVideos.bind(this)),this._proxy.on("library-download-complete",this._onLibraryDownloadComplete.bind(this)),this._proxy.on("show-edit-folder-dialog",this._onShowEditFolderDialog.bind(this)),this._proxy.on("receiverVersionChanged",this._onReceiverVersionChanged.bind(this)),this._proxy.on("played-20-percent",this._onPlayed20Percent.bind(this)),this._proxy.on("played-80-percent",this._onPlayed80Percent.bind(this)),this._proxy.on("idle-state-changed",this._onIdleStateChanged.bind(this)),this._proxy.on("continue-watching-file-failed-to-load",this._onContinueWatchingFileFailedToLoad.bind(this)),this._proxy.on("prompt-next-episode",this._onPromptNextEpisode.bind(this)),this._proxy.on("next-episode-cancelled",this._onNextEpisodeCancelled.bind(this)),this._proxy.on("videostream-platform-info",this._onPlatformInfoGiven.bind(this)),this._proxy.on("recent-download-continue-option",this._onRecentDownloadContinueOption.bind(this)),this._analytics.hijackEvents(this._onAnalyticsEvent.bind(this)),this._analytics.hijackAppViews(this._onAnalyticsAppView.bind(this)),this._proxy.on("recently-downloaded-files",this._onRecentlyDownloadedFiles.bind(this)),this._proxy.on("video-screenshot",this._onRecentlyDownloadedScreenshot.bind(this)),this._proxy.on("file-not-found",this._onFileNotFound.bind(this))},d.prototype.uninstallSelf=function(){this._proxy.send("uninstall-self")},d.prototype._onLocalSettingChanged=function(a,b){this._proxy.send("settingChanged",a,b)},d.prototype._onRemoteSettingChanged=function(a,b){this._settingsStore.remoteSettingChanged(a,b)},d.prototype._onAnalyticsEvent=function(){var a=[].slice.call(arguments);a.unshift("analytics-event"),this._proxy.send.apply(this._proxy,a)},d.prototype._onAnalyticsAppView=function(){var a=[].slice.call(arguments);a.unshift("analytics-app-view"),this._proxy.send.apply(this._proxy,a)},d.prototype._onResumeVideoPrompt=function(a){this.emit("resume-video-prompt",a)},d.prototype.userSelectedVideoStartTime=function(a){this._proxy.send("userSelectedStartTimeVideo",a)},d.prototype._onLoad=function(){this.emit("desktop-loaded")},d.prototype.setup=function(){var a=this;b.requestAnimationFrame(function(){a._proxy.send("setup"),setTimeout(function(){console.log("waiting-for-background"),a._proxy.send("waiting-for-background")},50)})},d.prototype.downloadLogs=function(){this._proxy.send("generateLogs")},d.prototype.killSwitch=function(a){this._proxy.send("kill-switch",a||"other")},d.prototype.triggerWallFunnel=function(a,b){this._proxy.send("trigger-wall-funnel",a,b)},d.prototype.launchPremiumCheckout=function(){this._proxy.send("launchPremiumCheckout")},d.prototype._onLoadingMedia=function(a){this.emit("loading-movie",a)},d.prototype._onDownloadUrl=function(a,b){var c=document.createElement("a");c.href=a,c.download=b,c.classList.add("log-file"),document.body.appendChild(c),c.click(),c.remove()},d.prototype._onProxySetupComplete=function(){this._proxy.send("ready"),this.emit("ready"),this.libraryGetDirectories()},d.prototype._onSnap=function(a){this.emit("snap",a)},d.prototype.selectMedia=function(){this._proxy.send("selectMedia")},d.prototype.loadMedia=function(b){var c=new CustomEvent("load-plain-files",{detail:b});a.runtime.getBackgroundPage(function(a){a.dispatchEvent(c)})},d.prototype.loadDroppedMedia=function(a){this._proxy.send("loadDroppedMedia",a)},d.prototype.launchUrl=function(a){this._proxy.send("launchUrl",a)},d.prototype.forceLoad=function(){this._proxy.send("forceLoad")},d.prototype.cancelLoad=function(){this._proxy.send("cancelLoad"),this.emit("stopping")},d.prototype.reloadMedia=function(){this._proxy.send("reloadMedia")},d.prototype.play=function(){this._proxy.send("play")},d.prototype.pause=function(){this._proxy.send("pause")},d.prototype.setQualityPreset=function(a){this._proxy.send("setQualityPreset",a)},d.prototype.setForcedAdaptiveState=function(a){this._proxy.send("setForcedAdaptiveState",a)},d.prototype.stop=function(){this._proxy.send("stop"),this.emit("stopping")},d.prototype.seekSeconds=function(a){this._proxy.send("seekSeconds",a)},d.prototype.seek=function(a){this._proxy.send("seek",a)},d.prototype.skipForward=function(a){this._proxy.send("skipForward",a||null)},d.prototype.skipBackward=function(a){this._proxy.send("skipBackward",a||null)},d.prototype.setVolume=function(a){this._proxy.send("setVolume",a)},d.prototype.setMuted=function(a){this._proxy.send("setMuted",a)},d.prototype.setSubtitleTrack=function(a){this._proxy.send("setSubtitleTrack",a)},d.prototype.setSubtitleOffset=function(a){this._proxy.send("setSubtitleOffset",a)},d.prototype.setAudioTrack=function(a){this._proxy.send("setAudioTrack",a)},d.prototype.selectExternalSubtitleFile=function(){this._proxy.send("selectExternalSubtitleFile")},d.prototype.setComputerName=function(a){this._proxy.send("setComputerName",a)},d.prototype.setVideoQuality=function(a){this._proxy.send("setVideoQuality",a)},d.prototype.setFivePointOnePolicy=function(a){this._proxy.send("setFivePointOnePolicy",a)},d.prototype.setSubtitleStyles=function(a){this._proxy.send("setSubtitleStyles",a)},d.prototype.setExternalSubtitleEncoding=function(a){this._proxy.send("setExternalSubtitleEncoding",a)},d.prototype.setDefaultAudioLanguage=function(a){this._proxy.send("setDefaultAudioLanguage",a)},d.prototype.setDefaultSubtitleLanguage=function(a){this._proxy.send("setDefaultSubtitleLanguage",a)},d.prototype.setSubtitleLoading=function(a){this._proxy.send("setSubtitleLoading",a)},d.prototype.selectPlaylist=function(a){this._proxy.send("selectPlaylist",a)},d.prototype.removePlaylist=function(a){this._proxy.send("removePlaylist",a)},d.prototype.addNewPlaylist=function(){this._proxy.send("addNewPlaylist")},d.prototype.setPlaylistTitle=function(a,b){this._proxy.send("setPlaylistTitle",a,b)},d.prototype.setPlaylistRepeatMode=function(a){this._proxy.send("setPlaylistRepeatMode",a)},d.prototype.shufflePlaylist=function(){this._proxy.send("shufflePlaylist")},d.prototype.clearPlaylist=function(){this._proxy.send("clearPlaylist")},d.prototype.playlistNext=function(){this._proxy.send("playlistNext")},d.prototype.playlistPrevious=function(){this._proxy.send("playlistPrevious")},d.prototype.selectPlaylistFile=function(){this._proxy.send("selectPlaylistFile")},d.prototype.addPlaylistMedia=function(a){this._proxy.send("addPlaylistMedia",a)},d.prototype.loadPlaylistMedia=function(a){this._proxy.send("loadPlaylistMedia",a)},d.prototype.removePlaylistFile=function(a){this._proxy.send("removePlaylistFile",a)},d.prototype.updatePlaylistPosition=function(a,b){this._proxy.send("updatePlaylistPosition",a,b)},d.prototype._onPlaylistList=function(a){this.emit("playlist-list",a)},d.prototype._onPlaylistLoaded=function(a){this.emit("playlist-loaded",a)},d.prototype._onPlaylistAdded=function(a){this.emit("playlist-added",a)},d.prototype._onPlaylistRemoved=function(a){this.emit("playlist-removed",a)},d.prototype._onPlaylistUpdated=function(a){this.emit("playlist-updated",a)},d.prototype._onPlaylistRepeatModeChange=function(a){this.emit("playlist-repeat-mode-change",a)},d.prototype._onPlaylistFileAdded=function(a,b){this.emit("playlist-file-added",a,b)},d.prototype._onPlaylistFileRemoved=function(a,b){this.emit("playlist-file-removed",a,b)},d.prototype._onPlaylistFileUpdate=function(a,b){this.emit("playlist-file-update",a,b)},d.prototype._onPlaylistFileList=function(a){this.emit("playlist-file-list",a)},d.prototype._onPlaylistPosition=function(a){this.emit("playlist-position",a)},d.prototype._onPlaylistFileNotFound=function(a,b){this.emit("playlist-file-not-found",a,b)},d.prototype._onPlaylistComplete=function(){this.emit("playlist-complete")},d.prototype.setSocketId=function(a){this._proxy.send("setSocketId",a)},d.prototype.log=function(){var a=[].slice.call(arguments);a.unshift("log"),this._proxy.send.apply(this._proxy,a)},d.prototype._onPremium=function(a){this.emit("premium",a)},d.prototype._onStandard=function(){this.emit("standard")},d.prototype._onPlaying=function(){this.emit("playing")},d.prototype._onPaused=function(){this.emit("paused")},d.prototype._onTitle=function(a){this.emit("title",a)},d.prototype._onSubtitle=function(a){this.emit("subtitle",a)},d.prototype._onProgress=function(a){this.emit("progress",a)},d.prototype._onDuration=function(a){this.emit("duration",a)},d.prototype._onSeek=function(a){this.emit("progress",a)},d.prototype._onVolume=function(a,b){this.emit("volume",a),this.emit("muted",b)},d.prototype._onProbing=function(){this.emit("probing")},d.prototype._onProbeComplete=function(a,b,c,d,e){this.emit("probe-complete",a,b,c,d,e)},d.prototype._onLoaded=function(a){this.emit("loaded",a)},d.prototype._onUnloaded=function(){this.emit("unloaded")},d.prototype._onQualityPresetSelected=function(a){this.emit("quality-preset-selected",a)},d.prototype._onAudioTrackAdded=function(a){this.emit("audio-track-added",a)},d.prototype._onAudioTrackRemoved=function(a){this.emit("audio-track-removed",a)},d.prototype._onAudioTrackSelected=function(a){this.emit("audio-track-selected",a)},d.prototype._onSubtitleTrackAdded=function(a){this.emit("subtitle-track-added",a)},d.prototype._onSubtitleTrackRemoved=function(a){this.emit("subtitle-track-removed",a)},d.prototype._onSubtitleTrackSelected=function(a,b){this.emit("subtitle-track-selected",a,b)},d.prototype._onSubtitleOffsetSet=function(a){this.emit("subtitle-offset-set",a)},d.prototype._onSubtitleFormatUnsupported=function(a){this.emit("subtitle-format-unsupported",a)},d.prototype._onSubtitleTooLarge=function(a){this.emit("subtitle-too-large",a)},d.prototype._onRemoteSubsMessage=function(a){this.emit("remote-subs-msg",a)},d.prototype._onComputerNameChange=function(a){this.emit("computer-name-change",a)},d.prototype._onSubtitleStylesChange=function(a){this.emit("subtitle-styles-change",a)},d.prototype._onExternalSubtitleEncodingChange=function(a){this.emit("external-subtitle-encoding-change",a)},d.prototype._onDefaultAudioLanguageChange=function(a){this.emit("default-audio-language-change",a)},d.prototype._onPortfixStateChanged=function(a){this.emit("portfix-state-changed",a)},d.prototype._onDefaultSubtitleLanguageChange=function(a){this.emit("default-subtitle-language-change",a)},d.prototype._onSubtitleLoadingChange=function(a){this.emit("subtitle-loading-change",a)},d.prototype._onVideoQualityChange=function(a){this.emit("video-quality-change",a)},d.prototype._onFivePointOnePolicyChange=function(a){this.emit("five-point-one-policy-change",a)},d.prototype._onX264PresetChange=function(a){this.emit("x264-preset-change",a)},d.prototype._onCastDeviceAdded=function(a,b,c){this.emit("cast-device-added",a,b,c)},d.prototype._onCastDeviceUpdated=function(a,b,c){this.emit("cast-device-updated",a,b,c)},d.prototype._onCastDeviceRemoved=function(a,b){this.emit("cast-device-removed",a,b)},d.prototype._onCastSessionRequested=function(){this.emit("cast-session-requested")},d.prototype._onCastSessionRequestCancelled=function(){this.emit("cast-session-request-cancelled")},d.prototype._onCastSessionConnected=function(a,b){this.emit("cast-session-connected",a,b)},d.prototype._onCastSessionReconnected=function(a,b){this.emit("cast-session-reconnected",a,b)},d.prototype._onCastSessionDisconnected=function(a){this.emit("cast-session-disconnected",a)},d.prototype._onTriggerChromecastConnectTimeout=function(){this.emit("cast-session-timeout")},d.prototype._onCastMediaLoadError=function(a){this.emit("cast-media-load-error",a)},d.prototype._onCastMediaLoadSuccess=function(){this.emit("cast-media-load-success")},d.prototype._onCastBuffering=function(){this.emit("cast-buffering")},d.prototype._onCastSupportsScale=function(a){this.emit("cast-supports-scale",a)},d.prototype._onScaleSettingChanged=function(a){this.emit("scale-setting-changed",a)},d.prototype.setScaleSetting=function(a){this._proxy.send("setScaleSetting",a)},d.prototype._onVideoCanScale=function(a){this.emit("video-can-scale",a)},d.prototype._onPlayerBusy=function(a){this.emit("player-busy",a)},d.prototype._onPlayerReady=function(){this.emit("player-ready")},d.prototype._onPlayerComplete=function(){this.emit("player-complete")},d.prototype._onBackgroundBuffering=function(){this.emit("buffering")},d.prototype._onBackgroundBufferingStable=function(){this.emit("buffering-stable")},d.prototype._onBackgroundLoadMediaOffline=function(){this.emit("load-media-offline")},d.prototype._onBackgroundLoadMediaOnline=function(){this.emit("load-media-online")},d.prototype._onLoadMediaLoading=function(){this.emit("load-media-loading")},d.prototype._onNetworkDetectFail=function(a){this.emit("network-detect-failure",a)},d.prototype._onNetworkDetectSuccess=function(){this.emit("network-detect-success")},d.prototype._onNativeClientCrashed=function(a){this.emit("native-client-crashed")},d.prototype._onNativeClientLoaded=function(){this.emit("native-client-loaded")},d.prototype._onNativeClientMissingPlugin=function(){this.emit("native-client-missing-plugin")},d.prototype._onShowEditFolderDialog=function(){this.emit("show-edit-folder-dialog")},d.prototype._onLibrarySetup=function(){this.emit("library-setup")},d.prototype._onLibraryDirectoriesList=function(a,b){this.emit("library-directories-list",b)},d.prototype._onLibraryDirectoriesAdded=function(a,b){this.emit("library-directories-added",b)},d.prototype._onLibraryDirectoriesRemoved=function(a,b){this.emit("library-directories-removed",b)},d.prototype._onLibraryDirectoriesAddedDuplicate=function(a,b){this.emit("library-directories-added-duplicate",b)},d.prototype._onLibraryScanBegin=function(){this.emit("library-scan-begin")},d.prototype._onLibraryScanEnd=function(){this.emit("library-scan-end")},d.prototype.libraryAddDirectory=function(){this._proxy.send("libraryAddDirectory"),this.emit("library-add-directory")},d.prototype.libraryRemoveDirectory=function(a){this._proxy.send("libraryRemoveDirectory",a)},d.prototype.libraryPairDevice=function(){this._proxy.send("libraryPairDevice")},d.prototype.libraryGetDirectories=function(){this._proxy.send("libraryGetDirectories")},d.prototype._onBeginPair=function(){this.emit("library-pair-begin")},d.prototype._onCancelPair=function(){this.emit("library-pair-cancel")},d.prototype.completePairRequest=function(a){this._proxy.send("complete-pair-request",a)},d.prototype.setCastSession=function(a,b){this._proxy.send("cast-session-connected",a,b)},d.prototype._onReceiverVersionChanged=function(a){this.emit("receiverVersionChanged",a)},d.prototype._onPlayed20Percent=function(){this.emit("played-20-percent")},d.prototype._onPlayed80Percent=function(){this.emit("played-80-percent")},d.prototype._onIdleStateChanged=function(a){this.emit("idle-state-changed",a)},d.prototype.setHLSEnabled=function(a){this._proxy.send("set-hls-enabled",a)},d.prototype.cancelStripeSubscription=function(){this._proxy.send("cancelStripeSubscription")},d.prototype.cancelPaypalSubscription=function(){this._proxy.send("cancelPaypalSubscription")},d.prototype.submitEmail=function(a,b){this._proxy.send("submit-email",a,b)},d.prototype._onLoaderIncompatibleFilePrompt=function(a){this.emit("incompatible-file-prompt",a)},d.prototype._onLoaderCancel=function(){this.emit("loader-cancel")},d.prototype._onSelectChromecastAnimation=function(){this.emit("select-chromecast-animation")},d.prototype.login=function(){this._proxy.send("login")},d.prototype.userViewedAuthScreen=function(){this._proxy.send("userViewedAuthScreen")},d.prototype.libraryGetRecentlyAddedVideos=function(a){this._proxy.send("libraryGetRecentlyAddedVideos",a)},d.prototype._onLibraryRecentlyAddedVideos=function(a){this.emit("library-recently-added-videos",a)},d.prototype.loadLibraryItem=function(a){this._proxy.send("libraryLoadItem",a)},d.prototype.removeFromContinueWatchingList=function(a){this._proxy.send("removeFromContinueWatchingList",a)},d.prototype.loadFileByRetainedEntry=function(a){this._proxy.send("loadFileByRetainedEntry",a)},d.prototype._onContinueWatchingFileFailedToLoad=function(a){this.emit("continue-watching-file-failed-to-load",a)},d.prototype._onPromptNextEpisode=function(a,b,c){this.emit("prompt-next-episode",a,b,c)},d.prototype._onNextEpisodeCancelled=function(){this.emit("next-episode-cancelled")},d.prototype.cancelNextEpisode=function(){this._proxy.send("cancel-next-episode")},d.prototype.loadNextEpisode=function(){this._proxy.send("load-next-episode")},d.prototype._onRecentlyDownloadedFiles=function(a){this.emit("recently-downloaded-files",a)},d.prototype._onRecentlyDownloadedScreenshot=function(a){this.emit("video-screenshot",a)},d.prototype.getRecentlyDownloaded=function(a){this._proxy.send("recently-downloaded",a)},d.prototype.getRecentlyDownloadedScreenshot=function(a){this._proxy.send("recently-downloaded-screenshot-thing",a)},d.prototype.setFileDeleted=function(a){this._proxy.send("recent-download-deleted",a)},d.prototype._onLibraryDownloadComplete=function(a){this.emit("download-complete",a)},d.prototype.startInitialScan=function(){this._proxy.send("start-initial-scan"),this.emit("library-scan-begin")},d.prototype.startQuickScan=function(){this._proxy.send("start-quick-scan"),this.emit("library-scan-begin")},d.prototype._onFileNotFound=function(a){this.emit("file-not-found",a),this._proxy.send("next-video-loading-cancelled")},d.prototype._onPlatformInfoGiven=function(a,b){this.emit("videostream-platform-info",a,b)},d.prototype.setCastSessionFailed=function(a){this._proxy.send("cast-session-connect-fail",a)},d.prototype._onRecentDownloadContinueOption=function(a){this.emit("recent-download-continue-option",a)},d.prototype._recentDownloadResume=function(a){this._proxy.send("recent-download-resume",a)},function(a){var b=a.EventEmitter||require("lib/EventEmitter"),c=function(a){b.call(this),this._el=document.querySelector(a),this._isShown=!0};c.prototype=Object.create(b.prototype),c.prototype.show=function(a){this._el.style.removeProperty("display"),this._isShown=!0,a||this.emit("show")},c.prototype.hide=function(a){this._el.style.display="none",this._isShown=!1,a||this.emit("hide")},c.prototype.querySelector=function(a){return null==this._el?null:this._el.querySelector(a)},c.prototype.querySelectorAll=function(a){return null==this._el?[]:this._el.querySelectorAll(a)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.ElementView=c}(b),function(a){var b=a.ElementView||require("common/ui/ElementView"),c=function(a){b.call(this,a),this._progressEl=this.querySelector(".seeker-progress"),this._thumbEl=this.querySelector(".seeker-thumb"),this._clickerEl=this.querySelector(".seeker-clicker"),this._progress=0,this._total=1,this._isBeingTouched=!1,this._startX=0,this._startPercent=0,this._bindControls()};c.prototype=Object.create(b.prototype),c.prototype._bindControls=function(){this._onThumbUpBind=this._onThumbUp.bind(this),this._onThumbDragBind=this._onThumbDrag.bind(this),this._clickerEl.addEventListener("click",this._onClick.bind(this)),this._thumbEl.addEventListener("mousedown",this._onThumbDown.bind(this))},c.prototype.setAltStyle=function(a){a?this._el.classList.add("alt-style"):this._el.classList.remove("alt-style")},c.prototype.setTotal=function(a){this._total=a,this._updateProgress(this._progress/this._total),this._isBeingTouched===!1&&this._updateThumb(this._progress/this._total)},c.prototype.getTotal=function(){return this._total},c.prototype.setProgress=function(a){this._progress=a,this._updateProgress(this._progress/this._total),this._isBeingTouched===!1&&this._updateThumb(this._progress/this._total)},c.prototype.getProgress=function(){return this._progress},c.prototype.isBeingTouched=function(){return this._isBeingTouched},c.prototype._updateProgress=function(a){isNaN(a)&&(a=0),a=100*Math.max(Math.min(a,1),0),this._progressEl.style.width=a+"%"},c.prototype._updateThumb=function(a){isNaN(a)&&(a=0),a=100*Math.max(Math.min(a,1),0),this._thumbEl.style.left=a+"%"},c.prototype._onClick=function(a){if(a.target!==this._thumbEl){var b=a.pageX-this._el.offsetLeft,c=b/this._el.clientWidth;this._lastPercentage=c,this._updateThumb(this._lastPercentage),this.emit("progress-changed",this._total*this._lastPercentage)}},c.prototype._onThumbDown=function(b){a.addEventListener("mouseup",this._onThumbUpBind),document.body.addEventListener("mousemove",this._onThumbDragBind),this._startX=b.pageX,this._startPercent=this._el.clientWidth-b.pageX,this._isBeingTouched=!0},c.prototype._onThumbDrag=function(a){var b=this._el.clientWidth,c=a.pageX-this._startX,d=this._startX-this._el.offsetLeft+c;this._lastPercentage=Math.max(Math.min(d/b,1),0),this._updateThumb(this._lastPercentage),this.emit("progress-changed",this._total*this._lastPercentage)},c.prototype._onThumbUp=function(){a.removeEventListener("mouseup",this._onThumbUpBind),document.body.removeEventListener("mousemove",this._onThumbDragBind),this._isBeingTouched=!1,this.emit("progress-changed",this._total*this._lastPercentage)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.SeekerView=c}(b),function(a){var b=a.ElementView||require("common/ui/ElementView"),c=function(a,c){b.call(this,a),this._keyPressBind=this._onKeyPress.bind(this),this._isDismissable=!0,c&&this._initialize(c),this._el.addEventListener("click",this._onClick.bind(this))};c.prototype=Object.create(b.prototype),c.prototype._initialize=function(a){if(a.dismissElements){var b=this.querySelectorAll(a.dismissElements);b&&b.length&&this._initializeDismissElements(b)}a.dismissable===!1&&(this._isDismissable=!1)},c.prototype._initializeDismissElements=function(a){for(var b=0;b<a.length;b++)a[b].addEventListener("click",this.hide.bind(this))},c.prototype._onClick=function(a){for(var b=0;b<a.path.length;b++){var c=a.path[b];if(c&&c.classList&&c.classList.contains("dialog-inner"))return}this._isDismissable&&(this.hide(),this.emit("dismissed"))},c.prototype._onKeyPress=function(a){this._isDismissable&&27===a.which&&(this.hide(),this.emit("dismissed"))},c.prototype.show=function(){var a=this;requestAnimationFrame(function(){a._el.classList.add("visible"),document.body.addEventListener("keydown",a._keyPressBind),a.emit("show")})},c.prototype.hide=function(){var a=this;requestAnimationFrame(function(){a._el.classList.remove("visible"),document.body.removeEventListener("keydown",a._keyPressBind),a.emit("hide")})},c.prototype.isOpen=function(){return this._el.classList.contains("visible")},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.DialogView=c}(b);var e=function(a,b){EventEmitter.call(this),this._el=a,this._checkbox=this._el.children[0],this._label=this._el.children[1],this._isChecked=!1,this._isUncheckable=b,this._isReadOnly=a&&void 0!==a.attributes.readonly,this.setChecked(!1),this._el.addEventListener("click",this._onClick.bind(this)),this._el.addEventListener("mouseover",this._onMouseOver.bind(this)),this._el.addEventListener("mouseout",this._onMouseOut.bind(this))};e.prototype=Object.create(EventEmitter.prototype),e.prototype.setChecked=function(a){this._isChecked=a,a?(this._el.classList.add("checked"),this._checkbox.classList.add("checked")):(this._el.classList.remove("checked"),this._checkbox.classList.remove("checked"))},e.prototype.isChecked=function(){return this._isChecked},e.prototype.getValue=function(){return this._el.getAttribute("value")},e.prototype._onClick=function(){this._isReadOnly||(this._isChecked?this._isUncheckable&&(this.setChecked(!1),this.emit("unchecked")):(this.setChecked(!0),this.emit("checked")))},e.prototype._onMouseOver=function(){this._isReadOnly||(this._el.classList.add("hover"),this._checkbox.classList.add("hover"))},e.prototype._onMouseOut=function(){this._isReadOnly||(this._el.classList.remove("hover"),this._checkbox.classList.remove("hover"))};var f=function(a){e.call(this,a,!1)};f.prototype=Object.create(e.prototype);var g=function(a){e.call(this,a,!0),a.style.transition="border-radius 0.5s ease-in-out",a.style.animation="rotating 2s linear infinite;"};g.prototype=Object.create(e.prototype),g.prototype.check=function(){this._isChecked||(delete this._checkbox.style.borderRadius,this.setChecked(!0),this.emit("checked"))},g.prototype.uncheck=function(){this._isChecked&&this._isUncheckable&&(this.setChecked(!1),this.emit("unchecked"))},g.prototype.startSpinning=function(){this._checkbox.classList.add("checkbox-spin")},g.prototype.stopSpinning=function(){this._checkbox.classList.remove("checkbox-spin")};var h=function(a){EventEmitter.call(this),this._radioButtonList=[],this._checkedRadioButton=null,this._isReadOnly=a.readonly;for(var b=a.querySelectorAll(".radio-button-wrapper"),c=0;c<b.length;c++)this._bindRadioButtonElement(b[c])};h.prototype=Object.create(EventEmitter.prototype),h.prototype._bindRadioButtonElement=function(a){var b=new f(a);b.on("checked",this._onRadioButtonChecked.bind(this,b)),this._radioButtonList.push(b)},h.prototype._onRadioButtonChecked=function(a){for(var b=0;b<this._radioButtonList.length;b++)this._radioButtonList[b]!==a&&this._radioButtonList[b].setChecked(!1);
this._checkedRadioButton=a,this.emit("change",a.getValue())},h.prototype.getValue=function(){return null==this._checkedRadioButton?null:this._checkedRadioButton.getValue()},h.prototype.setValue=function(a){for(var b=0;b<this._radioButtonList.length;b++){var c=this._radioButtonList[b];c.getValue()==a?(c.setChecked(!0),this._checkedRadioButton=c):c.setChecked(!1)}};var i=function(a){e.call(this,a,!0)};i.prototype=Object.create(e.prototype);var j=function(a,b,c){EventEmitter.call(this),this.id=a,this.duration=c||0,this._el=document.createElement("li"),this._el.classList.add("playlist-item");var d=document.createElement("div");d.classList.add("playlist-item-left");var e=document.createElement("div");e.classList.add("playlist-item-right"),this._titleEl=document.createElement("div"),this._titleEl.classList.add("playlist-item-title"),this._removeButtonEl=document.createElement("button"),this._removeButtonEl.classList.add("playlist-item-remove-button"),this._removeButtonEl.classList.add("button-flat"),this._removeButtonEl.classList.add("button-small"),this._removeButtonEl.classList.add("button-clear-grey-alt"),this._removeButtonEl.classList.add("dobby"),this._removeButtonEl.classList.add("dobby-x"),this._imageEl=document.createElement("div"),this._imageEl.classList.add("playlist-item-image"),this._el.appendChild(d),this._el.appendChild(e),d.appendChild(this._imageEl),e.appendChild(this._titleEl),e.appendChild(this._removeButtonEl),this._titleEl.textContent=b,this._el.addEventListener("click",this._onClick.bind(this)),this._removeButtonEl.addEventListener("click",this._onRemoveClick.bind(this))};j.prototype=Object.create(EventEmitter.prototype),j.prototype.getElement=function(){return this._el},j.prototype.toObject=function(){return{id:this.id,name:this._entry.name,duration:this.duration,selected:this._el.classList.contains("selected")}},j.prototype.setIcon=function(a){a?this._imageEl.style.backgroundImage="url('"+a+"')":this._imageEl.style.removeProperty("background-image")},j.prototype.select=function(){this._el.classList.add("selected"),this._el.classList.remove("file-not-found")},j.prototype.unselect=function(){this._el.classList.remove("selected")},j.prototype.click=function(){this._onClick()},j.prototype._onClick=function(a){this._el.classList.contains("selected")||(this.emit("click",this),a.stopPropagation())},j.prototype._onRemoveClick=function(a){a.stopPropagation(),this.emit("remove",this)},j.prototype.fileNotFound=function(){this._el.classList.add("file-not-found")};var k=function(){ElementView.call(this,"#playlist-view"),this._background=inject("BackgroundCommunicator"),this._settings=inject("VideostreamSettings"),this._settingsDialog=inject("SettingsDialog"),this._panelOpen=!1,this._premiumNotificationDialog=new O,this._switchPlaylistNotificationDialog=new P,this._playlist=null,this._items=[],this._suppressedPair=[],this.__onFileClicked=this._onFileClicked.bind(this),this.__onFileRemoveClicked=this._onFileRemoveClicked.bind(this),this.__onPlaylistAddButtonClicked=this._onPlaylistAddButtonClicked.bind(this),this._background.on("premium",this._isPremiumChange.bind(this,!0)),this._background.on("standard",this._isPremiumChange.bind(this,!1)),this._background.on("playlist-loaded",this._playlistLoaded.bind(this)),this._background.on("playlist-updated",this._playlistUpdated.bind(this)),this._background.on("playlist-repeat-mode-change",this._playlistRepeatModeChange.bind(this)),this._background.on("playlist-enabled-change",this._playlistEnabledChange.bind(this)),this._background.on("playlist-file-added",this.add.bind(this)),this._background.on("playlist-file-removed",this.remove.bind(this)),this._background.on("playlist-file-list",this.preload.bind(this)),this._background.on("playlist-file-update",this.update.bind(this)),this._background.on("playlist-position",this.setSelectedPosition.bind(this)),this._background.on("playlist-file-not-found",this._playlistFileNotFound.bind(this)),this._settings.on("isPlaylistEnabledChanged",this._playlistEnabledChange.bind(this)),this.initialize()};k.prototype=Object.create(ElementView.prototype),k.prototype.initialize=function(){var a=this;this._fileListEl=this.querySelector(".playlist-body"),new Slip(this._fileListEl),this._addFileButton=this.querySelector("#button-playlist-add-item"),this._addFileButton.addEventListener("click",this.__onPlaylistAddButtonClicked),this._playlistSelectButton=this.querySelector("#button-playlist-select"),this._playlistSelectButton.addEventListener("click",this._onPlaylistSelectButtonClicked.bind(this)),this._playlistTitle=this.querySelector("#playlist-title"),this._playlistTitle.addEventListener("change",this._onPlaylistTitleChange.bind(this)),this._playlistTitle.addEventListener("focus",this._onPlaylistTitleFocus.bind(this)),this._repeatButton=this.querySelector("#button-playlist-repeat"),this._repeatButton.addEventListener("click",this._onRepeatButtonClicked.bind(this)),this._shuffleButton=this.querySelector("#button-playlist-shuffle"),this._shuffleButton.addEventListener("click",this._onShuffleButtonClicked.bind(this)),this._clearAllButton=this.querySelector("#button-playlist-clear-all"),this._clearAllButton.addEventListener("click",this._onClearAllButtonClicked.bind(this)),this._fileListEl.addEventListener("slip:beforereorder",function(){}),this._fileListEl.addEventListener("slip:reorder",function(b){var c=b.detail.spliceIndex,d=b.detail.originalIndex;if(c!==d){a._background.updatePlaylistPosition(c,d);var e=a._items.splice(d,1);a._items.splice(c,0,e[0])}b.target.parentNode.insertBefore(b.target,b.detail.insertBefore)}),this._fileListEl.addEventListener("slip:beforewait",function(a){a.preventDefault()}),this._dropzone=this.querySelector("#dropzone-playlist"),this._dropzone.addEventListener("dragover",this._onDragover.bind(this)),this._dropzone.addEventListener("drop",this.onDrop.bind(this))},k.prototype._onDragover=function(a){a.preventDefault(),a.dataTransfer.dropEffect="copy"},k.prototype.onDrop=function(b){function c(b,c){var f=b.filter(function(a){return a.isFile}),g=b.filter(function(a){return a.isDirectory});f&&e._background.addPlaylistMedia(f.map(function(b){return a.fileSystem.retainEntry(b)})),async.eachSeries(g,d,c)}function d(a,b){function d(){e.readEntries(function(a){a.length>0?(f=f.concat(a),d()):c(f,b)})}var e=a.createReader(),f=[];d()}b.preventDefault();var e=this,f=[].slice.call(b.dataTransfer.items),g=[];f.forEach(function(a){var b=a.webkitGetAsEntry();b&&g.push(b)}),g&&(this._isPremium?(this._settings.setPlaylistEnabled(!0),c(g)):this._premiumNotificationDialog.show())},k.prototype._isPremiumChange=function(a){this._isPremium=a,this._isPremium&&this._isEnabled?this.show():this.hide()},k.prototype.show=function(a){this._el.style.removeProperty("display"),this._el.classList.add("visible"),this._isShown=!0,a||this.emit("show")},k.prototype.hide=function(a){this._el.classList.remove("visible"),this._isShown=!1,a||this.emit("hide")},k.prototype._playlistUpdated=function(a){this._playlist&&this._playlist.identifier===a.identifier&&this._playlistLoaded(a)},k.prototype._playlistLoaded=function(a){this._playlist=a,this._playlistTitle.value=a.title},k.prototype._playlistRepeatModeChange=function(a){switch(this._repeatButton.classList.remove("dobby-repeat"),this._repeatButton.classList.remove("dobby-repeat-one"),this._repeatButton.classList.remove("button-white-grey"),this._repeatButton.classList.remove("button-white-indigo"),this._repeatMode=a,a){case"off":this._repeatButton.classList.add("dobby-repeat"),this._repeatButton.classList.add("button-white-grey");break;case"all":this._repeatButton.classList.add("dobby-repeat"),this._repeatButton.classList.add("button-white-indigo");break;case"one":this._repeatButton.classList.add("dobby-repeat-one"),this._repeatButton.classList.add("button-white-indigo")}},k.prototype._playlistEnabledChange=function(a){this._isEnabled=a,this._isPremium&&this._isEnabled?this.show():this.hide()},k.prototype.preload=function(a){this.empty();for(var b=0;b<a.length;++b)this.add(a[b],b)},k.prototype.empty=function(){for(this.items=[];this._fileListEl.firstChild;)this._fileListEl.removeChild(this._fileListEl.firstChild)},k.prototype._insertAtPosition=function(a,b,c){if(c=c||!1,!c){var d=this._fileListEl.childNodes.length;0==d||b>=d-1?this._fileListEl.appendChild(a.getElement()):this._fileListEl.insertBefore(a.getElement(),this._fileListEl.childNodes[b])}this._items.splice(b,0,a)},k.prototype._removeAtPosition=function(a,b){return b=b||!1,b||this._fileListEl.removeChild(this._fileListEl.childNodes[a]),this._items.splice(a,1)[0]},k.prototype.add=function(a,b){var c=new j(a.identifier,a.name,0);a.icon&&c.setIcon(a.icon),c.on("click",this.__onFileClicked),c.on("remove",this.__onFileRemoveClicked),this._insertAtPosition(c,b)},k.prototype.remove=function(a,b){var c=this._removeAtPosition(b);c.removeListener("click",this.__onFileClicked),c.removeListener("remove",this.__onFileRemoveClicked)},k.prototype.update=function(a,b){this._items[a].setIcon(b.icon)},k.prototype.move=function(a,b,c){for(var d=!1,e=0;e<this._suppressedPair.length;++e){var f=this._suppressedPair[e];if(f.from==b&&f.to==c){d=!0,this._suppressedPair.splice(e,1);break}}this._insertAtPosition(this._removeAtPosition(b,d),c,d)},k.prototype.complete=function(){this._previouslyPlayingItem&&(this._previouslyPlayingItem.unselect(),this._previouslyPlayingItem=null)},k.prototype.setSelectedPosition=function(a){this._previouslyPlayingItem&&(this._previouslyPlayingItem.unselect(),this._previouslyPlayingItem=null),a>-1&&a<this._items.length&&(this._items[a].select(),this._previouslyPlayingItem=this._items[a])},k.prototype._playlistFileNotFound=function(a,b){b>-1&&b<this._items.length&&this._items[b].fileNotFound()},k.prototype._onFileClicked=function(a){this._background.loadPlaylistMedia(a.id)},k.prototype._onFileRemoveClicked=function(a){this._background.removePlaylistFile(a.id)},k.prototype._onPlaylistAddButtonClicked=function(){this._isPremium?this._background.selectPlaylistFile():this._premiumNotificationDialog.show()},k.prototype._onPlaylistSelectButtonClicked=function(){this._settingsDialog.show(),this._settingsDialog._showPage("playlist")},k.prototype._onPlaylistAddFolderButtonClicked=function(){},k.prototype._onPlaylistTitleChange=function(){this._background.setPlaylistTitle(this._playlist.identifier,this._playlistTitle.value),this._playlistTitle.blur()},k.prototype._onPlaylistTitleFocus=function(){this._playlistTitle.select()},k.prototype._onRepeatButtonClicked=function(){if(this._isPremium)switch(this._repeatMode){case"off":this._background.setPlaylistRepeatMode("all");break;case"all":this._background.setPlaylistRepeatMode("one");break;case"one":this._background.setPlaylistRepeatMode("off")}else this._premiumNotificationDialog.show()},k.prototype._onShuffleButtonClicked=function(){this._isPremium?this._background.shufflePlaylist():this._premiumNotificationDialog.show()},k.prototype._onClearAllButtonClicked=function(){this._background.clearPlaylist()};var l=function(){ElementView.call(this,"#pager-view"),this._background=inject("BackgroundCommunicator"),this.mainView=inject("MainView"),this.playbackView=inject("PlaybackView"),this._playlist=inject("PlaylistPanelView"),this._settings=inject("VideostreamSettings"),this.showMainView(),this._sheet=document.head.appendChild(document.createElement("style")).sheet,this._before=!0,this._dropzone=this.querySelector("#dropzone-main"),this._bindEvents()};l.prototype=Object.create(ElementView.prototype),l.prototype._bindEvents=function(){this._background.on("snap",this._onSnap.bind(this)),this._background.on("loaded",this._onLoaded.bind(this)),this._background.on("unloaded",this._onUnloaded.bind(this)),this._background.on("playlist-position",this._onBackgroundPlaylistPosition.bind(this)),this._background.on("player-complete",this._onPlayerComplete.bind(this)),this._background.on("loaded",this.showPlaybackView.bind(this)),this._background.on("loading-movie",this.showPlaybackView.bind(this)),this._background.on("probe-complete",this._onBackgroundProbeComplete.bind(this)),this._background.on("stopping",this.showMainView.bind(this)),this._background.on("playlist-complete",this.showMainView.bind(this)),this._background.on("cast-session-disconnected",this.showMainView.bind(this)),this._dropzone.addEventListener("drop",this._onDrop.bind(this)),this._dropzone.addEventListener("dragover",this._onDragover.bind(this))},l.prototype._onLoaded=function(){this._isLoaded=!0},l.prototype._onUnloaded=function(){this._isLoaded=!1},l.prototype._onBackgroundProbeComplete=function(a){"Incompatible"===a&&this.showMainView()},l.prototype._onPlayerComplete=function(){this._playlistEnabled||this.showMainView()},l.prototype._onBackgroundPlaylistPosition=function(a){this._playlistEnabled=a>-1},l.prototype.showMainView=function(){this.mainView.show(),this.playbackView.hide(),document.body.classList.remove("playback-mode"),document.body.classList.remove("show-after-image"),document.body.classList.remove("show-before-image")},l.prototype.showPlaybackView=function(a){var b=a&&0===a.indexOf("image");this.playbackView.adjustControls(b),this.playbackView.show(),this.mainView.hide(),document.body.classList.add("playback-mode")},l.prototype._onSnap=function(a){if(null!=this._backgroundImage&&URL.revokeObjectURL(this._backgroundImage),this._backgroundImage=a,this._isLoaded){if(null==this._backgroundImage)return document.body.classList.remove("show-after-image"),void document.body.classList.remove("show-before-image");this._settings.getContentScreenshotOptIn(function(a){if(!a)return document.body.classList.remove("show-after-image"),void document.body.classList.remove("show-before-image")}),this._before?(this._sheet.addRule(".desktop-view:before",'background-image:url("'+a+'");'),document.body.classList.add("show-before-image"),document.body.classList.remove("show-after-image"),this._before=!1):(this._sheet.addRule(".desktop-view:after",'background-image:url("'+a+'");'),document.body.classList.add("show-after-image"),document.body.classList.remove("show-before-image"),this._before=!0)}},l.prototype._onDragover=function(a){a.preventDefault(),a.dataTransfer.dropEffect="copy"},l.prototype._onDrop=function(b){b.preventDefault();var c=[].slice.call(b.dataTransfer.items),d=[],e=!1;c.forEach(function(a){var b=a.webkitGetAsEntry();b&&(d.push(b),b.isDirectory&&(e=!0))}),e?this._playlist.onDrop(b):d&&this._background.loadDroppedMedia(d.map(function(b){return a.fileSystem.retainEntry(b)}))};var m=function(a){ElementView.call(this,a),this._lockedButtonIntervals=[]};m.prototype=Object.create(ElementView.prototype),m.prototype.show=function(a){this._clearLockedIntervals();for(var b=this.querySelectorAll(".loader-locked-button"),c=0;c<b.length;++c){b[c].originalText||(b[c].originalText=b[c].innerHTML);var d=setInterval(this._lockedButtonInterval.bind(this,b[c],b[c].originalText,Date.now()+5e3),1e3);this._lockedButtonIntervals.push(d),b[c].classList.add("disabled"),b[c].innerHTML=b[c].innerHTML+" (5)"}this._el.classList.add("visible"),a&&a()},m.prototype.hide=function(a){this._clearLockedIntervals(),this._el.classList.remove("visible"),a&&a()},m.prototype._clearLockedIntervals=function(){for(var a=0;a<this._lockedButtonIntervals.length;++a)clearInterval(this._lockedButtonIntervals[a]);this._lockedButtonIntervals=[]},m.prototype._lockedButtonInterval=function(a,b,c){var d=Math.round((c-Date.now())/1e3);0==d?(a.classList.remove("disabled"),a.innerHTML=b):d>0&&(a.innerHTML=b+" ("+d+")")};var n=function(){m.call(this,"#loader-card-incompatible-file"),this._fileNameEl=this.querySelector("#loader_card_incompatible_file_filename")};n.prototype=Object.create(m.prototype),n.prototype.setFilename=function(a){if(a){var b=a.substr(a.lastIndexOf(".")+1),c=a.substr(0,a.lastIndexOf(".")+1);this._fileNameEl.innerHTML="<b>Selected file:</b> "+c+"<b>"+b+"</b>"}else this._fileNameEl.innerHTML=""};var o=function(){m.call(this,"#loader-card-dvd")};o.prototype=Object.create(m.prototype);var p=function(){m.call(this,"#loader-card-antivirus")};p.prototype=Object.create(m.prototype);var q=function(){m.call(this,"#restart-chrome-how-to")};q.prototype=Object.create(m.prototype);var r=function(){m.call(this,"#loader-card-no-chromecast")};r.prototype=Object.create(m.prototype);var s=function(){m.call(this,"#loader-card-chromecast-timeout")};s.prototype=Object.create(m.prototype);var t=function(){m.call(this,"#loader-card-no-network")};t.prototype=Object.create(m.prototype);var u=function(){m.call(this,"#loader-card-firewall"),this._windows=this.querySelector("#loader-card-firewall-body-windows"),this._windows10=this.querySelector("#loader-card-firewall-body-windows-10"),this._mac=this.querySelector("#loader-card-firewall-body-mac"),this._linux=this.querySelector("#loader-card-firewall-body-linux")};u.prototype=Object.create(m.prototype),u.prototype.show=function(){this._windows10.style.display="none",this._windows.style.display="none",this._mac.style.display="none",this._linux.style.display="none",navigator.appVersion.indexOf("Windows NT 10.0")!=-1?this._windows10.style.removeProperty("display"):navigator.appVersion.indexOf("Win")!=-1?this._windows.style.removeProperty("display"):navigator.appVersion.indexOf("Mac")!=-1?this._mac.style.removeProperty("display"):navigator.appVersion.indexOf("Linux")!=-1&&this._linux.style.removeProperty("display"),m.prototype.show.call(this)};var v=function(){ElementView.call(this,"#loader-overlay"),this._background=inject("BackgroundCommunicator"),this._chromecast=inject("Chromecast"),this._desktopView=document.querySelector("#desktop-view");var a=this.querySelectorAll(".loader-cancel"),b=0;for(b=0;b<a.length;b++)a[b].addEventListener("click",this._cancelLoad.bind(this));var c=this.querySelectorAll(".loader-hide");for(b=0;b<c.length;b++)c[b].addEventListener("click",this._backCard.bind(this));var d=this.querySelectorAll(".loader-restart");for(b=0;b<d.length;b++)d[b].addEventListener("click",this._showChromeRestart.bind(this));var e=this.querySelectorAll(".loader-force");for(b=0;b<e.length;b++)e[b].addEventListener("click",this._forceLoad.bind(this));this._incompatibleFileCard=new n,this._dvdFileCard=new o,this._antivirusCard=new p,this._chromeRestartCard=new q,this._chromecastCard=new r,this._firewallCard=new u,this._noNetworkCard=new t,this._chromecastTimeout=new s,this._placeholder=this.querySelector("#placeholder"),this._hideTimeout=null,this._blurTimeout=null,this._loadingMessageTimeout=null,this._activeCard=null,this.querySelector(".loading-text-0").textContent=this._getNewMessage(0),this.querySelector(".loading-text-1").textContent=this._getNewMessage(0),this.querySelector(".loading-text-2").textContent=this._getNewMessage(0),this.querySelector(".loading-text-3").textContent=this._getNewMessage(1),this.querySelector(".loading-text-4").textContent=this._getNewMessage(1),this.querySelector(".loading-text-5").textContent=this._getNewMessage(1)};v.prototype=Object.create(ElementView.prototype),v.prototype._cancelLoad=function(){this.hide(),this.emit("unload-file")},v.prototype._backCard=function(){this._hideCard(),this._showCard(this._chromecastCard)},v.prototype._showChromeRestart=function(){this._hideCard(),this._showCard(this._chromeRestartCard)},v.prototype._forceLoad=function(){this._hideCard(),this.emit("force-file")},v.LOADING_MESSAGE_TIMEOUT=1500,v.LOADING_MESSAGE_ITERATIONS=20,v._LoadingMessages=["Reticulating Splines...","Gathering Goblins...","Lifting Weights...","Pushing Pixels...","Formulating Plan...","Taking Break...","Herding Ducks...","Feeding Developers...","Fishing for Change...","Searching for Dancers...","Waking Up Gnomes...","Playing Chess...","Building Igloos...","Converting Celsius...","Scanning Power Level...","Delivering Presents...","Finding Dragon Balls...","Firing Lasers...","Party Rocking...","Walking up to the club...","Righting wrongs...","Building Lego...","Assembling Avengers...","Turning Down for What...","Reaching 88mph...","Pondering Existence...","Battling Robots...","Smashing Pots...","Stomping Goombas...","Doing Donuts...","Entering Danger Zone...","Talking to Mom...","Chasing Squirrels...","Setting Phasers to Stun...","Doing Macarena...","Dropping Bass...","Removing Biebers...","Performing Magic...","Autotuning Kanye...","Waxing Legs...","Invading Space...","Levelling Up...","Generating Map...","Feeding Intern...","Piloting Tardis...","Destroying Deathstar...","Typing Letters...","Making Code...","Running Marathon...","Shooting Pucks...","Kicking Field Goals...","Fighting Bad Guys...","Driving Batmobile...","Warming Up Kryptonite...","Popping Popcorn...","Creating Hashes...","Spawning Boss...","Evaluating Life Choices...","Eating Ramen...","Re-heating Leftovers...","Petting Kittens...","Walking Puppies...","Catching Z’s...","Jumping Rope...","Declaring Variables...","Yessing Doge...","Recycling Memes...","Tipping Fedora...","Walking Runway...","Counting to Ten...","Booting Native Client...","Launching App...","Drawing Icons...","Reading Instructions...","Finding Screws...","Completing Puzzles...","Generating Volume Slider...","Brightening Orange...","Ordering Pizza...","You Look Good Today...","Clearing Screen...","Stirring Pot...","Mashing Potatoes...","Banishing Evil...","Taking Selfies...","Accelerating Disks...","Benching Network...","Rocking Out...","Grinding Mage...","Studying Calculus...","Playing N64...","Racing GoKarts...","Defeating Creepers...","Blowing Game Cartridge...","Choosing Pikachu...","Postponing Half Life 3...","Rushing Zergs...","Rescuing Hostages...","Typing Konami Code...","Building Snowman...","Letting it Snow...","Burning HDMI Cords...","Applying Filters...","Taking Screenshot...","Shaving Mustache...","Growing Beard...","Baking Muffins...","Iterating Javascript...","Attracting Venture Capital...","Disrupting Industry...","Tweeting Hashtags...","Encrypting Lines...","Obfuscating C...","Enhancing License Plate...","Running Diagnostic...","Warming Hyperdrive...","Calibrating Positions...","Calculating Percentages...","Revoking Licenses...","Shedding Core...","Dampening Gravity...","Increasing Power...","Checking Sensors...","Indexing RSS...","Programming PCI...","Determining USB Position...","Connecting to Bus...","Inverting Ports...","Bypassing Capacitor...","Reversing Bandwidth Throttle...","Testing AI...","Virtualizing Microchip...","Emulating Playstation...","Synthesizing Drivers...","Structuring Chlorophyll...","Watering Plants...","Ingesting Caffeine...","Chugging Redbull...","Parsing System...","Navigating Arrays...","Searching Google...","Overflowing Stack...","Compiling Binaries...","Answering Emails...","Migrating CSS...","Backing Up Primaries...","Rendering Dialogs...","Reading RSS...","Compressing Data...","Rejecting Cloud...","Evaluating Weissman Score...","Purging Local Storage...","Leaking Memory...","Scripting Python...","Grunting Ruby...","Benching RAM...","Determining Auxiliaries...","Jiggling Internet...","Ejecting Floppy...","Fluctuating Objects...","Spiking Reactor Core...","Firing Bosons...","Testing Processor...","Debugging Prompts...","Connecting Floats...","Rounding Integers...","Pronouncing Gigawatt...","Inverting Transponders...","Bypassing Silicon...","Raising Funds...","Caching Logs...","Dithering Broadband...","Eating Poutine...","Rolling Rims to Win...","Begging for Change...","Chasing Waterfalls...","Pumping Gas...","Emptying Pipes...","Hitting Piñata...","Unleashing Freedom...","Airbrushing Actors...","Filing Taxes...","Powering Mitochondria...","Calculating Qi charge...","Completing Geometry...","Turning in Algebra...","Solving for X...","Benching Wattage...","Kludging Playback Bar...","Stringifying Json...","Consuming Spaghetti Code...","Deleting Comments...","Transitioning to Django...","Learning to Code...","Battling Feature Creep...","Losing Flappy Bird...","Celebrating Good Times...","Sharpening Pencils...","Automating Processes...","Attacking Godzilla...","Carbonating Soda...","Thinking of Witty Text...","Opening Vault 111...","Ganking Lane...","Generating Puns...","Shaking it Off...","Adding Toppings...","Printing Stickers...","Spawning Meseeks...","Questioning Future...","Regretting Haircuts...","Finding Coupons...","Camping Spawn...","Defending Liberty...","Delivering Justice...","Saying Hello. Hello.","Hello World...","Folding Burritos...","Oiling Robots...","Pranking Dwight...","Hiding Jason’s Mouse...","Hiding Graham’s Phone...","Drinking Matt’s Pop...","Chasing Golden Snitch...","Insert Additional Quarters 1/2...","Hunting Walkers...","Warming Soup...","Sharpening Swords...","Petting Unicorns...","Tweeting to @getvideostream...","Solving Mysteries...","Feeding Scooby...","Refactoring Console Xors...","Annoying Watson...","Bottling up Navi...","Anticipating Star Wars...","Counting to Christmas...","Respecting Elders...","Rendering Arrow in Knee...","Reviving Geralt...","Exploring Wasteland...","Ordering Martini...","Hatching Yoshi...","Combining Bits...","Stomping Goombas...","Rescuing Princess...","Finding True Love...","Videostream and Chilling...","Saving Companion Cube...","Saving Progress…...","Rendering Checkpoint...","Loading Saves...","Feeding Fish...","Phoning Home...","Protecting VIP...","Shaking Buns...","Makin Bacon Pancakes...","Playing Pong...","Charging Batteries...","Backing up Data...","Burning to Disk...","Making New Friends...","Spawning Sims..."],v.prototype.show=function(a){clearTimeout(this._hideTimeout),clearTimeout(this._blurTimeout),this._startMessageCycle();var b=this;this._placeholder.classList.remove("chromecast-select"),this._placeholder.classList.add("probing-file"),a?this._el.classList.add("hide-loading-text"):this._el.classList.remove("hide-loading-text"),this._blurTimeout=setTimeout(function(){b._el.classList.add("visible"),b._blurTimeout=setTimeout(function(){b._desktopView.classList.add("blur-8")},1e3)},50)},v.prototype.hide=function(){clearTimeout(this._hideTimeout),clearTimeout(this._blurTimeout),this.clearErrors(),this._stopMessageCycle(),this._desktopView.classList.remove("blur-8");var a=this;this._hideTimeout=setTimeout(function(){a._el.classList.remove("visible")},50)},v.prototype.selectChromecastView=function(){this._selectingChromecast=!0,this._placeholder.classList.remove("probing-file"),this._placeholder.classList.add("chromecast-select"),this._stopMessageCycle()},v.prototype.selectedChromecastView=function(){this._selectingChromecast=!1,this._placeholder.classList.contains("chromecast-select")&&(this._placeholder.classList.remove("chromecast-select"),this._placeholder.classList.remove("probing-file")),this._startMessageCycle()},v.prototype.incompatibleFileError=function(a){this._incompatibleFileCard.setFilename(a),this._showCard(this._incompatibleFileCard)},v.prototype.dvdFileError=function(){this._showCard(this._dvdFileCard)},v.prototype.antivirusError=function(){this._showCard(this._antivirusCard)},v.prototype.chromeRestartShow=function(){this._showCard(this._chromeRestartCard)},v.prototype.firewallError=function(){this._showCard(this._firewallCard)},v.prototype.noNetworkError=function(){this._showCard(this._noNetworkCard)},v.prototype.noChromecastError=function(){this._showCard(this._chromecastCard)},v.prototype.chromecastTimeout=function(){this._showCard(this._chromecastTimeout)},v.prototype.clearErrors=function(){this._hideCard()},v.prototype.networkDown=function(){this._networkDown=!0,this._showCard(this._noNetworkCard)},v.prototype.networkUp=function(){this._networkDown=!1,this._activeCard===this._noNetworkCard&&this._hideCard()},v.prototype.noCastDevicesFound=function(){this._hasCastDevices=!1,this._showCard(this._chromecastCard)},v.prototype.castDevicesFound=function(){this._hasCastDevices=!0,this._activeCard===this._chromecastCard&&(this._hideCard(),this._chromecast.openSession())},v.prototype._showCard=function(a){this._activeCard||(this._activeCard=a,this._activeCard.show(),this._stopMessageCycle())},v.prototype._hideCard=function(){this._activeCard&&(this._activeCard.hide(),this._activeCard=null,this._startMessageCycle())},v.prototype._startMessageCycle=function(){clearInterval(this._cycleInterval),this._cycleIntervalIterations=0,this._cycleInterval=setInterval(this._messageCycleTick.bind(this),v.LOADING_MESSAGE_TIMEOUT)},v.prototype._stopMessageCycle=function(){clearInterval(this._cycleInterval)},v.prototype._messageCycleTick=function(){this._cycleIntervalIterations++,this._cycleIntervalIterations<=v.LOADING_MESSAGE_ITERATIONS?(this._cycleMessages(0),this._cycleMessages(1)):this._stopMessageCycle()},v.prototype._cycleMessages=function(a){var b=this._getNewMessage(a),c=this.querySelector(".loading-text-"+(0+3*a)),d=this.querySelector(".loading-text-"+(1+3*a)),e=this.querySelector(".loading-text-"+(2+3*a));c.textContent=b,c.classList.remove("loading-text-"+(0+3*a)),d.classList.remove("loading-text-"+(1+3*a)),e.classList.remove("loading-text-"+(2+3*a)),c.classList.add("loading-text-"+(2+3*a)),d.classList.add("loading-text-"+(0+3*a)),e.classList.add("loading-text-"+(1+3*a))},v.prototype._getNewMessage=function(a){var b=v._LoadingMessages[Math.floor(Math.random()*v._LoadingMessages.length)];return this.querySelector(".loading-text-"+(0+3*a)).textContent==b||this.querySelector(".loading-text-"+(1+3*a)).textContent==b||this.querySelector(".loading-text-"+(2+3*a)).textContent==b?this._getNewMessage(a):b};var w=function(a,b){EventEmitter.call(this),this.list={},this.container=a,this._listLocked=!1,b.addEventListener("click",this._onAddLibraryDirectory.bind(this))};w.prototype=Object.create(EventEmitter.prototype),w.prototype.getCount=function(){return Object.keys(this.list).length},w.prototype.scanStarted=function(){this.container.classList.add("scan-in-progress"),this._listLocked=!0,this.emit("scan-has-started-add-file-dialog")},w.prototype.scanEnded=function(){this.container.classList.remove("scan-in-progress"),this._listLocked=!1,this.emit("scan-is-done-add-file-dialog")},w.prototype.addLibrary=function(a){var b=new x(a);b.on("remove",this._onRemoveLibraryDirectory.bind(this,b.libraryPath)),this.list[a]=b,this.container.appendChild(b.el),b.blink()},w.prototype.addLibraryDirectories=function(a){var b=this;async.each(a,function(a,c){b.addLibrary(a),c()})},w.prototype.removeLibraryDirectories=function(a){var b=this;async.each(a,function(a,c){b.list[a].el.parentElement.removeChild(b.list[a].el),delete b.list[a],c()})},w.prototype.addLibraryDirectoryDuplicate=function(a){console.log("duplicate::",a)},w.prototype.setLibraryDirectories=function(a){for(;this.container.hasChildNodes();)this.container.removeChild(this.container.lastChild);this.addLibraryDirectories(a)},w.prototype._onRemoveLibraryDirectory=function(a){this._listLocked||this.emit("remove-directory",a)},w.prototype._onAddLibraryDirectory=function(){this.emit("add-directory")},w.prototype._onLibraryDirectoriesRemoved=function(a){console.log("SettingsDialogLibrary.prototype._onLibraryDirectoriesRemoved::",a),this.removeLibraryDirectories(a)},w.prototype._onLibraryDirectoriesAdded=function(a){console.log("SettingsDialogLibrary.prototype._onLibraryDirectoriesAdded::",a),this.addLibraryDirectories(a)},w.prototype._onLibraryDirectoriesAddedDuplicate=function(a){console.log("SettingsDialogLibrary.prototype._onLibraryDirectoriesAddedDuplicate::",a);var b=this;async.each(a,function(a,c){b.list[a].blink(),c()})};var x=function(a){EventEmitter.call(this),this.libraryPath=a,this.el=document.createElement("li"),this.el.classList.add("folder-item");var b=document.createElement("div");b.textContent=a,b.classList.add("library-item-title"),this.el.appendChild(b);var c=document.createElement("div");c.classList.add("library-syncing"),this.el.appendChild(c);var d=document.createElement("div");d.classList.add("loader"),c.appendChild(d);var e=document.createElement("div");e.classList.add("flipper"),d.appendChild(e);var f=document.createElement("div");f.classList.add("front"),e.appendChild(f);var g=document.createElement("div");g.classList.add("back"),
e.appendChild(g);var h=document.createElement("div");h.textContent="Scanning",c.appendChild(h);var i=document.createElement("button");"library-item-remove-button button-flat button-small button-clear-grey-alt dobby dobby-x".split(" ").forEach(function(a){i.classList.add(a)}),i.addEventListener("click",this._onRemoveLibraryDirectory.bind(this)),this.el.appendChild(i)};x.prototype=Object.create(EventEmitter.prototype),x.prototype._onRemoveLibraryDirectory=function(){this.emit("remove")},x.prototype.blink=function(){this.el.classList.add("library-blink"),setTimeout(function(){this.el.classList.remove("library-blink")}.bind(this),3e3)};var y=function(a,b){EventEmitter.call(this),this.list={},this.container=a,this._loadedPlaylist=null,b.addEventListener("click",this._onAddNewPlaylist.bind(this))};y.prototype=Object.create(EventEmitter.prototype),y.prototype.addPlaylist=function(a,b){var c=new z(a);c.setTitle(b),c.on("remove",this._onRemovePlaylist.bind(this,a)),c.on("select",this._onSelectPlaylist.bind(this,a)),this.list[a]=c,this.container.appendChild(c.el)},y.prototype.removePlaylist=function(a){this.list[a].el.parentElement.removeChild(this.list[a].el),delete this.list[a],this._loadedPlaylist&&this._loadedPlaylist.identifier===a&&(this._loadedPlaylist=null)},y.prototype._onBackgroundPlaylistList=function(a){for(var b=this;this.container.hasChildNodes();)this.container.removeChild(this.container.lastChild);this.list={},this._loadedPlaylist=null,a.forEach(function(a){b.addPlaylist(a.identifier,a.title)})},y.prototype._onBackgroundPlaylistLoaded=function(a){this._loadedPlaylist&&this._loadedPlaylist.el.classList.remove("selected"),a&&(this.list[a.identifier].el.classList.add("selected"),this._loadedPlaylist=this.list[a.identifier])},y.prototype._onBackgroundPlaylistAdded=function(a){this.addPlaylist(a.identifier,a.title),console.log("Playlist._onBackgroundPlaylistAdded:",a)},y.prototype._onBackgroundPlaylistRemoved=function(a){this.removePlaylist(a.identifier),console.log("Playlist._onBackgroundPlaylistRemoved:",a)},y.prototype._onBackgroundPlaylistUpdated=function(a){this.list[a.identifier].setTitle(a.title)},y.prototype._onAddNewPlaylist=function(){this.emit("add-playlist")},y.prototype._onRemovePlaylist=function(a){this.emit("remove-playlist",a)},y.prototype._onSelectPlaylist=function(a){this._loadedPlaylist&&this._loadedPlaylist.identifier===a||this.emit("select-playlist",a)};var z=function(a){EventEmitter.call(this),this.identifier=a,this.el=document.createElement("li"),this.el.id="playlist-"+a,this.el.classList.add("folder-item"),this.el.addEventListener("click",this._onSelectPlaylistItem.bind(this));var b=document.createElement("div");b.classList.add("library-item-title"),this.el.appendChild(b);var c=document.createElement("button");"library-item-remove-button button-flat button-small button-clear-grey-alt dobby dobby-x".split(" ").forEach(function(a){c.classList.add(a)}),c.addEventListener("click",this._onRemovePlaylistItem.bind(this)),this.el.appendChild(c)};z.prototype=Object.create(EventEmitter.prototype),z.prototype.setTitle=function(a){this.el.firstElementChild.textContent=a||"Untitled Playlist"},z.prototype._onRemovePlaylistItem=function(){this.emit("remove")},z.prototype._onSelectPlaylistItem=function(){this.emit("select")},function(b){var c=b.DialogView||require("desktop/ui/DialogView"),d=b.RemoteSettings||require("common/RemoteSettings"),e=function(){var a=this;c.call(this,"#settings-dialog",{dismissElements:"#button-settings-close,#button-settings-close-2"}),this._background=inject("BackgroundCommunicator"),this._libraryDialog=new w(this.querySelector("#settings-library-list"),this.querySelector("#button-library-add")),this._background.on("library-scan-begin",this._libraryDialog.scanStarted.bind(this._libraryDialog)),this._background.on("library-scan-end",this._libraryDialog.scanEnded.bind(this._libraryDialog)),this._playlistDialog=new y(this.querySelector("#settings-playlist-list"),this.querySelector("#button-playlist-add")),this._settings=inject("VideostreamSettings"),this._currentPage=this.querySelector("#settings-page-main"),this._currentHeader=this.querySelector("#settings-dialog-main-title"),this._backButton=this.querySelector("#button-settings-back"),this._fivePointOnePolicyButtonGroup=new h(this.querySelector("#audio-button-group")),this._computerNameInput=this.querySelector("#computer-name"),this._analyticsOptInCheckbox=new g(this.querySelector("#analytics-opt-in-checkbox")),this._resumeOptInCheckbox=new g(this.querySelector("#resume-opt-in-checkbox")),this._splashContentImagesOptInCheckbox=new g(this.querySelector("#splash-content-images-opt-in-checkbox")),this._contentScreenshotOptInCheckbox=new g(this.querySelector("#content-screenshot-opt-in-checkbox")),this._localMediaContentSuggestionsOptInCheckbox=new g(this.querySelector("#content-suggestions-opt-in-checkbox")),this._recentlyDownloadedOptInCheckbox=new g(this.querySelector("#recently-downloaded-opt-in-checkbox")),this._playlistModeSwitch=new i(this.querySelector("#playlist-enable-switch")),this._playlistSelection=this.querySelector("#settings-playlist-selection"),this._superfastModeSwitch=new i(this.querySelector("#superfast-enable-switch")),this._splashContentImagesWrapper=this.querySelector("#splash-content-images-opt-in-wrapper"),this._audioDefaultLanguageSelect=this.querySelector("#audio-default-language"),this._subtitleSizeButtonGroup=new h(this.querySelector("#subtitle-size-button-group")),this._subtitleColorButtonGroup=new h(this.querySelector("#subtitle-color-button-group")),this._subtitlePositionButtonGroup=new h(this.querySelector("#subtitle-position-button-group")),this._subtitleEncodingSelect=this.querySelector("#subtitle-encoding"),this._subtitleDefaultLanguageSelect=this.querySelector("#subtitle-default-language"),this._subtitleLoadingSwitch=new i(this.querySelector("#subtitle-loading-switch")),this._subtitleRemoteSwitch=new i(this.querySelector("#subtitle-remote-switch")),this._subtitleLoadingLibrarySwitch=new i(this.querySelector("#subtitle-loading-library-switch")),this._bindControls(),d.fetch(function(a){a&&(a.enableLibrary===!0?(this.querySelector("#button-settings-navigate-library").style.display="block",this.querySelector("#mobile-library-button").style.display="block",this.querySelector("#mobile-library-title").style.display="block"):a.enableLibrary===!1&&(this.querySelector("#button-settings-navigate-library").style.display="none",this.querySelector("#mobile-library-button").style.display="none",this.querySelector("#mobile-library-title").style.display="none"))}.bind(this)),this._settings.getLocalMediaContentSuggestionsOptIn(function(b){a._localMediaContentSuggestionsOptInCheckbox.setChecked(b)}),this._settings.getRecentlyDownloadedContentSuggestionsOptIn(function(b){a._recentlyDownloadedOptInCheckbox.setChecked(b)}),this._settings.getSplashContentImagesOptIn(function(b){a._splashContentImagesOptInCheckbox.setChecked(b)}),this._settings.getContentScreenshotOptIn(function(b){a._contentScreenshotOptInCheckbox.setChecked(b)}),this._background._onLoad()};e.prototype=Object.create(c.prototype),e.prototype.show=function(){if("test"===inject("SplitTestController").getTestGroup("churnTestGroup")&&(this._splashContentImagesWrapper.style.display=null),"test"===inject("SplitTestController").getTestGroup("ac3OptionEnable")){var a=[].slice.call(this.querySelector("#audio-button-group").children);a.forEach(function(a){"ac3"===a.getAttribute("value")&&(a.style.display="flex")})}this._showPage("main"),c.prototype.show.call(this)},e.prototype._bindControls=function(){var a=this;this._backButton.addEventListener("click",this._showPage.bind(this,"main")),this.querySelector("#button-settings-navigate-audio").addEventListener("click",this._showPage.bind(this,"audio")),this.querySelector("#button-settings-navigate-subtitles").addEventListener("click",this._showPage.bind(this,"subtitles")),this.querySelector("#button-settings-navigate-playlist").addEventListener("click",this._showPage.bind(this,"playlist")),this.querySelector("#button-settings-navigate-playlist-locked").addEventListener("click",this._launchPremiumCheckout.bind(this)),this.querySelector("#button-settings-navigate-other").addEventListener("click",this._showPage.bind(this,"other")),this.querySelector("#button-settings-navigate-premium").addEventListener("click",this._launchPremiumCheckout.bind(this)),this.querySelector("#button-settings-navigate-mobile").addEventListener("click",this._showPage.bind(this,"mobile")),this.querySelector("#button-settings-navigate-library").addEventListener("click",this._showPage.bind(this,"library")),this.querySelector("#button-settings-navigate-subscriptions-paypal").addEventListener("click",this._showPage.bind(this,"subscriptions-paypal")),this.querySelector("#button-settings-navigate-subscriptions-stripe").addEventListener("click",this._showPage.bind(this,"subscriptions-stripe")),this.querySelector("#button-settings-navigate-buffering-fixes").addEventListener("click",this._showPage.bind(this,"buffering-fixes")),this.querySelector(".subtitles-advanced-standard-blocker").addEventListener("click",this._launchPremiumCheckout.bind(this)),this.querySelector("#subtitle-library-button").addEventListener("click",this._onLibraryButtonClicked.bind(this)),this.querySelector("#mobile-library-button").addEventListener("click",this._onMobileLibraryButtonClicked.bind(this)),this._background.on("premium",this._onBackgroundPremium.bind(this)),this._background.on("standard",this._onBackgroundStandard.bind(this)),this._background.on("five-point-one-policy-change",this._onBackgroundFivePointOnePolicyChange.bind(this)),this._background.on("computer-name-change",this._onBackgroundComputerNameChange.bind(this)),this._background.on("subtitle-loading-change",this._onBackgroundSubtitleLoadingChange.bind(this)),this._background.on("subtitle-styles-change",this._onBackgroundSubtitleStylesChange.bind(this)),this._background.on("subtitle-track-selected",this._onBackgroundSubtitleTrackSelected.bind(this)),this._background.on("external-subtitle-encoding-change",this._onBackgroundSubtitleEncodingChange.bind(this)),this._background.on("default-audio-language-change",this._onBackgroundDefaultAudioLanguageChange.bind(this)),this._background.on("default-subtitle-language-change",this._onBackgroundDefaultSubtitleLanguageChange.bind(this)),this._settings.on("x264PresetChanged",this._onX264PresetChange.bind(this)),this._settings.on("isPlaylistEnabledChanged",this._onPlaylistEnabledChange.bind(this)),this._settings.on("resumeOptInChanged",this._onResumeOptInChange.bind(this)),this._settings.on("analyticsOptInChanged",this._onAnalyticsOptInChange.bind(this)),this._settings.on("remoteSubtitlesEnabledChanged",this._onRemoteSubtitlesEnabledChange.bind(this)),this._fivePointOnePolicyButtonGroup.on("change",this._onFivePointOnePolicyChange.bind(this)),this._computerNameInput.addEventListener("change",this._onComputerNameChange.bind(this,this._computerNameInput)),this._analyticsOptInCheckbox.on("checked",this._onAnalyticsOptInCheckboxChange.bind(this,!0)),this._analyticsOptInCheckbox.on("unchecked",this._onAnalyticsOptInCheckboxChange.bind(this,!1)),this._resumeOptInCheckbox.on("checked",this._onResumeOptInCheckboxChange.bind(this,!0)),this._resumeOptInCheckbox.on("unchecked",this._onResumeOptInCheckboxChange.bind(this,!1)),this._splashContentImagesOptInCheckbox.on("checked",this._onSplashContentImagesOptInCheckboxChange.bind(this,!0)),this._splashContentImagesOptInCheckbox.on("unchecked",this._onSplashContentImagesOptInCheckboxChange.bind(this,!1)),this._contentScreenshotOptInCheckbox.on("checked",this._onContentScreenshotOptInCheckboxChange.bind(this,!0)),this._contentScreenshotOptInCheckbox.on("unchecked",this._onContentScreenshotOptInCheckboxChange.bind(this,!1)),this._localMediaContentSuggestionsOptInCheckbox.on("checked",this._onLocalMediaContentSuggestionsChange.bind(this,!0)),this._localMediaContentSuggestionsOptInCheckbox.on("unchecked",this._onLocalMediaContentSuggestionsChange.bind(this,!1)),this._recentlyDownloadedOptInCheckbox.on("checked",this._onRecentlyDownloadedSuggestionsChange.bind(this,!0)),this._recentlyDownloadedOptInCheckbox.on("unchecked",this._onRecentlyDownloadedSuggestionsChange.bind(this,!1)),this._playlistModeSwitch.on("checked",this._onPlaylistModeChange.bind(this,!0)),this._playlistModeSwitch.on("unchecked",this._onPlaylistModeChange.bind(this,!1)),this._superfastModeSwitch.on("checked",this._onSuperfastModeChange.bind(this,!0)),this._superfastModeSwitch.on("unchecked",this._onSuperfastModeChange.bind(this,!1)),this._subtitleSizeButtonGroup.on("change",this._onSubtitleStylesUpdated.bind(this)),this._subtitlePositionButtonGroup.on("change",this._onSubtitleStylesUpdated.bind(this)),this._subtitleColorButtonGroup.on("change",this._onSubtitleStylesUpdated.bind(this)),this._subtitleEncodingSelect.addEventListener("change",this._onSubtitleEncodingChanged.bind(this)),this._audioDefaultLanguageSelect.addEventListener("change",this._onDefaultAudioLanguageChanged.bind(this)),this._subtitleDefaultLanguageSelect.addEventListener("change",this._onDefaultSubtitleLanguageChanged.bind(this)),this._subtitleLoadingSwitch.on("checked",this._onSubtitleLoadingSwitchChanged.bind(this,!0)),this._subtitleLoadingSwitch.on("unchecked",this._onSubtitleLoadingSwitchChanged.bind(this,!1)),this._subtitleRemoteSwitch.on("checked",this._onSubtitleRemoteSwitchChanged.bind(this,!0)),this._subtitleRemoteSwitch.on("unchecked",this._onSubtitleRemoteSwitchChanged.bind(this,!1)),this._subtitleLoadingLibrarySwitch.on("checked",this._onSubtitleLoadingSwitchChanged.bind(this,!0)),this._subtitleLoadingLibrarySwitch.on("unchecked",this._onSubtitleLoadingSwitchChanged.bind(this,!1)),this._libraryDialog.on("remove-directory",this._background.libraryRemoveDirectory.bind(this._background)),this._libraryDialog.on("add-directory",this._background.libraryAddDirectory.bind(this._background)),this._background.on("library-directories-list",a._libraryDialog.setLibraryDirectories.bind(this._libraryDialog)),this._background.on("library-directories-removed",a._libraryDialog._onLibraryDirectoriesRemoved.bind(this._libraryDialog)),this._background.on("library-directories-added",a._libraryDialog._onLibraryDirectoriesAdded.bind(this._libraryDialog)),this._background.on("library-directories-added-duplicate",a._libraryDialog._onLibraryDirectoriesAddedDuplicate.bind(this._libraryDialog)),this._background.on("show-edit-folder-dialog",function(){a.show(),a._showPage("library")}),this._playlistDialog.on("select-playlist",this._background.selectPlaylist.bind(this._background)),this._playlistDialog.on("remove-playlist",this._background.removePlaylist.bind(this._background)),this._playlistDialog.on("add-playlist",this._background.addNewPlaylist.bind(this._background)),this._background.on("playlist-list",a._playlistDialog._onBackgroundPlaylistList.bind(this._playlistDialog)),this._background.on("playlist-loaded",a._playlistDialog._onBackgroundPlaylistLoaded.bind(this._playlistDialog)),this._background.on("playlist-added",a._playlistDialog._onBackgroundPlaylistAdded.bind(this._playlistDialog)),this._background.on("playlist-removed",a._playlistDialog._onBackgroundPlaylistRemoved.bind(this._playlistDialog)),this._background.on("playlist-updated",a._playlistDialog._onBackgroundPlaylistUpdated.bind(this._playlistDialog)),this.querySelector("#button-cancel-stripe").addEventListener("click",this._onCancelSubscriptionButtonClicked.bind(this)),this.querySelector("#button-cancel-paypal").addEventListener("click",this._onPaypalCancelSubscriptionButtonClicked.bind(this))},e.prototype._showPage=function(a){if("main"===a?this._backButton.style.display="none":this._backButton.style.removeProperty("display"),"subscriptions-stripe"===a){var b=this.querySelector("#button-cancel-stripe");b.classList.remove("button-disabled"),b.onclick=this._onCancelSubscriptionButtonClicked}this.querySelector("#button-settings-navigate-buffering-fixes").style.removeProperty("display"),this._currentPage.classList.add("gone"),this._currentHeader.classList.add("gone"),this._currentPage=this.querySelector("#settings-page-"+a),this._currentHeader=this.querySelector("#settings-dialog-"+a+"-title"),this._currentPage.classList.remove("gone"),this._currentHeader.classList.remove("gone")},e.prototype._onBackgroundPremium=function(b){var c=this;this._subscriptionType=b,this.querySelector("#button-settings-navigate-playlist").style.removeProperty("display"),this.querySelector("#button-settings-navigate-playlist-locked").style.display="none",b&&(b.match(/stripe/)&&!b.match(/lifetime/)?(this._settings.getStripeSubscriptionCancellationDate(function(b){if(b&&b>0){var d=new Date(b),e=c.querySelector("#stripe-cancelled-text");e.innerHTML=a.i18n.getMessage("settings_stripe_content",d.toDateString()),e.style.removeProperty("display"),c.querySelector("#button-cancel-stripe").style.removeProperty("display"),c.querySelector("#button-cancel-stripe").style.display="none"}else c.querySelector("#stripe-cancelled-text").style.display="none",c.querySelector("#button-cancel-stripe").classList.remove("button-disabled")}),this.querySelector("#button-settings-navigate-subscriptions-stripe").style.removeProperty("display")):b.match(/paypal/)&&!b.match(/lifetime/)&&(this._settings.getPaypalSubscriptionCancellationDate(function(b){if(b&&b>0){var d=new Date(b),e=c.querySelector("#paypal-cancelled-text");e.innerHTML=a.i18n.getMessage("settings_paypal_content",d.toDateString()),e.style.removeProperty("display"),c.querySelector("#button-cancel-paypal").style.removeProperty("display"),c.querySelector("#button-cancel-paypal").style.display="none"}else c.querySelector("#paypal-cancelled-text").style.display="none",c.querySelector("#button-cancel-paypal").classList.remove("button-disabled")}),this.querySelector("#button-settings-navigate-subscriptions-paypal").style.removeProperty("display"))),this.querySelector("#button-settings-navigate-premium").style.display="none",this.querySelector(".subtitles-advanced-settings").classList.remove("standard")},e.prototype._onBackgroundStandard=function(){this.querySelector("#button-settings-navigate-playlist-locked").style.removeProperty("display"),this.querySelector("#button-settings-navigate-playlist").style.display="none",this.querySelector("#button-settings-navigate-subscriptions-stripe").style.display="none",this.querySelector("#button-settings-navigate-subscriptions-paypal").style.display="none",this.querySelector("#button-settings-navigate-premium").style.removeProperty("display"),this.querySelector(".subtitles-advanced-settings").classList.add("standard")},e.prototype._onBackgroundFivePointOnePolicyChange=function(a){this._fivePointOnePolicyButtonGroup.setValue(a)},e.prototype._onBackgroundComputerNameChange=function(a){this._computerNameInput.value=a},e.prototype._onAnalyticsOptInChange=function(a){this._analyticsOptInCheckbox.setChecked(a)},e.prototype._onResumeOptInChange=function(a){this._resumeOptInCheckbox.setChecked(a)},e.prototype._onPlaylistEnabledChange=function(a){a?this._playlistSelection.style.removeProperty("display"):this._playlistSelection.style.display="none",this._playlistModeSwitch.setChecked(a)},e.prototype._onRemoteSubtitlesEnabledChange=function(a){this._subtitleRemoteSwitch.setChecked(a)},e.prototype._onBackgroundSubtitleStylesChange=function(a){var b=a.size,c=a.position,d=a.color;this._subtitleSizeButtonGroup.setValue(b),this._subtitlePositionButtonGroup.setValue(c),this._subtitleColorButtonGroup.setValue(d)},e.prototype._onBackgroundSubtitleTrackSelected=function(a,b){!b||"ssa"!=b.toLowerCase()&&"ass"!=b.toLowerCase()?this.querySelector(".subtitles-advanced-settings").classList.remove("blocked"):this.querySelector(".subtitles-advanced-settings").classList.add("blocked")},e.prototype._onBackgroundSubtitleEncodingChange=function(a){console.log("SettingsDialog._onBackgroundSubtitleEncodingChange",a),this._subtitleEncodingSelect.value=a},e.prototype._onBackgroundDefaultAudioLanguageChange=function(a){this._audioDefaultLanguageSelect.value=a},e.prototype._onBackgroundDefaultSubtitleLanguageChange=function(a){this._subtitleDefaultLanguageSelect.value=a},e.prototype._onBackgroundSubtitleLoadingChange=function(a){this._subtitleLoadingSwitch.setChecked(a),this._subtitleLoadingLibrarySwitch.setChecked(a)},e.prototype._onX264PresetChange=function(a){this._superfastModeSwitch.setChecked("superfast"===a)},e.prototype._onFivePointOnePolicyChange=function(a){this._background.setFivePointOnePolicy(a)},e.prototype._onComputerNameChange=function(a){var b=a.value;this._background.setComputerName(b)},e.prototype._onAnalyticsOptInCheckboxChange=function(a){this._settings.setAnalyticsOptIn(a)},e.prototype._onResumeOptInCheckboxChange=function(a){this._settings.setResumeOptIn(a)},e.prototype._onSplashContentImagesOptInCheckboxChange=function(a){this._settings.setSplashContentImagesOptIn(a)},e.prototype._onContentScreenshotOptInCheckboxChange=function(a){this._settings.setContentScreenshotOptIn(a)},e.prototype._onLocalMediaContentSuggestionsChange=function(a){this._settings.setLocalMediaContentSuggestionsOptIn(a)},e.prototype._onRecentlyDownloadedSuggestionsChange=function(a){this._settings.setRecentlyDownloadedContentSuggestionsOptIn(a)},e.prototype._onPlaylistModeChange=function(a){this._settings.setPlaylistEnabled(a)},e.prototype._onSuperfastModeChange=function(a){this._settings.setX264Preset(a?"superfast":"ultrafast")},e.prototype._onSubtitleStylesUpdated=function(){var a={size:"small",position:"bottom",color:"1"};a.size=this._subtitleSizeButtonGroup.getValue(),a.position=this._subtitlePositionButtonGroup.getValue(),a.color=this._subtitleColorButtonGroup.getValue(),this._background.setSubtitleStyles(a)},e.prototype._onSubtitleEncodingChanged=function(){this._background.setExternalSubtitleEncoding(this._subtitleEncodingSelect.value)},e.prototype._onDefaultAudioLanguageChanged=function(){this._background.setDefaultAudioLanguage(this._audioDefaultLanguageSelect.value)},e.prototype._onDefaultSubtitleLanguageChanged=function(){this._background.setDefaultSubtitleLanguage(this._subtitleDefaultLanguageSelect.value)},e.prototype._onSubtitleLoadingSwitchChanged=function(a){this._background.setSubtitleLoading(a)},e.prototype._onSubtitleRemoteSwitchChanged=function(a){this._settings.setRemoteSubtitlesEnabled(a)},e.prototype._onLibraryButtonClicked=function(){this._background.setSubtitleLoading(!0),this._showPage("library")},e.prototype._onMobileLibraryButtonClicked=function(){this._showPage("library")},e.prototype._onCancelSubscriptionButtonClicked=function(){var a=this.querySelector("#button-cancel-stripe");a.classList.add("button-disabled"),a.onclick=null,this._background.cancelStripeSubscription(),inject("AnalyticsInterface").triggerSubscriptionCancelled()},e.prototype._onPaypalCancelSubscriptionButtonClicked=function(){var a=this.querySelector("#button-cancel-paypal");a.classList.add("button-disabled"),a.onclick=null,this._background.cancelPaypalSubscription(),inject("AnalyticsInterface").triggerSubscriptionCancelled()},e.prototype._launchPremiumCheckout=function(){this._background.launchPremiumCheckout()},e.prototype.showAll=function(a){for(var b=0;b<a.length;b++)a[b].style.removeProperty("display")},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:b.SettingsDialog=e}(b),function(a){var b=a.ElementView||require("common/ui/ElementView"),c=function(){b.call(this,".watch-wrapper"),this._optIn=!1,this._watchedFirstVideo=!1,this._backgroundCommunicator=inject("BackgroundCommunicator"),this._recentlyDownloadedView=inject("RecentlyDownloadedView"),this._elMadeBy=document.querySelector(".made-by"),this._elContinueWatching=document.querySelector("#continue-watching"),this._elNoItems=document.querySelector("#no-items"),this._elNoItemsDownloaded=document.querySelector("#no-items-downloaded"),this._continueWatchingDialogEl=document.querySelector("#open-tab-information-dialog"),this._continueWatchingDialogEl.onclick=this._onContinueWatchingDialogClick,this._continueWatchingTitleEl=document.querySelector("#continue-watching-title"),this._continueWatchingTitleEl.onclick=this._onContinueWatchingTitleClick,this._recentlyDownloadedEl=document.querySelector("#recently-downloaded-title"),this._recentlyDownloadedEl.onclick=this._onRecentlyDownloadedElClick,this._settings=inject("VideostreamSettings"),this._settings.on("localMediaContentSuggestionsOptInChanged",this._onLocalMediaContentSuggestionsOptInChanged.bind(this)),this._settings.getLocalMediaContentSuggestionsOptIn(this._onLocalMediaContentSuggestionsOptInChanged.bind(this)),this._elRecentlyDownloaded=document.querySelector("#recently-downloaded"),this._bindEvents()};c.prototype=Object.create(b.prototype),c.prototype._bindEvents=function(a){this._backgroundCommunicator.on("continue-watching-file-failed-to-load",this._onContinueWatchingFileFailedToLoad.bind(this)),this._settings.on("continueWatchingListChanged",this._onContinueWatchingListUpdated.bind(this)),this._settings.on("watchedFirstVideoChanged",this._userHasWatchedFirstVideo.bind(this))},c.prototype._userHasWatchedFirstVideo=function(a){this._watchedFirstVideo=a,this._recentlyDownloadedView=inject("RecentlyDownloadedView"),this._recentlyDownloadedView._watchedFirstVideo=a,this._checkUIVisibility()},c.prototype._onLocalMediaContentSuggestionsOptInChanged=function(a){this._optIn=a,this._checkUIVisibility()},c.prototype._onContinueWatchingFileFailedToLoad=function(a){var b=inject("UnableToLoadFileDialog");b.setFilePath(a),b.show()},c.prototype._onContinueWatchingDialogClick=function(){inject("ContinueWatchingDialog").show()},c.prototype._onContinueWatchingTitleClick=function(){document.getElementById("recently-downloaded-title").classList.remove("selected"),document.getElementById("loading-wheel-recently-downloaded").classList.remove("selected"),document.getElementById("refresh-button-recently-downloaded").classList.remove("selected"),this.classList.add("selected"),document.getElementById("recently-downloaded").style.display="none",document.getElementById("continue-watching").style.display="flex"},c.prototype._onRecentlyDownloadedElClick=function(){document.getElementById("continue-watching-title").classList.remove("selected"),document.getElementById("loading-wheel-recently-downloaded").classList.add("selected"),document.getElementById("refresh-button-recently-downloaded").classList.add("selected"),this.classList.add("selected"),document.getElementById("continue-watching").style.display="none",document.getElementById("recently-downloaded").style.display="flex"},c.prototype._checkUIVisibility=function(){this._recentlyDownloadedView=inject("RecentlyDownloadedView"),this._optIn&&this._watchedFirstVideo?(this._continueWatchingTitleEl.click(),this._continueWatchingTitleEl.style.display="block",this._continueWatchingDialogEl.style.display="block",this._elMadeBy.style.display="none",this._recentlyDownloadedView._optIn&&this._recentlyDownloadedView._watchedFirstVideo?document.getElementById("continue-watching-title").style.marginLeft="4px":document.getElementById("continue-watching-title").style.marginLeft="0px"):(this._recentlyDownloadedView._optIn&&this._recentlyDownloadedView._watchedFirstVideo&&(this._recentlyDownloadedView._recentlyDownloadedEl.click(),document.getElementById("recently-downloaded-title").style.marginLeft="0px"),this._elContinueWatching.style.display="none",this._continueWatchingTitleEl.style.display="none",this._elMadeBy.style.removeProperty("display"),this._recentlyDownloadedView._optIn&&this._recentlyDownloadedView._watchedFirstVideo||this._optIn&&this._watchedFirstVideo||(this._continueWatchingDialogEl.style.display="none"))},c.prototype._onContinueWatchingListUpdated=function(a){if(a){for(var b=this,c=this._elContinueWatching.children,d=0;d<c.length;d++)"item-wrapper"===c[d].className&&(b._elContinueWatching.removeChild(c[d]),d--);if(0===a.length)this._elNoItems.style.removeProperty("display");else{this._elNoItems.style.display="none";for(var d=0;d<a.length;d++){var e=this._createListItem(a[d]);e.onclick=this._onItemClick.bind(this),this._elContinueWatching.insertBefore(e,this._elNoItems)}for(var d=0;d<5-a.length;d++){var f=document.createElement("div");f.className="item-wrapper",f.style.backgroundImage="none",f.style.width="145px",f.style.border="rgba(0, 0, 0, 0) 1px solid",this._elContinueWatching.insertBefore(f,this._elNoItems)}}this._optIn&&this._watchedFirstVideo&&(this.show(),this._elMadeBy.style.display="none")}},c.prototype._onItemClick=function(a){var b=a.path[0].className.indexOf("playlist-item-remove-button")>=0,c=a.currentTarget.item;b?this._backgroundCommunicator.removeFromContinueWatchingList(c.retainedEntry):this._backgroundCommunicator.loadFileByRetainedEntry(c.retainedEntry)},c.prototype._createListItem=function(a){var b=a.metadata,c=document.createElement("div");c.className="item-wrapper",c.style.backgroundImage="url(data:image/jpg;base64,"+btoa(String.fromCharCode.apply(null,a.screenshot.data))+")";var d=document.createElement("div");d.className="right-aligner";var e=document.createElement("button");e.className="playlist-item-remove-button button-flat button-small button-clear dobby dobby-x",d.appendChild(e);var f=document.createElement("div");f.className="title-wrapper";var g=document.createElement("span");g.className="title",g.innerHTML=b&&b.series?b.series:a.filename;var h=document.createElement("span");h.className="subtitle",b&&b.series&&b.episodes.length>0&&(h.innerHTML="",b.season&&(h.innerHTML="Season "+b.season+" "),h.innerHTML+="Episode "+b.episodes[0]);var i=document.createElement("div");i.style.background="rgba(10,10,10,1)",i.style.height="2px";var j=document.createElement("div");j.style.width=a.progress?100*a.progress+"%":"0%",j.style.backgroundColor="#ef6c00",j.style.height="2px",i.appendChild(j),f.appendChild(g),f.appendChild(h),f.appendChild(i);var k=document.createElement("div");k.className="cover-up";var l=document.createElement("div");return l.className="play-icon",k.appendChild(l),c.appendChild(d),c.appendChild(f),c.appendChild(k),c.item=a,c},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.UserContentView=c}(b),function(a){var b=a.ElementView||require("common/ui/ElementView"),c=function(){b.call(this,".watch-wrapper"),this._optIn=!1,this._hasNaCl=!0,this._isChromebook=!1,this._featureEnabled=!0,this._watchedFirstVideo=!1,this._isScanning=!1,this._directoryListLength,this._settingsDialog=inject("SettingsDialog"),this._settings=inject("VideostreamSettings"),this._backgroundCommunicator=inject("BackgroundCommunicator"),this._elMadeBy=document.querySelector(".made-by"),this._elNoItemsDownloaded=document.querySelector("#no-items-downloaded"),this._continueWatchingDialogEl=document.querySelector("#open-tab-information-dialog"),this._recentlyDownloadedEl=document.querySelector("#recently-downloaded-title"),this._recentlyDownloadedEl.onclick=this._onRecentlyDownloadedElClick,this._recentlyDownloadedBarEl=document.querySelector("#recently-downloaded"),this._elRecentlyDownloaded=document.querySelector("#recently-downloaded"),this._elRecentlyDownloadedSetup=document.querySelector("#recently-downloaded-setup"),this._elToggleContinueWatchingPrompt=document.querySelector("#toggle-continue-watching-prompt"),this._elSetUpRecentlyDownloadedPrompt=document.querySelector("#set-up-recently-downloaded-prompt"),this._elToggleRecentlyDownloadedPrompt=document.querySelector("#toggle-recently-downloaded-prompt"),this._elLoadingStuff=document.querySelector("#loading-wheel-recently-downloaded"),this._elReloadQueue=document.querySelector("#refresh-button-recently-downloaded"),this._elReloadQueue.onclick=this._onReloadQueueClick.bind(this),this._continueWatchingList=[],this._bindEvents()};c.prototype=Object.create(b.prototype),c.prototype._bindEvents=function(a){this._backgroundCommunicator.on("recently-downloaded-files",this._onRecentlyDownloadedFiles.bind(this)),
this._backgroundCommunicator.on("file-not-found",this._onRecentlyDownloadedFileFailedtoLoad.bind(this)),this._backgroundCommunicator.on("library-directories-added",this._onLibraryDirectoryAdded.bind(this)),this._backgroundCommunicator.on("library-directories-removed",this._onLibraryDirectoryRemoved.bind(this)),this._backgroundCommunicator.on("library-directories-list",this._onLibraryDirectoryList.bind(this)),this._backgroundCommunicator.on("native-client-missing-plugin",this._onNativeClientMissingPlugin.bind(this)),this._backgroundCommunicator.on("library-scan-end",this._onLibraryScanHasEnded.bind(this)),this._backgroundCommunicator.on("library-scan-begin",this._onLibraryScanHasBegun.bind(this)),this._backgroundCommunicator.on("videostream-platform-info",this._onPlatformInfoGiven.bind(this)),this._backgroundCommunicator.on("recent-download-continue-option",this._onRecentDownloadContinueOption.bind(this)),this._settings.on("recentlyDownloadedContentSuggestionsOptInChanged",this._onRecentlyDownloadedContentSuggestionsOptInChanged.bind(this)),this._settings.on("continueWatchingListChanged",this._onContinueWatchingListChanged.bind(this))},c.prototype._onNativeClientMissingPlugin=function(){this._hasNaCl=!1,this._checkUIVisibility()},c.prototype._onRecentlyDownloadedContentSuggestionsOptInChanged=function(a){this._optIn=a,this._checkUIVisibility()},c.prototype._onPlatformInfoGiven=function(a,b){this._isChromebook=a.indexOf("Linux")>-1&&b.indexOf("CrOS")>-1,this._checkUIVisibility()},c.prototype._onContinueWatchingListChanged=function(a){this._continueWatchingList=a||[],this._recentlyDownloadedFilesList&&this._onRecentlyDownloadedFiles(this._recentlyDownloadedFilesList)},c.prototype._onLibraryDirectoryList=function(a){if((document.getElementById("non-chromium-native-client-missing-plugin").classList.contains("visible")||document.getElementById("chromium-native-client-missing-plugin").classList.contains("visible"))&&(this._hasNaCl=!1,this.setLibraryNoItemsDownloaded(),document.getElementById("no-items-downloaded").style.display="none"),this._hasNaCl)if(this._directoryListLength=a.length,0===a.length){for(var b=this._elRecentlyDownloaded.children,c=0;c<b.length;c++)"item-wrapper"!==b[c].className&&"item-wrapper emptybox"!==b[c].className||(this._elRecentlyDownloaded.removeChild(b[c]),c--);this.setLibraryNoItemsDownloaded()}else{if("flex"===document.getElementById("no-items-downloaded").style.display)this._hasNaCl&&(document.getElementById("videos-are-loading").style.display="flex");else{for(var d,b=this._elRecentlyDownloaded.children,c=0;c<b.length;c++)if("item-wrapper"===b[c].className||"item-wrapper emptybox"===b[c].className){d=!0;break}d||this._hasNaCl&&(document.getElementById("videos-are-loading").style.display="flex")}document.getElementById("no-items-downloaded").style.display="none",document.getElementById("recent-downloads-text").style.paddingLeft="8px",this._showLoadingScreen()}},c.prototype.initialize=function(){(document.getElementById("non-chromium-native-client-missing-plugin").classList.contains("visible")||document.getElementById("chromium-native-client-missing-plugin").classList.contains("visible"))&&(this._hasNaCl=!1,this.setLibraryNoItemsDownloaded(),document.getElementById("no-items-downloaded").style.display="none"),this._userContentView=inject("UserContentView"),this._checkUIVisibility(),this._settings.on("watchedFirstVideoChanged",this._userHasWatchedFirstVideo.bind(this)),this._elRecentlyDownloadedSetup.addEventListener("click",this._onRecentlyDownloadedSetup.bind(this)),this._elToggleRecentlyDownloadedPrompt.addEventListener("click",this._onToggleRecentlyDownloadedPrompt.bind(this)),this._elSetUpRecentlyDownloadedPrompt.addEventListener("click",this._onSetUpRecentlyDownloadedPrompt.bind(this)),this._elToggleContinueWatchingPrompt.addEventListener("click",this._onToggleContinueWatchingPrompt.bind(this)),this._hasNaCl&&!this._isChromebook&&(this._backgroundCommunicator.getRecentlyDownloaded(5),this._backgroundCommunicator.libraryGetDirectories(),this._backgroundCommunicator.startQuickScan(),this._backgroundCommunicator.startInitialScan())},c.prototype._userHasWatchedFirstVideo=function(a){this._watchedFirstVideo=a,this._userContentView=inject("UserContentView"),this._userContentView._watchedFirstVideo=a,this._checkUIVisibility()},c.prototype._onLibraryDirectoryAdded=function(){this._hasNaCl&&!this._isChromebook&&this._backgroundCommunicator.libraryGetDirectories()},c.prototype._onReloadQueueClick=function(){this._hasNaCl&&!this._isChromebook&&(this._backgroundCommunicator.startQuickScan(),this._backgroundCommunicator.startInitialScan())},c.prototype._onLibraryDirectoryRemoved=function(){this._hasNaCl&&!this._isChromebook&&this._backgroundCommunicator.libraryGetDirectories()},c.prototype._checkUIVisibility=function(){this._isChromebook&&(this._optIn=!1,document.getElementById("recently-downloaded-opt-in-checkbox").style.display="none",document.getElementById("recently-downloaded-dialog-header").style.display="none",document.getElementById("recently-downloaded-dialog-body").style.display="none",document.getElementById("button-settings-navigate-library").style.display="none",document.getElementById("button-settings-navigate-mobile").style.display="none",document.getElementById("settings-page-main").style.maxWidth="86%"),this._watchedFirstVideo?document.getElementById("nuke-field").style.display="flex":document.getElementById("nuke-field").style.display="none",this._hasNaCl&&!this._isChromebook&&this._backgroundCommunicator.libraryGetDirectories(),this._userContentView=inject("UserContentView"),this._optIn&&this._watchedFirstVideo?(this._recentlyDownloadedEl.click(),this._recentlyDownloadedEl.style.display="flex",this._elMadeBy.style.display="none",this._continueWatchingDialogEl.style.display="block",this._userContentView._optIn&&this._userContentView._watchedFirstVideo?document.getElementById("continue-watching-title").style.marginLeft="4px":document.getElementById("continue-watching-title").style.marginLeft="0px",this._hasNaCl===!1?(document.getElementById("no-nacl").style.display="flex",document.getElementById("videos-are-loading").style.display="none"):document.getElementById("no-nacl").style.display="none","flex"!=this._elLoadingStuff.style.display&&"flex"!=this._elReloadQueue.style.display&&(this._hasNaCl?(this._elReloadQueue.style.display="flex",document.getElementById("recent-downloads-text").style.paddingLeft="8px"):document.getElementById("recent-downloads-text").style.paddingLeft="27px",document.getElementById("recent-downloads-text").innerHTML="Recent Downloads",document.getElementById("recent-downloads-text").style.paddingRight="12px")):(this._userContentView._optIn&&this._userContentView._watchedFirstVideo&&(this._userContentView._continueWatchingTitleEl.click(),document.getElementById("continue-watching-title").style.marginLeft="0px"),this._recentlyDownloadedEl.style.display="none",this._recentlyDownloadedBarEl.style.display="none",this._elMadeBy.style.removeProperty("display"),this._userContentView._optIn&&this._userContentView._watchedFirstVideo||this._optIn&&this._watchedFirstVideo||(this._continueWatchingDialogEl.style.display="none"),this._elReloadQueue.style.display="none",this._elLoadingStuff.style.display="none")},c.prototype._onLibraryScanHasEnded=function(){this._isScanning=!1},c.prototype._onLibraryScanHasBegun=function(){this._showLoadingScreen(),this._isScanning=!0},c.prototype._onRecentlyDownloadedFiles=function(a){if(this._recentlyDownloadedFilesList=a,this._hasNaCl){document.getElementById("videos-are-loading").style.display="none";var b=this;this._isScanning===!1&&(b._elLoadingStuff.style.display="none",b._elReloadQueue.style.display="flex",document.getElementById("recent-downloads-text").innerHTML="Recent Downloads",document.getElementById("recent-downloads-text").style.paddingRight="12px");for(var c=this._elRecentlyDownloaded.children,d=0;d<c.length;d++)"item-wrapper"!==c[d].className&&"item-wrapper emptybox"!==c[d].className||(b._elRecentlyDownloaded.removeChild(c[d]),d--);if(0===a.length)this._elNoItemsDownloaded.style.removeProperty("display"),this._elReloadQueue.style.display="none";else{var e=!1;if(a.length<5&&(e=!0),this._elNoItemsDownloaded.style.display="none",document.getElementById("recent-downloads-text").style.paddingLeft="8px",this._directoryListLength>0){for(var d=0;d<a.length;d++)if("no file found"===a[d].screenshot)a.splice(d,1),d--;else{this._continueWatchingList.forEach(function(b){b.path===a[d].path&&(a[d].progress=b.progress)});var f=this._createListItemDownloaded(a[d]);f.onclick=this._onItemClick.bind(this),this._elRecentlyDownloaded.insertBefore(f,this._elNoItemsDownloaded)}for(var d=0;d<5-a.length;d++){var g=document.createElement("div");g.className="item-wrapper",g.style.border="rgba(240, 240, 240, 0) 1px solid",g.style.opacity="0.7",e?g.style.backgroundImage="none":(g.innerHTML='<div style="display: flex;flex-direction: column;color: rgba(240, 240, 240, .9);position: absolute;bottom: 35px;text-align: center;width: 145px;z-index: 2;padding-top: 1px;"><span style="color: $white;">Looking for Videos...</span></div>',g.style.backgroundImage="url(/img/loadingvideo.png)"),g.classList.add("emptybox"),this._elRecentlyDownloaded.insertBefore(g,this._elNoItemsDownloaded)}}else this.setLibraryNoItemsDownloaded()}}},c.prototype.setLibraryNoItemsDownloaded=function(){document.getElementById("no-items-downloaded").style.display="flex",document.getElementById("videos-are-loading").style.display="none",document.getElementById("refresh-button-recently-downloaded").style.display="none",document.getElementById("loading-wheel-recently-downloaded").style.display="none",document.getElementById("recent-downloads-text").innerHTML="Recent Downloads",document.getElementById("recent-downloads-text").style.paddingLeft="27px",document.getElementById("recent-downloads-text").style.paddingRight="12px"},c.prototype._onRecentlyDownloadedFileFailedtoLoad=function(a){var b=inject("UnableToLoadFileDialog");b.setFilePath(a),b.show()},c.prototype._createListItemDownloaded=function(a){var b=document.createElement("div");b.className="item-wrapper",a.screenshot?b.style.backgroundImage="url(data:image/jpg;base64,"+a.screenshot+")":b.style.backgroundImage="url(/img/loadingvideo.png)";var c=document.createElement("div");c.className="right-aligner",c.style.height="20px";var d=document.createElement("button");d.className="playlist-item-remove-button button-flat button-small button-clear dobby dobby-x",c.appendChild(d);var e=document.createElement("div");e.className="title-wrapper";var f=document.createElement("span");f.className="title",a.hasOwnProperty("series")?f.innerHTML=a.series:"_UNCATAGORIZED_"!=a.title&&"_HOMEMOVIE_"!=a.title?f.innerHTML=a.title:f.innerHTML=a.path.replace(/^.*[\\\/]/,"");var g=document.createElement("span");g.className="subtitle",a.hasOwnProperty("season")?(g.innerHTML="Season "+a.season,a.hasOwnProperty("episodes")&&(g.innerHTML+=" Episode "+a.episodes[0])):g.innerHTML="";var h=document.createElement("div");h.style.background="rgba(10,10,10,1)",h.style.height="2px";var i=document.createElement("div");i.style.width=a.progress?100*a.progress+"%":"0%",i.style.backgroundColor="#ef6c00",i.style.height="2px",h.appendChild(i),e.appendChild(f),e.appendChild(g),e.appendChild(h);var j=document.createElement("div");j.className="cover-up";var k=document.createElement("div");return k.className="play-icon",j.appendChild(k),b.appendChild(c),b.appendChild(e),b.appendChild(j),b.item=a,b},c.prototype._onItemClick=function(a){var b=a.path[0].className.indexOf("playlist-item-remove-button")>=0,c=a.currentTarget.item;b?this._backgroundCommunicator.setFileDeleted(c):this._backgroundCommunicator.loadLibraryItem(c.path)},c.prototype._onRecentlyDownloadedSetup=function(){this._settingsDialog.show(),document.getElementById("button-settings-navigate-library").click()},c.prototype._onToggleRecentlyDownloadedPrompt=function(){document.getElementById("tab-information-dialog-dismiss").click(),this._settingsDialog.show(),document.getElementById("button-settings-navigate-other").click()},c.prototype._onToggleContinueWatchingPrompt=function(){document.getElementById("tab-information-dialog-dismiss").click(),this._settingsDialog.show(),document.getElementById("button-settings-navigate-other").click()},c.prototype._onSetUpRecentlyDownloadedPrompt=function(){document.getElementById("tab-information-dialog-dismiss").click(),this._settingsDialog.show(),document.getElementById("button-settings-navigate-library").click()},c.prototype._showLoadingScreen=function(){(document.getElementById("non-chromium-native-client-missing-plugin").classList.contains("visible")||document.getElementById("chromium-native-client-missing-plugin").classList.contains("visible"))&&(this._hasNaCl=!1,this.setLibraryNoItemsDownloaded(),document.getElementById("no-items-downloaded").style.display="none"),this._hasNaCl&&(document.getElementById("recent-downloads-text").innerHTML="Refreshing...",document.getElementById("recent-downloads-text").style.paddingRight="50px",this._elLoadingStuff.style.display="flex",this._elReloadQueue.style.display="none")},c.prototype._onRecentDownloadContinueOption=function(a){this._resumeVideoPrompt=inject("RecentDownloadResumeAsk"),this._resumeVideoPrompt.show(a)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.RecentlyDownloadedView=c}(b),function(b){var c=b.ElementView||require("common/ui/ElementView"),d=b.RemoteSettings||require("common/RemoteSettings"),e=function(){function a(){var a=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return a?parseInt(a[2],10):-1}var e=this;c.call(this,"#header-view"),this._splitTestController=inject("SplitTestController"),this._background=inject("BackgroundCommunicator"),this._analytics=inject("AnalyticsInterface"),this._settingsDialog=inject("SettingsDialog"),this._chromecast=inject("Chromecast"),this._loader=inject("LoaderOverlayView"),this._goPremiumButton=this.querySelector("#button-go-premium"),this._goPremiumWrapper=this.querySelector("#go-premium-wrapper"),this._upgradeWrapper=this.querySelector("#upgrade-wrapper"),this._saleTag=this.querySelector(".sale-tag"),this._saleTagUpgrade=this.querySelector(".sale-tag-upgrade"),this._saleTagBlue=this.querySelector("#blue-sale"),this._newTagIOS=this.querySelector("#iOS-app-wrapper .new-tag"),this._newTagAndroid=this.querySelector("#android-app-wrapper .new-tag"),this._helpButton=this.querySelector("#button-help"),this._settingsButton=this.querySelector("#button-settings"),this._castButton=this.querySelector("#button-cast"),this._androidButton=this.querySelector("#get-android-remote"),this._upgradeButton=this.querySelector("#button-upgrade"),this._helpDialog=inject("HelpDialog"),this._currentHelpDialog=this._antivirusHelpDialog,this._background.on("premium",this._onPremium.bind(this)),this._background.on("standard",this._onStandard.bind(this)),this._bindControls(),this._chromecast.isNewApiAsync(function(a,b){function c(a){a?(e._castButton.querySelector(".disconnected").style.display="none",e._castButton.querySelector(".connected").style.display="inline-block"):(e._castButton.querySelector(".connected").style.display="none",e._castButton.querySelector(".disconnected").style.display="inline-block")}b&&(e._castButton.style="",e._chromecast.hasSession(c),e._chromecast.on("session",c))}),d.fetch(function(a){a&&(a.enableSale===!0&&e.setPromoEnabled(!0),a.enableAndroidNewTag===!0&&e.setAndroidNewTagEnabled(!0),a.enableIOSNewTag===!0&&e.setIOSNewTagEnabled(!0))});var f=b.navigator.userAgent;f.indexOf("CrOS")>-1&&f.indexOf("Chrome")>-1&&a()<44&&new DialogView("#help-dialog-chromeos",{dismissElements:".dismiss"}).show()};e.prototype=Object.create(c.prototype),e.prototype._bindControls=function(){this._goPremiumButton.addEventListener("click",this._onGoPremiumButtonClick.bind(this)),this._helpButton.addEventListener("click",this._onHelpButtonClick.bind(this)),this._settingsButton.addEventListener("click",this._onSettingsButtonClick.bind(this)),this._castButton.addEventListener("click",this._onCastButtonClick.bind(this)),this._androidButton.addEventListener("click",this._onAndroidButtonClick.bind(this)),this._upgradeButton.addEventListener("click",this._onUpgradeButtonClick.bind(this))},e.prototype._onPremium=function(a){console.debug(a),null!==a&&(a.match("lifetime")||a.match(/premium_[a-z]*_subscription/))&&(this._upgradeWrapper.style.display="none"),this._goPremiumWrapper.style.display="none",this._el.classList.add("premium"),document.body.classList.remove("newrelease")},e.prototype._onStandard=function(){this._upgradeWrapper.style.display="none",this._goPremiumWrapper.style.removeProperty("display"),this._el.classList.remove("premium"),a.identity.getAuthToken({interactive:!1},function(a){a||document.body.classList.add("newrelease")})},e.prototype._onGoPremiumButtonClick=function(){this._background.launchPremiumCheckout()},e.prototype._onHelpButtonClick=function(){this._helpDialog.show()},e.prototype._onSettingsButtonClick=function(){this._settingsDialog.show()},e.prototype._onCastButtonClick=function(){var a=this;this._chromecast.openSession(function(){a._loader.hide()})},e.prototype._onAndroidButtonClick=function(){this._analytics._onAndroidDownload()},e.prototype._onUpgradeButtonClick=function(){this._background.launchPremiumCheckout()},e.prototype.setPromoEnabled=function(a){a?(this._saleTag.style.removeProperty("display"),this._saleTagUpgrade.style.removeProperty("display")):(this._saleTag.style.display="none",this._saleTagUpgrade.style.display="none")},e.prototype.setAndroidNewTagEnabled=function(a){this._newTagAndroid&&a?this._newTagAndroid.style.removeProperty("display"):this._newTagAndroid.style.display="none"},e.prototype.setIOSNewTagEnabled=function(a){this._newTagIOS&&a?this._newTagIOS.style.removeProperty("display"):this._newTagIOS.style.display="none"},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:b.HeaderView=e}(b),function(a){var b=a.ElementView||require("common/ui/ElementView"),c=function(){b.call(this,"#main-view"),this._analytics=inject("AnalyticsInterface"),this._selectVideoButton=this.querySelector("#button-select-video"),this._selectChromecastView=inject("SelectChromecastView"),this._dragAndDropSelectVideoButton=document.querySelector("#button-drag-and-drop-select-video"),this._background=inject("BackgroundCommunicator"),this._bindControls()};c.prototype=Object.create(b.prototype),c.prototype._bindControls=function(){this._selectVideoButton.addEventListener("click",this._onSelectVideoButtonClick.bind(this)),this._dragAndDropSelectVideoButton.addEventListener("click",this._onSelectVideoButtonClick.bind(this))},c.prototype._onSelectVideoButtonClick=function(){var a=this;a.launchChromeFileSelector()},c.prototype.launchChromeFileSelector=function(){this._background.selectMedia()},c.prototype.show=function(){this._el.classList.remove("gone")},c.prototype.hide=function(){this._el.classList.add("gone")},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.MainView=c}(b);var A=function(){ElementView.call(this,"#select-chromecast-view"),this._hideTimeout=null,this._chromecast=inject("Chromecast")};A.prototype=Object.create(ElementView.prototype),A.prototype.blockOnce=function(){this._blockOnce=!0},A.prototype.show=function(){return clearTimeout(this._hideTimeout),this._blockOnce?void(this._blockOnce=!1):(this._chromecast.isNewApi()?this._el.classList.add("media-router"):this._el.classList.remove("media-router"),void this._el.classList.add("visible"))},A.prototype.hide=function(){var a=this;this._hideTimeout=setTimeout(function(){a._el.classList.remove("visible")},50)};var B=function(){EventEmitter.call(this),this._background=inject("BackgroundCommunicator"),this.console={log:console.log,info:console.info,warn:console.warn,error:console.error}};B.prototype=Object.create(EventEmitter.prototype),B.getInstance=function(){return B._instance||(B._instance=new B),B._instance},B.prototype.hijack=function(){console.log=this.trace.bind(this),console.info=this.info.bind(this),console.warn=this.warn.bind(this),console.error=this.error.bind(this);var c=this;b.onerror=function(b,d,e,f,g){function h(){if(!g.stack.match(/-101/)){var b=a.runtime.getManifest(),c=b?b.version:"0.0.0.0",d=inject("ParseStackTrace"),e="https://api.parse.com/1/classes/DesktopStackTrace2";d.query(e,{name:g.name,stack:g.stack,message:g.message,version:c})}}c.error(g.stack),h()}},B.prototype.trace=function(){this.console.log.apply(console,arguments);var a=[].slice.call(arguments);a.unshift("log"),this._background.log.apply(this._background,a)},B.prototype.info=function(){this.console.info.apply(console,arguments);var a=[].slice.call(arguments);a.unshift("info"),this._background.log.apply(this._background,a)},B.prototype.warn=function(){this.console.warn.apply(console,arguments);var a=[].slice.call(arguments);a.unshift("warn"),this._background.log.apply(this._background,a)},B.prototype.error=function(){this.console.error.apply(console,arguments);var a=[].slice.call(arguments);a.unshift("error"),this._background.log.apply(this._background,a)},B.prototype.getBlobUrl=function(){var a=new Blob(this._logLines,{type:"application/octet-stream"}),b=URL.createObjectURL(a);return b},function(b){function c(a){var b=new Date(a);return b.getUTCMonth()+1+"/"+b.getUTCDate()+"/"+b.getUTCFullYear()}var d,e=b.EventEmitter||require("lib/EventEmitter"),f=b.analytics||require("lib/google-analytics-bundle"),g=b.SettingsStore||require("common/SettingsStore"),h=b.SyncdSettingsStore||require("common/SyncdSettingsStore"),i=b.VideostreamSettings||require("common/Settings"),j=function(){var a=this;e.call(this),this._service=f.getService("ChromestreamApp"),this._parse=inject("ParseAPI");var b;this._service.getConfig().addCallback(function(a){b=a}),this._tracker=this._service.getTracker("UA-36247732-8"),this._lastProgressEventDate=Date.now(),this._filename="",this._title="",this._subtitle="",this._sentEvents={},this._todaySentEvents={},this._goals={},this._installedVersion=-1,this._settingsStore=g.getInstance(),this._syncdSettingsStore=h.getInstance(),this._settings=i.getInstance(),this._lastProgressEventTime=0,this._currentRunningTime=0,this.enableLog=!0,this._settings.getInstallDate(function(b){a._installDate=b}),this._settingsStore.get("isMobileLoadedMediaUser",function(b){a._isMobileLoadedMediaUser=b}),this._settingsStore.get("isMobileRemoteControlUser",function(b){a._isMobileRemoteControlUser=b}),this._settingsStore.get("isMobilePairedUser",function(b){a._isMobilePairedUser=b})};j.getInstance=function(){return d||(d=new j),d},j.prototype=Object.create(e.prototype),j.prototype.sendEvent=function(){var a=[].slice.call(arguments);if(this.enableLog)switch(a.length){case 1:console.debug("AnalyticsInterface.sendEvent",a[0]);break;case 2:console.debug("AnalyticsInterface.sendEvent",a[0],a[1]);break;case 3:console.debug("AnalyticsInterface.sendEvent",a[0],a[1],a[2]);break;case 4:console.debug("AnalyticsInterface.sendEvent",a[0],a[1],a[2],a[3])}this._tracker.sendEvent.apply(this._tracker,a)},j.prototype.sendAppView=function(a){console.debug("AnalyticsInterface.sendAppView",a),this._tracker.sendAppView(a)},j.prototype.hijackEvents=function(a){j.prototype.sendEvent=a},j.prototype.hijackAppViews=function(a){j.prototype.sendAppView=a},j.prototype.sendSplitEvent=function(a,b){if(this._splitTestGroups)for(var c=0;c<this._splitTestGroups.length;c++){var d="SplitEventsSentOnce";b&&(d+=b),this.sendEvent(d,this._splitTestGroups[c],a);var e="v"+this._installedVersion;b&&(e+=b),this.sendEvent(e,this._splitTestGroups[c],a)}},j.prototype.sendSplitEventForFirstTime=function(a,b){var c=this;if(!this._sentEvents[a]){if(!this._sentEvents.hasOwnProperty(a))return void this._settingsStore.get(a,function(d){var e=d;c._sentEvents[a]=e,e||c.sendSplitEventForFirstTime(a,b)});if(this._splitTestGroups)for(var d=0;d<this._splitTestGroups.length;d++){var e="SplitEventsSentOnce";b&&(e+=b),this.sendEvent(e,this._splitTestGroups[d],a);var f="v"+this._installedVersion;b&&(f+=b),this.sendEvent(f,this._splitTestGroups[d],a)}this._sentEvents[a]=!0,this._settingsStore.set(a,!0)}},j.prototype.sendEventForFirstTime=function(a,b,c){var d=this,e=a;if(b&&(e+=", "+b,c&&(e+=", "+c)),!this._sentEvents[e]){if(!this._sentEvents.hasOwnProperty(e))return void this._settingsStore.get(e,function(f){var g=f;g||(b?c?d.sendEvent(a,b,c):d.sendEvent(a,b):d.sendEvent(a)),d._sentEvents[e]=!0,d._settingsStore.set(e,!0)});this.sendEvent(a,b,c),this._sentEvents[e]=!0,this._settingsStore.set(e,!0)}},j.prototype.sendEventOnceToday=function(a,b,c){var d=this,e=a;b&&(e+=", "+b,c&&(e+=", "+c)),this._todaySentEvents[e]||(this._todaySentEvents[e]=!0,this._settingsStore.get("onceToday:"+e,function(f){if(f=f||0,f<Date.now()){d.sendEvent(a,b,c);var g=new Date;g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0),g=g.getTime()+864e5,d._settingsStore.set("onceToday:"+e,g,function(){d._todaySentEvents[e]=!1})}else d._todaySentEvents[e]=!1}))},j.prototype._createNewGoal=function(a){var b=this,c="goal-"+a,d="created",e="reached";if(this._goals[a]!==d&&this._goals[a]!==e){if(!this._goals.hasOwnProperty(a))return void this._settingsStore.get(c,function(f){var g=f;g!==d&&g!==e&&(b.sendEvent("v"+b._installedVersion+"-goal",a,d),b._goals[a]=d,b._settingsStore.set(c,d))});this.sendEvent("v"+this._installedVersion+"-goal",a,d),this._goals[a]=d,this._settingsStore.set(c,d)}},j.prototype._reachGoal=function(a){var b=this,c="goal-"+a,d="created",e="reached";if(this._goals[a]!==e){if(!this._goals.hasOwnProperty(a))return void this._settingsStore.get(c,function(f){var g=f;g===d&&(b.sendEvent("v"+b._installedVersion+"-goal",a,e),b._goals[a]=e,b._settingsStore.set(c,e))});this.sendEvent("v"+this._installedVersion+"-goal",a,e),this._goals[a]=e,this._settingsStore.set(c,e)}},j.prototype.triggerGoalCreated=function(a){for(var b=0;b<this._splitTestGroups.length;b++)this._createNewGoal(this._splitTestGroups[b]+"-"+a)},j.prototype.triggerGoalReached=function(a){for(var b=0;b<this._splitTestGroups.length;b++)this._reachGoal(this._splitTestGroups[b]+"-"+a)},j.prototype.setInstalledVersion=function(a){this._installedVersion=a},j.prototype.setInstallDate=function(a){this._installDate=a},j.prototype.setSplitGroups=function(a){this._splitTestGroups=a},j.prototype.triggerUserCpu=function(){var b=this;a.system.cpu.getInfo(function(a){b._cpuModel=a.modelName,console.log("User CPU: "+b._cpuModel);var c=864e5,d=7*c*8;Date.now()-b._installDate<c?b.sendEventForFirstTime("User CPU 2","Under A Day",b._cpuModel):Date.now()-b._installDate>d&&b.sendEventForFirstTime("User CPU 2","Over Two Months",b._cpuModel),b.sendEventForFirstTime("User CPU 2","All Users",b._cpuModel)})},j.prototype._triggerDailyActive=function(){var a=new Date(Date.now()),b=a.getUTCDate()+"/"+(a.getUTCMonth()+1)+"/"+a.getUTCFullYear();this.sendEventForFirstTime("Daily Active",b);var c=inject("SplitTestController").getTestGroup("oldUserGroup");"control"===c?this.sendEventForFirstTime("Daily Active - July 10 - Control",b):"master"===c&&this.sendEventForFirstTime("Daily Active - July 10 - Master",b),this._isMobileLoadedMediaUser&&this.sendEventForFirstTime("Daily Active Mobile Loaded Media User",b),this._isMobileRemoteControlUser&&this.sendEventForFirstTime("Daily Active Mobile Remote Control User",b),this._isMobilePairedUser&&this.sendEventForFirstTime("Daily Active Mobile Paired User",b)},j.prototype._triggerWeeklyActive=function(){var a=new Date(Date.now()),b=a.getUTCDay(),c=0;b<5?c=-b-2:b>5&&(c=-b+5),c=1e3*c*60*60*24;var d=new Date(Date.now()+c),e=d.getUTCDate()+"/"+(d.getUTCMonth()+1)+"/"+d.getUTCFullYear();this.sendEventForFirstTime("Weekly Active",e),this.sendEventForFirstTime("Weekly Active 2015.04.21",e);var f=inject("SplitTestController").getTestGroup("oldUserGroup");"control"===f?this.sendEventForFirstTime("Weekly Active - July 10 - Control",e):"master"===f&&this.sendEventForFirstTime("Weekly Active - July 10 - Master",e),this._isMobileLoadedMediaUser&&this.sendEventForFirstTime("Weekly Active Mobile Loaded Media User",e),this._isMobileRemoteControlUser&&this.sendEventForFirstTime("Weekly Active Mobile Remote Control User",e),this._isMobilePairedUser&&this.sendEventForFirstTime("Weekly Active Mobile Paired User",e)},j.prototype.triggerAppStarted=function(){this.sendEvent("Started App"),this.sendSplitEventForFirstTime("Started App")},j.prototype.triggerAppLoaded=function(){this.sendEvent("Loaded App"),this.sendSplitEventForFirstTime("Loaded App")},j.prototype.triggerFirewallRetry=function(){this.sendEvent("Playback","Firewall Retry Attempt"),this.sendAppView("Firewall_Retry")},j.prototype.triggerFirewallPortFixDownload=function(){this.sendEvent("Playback","Firewall Portfix Download"),this.sendAppView("Firewall_Portfix_Download")},j.prototype.triggerChromecastNotFound=function(){this.sendEvent("Chromecast","Not Found")},j.prototype.triggerChromecastTimeoutReinitializeFailure=function(){this.sendEvent("BackgroundChromecast","reinitialize-failure")},j.prototype.triggerChromecastTimeout=function(){this.sendEvent("BackgroundChromecast","timeout-attempting-reinitialize")},j.prototype.triggerButtonPressed=function(a){this.sendEventForFirstTime("Button Pressed",a)},j.prototype.triggerPickFile=function(a){this.sendSplitEventForFirstTime("Pick File Button")},j.prototype.triggerLoadMovie=function(a,b,c){this._title=a,this._subtitle=b,this._filename=c,this.sendEvent("FilePicked",this._filename),this.sendSplitEventForFirstTime("File Picked")},j.prototype.triggerPlaying=function(){function a(){var a=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!a&&parseInt(a[2],10)}this.sendEvent("Play",this._filename),this.sendEvent("Chrome Version",a()),this.calculateBuffering()},j.prototype.triggerPaused=function(){this.sendEvent("Pause",this._filename),this._settings.incrementTotalPaused(),this.calculateBuffering()},j.prototype.triggerStopped=function(){this.sendEvent("Stop",this._filename),this.calculateBuffering()},j.prototype.calculateBuffering=function(){if(this._mediaBufferTime){var a=(Date.now()-this._mediaBufferTime)/1e3;this._settings.incrementTotalBufferingTime(a),this._mediaBufferTime=null}},j.prototype.triggerMovieProgress=function(a){var b=this;if(!this._lastProgressEventDate||Date.now()-this._lastProgressEventDate>6e4){this._lastProgressEventDate=Date.now();var c=this._title;this._subtitle&&(c+=" "+this._subtitle),this.sendEvent("NewMovieProgress",c,this._filename),this.sendSplitEventForFirstTime("File started playing"),this._triggerDailyActive(),this._triggerWeeklyActive(),this._settings.incrementTotalWatchedTime(this._currentRunningTime,function(a){b._triggerTotalWatchedProgress(a)}),this._currentRunningTime=0}var d=a-this._lastProgressEventTime;d>0&&d<15&&(this._currentRunningTime+=d),this._lastProgressEventTime=a,this._triggerTotalWatchedProgress(this._currentRunningTime)},j.prototype._triggerTotalWatchedProgress=function(a){a>1&&(this.sendEventForFirstTime("Total watched duration","1 second"),this.sendSplitEventForFirstTime("1 second","-watched")),a>30&&(this.sendEventForFirstTime("Total watched duration","30 second"),this.sendSplitEventForFirstTime("30 second","-watched")),a>60&&(this.sendEventForFirstTime("Total watched duration","1 minute"),this.sendSplitEventForFirstTime("1 minute","-watched")),a>120&&(this.sendEventForFirstTime("Total watched duration","2 minutes"),this.sendSplitEventForFirstTime("2 minute","-watched")),a>180&&(this.sendEventForFirstTime("Total watched duration","3 minutes"),this.sendSplitEventForFirstTime("3 minute","-watched")),a>300&&(this.sendEventForFirstTime("Total watched duration","5 minutes"),this.sendSplitEventForFirstTime("5 minutes","-watched")),a>600&&(this.sendEventForFirstTime("Total watched duration","10 minutes"),this.sendSplitEventForFirstTime("10 minutes","-watched")),a>1200&&(this.sendEventForFirstTime("Total watched duration","20 minutes"),
this.sendSplitEventForFirstTime("20 minutes","-watched")),a>1800&&(this.sendEventForFirstTime("Total watched duration","30 minutes"),this.sendSplitEventForFirstTime("30 minutes","-watched")),a>3600&&(this.sendEventForFirstTime("Total watched duration","1 hour"),this.sendSplitEventForFirstTime("1 hour","-watched")),a>7200&&(this.sendEventForFirstTime("Total watched duration","2 hour"),this.sendSplitEventForFirstTime("2 hour","-watched")),a>10800&&(this.sendEventForFirstTime("Total watched duration","3 hour"),this.sendSplitEventForFirstTime("3 hour","-watched")),a>18e3&&(this.sendEventForFirstTime("Total watched duration","5 hour"),this.sendSplitEventForFirstTime("5 hour","-watched")),a>36e3&&(this.sendEventForFirstTime("Total watched duration","10 hour"),this.sendSplitEventForFirstTime("10 hour","-watched")),a>72e3&&(this.sendEventForFirstTime("Total watched duration","20 hour"),this.sendSplitEventForFirstTime("20 hour","-watched")),a>18e4&&(this.sendEventForFirstTime("Total watched duration","50 hour"),this.sendSplitEventForFirstTime("50 hour","-watched")),a>36e4&&(this.sendEventForFirstTime("Total watched duration","100 hour"),this.sendSplitEventForFirstTime("100 hour","-watched"))},j.prototype.logBrowserVersion=function(a){this.sendEventForFirstTime("Chromecast","Browser",a)},j.prototype.triggerSubtitlesLoaded=function(a,b){this.sendEvent("SubtitlesLoaded",a,b)},j.prototype.triggerInternalSRTSubtitleLoaded=function(){this.sendEvent("internalSRTSubtitleLoaded")},j.prototype.triggerSplitTests=function(a){for(var b=0;b<a.length;b++)this.sendEvent("splitTest",a[b]);this._splitTestGroups=a},j.prototype.triggerProbeActive=function(){this.sendEvent("ProbeActive")},j.prototype.triggerProbeComplete=function(){this.sendEvent("ProbeComplete")},j.prototype.triggerPlaylistNext=function(){this.sendEvent("playlistNext")},j.prototype.triggerPlaylistPrevious=function(){this.sendEvent("playlistPrevious")},j.prototype.triggerPremiumCheckoutLoaded=function(){this.sendEvent("Premium Checkout");var a=inject("SplitTestController").getTestGroup("premiumFlow");this.sendEvent("Premium Checkout-"+a)},j.prototype.triggerPremiumPlanSelected=function(a){this.sendEvent("Premium Plan Selected",a)},j.prototype.triggerPremiumPaymentAttempt=function(a){this.sendEvent("Premium Payment Attempt",a);var b=inject("SplitTestController").getTestGroup("premiumFlow");this.sendEvent("Premium Payment Attempt-"+b,a)},j.prototype.triggerPremiumPaymentSuccess=function(a){this.sendEvent("paymentSuccess",a);var b=inject("SplitTestController").getTestGroup("premiumFlow");this.sendEvent("paymentSuccess-"+b,a)},j.prototype.triggerPremiumLoginAttempt=function(a){this.sendEvent("Premium Login Attempt",a)},j.prototype.triggerPremiumLoginSuccess=function(){this.sendEvent("Premium Login Success")},j.prototype.triggerPremiumAbandon=function(){this.sendEvent("Premium Abandon")},j.prototype.triggerSubscriptionCancelled=function(){this.sendEvent("Subscription Cancelled")},j.prototype.sendNotPlaying=function(){this.sendAppView("Not_Playing")},j.prototype.sendVideoQualityView=function(a,b){a!=-1&&(a=null==a?"NT":a<=240?"240p":a<=360?"360p":a<=480?"480p":a<=720?"720p":a<=1080?"1080p":"BufferCity",b=b||"Original",this.sendAppView("Play_"+a+"_"+b))},j.prototype.qualityPresetSelected=function(a){var b="Original";null!=a&&(b=a.name),this.sendEvent("Playback","Quality Preset Selected",b)},j.prototype.qualityPresetsOpened=function(){this.sendEvent("Playback","Quality Presets Opened")},j.prototype.triggerNativeMissingPlugin=function(){this.sendEvent("Native","Missing Plugin")},j.prototype.triggerNativeStartupCrash=function(){this.sendEvent("Native","Startup Crash")},j.prototype.triggerNativeLoading=function(){this.sendEvent("Native","Loading")},j.prototype.triggerNativeCommunicationFailure=function(){this.sendEvent("Native","Ping Failure")},j.prototype.triggerNativeCrash=function(b){if(!inject._forceAssembly&&!inject._forceFFmpegAssembly){this.sendEvent("Native","Crash",b);var c=a.runtime.getManifest(),d=c?c.version:"0.0.0.0",e={filename:this._filename,testgroup:inject("SplitTestController").getTestGroupString(),cpu:this._cpuModel,version:d},f=inject("VideostreamNativeModule"),g=f&&f.arch();g&&(e.arch=g);var h=inject("PlaybackController");h&&(e.lastPlaybackEvent=h._lastProgressEvent,e.qualityPreset=h._qualityPreset);var i="https://api.parse.com/1/classes/NativeCrash8";inject("ParseStackTrace").query(i,e)}},j.prototype.triggerNativeCrashRecovery=function(){this.sendEvent("Native","Recovering")},j.prototype.triggerNativeCrashRecoveryFailure=function(a){this.sendEvent("Native","Recovery Failed",a)},j.prototype.triggerNativeCrashRecoverySuccess=function(){this.sendEvent("Native","Recovery Success")},j.prototype.triggerNativeLoaded=function(){this.sendEvent("Native","Loaded")},j.prototype.triggerBindleLoading=function(){this.sendEvent("Bindle","Loading")},j.prototype.triggerBindleLoadFailure=function(a){this.sendEvent("Bindle","Load Failure",a)},j.prototype.triggerBindleLoaded=function(){this.sendEvent("Bindle","Loaded")},j.prototype.triggerScreenshotLoading=function(){this.sendEvent("Screenshot","Loading")},j.prototype.triggerScreenshotLoadFailure=function(a){this.sendEvent("Screenshot","Load Failure",a)},j.prototype.triggerScreenshotLoaded=function(){this.sendEvent("Screenshot","Loaded")},j.prototype.triggerProbeRequest=function(){this.sendEvent("Probe","Requested")},j.prototype.triggerProbeTimedOut=function(){this.sendEvent("Probe","Timed Out")},j.prototype.triggerProbeFileSourceForced=function(){this.sendEvent("Probe","File Source Forced")},j.prototype.triggerProbeFailure=function(a){this.sendEvent("Probe","Failure",a)},j.prototype.triggerProbeSuccess=function(){this._settings.incrementTotalVideosLoaded()},j.prototype.triggerNoCastExtension=function(){this.sendEvent("Chromecast","No Cast Extension")},j.prototype.triggerLoadMedia=function(){this.sendEvent("Playback","Load Media")},j.prototype.triggerIncompatibleFile=function(a){this.sendEvent("Playback","Incompatible File",a),this.sendAppView("Incompatible_File")},j.prototype.triggerNoNetwork=function(){this.sendEvent("Playback","No Network"),this.sendAppView("No_Network")},j.prototype.triggerFirewallBlock=function(){var a;a=navigator.appVersion.indexOf("Win")!=-1?"Windows":navigator.appVersion.indexOf("Mac")!=-1?"OSX":navigator.appVersion.indexOf("Linux")!=-1?"Linux":"Other",this.sendEvent("Playback","Firewall Block",a),this.sendAppView("Firewall_Block")},j.prototype.triggerChromecastConnectTimeout=function(a){this.sendEvent("Chromecast","Connect Timeout",a)},j.prototype.triggerFirewallFalsePositive=function(){this.sendEvent("Playback","Firewall False Positive")},j.prototype.triggerAntivirusBlock=function(){this.sendEvent("Playback","Antivirus Block"),this.sendAppView("Antivirus_Block")},j.prototype.triggerPlaybackLoadError=function(a){this.sendEvent("Playback","Controller Load Failure",a)},j.prototype.triggerLoadCastMediaFailure=function(a){this.sendEvent("Playback","Load Cast Media Failure",a)},j.prototype.triggerLoadedCastMedia=function(){this.sendEvent("Playback","Loaded Media")},j.prototype.triggerMediaTranscodeType=function(a,b){this.sendEvent("Media",a?"Transcoding":"Passthrough",b?"Video":"Not Video")},j.prototype.triggerMediaBuffering=function(a){this._mediaBufferTime=Date.now(),this.sendEvent("Buffering",a?"Transcoding":"Passthrough");var b=inject("SplitTestController").getTestGroup("superHLS");if(a&&b){var c=inject("SplitTestController").isOldUser(),d=inject("SplitTestController").isBrandNewUser();b+=c?"-oldUser":d?"-brandNewUser":"-newUser",this.sendEvent("SuperHLSv4","Buffering-"+b)}},j.prototype.triggerStutterWarning=function(){this.sendEvent("Playback","Stutter Warning")},j.prototype.triggerImageViewed=function(a){this.sendEvent("NewImageProgress",a)},j.prototype.triggerChromecastSessionEvent=function(a){var b=this;inject("SettingsStore").get("watchedFirstVideo",function(c){inject("VideostreamSettings").getInstallDate(function(d){d>=SplitTestController.OLD_USER_CUTOFF&&(c||b.sendEvent("Chromecast-Session-Request",a))})})},j.prototype.triggerAppLauncherUnavailableLaunch=function(){var a=this;inject("SettingsStore").get("appLauncherTestGroup",function(b){a.sendEvent("app-launcher-unavailable","launch",b||"null")})},j.prototype.triggerAppLauncherUnavailableError=function(){var a=this;inject("SettingsStore").get("appLauncherTestGroup",function(b){a.sendEvent("app-launcher-unavailable","receiver_unavailable",b||"null")})},j.prototype._generateDateString=function(){var a=new Date;return a.getFullYear()+"/"+(a.getMonth()+1<10?"0":"")+a.getMonth()+"/"+(a.getDate()<10?"0":"")+a.getDate()},j.prototype.triggerWallFunnel=function(b,c){if(1==b||b===this._lastWallFunnelNumber+1){var d=Date.now(),e=this._lastWallFunnelTime||d,f=(b<=9?"0":"")+b+". "+c;1==b&&(e=d),this._lastWallFunnelNumber=b,this._lastWallFunnelAction=c,this._lastWallFunnelTime=d,Date.now()-this._installDate<864e5?this.sendEvent("wall-funnel-past-day",f,this._generateDateString(),d-e):this._installDate<SplitTestController.OLD_USER_CUTOFF?this.sendEvent("wall-funnel-before-apr-01",f,this._generateDateString(),d-e):this.sendEvent("wall-funnel-after-apr-01",f,this._generateDateString(),d-e),this.sendEventOnceToday("wall-funnel-"+a.runtime.getManifest().version,f,this._generateDateString(),d-e);var g=inject("SplitTestController").getTestGroup("superHLS");if(g){var h=inject("SplitTestController").isOldUser(),i=inject("SplitTestController").isBrandNewUser();g+=h?"-oldUser":i?"-brandNewUser":"-newUser",this.sendEvent("wall-funnel-superhls-v3-"+g,f,this._generateDateString(),d-e)}}},j.prototype.triggerKillSwitchFunnel=function(){var a=Date.now(),b=this._lastWallFunnelTime||a,c=this._lastWallFunnelNumber||0,d=this._lastWallFunnelAction||"null",e=null;null!=d&&(e=(c<=9?"0":"")+c+". "+d),Date.now()-this._installDate<864e5?this.sendEvent("kill-switch-funnel-past-day",e,this._generateDateString(),a-b):this._installDate<SplitTestController.OLD_USER_CUTOFF?this.sendEvent("kill-switch-funnel-before-apr-01",e,this._generateDateString(),a-b):this.sendEvent("kill-switch-funnel-after-apr-01",e,this._generateDateString(),a-b)},j.prototype.startStopwatch=function(a){this._stopwatches||(this._stopwatches={}),this._stopwatches[a]=performance.now()},j.prototype.cancelStopwatch=function(a){this._stopwatches&&this._stopwatches[a]&&delete this._stopwatches[a]},j.prototype.stopStopwatch=function(a){if(this._stopwatches&&this._stopwatches[a]){var b=Math.round(performance.now()-this._stopwatches[a]);delete this._stopwatches[a],this.sendEvent("Profiling","Stopwatch",a,b)}},j.prototype.sendPlaylistPath=function(a){this.sendEvent("PlaylistPath",a)},j.prototype._onMobilePaired=function(){this.sendEvent("MobilePaired")},j.prototype.fileSystemScannerTraversing=function(){this.sendEventOnceToday("FileSystemScanner","Traversal Started Today")},j.prototype.fileSystemScannerTransactionStuck=function(){this.sendEvent("FileSystemScanner","Transaction Stuck"),this.sendEventOnceToday("FileSystemScanner","Transaction Stuck Today")},j.prototype._onMobileLoadMediaSuccess=function(){this.sendEvent("MobileLoadMedia","Success")},j.prototype._onMobileLoadMediaFail=function(a){this.sendEvent("MobileLoadMedia","Fail",a)},j.prototype._onLibraryCreated=function(a){this.sendEventForFirstTime("LibraryCreated",a);var b=this;this._settingsStore.get("library-analytics-level",function(a){a||(a=Math.random(),b._settingsStore.set("library-analytics-level",a))})},j.prototype.scanStarted=function(){var a=this;this._settingsStore.get("library-analytics-level",function(b){null!=b&&b>.98&&a.sendEvent("MediaLibrary","Scan Started")})},j.prototype.scanCompleted=function(){var a=this;this._settingsStore.get("library-analytics-level",function(b){null!=b&&b>.98&&a.sendEvent("MediaLibrary","Scan Completed")})},j.prototype._onPlaying=function(a){this.sendEvent("MobilePlaying",a)},j.prototype._onLibrarySize=function(a){this.sendEvent("LibrarySize",a)},j.prototype._onDownloadComplete=function(a){this.sendEvent("DownloadComplete",a)},j.prototype._onLibraryItemAdded=function(a){var b="https://api.parse.com/1/classes/LibraryItem";this._parse.query(b,a)},j.prototype._onLibraryMovieAdded=function(a){var b="https://api.parse.com/1/classes/LibraryMovie";this._parse.query(b,a)},j.prototype._onLibraryShowAdded=function(a){var b="https://api.parse.com/1/classes/LibraryShow";this._parse.query(b,a)},j.prototype._onLibrarySubtitleAdded=function(a){var b="https://api.parse.com/1/classes/LibrarySubtitle";this._parse.query(b,a)},j.prototype._onAndroidDownload=function(){this.sendEvent("AndroidDownload")},j.prototype.triggerChooseDevice=function(a){this.sendEvent("ChooseDevice",a)},j.prototype.sendNetworkBufferEvents=function(a,b,c,d){var e=a/1e3/b;this.sendEvent("NETWORK_BUFFER_"+d,c?"TRANSCODE":"NON_TRANSCODE",e)},j.prototype.videoQualitySurveyResult=function(a){this.sendEvent("VideoQualitySurvey",a)},j.prototype._triggerNewInstall=function(){this.sendEventForFirstTime("Install base","New Install")},j.prototype._triggerDuplicateInstall=function(){this.sendEventForFirstTime("Install base","Duplicate Install")},j.prototype.triggerHLSTestStarted=function(){var a=inject("SplitTestController").getTestGroup("superHLS");if(a){var b=inject("SplitTestController").isOldUser(),c=inject("SplitTestController").isBrandNewUser();a+=b?"-oldUser":c?"-brandNewUser":"-newUser",this.sendEvent("SuperHLSv4","Movie Started - "+a)}},j.prototype.triggerHLSVariableSuccess=function(){var a=inject("SplitTestController").getTestGroup("superHLS");if(a){var b=inject("SplitTestController").isOldUser(),c=inject("SplitTestController").isBrandNewUser();a+=b?"-oldUser":c?"-brandNewUser":"-newUser",this.sendEvent("SuperHLSv4","Movie Variable Success - "+a)}},j.prototype.triggerHLSTestEnded=function(){var a=inject("SplitTestController").getTestGroup("superHLS");if(a){var b=inject("SplitTestController").isOldUser(),c=inject("SplitTestController").isBrandNewUser();a+=b?"-oldUser":c?"-brandNewUser":"-newUser",this.sendEvent("SuperHLSv4","Movie Ended - "+a)}},j.prototype.triggerReceiverVersion=function(a){this.sendEvent("Chromecast","Receiver Version",a)},j.prototype.triggerCastApiStatusTrue=function(){this.sendEvent("CastApi","StatusTrue2")},j.prototype.triggerCastApiStatusFalse=function(){this.sendEvent("CastApi","StatusFalse2")},j.prototype.triggerCastApiActionStop=function(){this.sendEvent("CastApi","ActionStop2")},j.prototype.triggerCastApiUnwarrantedDisconnect=function(a){this.sendEvent("CastApi","UnwarrantedDisconnect-"+a)},j.prototype.triggerCastApiUnwarrantedDisconnectUnderTwoMinutes=function(a){this.sendEvent("CastApi","UnwarrantedDisconnectUnderTwoMinutes-"+a)},j.prototype.setMobileLoadedMediaUser=function(){this._isMobileLoadedMediaUser||(this._isMobileLoadedMediaUser=!0,this._settingsStore.set("isMobileLoadedMediaUser",!0,function(){}))},j.prototype.setMobileRemoteControlUser=function(){this._isMobileRemoteControlUser||(this._isMobileRemoteControlUser=!0,this._settingsStore.set("isMobileRemoteControlUser",!0,function(){}))},j.prototype.setMobilePairedUser=function(){this._isMobilePairedUser||(this._isMobilePairedUser=!0,this._settingsStore.set("isMobilePairedUser",!0,function(){}))},j.prototype.triggerExitedDueToBuffering=function(a){this.sendEvent("UserExitedDueToBuffering",a)},j.prototype._connectAndDisconnect=function(b,c,d,e){a.sockets.tcp.connect(b,c,d,function(c){a.sockets.tcp.disconnect(b),e&&e(c>=0)})},j.prototype.onBindFail=function(){this.sendEvent("WebserverBlocked","Failed-Bind")},j.prototype.onRebindSuccess=function(){this.sendEvent("WebserverBlocked","Success-Rebind")},j.prototype.onRebindFail=function(){this.sendEvent("WebserverBlocked","Failed-Rebind")},j.prototype.onRebindPartialFail=function(){this.sendEvent("WebserverBlocked","Partial-Fail-Rebind")},j.prototype.triggerPlayerReloadAttempt=function(){var a=inject("SplitTestController").getTestGroup("playbackControllerReload");a&&(this._playerReloadAttempt=!0,this.sendEvent("Player-Reloader-"+a,"Attempt"))},j.prototype.triggerPlayerReloadSuccess=function(){var a=inject("SplitTestController").getTestGroup("playbackControllerReload");a&&this._playerReloadAttempt===!0&&(this.sendEvent("Player-Reloader-"+a,"Success"),this._playerReloadAttempt=!1)},j.prototype.triggerCastDeviceType=function(a){this.sendEvent("Cast-Device-Type",a)},j.prototype.triggerAndroidTVReset=function(){this._androidTVAttempt=!1,this._androidTVTranscoding=!1},j.prototype.triggerAndroidTVAttempt=function(a){this._androidTVAttempt=!0,this._androidTVTranscoding=a||!1,this.sendEvent("Cast-AndroidTV-"+(a?"Transcode":"Direct"),"Attempt")},j.prototype.triggerAndroidTV20PercentSuccess=function(){this._androidTVAttempt&&this.sendEvent("Cast-AndroidTV-"+(this._androidTVTranscoding?"Transcode":"Direct"),"20 Percent Reached")},j.prototype.triggerAndroidTV80PercentSuccess=function(){this._androidTVAttempt&&(this.sendEvent("Cast-AndroidTV-"+(this._androidTVTranscoding?"Transcode":"Direct"),"80 Percent Reached"),this.triggerAndroidTVReset())},j.prototype.triggerAppLoadedPremiumTest=function(a,b){this.sendEvent("Loaded App - "+a+" - install: "+c(b))},j.prototype.triggerPremiumCheckoutLoadedPremiumTest=function(a,b){this.sendEvent("Premium Checkout - "+a+" - install: "+c(b))},j.prototype.triggerPremiumPlanSelectedPremiumTest=function(a,b,d){this.sendEvent("Premium Plan Selected - "+a+" - plan: "+d+" - install: "+c(b),d)},j.prototype.triggerPremiumPaymentAttemptPremiumTest=function(a,b,d){this.sendEvent("Premium Payment Attempt - "+a+" - plan: "+d+" - install: "+c(b),d)},j.prototype.triggerPremiumPaymentSuccessPremiumTest=function(a,b,d){this.sendEvent("paymentSuccess - "+a+" - plan: "+d+" - install: "+c(b),d)},j.prototype.triggerPremiumAbandonPremiumTest=function(a,b){this.sendEvent("Premium Abandon - "+a+" - install: "+c(b))},j.prototype.triggerSubscriptionCancelledPremiumTest=function(a,b){this.sendEvent("Subscription Cancelled - "+a+" - install: "+c(b))},j.prototype.minidump=function(b,c){var d=a.runtime.getManifest(),e=d?d.version:"0.0.0.0",f={filename:this._filename,testgroup:inject("SplitTestController").getTestGroupString(),cpu:this._cpuModel,version:e,overflowed:c,dump:b},g=inject("PlaybackController");g&&(f.lastPlaybackEvent=g._lastProgressEvent,f.qualityPreset=g._qualityPreset);var h="https://api.parse.com/1/classes/NativeDump";inject("ParseStackTrace").query(h,f)},j.prototype.triggerEmailRequest=function(a){this.sendEvent("EmailRequest","Attempt-"+a)},j.prototype.triggerContactEmail=function(a,b){var c=this;this._settingsStore.get("contactEmailId",function(d){d||c._settings.getInstallDate(function(d){c.sendEvent("EmailRequest","Success-"+b);var e=inject("ParseChurnData");e.createObject("TestData",{email:a,installDate:d},function(a,b){console.log("AnalyticsInterface.triggerContactEmail: COMPLETE",arguments),!a&&b&&c._settingsStore.set("contactEmailId",b)})})})},j.prototype.triggerChurnDataVideoWatched=function(){this._settingsStore.get("contactEmailId",function(a){if(a){var b=inject("ParseChurnData");b.updateObject("TestData",a,{watchedDate:{__op:"Add",objects:[Date.now()]}},function(a){console.log("AnalyticsInterface.triggerChurnDataVideoWatched: COMPLETE",arguments)})}})},j.prototype.triggerChurnDataTotalWatched=function(){var a=this;this._settingsStore.get("contactEmailId",function(b){b&&a._settings.getTotalWatchedTime(function(a){var c=inject("ParseChurnData");c.updateObject("TestData",b,{totalWatchTime:a})},function(a){console.log("AnalyticsInterface.triggerChurnDataTotalWatched: COMPLETE",arguments)})})},j.prototype.triggerChangeLogSeen=function(a){this.sendEvent("ChangeLog-Launched",a)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=j:b.AnalyticsInterface=j,j.prototype.triggerAppLaunched=function(a){if(a){var b="no source",c="no url";a.source&&(b=a.source),a.url&&(c=a.url),this.sendEvent("onboarding",b,c),("url_handler"==b||"url_handlers"==b&&a.referrerUrl)&&this.sendEvent("onboarding","referral",a.referrerUrl)}}}(b);var C=function(a,b){this._settings=inject("VideostreamSettings"),this.available_queries=C.MAX_API_QUERY,this.available_connections=C.MAX_API_CONNECTIONS,this.waiting_queries=[],this._settings.getUniqueId(function(a){this._userId=a}.bind(this)),this._appId=a,this._apiKey=b};C.MAX_API_QUERY=30,C.MAX_API_CONNECTIONS=30,C.MAX_API_QUERY_TIME=1e3,C.prototype._onQueryAvailable=function(){if(0!=this.available_queries&&0!=this.available_connections){var a=this.waiting_queries.shift();a&&this._query(a.url,a.query,a.resolve,a.reject)}},C.prototype.query=function(a,b){var c=this;return b=b||{},new Promise(function(d,e){return 0==c.available_queries?void c.waiting_queries.push({url:a,query:b,resolve:d,reject:e}):0==c.available_connections?void c.waiting_queries.push({url:a,query:b,resolve:d,reject:e}):void c._query(a,b,d,e)})},C.prototype._query=function(a,b,c,d){var e=this;e.available_connections--,e.available_queries--,setTimeout(function(){e.available_queries++,e._onQueryAvailable()},C.MAX_API_QUERY_TIME);var f=new XMLHttpRequest;f.open("POST",a,!0),f.setRequestHeader("X-Parse-Application-Id",e._appId),f.setRequestHeader("X-Parse-REST-API-Key",e._apiKey),f.setRequestHeader("Content-Type","application/json"),b.userId=this._userId;JSON.stringify(b);f.onload=function(){e.available_connections++,c()},f.onerror=function(){e.available_connections++,d()}},function(a){var b=a.Languages||require("common/Languages"),c=function(){DialogView.call(this,"#track-selection-dialog",{dismissElements:"#button-track-selection-close,.dismiss"}),this._backgroundSubtitleOffsetValue=0,this._backgroundSubtitleTrack="",this._premium=!1,this._background=inject("BackgroundCommunicator"),this._settingsDialog=inject("SettingsDialog"),this._audioTrackDropdown=this.querySelector("#dropdown-audio-track-list"),this._audioTrackWrapper=this.querySelector("#audio-track-wrapper"),this._subtitleTrackDropdown=this.querySelector("#dropdown-subtitle-track-list"),this._subtitleInternalOptionGroup=this.querySelector("#optgroup-subtitle-internal"),this._subtitleExternalOptionGroup=this.querySelector("#optgroup-subtitle-external"),this._subtitleRemoteOptionGroup=this.querySelector("#optgroup-subtitle-remote"),this._subtitleTrackWrapper=this.querySelector("#subtitle-track-wrapper"),this._subtitleEncodingDropdown=this.querySelector("#dropdown-encoding-list"),this._subtitleOffsetInput=this.querySelector("#subtitle-offset-input"),this._addExternalSubtitleButton=this.querySelector("#button-add-external-subtitle-track"),this._onOpenMediaLibraryButton=this.querySelector("#button-open-media-library"),this._unsupportedExternalSubMessage=this.querySelector("#unsupported-external-sub-message"),this._unsupportedInternalSubMessage=this.querySelector("#unsupported-internal-sub-message"),this._subtitleTooLargeMessage=this.querySelector("#external-sub-too-large"),this._remoteSubsErrorMessage=this.querySelector("#remote-subs-error-message"),this._remoteSubsNotFoundMessage=this.querySelector("#remote-subs-not-found-message"),this._remoteSubsDownloadFailedMessage=this.querySelector("#remote-subs-download-failed"),this._openSubtitleSettingsButton=this.querySelector("#more-subtitle-options-button"),this._bindControls(),this._hideAudioTrackWrapper(),this._hideSubtitleTrackWrapper(),this._background.on("audio-track-added",this._onBackgroundAudioTrackAdded.bind(this)),this._background.on("audio-track-removed",this._onBackgroundAudioTrackRemoved.bind(this)),this._background.on("audio-track-selected",this._onBackgroundAudioTrackSelected.bind(this)),this._background.on("subtitle-track-added",this._onBackgroundSubtitleTrackAdded.bind(this)),this._background.on("subtitle-track-removed",this._onBackgroundSubtitleTrackRemoved.bind(this)),this._background.on("subtitle-track-selected",this._onBackgroundSubtitleTrackSelected.bind(this)),this._background.on("subtitle-offset-set",this._onBackgroundSubtitleOffsetSet.bind(this)),this._background.on("subtitle-format-unsupported",this._showUnsupportedSubMessage.bind(this)),this._background.on("subtitle-too-large",this._showSubTooLargeMessage.bind(this)),this._background.on("remote-subs-msg",this._onBackgroundRemoteSubsMessage.bind(this)),this._background.on("loaded",this._onBackgroundPlayerLoaded.bind(this)),this._background.on("external-subtitle-encoding-change",this._onBackgroundSubtitleEncodingChange.bind(this)),this._background.on("premium",this._onPremium.bind(this)),this._background.on("standard",this._onStandard.bind(this))};c.prototype=Object.create(DialogView.prototype),c.prototype._bindControls=function(){this._subtitleTrackDropdown.addEventListener("change",this._onSubtitleTrackChange.bind(this)),this._subtitleEncodingDropdown.addEventListener("change",this._onSubtitleEncodingChanged.bind(this)),this._subtitleOffsetInput.addEventListener("input",this._onSubtitleOffsetInput.bind(this)),this._subtitleOffsetInput.addEventListener("change",this._onSubtitleOffsetChange.bind(this)),this._audioTrackDropdown.addEventListener("change",this._onAudioTrackChange.bind(this)),this._addExternalSubtitleButton.addEventListener("click",this._onAddExternalSubtitleButtonClick.bind(this)),this._onOpenMediaLibraryButton.addEventListener("click",this._onOpenMediaLibraryButtonClick.bind(this)),this._openSubtitleSettingsButton.addEventListener("click",this._onOpenSubtitleSettingsButtonClick.bind(this))},c._shortenString=function(a,b){return a.length>b?(b=(b-3)/2,a.substr(0,b)+"..."+a.substr(a.length-b+1,b)):a},c.prototype._onBackgroundPlayerLoaded=function(){this._hideUnsupportedSubMessage("external"),this._hideSubTooLargeMessage()},c.prototype._onBackgroundSubtitleTrackAdded=function(a){var d=document.createElement("option");d.value=a.supported?a.identifier:"unsupported",d.id="subtitle-track-"+a.identifier,d.disabled=!a.supported;var e=a.language||"und",f=b.CODES[e];f||(f="Unknown","und"!=e&&(f+=" ("+e+")")),d.textContent=(a.supported?"":"[Unsupported Format] ")+f,"internal"==a.type?this._subtitleInternalOptionGroup.appendChild(d):"external"==a.type?(d.textContent+=" [ "+c._shortenString(a.description,60)+" ]",this._subtitleExternalOptionGroup.appendChild(d)):"remote"==a.type&&(d.textContent=(this._premium?"":"🔒 ")+d.textContent+" [ "+c._shortenString(a.description,60)+" ]",this._premium||(d.title="This is Premium only. Click to check out the other Premium Features!"),this._subtitleRemoteOptionGroup.appendChild(d)),this._showSubtitleTrackWrapper(),this._hideUnsupportedSubMessage("external"),"internal"!=a.type||a.supported||this._showUnsupportedSubMessage("internal"),"remote"==a.type&&this._showSubtitleRemoteOptionGroup()},c.prototype._onBackgroundSubtitleTrackRemoved=function(a){this._subtitleTrackDropdown.value==a.identifier&&(this._subtitleTrackDropdown.value="",this._backgroundSubtitleTrack="");var b=this._subtitleTrackDropdown.querySelector("#subtitle-track-"+a.identifier.replace(/\:/g,"\\:"));null!=b&&b.remove(),0==this._getSubtitleTrackCount()&&(this._hideSubtitleTrackWrapper(),this._hideUnsupportedSubMessage("internal")),0==this._getRemoteSubtitleTrackCount()&&this._hideSubtitleRemoteOptionGroup()},c.prototype._onBackgroundSubtitleTrackSelected=function(a){this._subtitleTrackDropdown.value=a,this._backgroundSubtitleTrack=a,this._hideUnsupportedSubMessage("external"),this._hideRemoteSubsMessage("download-failed")},c.prototype._onBackgroundSubtitleEncodingChange=function(a){this._subtitleEncodingDropdown.value=a},c.prototype._onBackgroundSubtitleOffsetSet=function(a){console.log("TrackSelectionDialog._onBackgroundSubtitleOffsetSet",a),this._backgroundSubtitleOffsetValue=a/1e3,this._subtitleOffsetInput.value!=this._backgroundSubtitleOffsetValue&&(this._subtitleOffsetInput.value=this._backgroundSubtitleOffsetValue)},c.prototype._onBackgroundRemoteSubsMessage=function(a){if(this._hideRemoteSubsMessage(),this._premium)switch(a){case"success":break;case"error":this._remoteSubsErrorMessage.classList.add("visible");break;case"no-results":this._remoteSubsNotFoundMessage.classList.add("visible");break;case"download-failed":this._remoteSubsDownloadFailedMessage.classList.add("visible"),this._subtitleTrackDropdown.value="";break;case"download-request":}},c.prototype._onSubtitleEncodingChanged=function(){this._background.setExternalSubtitleEncoding(this._subtitleEncodingDropdown.value)},c.prototype._onSubtitleTrackChange=function(){if(this._premium||this._subtitleTrackDropdown[this._subtitleTrackDropdown.selectedIndex].parentNode!=this._subtitleRemoteOptionGroup)this._background.setSubtitleTrack(this._subtitleTrackDropdown.value);else{var a="test"===inject("SplitTestController").getTestGroup("premiumFlow")?"new":"old";this._background.launchPremiumCheckout(a),this._subtitleTrackDropdown.value=this._backgroundSubtitleTrack}},c.prototype._onSubtitleOffsetInput=function(){var a=this;clearTimeout(this._subtitleOffsetChangeTimeout),this._subtitleOffsetChangeTimeout=setTimeout(function(){""!=a._subtitleOffsetInput.value&&a._background.setSubtitleOffset(Math.floor(1e3*parseFloat(a._subtitleOffsetInput.value)))},1e3)},c.prototype._onSubtitleOffsetChange=function(){""==this._subtitleOffsetInput.value&&(this._subtitleOffsetInput.value=this._backgroundSubtitleOffsetValue)},c.prototype._onAddExternalSubtitleButtonClick=function(){this._background.selectExternalSubtitleFile()},c.prototype._onOpenMediaLibraryButtonClick=function(){this._settingsDialog.show(),this._settingsDialog._showPage("library"),this.hide(),this._background.setSubtitleLoading(!0)},c.prototype._onOpenSubtitleSettingsButtonClick=function(){this._settingsDialog.show(),this._settingsDialog._showPage("subtitles"),this.hide()},c.prototype._onPremium=function(){this._premium=!0},c.prototype._onStandard=function(){this._premium=!1},c.prototype._getSubtitleTrackCount=function(){return this._subtitleTrackDropdown.querySelectorAll("option").length-1},c.prototype._getRemoteSubtitleTrackCount=function(){return this._subtitleRemoteOptionGroup.querySelectorAll("option").length},c.prototype._showAudioTrackWrapper=function(){this._audioTrackWrapper.style.removeProperty("display")},c.prototype._hideAudioTrackWrapper=function(){this._audioTrackWrapper.style.display="none"},c.prototype._showSubtitleTrackWrapper=function(){this._subtitleTrackWrapper.style.removeProperty("display")},c.prototype._hideSubtitleTrackWrapper=function(){this._subtitleTrackWrapper.style.display="none"},c.prototype._showSubtitleRemoteOptionGroup=function(){this._subtitleRemoteOptionGroup.style.removeProperty("display")},c.prototype._hideSubtitleRemoteOptionGroup=function(){this._subtitleRemoteOptionGroup.style.display="none"},c.prototype._showUnsupportedSubMessage=function(a){"external"==a&&this._unsupportedExternalSubMessage.classList.add("visible"),"internal"==a&&this._unsupportedInternalSubMessage.classList.add("visible"),this._hideSubTooLargeMessage()},c.prototype._hideUnsupportedSubMessage=function(a){a&&"external"!==a||this._unsupportedExternalSubMessage.classList.remove("visible"),a&&"internal"!==a||this._unsupportedInternalSubMessage.classList.remove("visible")},c.prototype._showSubTooLargeMessage=function(a){this._subtitleTooLargeMessage.classList.add("visible"),this._hideUnsupportedSubMessage()},c.prototype._hideSubTooLargeMessage=function(){this._subtitleTooLargeMessage.classList.remove("visible")},c.prototype._hideRemoteSubsMessage=function(a){switch(a){default:this._remoteSubsErrorMessage.classList.remove("visible"),this._remoteSubsNotFoundMessage.classList.remove("visible"),this._remoteSubsDownloadFailedMessage.classList.remove("visible");break;case"error":this._remoteSubsErrorMessage.classList.remove("visible");break;case"no-results":this._remoteSubsNotFoundMessage.classList.remove("visible");break;case"download-failed":this._remoteSubsDownloadFailedMessage.classList.remove("visible")}},c.prototype._onBackgroundAudioTrackAdded=function(a){var c=document.createElement("option");c.value=a.identifier,c.id="audio-track-"+a.identifier;var d=a.language||"und",e=b.CODES[d];e||(e="Unknown","und"!=d&&(e+=" ("+d+")"),e+=" [ "+a.description+" ]"),
c.textContent=e,this._audioTrackDropdown.appendChild(c),this._audioTrackDropdown.childElementCount>1&&this._showAudioTrackWrapper()},c.prototype._onBackgroundAudioTrackRemoved=function(a){this._audioTrackDropdown.value==a.identifier&&(this._audioTrackDropdown.value="");var b=this._audioTrackDropdown.querySelector("#audio-track-"+a.identifier.replace(/:/g,"\\:"));null!=b&&b.remove(),this._audioTrackDropdown.childElementCount<=1&&this._hideAudioTrackWrapper()},c.prototype._onBackgroundAudioTrackSelected=function(a){this._audioTrackDropdown.value=a},c.prototype._onAudioTrackChange=function(){this._background.setAudioTrack(this._audioTrackDropdown.value)},c.prototype.hide=function(){this._hideUnsupportedSubMessage("external");var a=this;requestAnimationFrame(function(){a._el.classList.remove("visible"),document.body.removeEventListener("keydown",a._keyPressBind),a.emit("hide")})},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.TrackSelectionDialog=c}(b);var D=function(){DialogView.call(this,"#cast-extension-dialog",{dismissable:!1}),this._helpButton=this.querySelector("#cast-extension-failure-dialog-contact"),this._helpButton.addEventListener("click",this._helpClick.bind(this)),this._analytics=inject("AnalyticsInterface"),this._emitted=!1};D.prototype=Object.create(DialogView.prototype),D.prototype._helpClick=function(){},D.prototype.show=function(){DialogView.prototype.show.call(this),this._emitted||(this._analytics.triggerNoCastExtension(),this._emitted=!0)};var E=function(){DialogView.call(this,"#tab-information-dialog",{dismissElements:"#tab-information-dialog-dismiss,.dismiss"})};E.prototype=Object.create(DialogView.prototype);var F=function(){this._analytics=inject("AnalyticsInterface"),this._background=inject("BackgroundCommunicator"),DialogView.call(this,"#login-dialog",{dismissable:!0,dismissElements:"#login-dialog-dismiss"}),this._loginButton=this.querySelector("#login-dialog-login-button"),this._loginButton.addEventListener("click",this._loginClick.bind(this)),this._loginSpinner=this.querySelector("#login-blocker")};F.prototype=Object.create(DialogView.prototype),F.prototype._loginClick=function(){var b=this;this._loginSpinner.classList.add("visible"),a.identity.getAuthToken({interactive:!0},function(a){a?(b._background.login(),b.hide(),document.body.classList.remove("newrelease")):b._loginSpinner.classList.remove("visible")})},F.prototype.show=function(){DialogView.prototype.show.call(this)},F.prototype.hide=function(){DialogView.prototype.hide.call(this),this._loginSpinner.classList.remove("visible")};var G=function(){DialogView.call(this,"#chromium-native-client-missing-plugin",{dismissElements:".dismiss,#chromium-nacl-missing-plugin-dismiss"}),this._helpButton=this.querySelector("#chromium-nacl-missing-plugin-contact"),this._helpButton.addEventListener("click",this._helpClick.bind(this))};G.prototype=Object.create(DialogView.prototype),G.prototype._helpClick=function(){};var H=function(){DialogView.call(this,"#non-chromium-native-client-missing-plugin",{dismissElements:".dismiss,#non-chromium-nacl-missing-plugin-dismiss"}),this._helpButton=this.querySelector("#non-chromium-nacl-missing-plugin-contact"),this._helpButton.addEventListener("click",this._helpClick.bind(this))};H.prototype=Object.create(DialogView.prototype),H.prototype._helpClick=function(){};var I=function(){DialogView.call(this,"#wifi-failure-dialog",{dismissElements:"#wifi-failure-dialog-dismiss,.dismiss"}),this._helpButton=this.querySelector("#wifi-failure-dialog-contact"),this._helpButton.addEventListener("click",this._helpClick.bind(this))};I.prototype=Object.create(DialogView.prototype),I.prototype._helpClick=function(){};var J=function(){DialogView.call(this,"#simplified-help-dialog",{dismissElements:"#simplified-help-dialog-dismiss,#simplified-x",dismissable:!0}),this._mainDialog=this.querySelector("#main-dialog"),this._stutterDialog=this.querySelector("#stuttering-dialog"),this._loadingDialog=this.querySelector("#loading-dialog"),this._tabcastDialog=this.querySelector("#tabcast-dialog"),this._firewallDialog=this.querySelector("#firewall-dialog"),this._phoneDialog=this.querySelector("#phone-dialog"),this._openDialog=this.querySelector("#open-dialog"),this._otherDialog=this.querySelector("#other-dialog"),this._stutteringBox=this.querySelector("#stuttering-box"),this._loadingBox=this.querySelector("#infinite-loading-box"),this._tabcastBox=this.querySelector("#tab-casting-box"),this._firewallBox=this.querySelector("#firewall-box"),this._phoneBox=this.querySelector("#phone-box"),this._openBox=this.querySelector("#open-box"),this._otherBox=this.querySelector("#other-box"),this._mainTitle=this.querySelector("#dialog-main-title"),this._stutteringTitle=this.querySelector("#dialog-stuttering-title"),this._loadingTitle=this.querySelector("#dialog-loading-title"),this._tabcastTitle=this.querySelector("#dialog-tabcast-title"),this._firewallTitle=this.querySelector("#dialog-firewall-title"),this._phoneTitle=this.querySelector("#dialog-phone-title"),this._openTitle=this.querySelector("#dialog-open-title"),this._otherTitle=this.querySelector("#dialog-other-title"),this._backButton=this.querySelector("#simplified-help-button-back"),this._backButton.addEventListener("click",this._backButtonHandler.bind(this)),this._stutteringBox.addEventListener("click",this._stutteringBoxClickHandler.bind(this)),this._loadingBox.addEventListener("click",this._loadingBoxClickHandler.bind(this)),this._tabcastBox.addEventListener("click",this._tabcastingBoxClickHandler.bind(this)),this._firewallBox.addEventListener("click",this._firewallBoxClickHandler.bind(this)),this._phoneBox.addEventListener("click",this._phoneBoxClickHandler.bind(this)),this._openBox.addEventListener("click",this._openBoxClickHandler.bind(this)),this._otherBox.addEventListener("click",this._otherBoxClickHandler.bind(this))};J.prototype=Object.create(DialogView.prototype),J.prototype.show=function(){this._showDialog("main"),DialogView.prototype.show.call(this)},J.prototype._stutteringBoxClickHandler=function(){this._showDialog("stuttering")},J.prototype._loadingBoxClickHandler=function(){this._showDialog("loading")},J.prototype._tabcastingBoxClickHandler=function(){this._showDialog("tabcast")},J.prototype._firewallBoxClickHandler=function(){this._showDialog("firewall")},J.prototype._phoneBoxClickHandler=function(){this._showDialog("phone")},J.prototype._openBoxClickHandler=function(){this._showDialog("open")},J.prototype._otherBoxClickHandler=function(){this._showDialog("other")},J.prototype._showDialog=function(a){this._mainDialog.classList.add("gone"),this._stutterDialog.classList.add("gone"),this._loadingDialog.classList.add("gone"),this._tabcastDialog.classList.add("gone"),this._firewallDialog.classList.add("gone"),this._phoneDialog.classList.add("gone"),this._openDialog.classList.add("gone"),this._otherDialog.classList.add("gone"),this._mainTitle.classList.add("gone"),this._stutteringTitle.classList.add("gone"),this._loadingTitle.classList.add("gone"),this._tabcastTitle.classList.add("gone"),this._firewallTitle.classList.add("gone"),this._phoneTitle.classList.add("gone"),this._openTitle.classList.add("gone"),this._otherTitle.classList.add("gone"),"main"===a?this._backButton.classList.add("gone"):this._backButton.classList.remove("gone"),this.querySelector("#"+a+"-dialog").classList.remove("gone"),this.querySelector("#dialog-"+a+"-title").classList.remove("gone")},J.prototype._backButtonHandler=function(){this._showDialog("main")};var K=function(){DialogView.call(this,"#cast-timeout-dialog",{dismissElements:"#cast-timeout-dialog-dismiss,.dismiss"});var a=inject("BackgroundCommunicator"),b=this;a.on("cast-session-timeout",function(){b.show()})};K.prototype=Object.create(DialogView.prototype);var L=function(a,b,c){this._parse=inject("ParseAPISurvey"),document.body.appendChild(b),DialogView.call(this,"#"+b.id,{dismissElements:".dismiss,#"+b.id+"-dismiss-button,#"+b.id+"-submit-button"}),this._surveyName=a,this._hooks=c||null};L.prototype=Object.create(DialogView.prototype),L.prototype.show=function(){var a=this.querySelectorAll("input[type=radio]"),b=0;for(b=0;b<a.length;++b)a[b].checked=!1;var c=this.querySelectorAll("input[type=text]");for(b=0;b<c.length;++b)c[b].value="";var d=this.querySelectorAll("input[type=checkbox]");for(b=0;b<d.length;++b)d[b].checked="";DialogView.prototype.show.call(this)},L.prototype.hide=function(){this._collect(),DialogView.prototype.hide.call(this)},L.prototype._runHook=function(a,b){return this._hooks&&this._hooks[a]?this._hooks[a](b):b},L.prototype._collect=function(){var a={},b=this.querySelectorAll("fieldset"),c=0;for(c=0;c<b.length;++c){var d=b[c].querySelector("input[type=radio]:checked");if(d)a[d.name]=this._runHook(d.name,d.value);else{var e=b[c].querySelector("input[type=radio]");e&&(a[e.name]=null)}}var f=this.querySelectorAll("input[type=text]");for(c=0;c<f.length;++c)a[f[c].name]=this._runHook(f[c].name,f[c].value);var g=this.querySelectorAll("input[type=checkbox]");for(c=0;c<g.length;++c)a[g[c].name]=this._runHook(g[c].name,g[c].checked);a=this._runHook(this._surveyName,a);var h="https://api.parse.com/1/classes/"+this._surveyName;this._parse.query(h,a)};var M=function(b,c){var d=document.createElement("div");d.id=b,d.className="dialog survey";var e=document.createElement("div");e.className="dialog-inner",d.appendChild(e);var f=document.createElement("div");f.className="dialog-header";var g=document.createElement("h1");g.innerHTML=c;var h=document.createElement("button");h.id=b+"-close-button",h.className="dismiss button-flat button-small button-white dobby dobby-x",h.title="[close_button_title]",h.dataset.localizeTitle="close_button_title",f.appendChild(g),f.appendChild(h);var i=document.createElement("div");i.className="dialog-body";var j=document.createElement("form");j.addEventListener("submit",function(a){a.preventDefault&&a.preventDefault(),a.returnValue=!1},!1),i.appendChild(j);var k=document.createElement("div");k.className="dialog-footer";var l=document.createElement("button");l.id=b+"-dismiss-button",l.className="button-flat button-white button-small",l.innerHTML=a.i18n.getMessage("survey_dialog_dismiss");var m=document.createElement("button");return m.id=b+"-submit-button",m.className="button-flat button-white-blue button-small",m.innerHTML=a.i18n.getMessage("survey_dialog_submit"),k.appendChild(l),k.appendChild(m),e.appendChild(f),e.appendChild(i),e.appendChild(k),this._dialog=d,this._form=j,this._hooks={},this};M.prototype.addHeader=function(a){var b=document.createElement("h2");return b.innerHTML=a,this._form.appendChild(b),this},M.prototype.addDescription=function(a){var b=document.createElement("p");return b.className="description",b.innerHTML=a,this._form.appendChild(b),this},M.prototype.addParagraph=function(a){var b=document.createElement("p");return b.innerHTML=a,this._form.appendChild(b),this},M.prototype.addTextField=function(a,b,c,d){var e=document.createElement("input");return e.type="text",e.name=a,e.required=!0,e.size=b||60,c&&(e.placeholder=c),this._form.appendChild(e),d&&(this._hooks[a]=d),this},M.prototype.addMultipleChoice=function(a,b,c,d,e){function f(a){return JSON.parse(JSON.stringify(a))}function g(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a}var h=document.createElement("fieldset");h.name=a;var i=f(b);g(i);for(var j=0;j<i.length;++j){var k=document.createElement("input");k.name=a,k.type="radio",k.id=a+"-"+j,k.value=i[j],k.required=!0;var l=document.createElement("label");l.htmlFor=k.id,l.innerHTML="<span></span>"+i[j],h.appendChild(k),h.appendChild(l),h.appendChild(document.createElement("br"))}if(c){var m=document.createElement("input");m.name=a,m.type="radio",m.id=a+"-"+j,m.value="Other",m.required=!0;var n=document.createElement("label");n.htmlFor=m.id,n.innerHTML="<span></span> Other:";var o=document.createElement("input");o.id=a+"OtherReason",o.name=o.id,o.type="text",o.value="",o.size=d||60,o.disabled="disabled",o.placeholder="(Please specify)",h.appendChild(m),h.appendChild(n),h.appendChild(o);var p=function(){o.disabled=m.checked?"":"disabled"};i=h.querySelectorAll("input[type=radio]");for(var q=0;q<i.length;++q)i[q].onchange=p}return this._form.appendChild(h),e&&(this._hooks[a]=e),this},M.prototype.addCheckbox=function(a,b,c){var d=document.createElement("input");d.type="checkbox",d.id=a,d.name=a;var e=document.createElement("label");return e.htmlFor=a,e.innerHTML="<span></span>"+b,this._form.appendChild(d),this._form.appendChild(e),c&&(this._hooks[a]=c),this},M.prototype.addPreSubmitHook=function(a){return a&&(this._hooks[this._dialog.id]=a),this},M.prototype.get=function(){return new L(this._dialog.id,this._dialog,this._hooks)};var N=function(){this._settingsStore=inject("SettingsStore")};N.prototype=Object.create(null);var O=function(){DialogView.call(this,"#notify-premium-playlist",{dismissElements:".dismiss"}),this._background=inject("BackgroundCommunicator"),this._settings=inject("VideostreamSettings"),this._closeButton=this.querySelector("#premium_playlist_notify_no_thanks"),this._closeButton.addEventListener("click",this._closeClick.bind(this)),this._seePremium=this.querySelector("#premium_playlist_notify_go_premium"),this._seePremium.addEventListener("click",this._premiumClick.bind(this)),this._imagesPremium=this.querySelector("#carousel-mask"),this._imagesPremium.addEventListener("click",this._imagesClick.bind(this))};O.prototype=Object.create(DialogView.prototype),O.prototype._premiumClick=function(){this._background.launchPremiumCheckout()},O.prototype._imagesClick=function(){this._background.launchPremiumCheckout()},O.prototype._closeClick=function(){DialogView.prototype.hide.call(this)},O.prototype.hide=function(){DialogView.prototype.hide.call(this),this._imageMask=this.querySelector("#carousel-mask").classList.add("paused")},O.prototype.show=function(){DialogView.prototype.show.call(this),this.querySelector("#carousel-images").classList.remove("paused"),this._settings.setSeenPremiumDialogue(!0)};var P=function(){DialogView.call(this,"#notify-switch-playlist",{dismissElements:".dismiss"}),this._background=inject("BackgroundCommunicator"),this._closeButton=this.querySelector("#switch_playlist_notify_cancel"),this._closeButton.addEventListener("click",this._closeClick.bind(this)),this._imagesPremium=this.querySelector("#carousel-mask")};P.prototype=Object.create(DialogView.prototype),P.prototype._closeClick=function(){DialogView.prototype.hide.call(this)},P.prototype.hide=function(){DialogView.prototype.hide.call(this)},P.prototype.show=function(){DialogView.prototype.show.call(this)};var Q=function(a,b){DialogView.call(this,"#do-you-want-to-build-a-survey",{dismissElements:".dismiss,#no-survey,#yes-survey,#want_to_survey_dialog_dismiss"}),this._yesSurvey=this.querySelector("#yes-survey"),this._yesSurvey.onclick=b,this._title=this.querySelector("#want-to-survey-title"),this._title.innerHTML=a};Q.prototype=Object.create(DialogView.prototype);var R=function(){DialogView.call(this,"#dialog-get-extension",{dismissElements:"#button-extension-dismiss, .dismiss"}),this._downloadButton=this.querySelector("#button-extension-install"),this._downloadButton.addEventListener("click",this._downloadClick.bind(this))};R.prototype=Object.create(DialogView.prototype),R.prototype._downloadClick=function(){};var S=function(){DialogView.call(this,"#chat-request-dialog",{}),this._acceptButton=this.querySelector("#chat-request-accept"),this._dismissButton=this.querySelector("#chat-request-dismiss"),this._acceptButton.addEventListener("click",this._onAcceptButtonClick.bind(this)),this._dismissButton.addEventListener("click",this._onDismissButtonClick.bind(this))};S.prototype=Object.create(DialogView.prototype),S.prototype.show=function(){clearTimeout(this._requestTimeout),clearInterval(this._titleInterval),DialogView.prototype.show.call(this);var a=this;this._requestTimeout=setTimeout(function(){a.hide()},3e4);var b=!1;this._titleInterval=setInterval(function(){b=!b,document.title=b?"Incoming Chat Request":"Videostream"},1500)},S.prototype.hide=function(){DialogView.prototype.hide.call(this),clearTimeout(this._requestTimeout),clearInterval(this._titleInterval),document.title="Videostream"},S.prototype.setOperator=function(a){for(var b=this.querySelectorAll(".operator"),c=0;c<b.length;c++)b[c].style.display="none";for(var d=this.querySelectorAll("."+a),e=0;e<d.length;e++)d[e].style.removeProperty("display")},S.prototype._onAcceptButtonClick=function(){this.hide()},S.prototype._onDismissButtonClick=function(){this.hide()};var T=function(){DialogView.call(this,"#email-request-dialog",{dismissElements:".dismiss"}),this._background=inject("BackgroundCommunicator"),this._analytics=inject("AnalyticsInterface"),this._emailInput=this.querySelector("#email-request-text"),this._submitButton=this.querySelector("#email-request-submit"),this._emailInput.addEventListener("keypress",this._onEmailInputKeyPress.bind(this)),this._submitButton.addEventListener("click",this._onSubmitButtonClick.bind(this))};T.prototype=Object.create(DialogView.prototype),T.prototype._onEmailInputKeyPress=function(a){13===a.keyCode&&this._onSubmitButtonClick()},T.prototype._onSubmitButtonClick=function(){var a=this._emailInput.value;a&&a.indexOf("@")>-1&&(this._background.submitEmail(a,this._messageChoice),this.hide())},T.prototype.show=function(){var a=this.querySelectorAll(".email-request-text");this._messageChoice=Math.floor(Math.random()*a.length),this._analytics.triggerEmailRequest(this._messageChoice),this._emailInput.focus();for(var b=0;b<a.length;b++)b===this._messageChoice?a[b].style.removeProperty("display"):a[b].style.display="none";DialogView.prototype.show.call(this)},T.prototype.hide=function(){this._emailInput.blur(),DialogView.prototype.hide.call(this)};var U=function(){DialogView.call(this,"#resume-ask",{dismissable:!1}),this._background=inject("BackgroundCommunicator"),this._resume=this.querySelector("#resume-now-button"),this._resume.addEventListener("click",this._resumeClick.bind(this)),this._startOver=this.querySelector("#start-over-button"),this._startOver.addEventListener("click",this._startOverClick.bind(this)),this._countdownInterval=null,this._elapsed=this.querySelector("#left-off-at")};U.prototype=Object.create(DialogView.prototype),U.prototype.show=function(a){this._elapsedTimeInS=a,this._countdown=this.querySelector("#automatic-countdown");var b=10;this._countdown.innerHTML=String(b);var c="unknown";if(this._elapsedTimeInS){var d=this._elapsedTimeInS;c=Math.floor(d%60)/10>=1?Math.floor(d%60):"0"+Math.floor(d%60),d/=60,c=Math.floor(d%60)/10>=1?Math.floor(d%60)+":"+c:"0"+Math.floor(d%60)+":"+c,d/=60,0!=Math.floor(d%24)&&(c=Math.floor(d%24)+":"+c);for(var e=0;e<c.length-3&&("0"===c.charAt(0)||":"===c.charAt(0));e++)c=c.substring(1)}else c="unknown";this._elapsed.innerHTML=c;var f=this;this._countdownInterval=setInterval(function(){b<=0?(f._countdown.innerHTML="0",f._resumeClick(),f.hide()):(b-=1,f._countdown.innerHTML=String(b))},1100),DialogView.prototype.show.call(this)},U.prototype._resumeClick=function(){clearInterval(this._countdownInterval),this._background.userSelectedVideoStartTime(this._elapsedTimeInS),this.hide()},U.prototype._startOverClick=function(){clearInterval(this._countdownInterval),this._background.userSelectedVideoStartTime(0),this.hide()};var V=function(){DialogView.call(this,"#resume-recent-download-ask",{dismissable:!1}),this._background=inject("BackgroundCommunicator"),this._resume=this.querySelector("#recent-download-resume-now-button"),this._resume.addEventListener("click",this._resumeClick.bind(this)),this._startOver=this.querySelector("#recent-download-start-over-button"),this._startOver.addEventListener("click",this._startOverClick.bind(this)),this._countdownInterval=null};V.prototype=Object.create(DialogView.prototype),V.prototype.show=function(a){var b=this,c=10;this._countdown=this.querySelector("#automatic-countdown"),this._countdown.innerHTML=String(c),this._countdownInterval=setInterval(function(){c<=0?(b._countdown.innerHTML="0",b._resumeClick(),b.hide()):(c-=1,b._countdown.innerHTML=String(c))},1e3),DialogView.prototype.show.call(this)},V.prototype._resumeClick=function(){clearInterval(this._countdownInterval),this._background._recentDownloadResume(!0),this.hide()},V.prototype._startOverClick=function(){clearInterval(this._countdownInterval),this._background._recentDownloadResume(!1),this.hide()};var W=function(){DialogView.call(this,"#unable-to-load-file-dialog",{dismissElements:"#unable-to-load-file-dialog-dismiss,.dismiss"}),this._pathEl=document.querySelector("#unable-to-load-file-dialog-path")};W.prototype=Object.create(DialogView.prototype),W.prototype.setFilePath=function(a){this._pathEl.innerHTML=a},function(b){b.chrome=b.chrome||{},b.chrome.socketsExtended={tcp:{},udp:{},tcpServer:{}};var c={tcp:{},udp:{},tcpServer:{}};a.socketsExtended.tcp.socketList=c.tcp,a.socketsExtended.udp.socketList=c.udp,a.socketsExtended.tcpServer.socketList=c.tcpServer;var d=function(){a.sockets.tcpServer.getSockets(function(a){for(var b=0;b<a.length;b++){var d=a[b];if(d.name&&d.name.indexOf(":")>-1){var e=d.name.split(":"),f=e[0],g=e[1],h=new j(d.socketId);h.host=f,h.port=g,c.tcpServer[d.socketId]=h}}})},e=function(){a.sockets.udp.getSockets(function(a){for(var b=0;b<a.length;b++){var d=a[b];if(d.name&&d.name.indexOf(":")>-1){var e=d.name.split(":"),f=e[0],g=e[1],h=new i(d.socketId);h.host=f,h.port=g,c.udp[d.socketId]=h}}})};a.socketsExtended.tcp.open=function(b,d){a.sockets.tcp.create(b,function(a){var b=new h(a.socketId);b.on("closed",f),c.tcp[a.socketId]=b,d(b)})},a.socketsExtended.tcpServer.create=function(b,d,e){var f=null;for(var g in c.tcpServer)c.tcpServer[g].host==b&&c.tcpServer[g].port==d&&(f=c.tcpServer[g]);f?(console.log("ChromeSocketsExtended.create","Passing old socket:",f),e&&e(f)):a.socketsExtended.tcpServer.open({persistent:!0,name:b+":"+d},function(a){a.listen(b,d,function(b){console.log("ChromeSocketsExtended.create","Passing new socket:",a),e&&e(a)})})},a.socketsExtended.tcpServer.open=function(b,d){a.sockets.tcpServer.create(b,function(a){var e=new j(a.socketId);b.name&&(e.name=name),e.on("closed",f),c.tcpServer[a.socketId]=e,d(e)})},a.socketsExtended.udp.create=function(b,d,e,f){var g=null;for(var h in c.udp)c.udp[h].host==b&&c.udp[h].port==d&&(g=c.udp[h]);g?(console.log("ChromeSocketsExtended.create","Passing old socket:",g),f&&f(g)):a.socketsExtended.udp.open({persistent:!0,name:b+":"+d},function(a){a.bind(b,d,function(b){console.log("ChromeSocketsExtended.create","Passing new socket:",a),f&&f(a)})})},a.socketsExtended.udp.open=function(b,d){a.sockets.udp.create(b,function(a){var e=new i(a.socketId);b.name&&(e.name=name),e.on("closed",f),c.udp[a.socketId]=e,d(e)})},a.socketsExtended.tcp.closeAll=function(b){a.sockets.tcp.getSockets(function(c){for(var d=0;d<c.length;d++)a.sockets.tcp.close(c[d].socketId);b&&b()})},a.socketsExtended.udp.closeAll=function(b){a.sockets.udp.getSockets(function(c){for(var d=0;d<c.length;d++)a.sockets.udp.close(c[d].socketId);b&&b()})},a.socketsExtended.tcpServer.closeAll=function(b){a.sockets.tcpServer.getSockets(function(c){for(var d=0;d<c.length;d++)a.sockets.tcpServer.close(c[d].socketId);b&&b()})};var f=function(){c[this.type][this.socketId]=null,delete c[this.type][this.socketId],this.removeAllListeners()};a.sockets.tcp.onReceive.addListener(function(a){var b=a.socketId;c.tcp[b]&&c.tcp[b].emit("receive",a)}),a.sockets.tcp.onReceiveError.addListener(function(a){a&&a.socketId&&c.tcp[a.socketId]&&c.tcp[a.socketId].emit("receiveError",a.resultCode)}),a.sockets.udp.onReceive.addListener(function(a){c.udp[a.socketId]&&c.udp[a.socketId].emit("receive",a)}),a.sockets.udp.onReceiveError.addListener(function(a){a&&a.socketId&&c.udp[a.socketId]&&c.udp[a.socketId].emit("receiveError",a.resultCode)}),a.sockets.tcpServer.onAccept.addListener(function(a){if(c.tcpServer[a.socketId]){var b=new h(a.clientSocketId);b.on("closed",f),c.tcp[a.clientSocketId]=b,c.tcpServer[a.socketId].emit("accept",b)}}),a.sockets.tcpServer.onAcceptError.addListener(function(a){console.log("chrome.socketsExtended.tcpServer.onAcceptError",a),a&&a.socketId&&c.udp[a.socketId]&&c.tcpServer[a.socketId].emit("acceptError",a.resultCode)});var g=function(b){EventEmitter.call(this),this._api=a.sockets[b],this.type=b};g.prototype=Object.create(EventEmitter.prototype),g.prototype.update=function(a,b){this._api.update(this.socketId,a,b)},g.prototype.setPaused=function(a,b){this._api.setPaused(this.socketId,a,b)},g.prototype.close=function(a){var b=this;this._api.close(this.socketId,function(){b.emit("closed"),a&&a()})},g.prototype.getInfo=function(a){this._api.getInfo(this.socketId,a)};var h=function(a){g.call(this,"tcp"),this.socketId=a};h.prototype=Object.create(g.prototype),h.prototype.setKeepAlive=function(b,c,d){a.sockets.tcp.setKeepAlive(this.socketId,b,c,d)},h.prototype.setNoDelay=function(b,c){a.sockets.tcp.setNoDelay(this.socketId,b,c)},h.prototype.connect=function(b,c,d){a.sockets.tcp.connect(this.socketId,b,c,d)},h.prototype.secure=function(b,c){a.sockets.tcp.secure(this.socketId,b,c)},h.prototype.disconnect=function(b){a.sockets.tcp.disconnect(this.socketId,b)},h.prototype.send=function(b,c){void 0==c&&(c=function(a){a.resultCode<0&&console.log("ERR sending data on socket, err code: "+a.resultCode)}),b=b.writeInt32BE?b.arrayBuffer:b,a.sockets.tcp.send(this.socketId,b,c)};var i=function(a){g.call(this,"udp"),this.socketId=a};i.prototype=Object.create(g.prototype),i.prototype.bind=function(b,c,d){a.sockets.udp.bind(this.socketId,b,c,d)},i.prototype.send=function(b,c,d,e){a.sockets.udp.send(this.socketId,b,c,d,e)},i.prototype.joinGroup=function(b,c){a.sockets.udp.joinGroup(this.socketId,b,c)},i.prototype.leaveGroup=function(b,c){a.sockets.udp.leaveGroup(this.socketId,b,c)},i.prototype.setMulticastTimeToLive=function(b,c){a.sockets.udp.setMulticastTimeToLive(this.socketId,b,c)},i.prototype.setMulticastLoopbackMode=function(b,c){a.sockets.udp.setMulticastLoopbackMode(this.socketId,b,c)},i.prototype.getJoinedGroups=function(b){a.sockets.udp.getJoinedGroups(this.socketId,b)};var j=function(a){g.call(this,"tcpServer"),this.socketId=a};j.prototype=Object.create(g.prototype),j.prototype.listen=function(b,c,d){this.host=b,this.port=c,a.sockets.tcpServer.listen(this.socketId,b,c,d)},d(),e(),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=a.socketsExtended)}(b),function(a){var b=function(){};b.getByteLength=function(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=1:d<2048?b+=2:d<55296||d>=57344?b+=3:(++c,b+=4)}return b},b.toArrayBuffer=function(a){for(var c=new ArrayBuffer(b.getByteLength(a)),d=new Uint8Array(c),e=0,f=0;f<a.length;f++){var g=a.charCodeAt(f);g<128?d[e++]=g:g<2048?(d[e++]=192|g>>6,d[e++]=128|63&g):g<55296||g>=57344?(d[e++]=224|g>>12,d[e++]=128|g>>6&63,d[e++]=128|63&g):(++f,g=65536+((1023&g)<<10|1023&a.charCodeAt(f)),d[e++]=240|g>>18,d[e++]=128|g>>12&63,d[e++]=128|g>>6&63,d[e++]=128|63&g)}return c},b.uint8ToString=function(a){for(var b=32768,c=[],d=0;d<a.length;d+=b)c.push(String.fromCharCode.apply(null,a.subarray(d,d+b)));return c.join("")},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=b:a.Utf8=b}(b);var X=function(){this._background=inject("BackgroundCommunicator"),this._settings=inject("VideostreamSettings"),this._dialog=inject("ChatRequestDialog"),this._data={},this._socket=null,this._onSocketConnectBind=this._onSocketConnect.bind(this),this._onSocketDisconnectBind=this._onSocketDisconnect.bind(this),this._onSocketMessageBind=this._onSocketMessage.bind(this),this._onSocketConnectErrorBind=this._onSocketConnectError.bind(this),a.notifications.onClicked.addListener(this._onNotificationClicked.bind(this)),this._dialog.on("hide",this._onDialogHide.bind(this)),this._notificationIds=[],this.initialize()};X.prototype.initialize=function(){function c(a){p._settings.getKeystoneId(function(b){p._data.keystoneId=b,a()})}function d(a){p._settings.getInstallDate(function(b){p._data.installDate=b,a()})}function e(b){p.setValue("appVersion",a.runtime.getManifest().version,b)}function f(a){p.setValue("localTime",(new Date).toString(),a)}function g(a){a()}function h(a){p.setValue("language",b.navigator.language,a)}function i(a){p._settings.getTotalWatchedTime(function(b){p.setValue("totalWatchTime",b,a)})}function j(a){p.setValue("userAgent",navigator.userAgent,a)}function k(b){a.system.cpu.getInfo(function(a){p.setValue("cpu",a.modelName,b)})}function l(a){p._settings.getLastChatRequestDate(function(b){p.setValue("lastChatRequestDate",b,a)})}function m(b){a.idle.queryState(15,function(a){p.setValue("idleStatus",a,b)})}function n(a){p.setValue("timezoneOffset",(new Date).getTimezoneOffset(),a)}function o(a){a&&console.error("CloudbotMetrics FAILED")}var p=this;this._background.on("premium",this._setIsPremium.bind(this,!0)),this._background.on("standard",this._setIsPremium.bind(this,!1)),this._background.on("loaded",this.setValue.bind(this,"videoLoaded",!0)),this._background.on("unloaded",this.setValue.bind(this,"videoLoaded",!1)),this._background.on("unloaded",this.setValue.bind(this,"played-20-percent",!1)),this._background.on("unloaded",this.setValue.bind(this,"played-80-percent",!1)),this._background.on("played-20-percent",this.setValue.bind(this,"played20Percent",!0)),this._background.on("played-80-percent",this.setValue.bind(this,"played80Percent",!0)),this._background.on("idle-state-changed",this.setValue.bind(this,"idleStatus")),this._settings.on("isPlaylistEnabledChanged",this.setValue.bind(this,"playlistEnabled")),async.parallel([c,d,e,f,g,h,i,j,k,l,m,n],o)},X.prototype._setupSocket=function(){var a=this;this._getRealtimeServers(function(b,c){if(!b&&c&&c.length){var d=c[Math.floor(Math.random()*c.length)];a._socket=io.connect(d,{reconnect:!1,reconnection:!1}),a._socket.removeEventListener("connect_error",a._onSocketConnectErrorBind),a._socket.removeEventListener("connect",a._onSocketConnectBind),a._socket.removeEventListener("disconnect",a._onSocketDisconnectBind),a._socket.removeEventListener("message",a._onSocketMessageBind),a._socket.on("connect_error",a._onSocketConnectErrorBind),a._socket.on("connect",a._onSocketConnectBind),a._socket.on("disconnect",a._onSocketDisconnectBind),a._socket.on("message",a._onSocketMessageBind),a._socket.connect()}else clearTimeout(this._nextConnectAttempt),this._nextConnectAttempt=setTimeout(a._setupSocket.bind(a),3e5)})},X.prototype._getRealtimeServers=function(a){var b=new XMLHttpRequest;b.open("GET","https://cloudbot.getvideostream.com/realtime-servers",!0),b.onreadystatechange=function(){if(4==this.readyState)try{var b=JSON.parse(this.responseText);a(b.err,b.serverList)}catch(a){}},b.send()},X.prototype.setValue=function(a,b,c){this._data[a]=b,this._socket&&this._socket.connected&&this._socket.emit("setValue",a,b),c&&"function"==typeof c&&c()},X.prototype.unsetValue=function(a,b){delete this._data[a],this._socket&&this._socket.connected&&this._socket.emit("unsetValue",a),b&&"function"==typeof b&&b()},X.prototype._onSocketConnect=function(){this._socket.emit("stats",this._data),this._background.setSocketId(this._socket.id)},X.prototype._onSocketConnectError=function(){var a=this;clearTimeout(this._nextConnectAttempt),this._nextConnectAttempt=setTimeout(function(){a._setupSocket()},3e4)},X.prototype._onSocketDisconnect=function(){this._socket.close();var a=this;clearTimeout(this._nextConnectAttempt),this._nextConnectAttempt=setTimeout(function(){a._setupSocket()},5e3)},X.prototype._onSocketMessage=function(b){var c=this;try{b=JSON.parse(b)}catch(a){return}switch(console.debug("CloudbotMetrics._onSocketMessage",b),b.event){case"prompt-chat":this._dialog.setOperator(b.operator),this._dialog.show();var d=Date.now();this._settings.setLastChatRequestDate(d),this.setValue("lastChatRequestDate",d),a.notifications.create("chat:"+Math.random(),{type:"basic",iconUrl:"/img/chat-"+b.operator+".png",
title:b.operator.substr(0,1).toUpperCase()+b.operator.substr(1)+" from Videostream:",message:"Hey! I'm one of the creators of Videostream and I'd love to live chat with you right now if you have a few minutes :)",contextMessage:"Click here to chat (No this isn't a robot!)",isClickable:!0},function(a){c._notificationIds.push(a)})}},X.prototype._setIsPremium=function(a,b){a?this.setValue("premium",b):this.setValue("premium",!1)},X.prototype._onNotificationClicked=function(a){a.indexOf("chat")>-1&&this._background.launchUrl("http://getvideostream.com/chat-with-us.html")},X.prototype._onDialogHide=function(){console.log("Clearing notifications");for(var b=0;b<this._notificationIds.length;b++)a.notifications.clear(this._notificationIds[b]);this._notificationIds=[]},function(a){var b,c=a.VideostreamSettings||require("common/Settings"),d=a.SettingsStore||require("common/SettingsStore"),e=a.AnalyticsInterface||require("common/AnalyticsInterface"),f=a.EventEmitter||require("lib/EventEmitter"),g=a.async||require("lib/async"),h=function(){f.call(this),this._settings=c.getInstance(),this._settingsStore=d.getInstance(),this._installDate=-1,this._totalWatchedTime=0,this._testGroups={},this._setupComplete=!1,this._installed=!1,this._updated=!1,this._groupsApplied=!1,this._launchRequested=!1,this._launchData=null,this.setup()};h.getInstance=function(){return b||(b=new h),b},h.OLD_USER_CUTOFF=14278464e5,h.RETENTION_CHECKPOINT_CUTOFF_DATE=12096e5,h.RETENTION_CHECKPOINT_CUTOFF_SECONDS_AFTER_DATE=7200,h.RETENTION_CHECKPOINT_CUTOFF_SECONDS_WATCHED=18e3,h.INSTALL_DATE_TIMEOUT_LENGTH=3e3,h.prototype=Object.create(f.prototype),h.prototype.getInstallDate=function(){return this._installDate},h.prototype.getTestGroup=function(a){return this._testGroups[a]},h.prototype.hasAcceptedFeatures=function(){return this._installDate>=h.OLD_USER_CUTOFF||"control"!==this._testGroups.oldUserGroup},h.prototype.isOldUser=function(){return this._installDate<h.OLD_USER_CUTOFF},h.prototype.isBrandNewUser=function(){return this._installDate>Date.now()-864e5},h.prototype.isRetentionUser=function(){return this._totalWatchedTime>h.RETENTION_CHECKPOINT_CUTOFF_SECONDS_WATCHED||this._installDate<Date.now()-h.RETENTION_CHECKPOINT_CUTOFF_DATE&&this._totalWatchedTime>h.RETENTION_CHECKPOINT_CUTOFF_SECONDS_AFTER_DATE},h.prototype.getTestGroupArray=function(){var a=[];for(var b in this._testGroups)a.push(b+"-"+this._testGroups[b]);return a},h.prototype.getTestGroupString=function(){return this.getTestGroupArray().join(";")},h.prototype.getTestGroups=function(){return JSON.parse(JSON.stringify(this._testGroups))},h.prototype.commitTestGroups=function(){try{this._settingsStore.set("SplitTestControllerTestGroups",JSON.stringify(this._testGroups))}catch(a){console.error("SplitTestController.commitTestGroups: Unable to commit test groups")}},h.prototype.setup=function(){function a(a){f._settings.getInstallDate(function(b){b||(b=Date.now(),setTimeout(function(){f._settings.setInstallDate(b,function(){f.emit("installed")})},h.INSTALL_DATE_TIMEOUT_LENGTH)),console.info("SplitTestController.setup","installDate",new Date(b).toUTCString()),f._installDate=b,e.getInstance().setInstallDate(f._installDate),a()})}function b(a){f._settingsStore.get("SplitTestControllerTestGroups",function(b){b?f._testGroups=JSON.parse(b):f._testGroups={},a()})}function c(a){f._settings.getTotalWatchedTime(function(b){f._totalWatchedTime=b||0,a()})}function d(){f._setupComplete=!0,f.emit("setup-complete"),f._readyStep()}var f=this;g.parallel([a,b,c],d)},h.prototype.onInstalled=function(a){return this._setupComplete?(this._installed=!0,this._launchRequested=!0,void this._readyStep()):void setTimeout(this.onInstalled.bind(this,a),100)},h.prototype.onUpdated=function(a){return this._setupComplete?(this._updated=!0,this._updateInfo=a,void this._readyStep()):void setTimeout(this.onUpdated.bind(this,a),100)},h.prototype.onLaunch=function(a){this._launchRequested=!0,this._launchData=a,this._readyStep()},h.prototype._readyStep=function(){if(this._setupComplete!==!1){if(!this._groupsApplied&&this._installed)return this._groupsApplied=!0,this._applyInstallTestGroups(),this._applyNewUserGroups(),this.commitTestGroups(),void this._readyStep();if(!this._groupsApplied&&this._updated){if(this._groupsApplied=!0,this._removeExpiredSplitTests(),this._installDate>=h.OLD_USER_CUTOFF)return this._applyNewUserGroups(),void this.commitTestGroups();if(null==this._testGroups.oldUserGroup){var a=Math.random();a>=.8?this._testGroups.oldUserGroup="control":a>=.6?this._testGroups.oldUserGroup="master":this._testGroups.oldUserGroup="test"}return"test"!==this._testGroups.oldUserGroup?(this.commitTestGroups(),void this._readyStep()):(this._applyOldUserGroups(),this.commitTestGroups(),void this._readyStep())}if(this._launchRequested){for(var b in this._testGroups)console.info("SplitTestController._readyStep","Test Group:",b,this._testGroups[b]);this.emit("launch",this._launchData),this._launchData=null,this._launchRequested=!1}}},h.prototype._removeExpiredSplitTests=function(){if(delete this._testGroups.premiumClickThroughTest,delete this._testGroups.pepperFileIO,delete this._testGroups.hls,delete this._testGroups.ffmpegAssembly,delete this._testGroups.x264_32bit,delete this._testGroups.ffmpeg32bit,delete this._testGroups.loginSplitGroup,delete this._testGroups.newUserBlockSplitGroup,delete this._testGroups.superHLS,"none"===this._testGroups.noTest){var a=Math.random();a>=.8?(delete this._testGroups.noTest,this._testGroups.loginSplitGroup="newrelease"):a>=.6?(delete this._testGroups.noTest,this._testGroups.loginSplitGroup="login"):a>=.4&&(delete this._testGroups.noTest,this._testGroups.loginSplitGroup="control")}},h.prototype._applyInstallTestGroups=function(){console.debug("SplitTestController._applyInstallTestGroups")},h.prototype._applyNewUserGroups=function(){if(console.debug("SplitTestController._applyNewUserGroups"),this._testGroups.premiumFlow||(this._testGroups.premiumFlow=Math.random()>=.5?"test":"control"),!this._testGroups.ac3OptionEnable){var a=Math.random();a>=.8?this._testGroups.ac3OptionEnable="control":a>=.6?this._testGroups.ac3OptionEnable="test":a>=0&&(this._testGroups.ac3OptionEnable="none")}},h.prototype._applyOldUserGroups=function(){console.debug("SplitTestController._applyOldUserGroups"),this._testGroups.premiumFlow||(this._testGroups.premiumFlow=Math.random()>=.5?"test":"control")},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=h:a.SplitTestController=h}(b),function(b){var c,d=b.DialogView||require("desktop/ui/DialogView"),e=b.ChangeLogRemoteFile||require("common/ChangeLogRemoteFile"),f=b.VideostreamSettings||require("common/Settings"),g=b.SplitTestController||require("common/SplitTestController"),h=b.AnalyticsInterface||require("common/AnalyticsInterface"),i=b.async||require("lib/async"),j=function(){d.call(this,"#change-log-dialog",{dismissElements:".dismiss"}),this._titleEl=this.querySelector("h1"),this._contentEl=this.querySelector(".content"),this._dateEl=this.querySelector(".change-log-last-updated-span")};j.getInstance=function(){return c||(c=new j),c},j.prototype=Object.create(d.prototype),j.prototype.launch=function(){function b(a){g.getInstance().isRetentionUser()?a():a("notInTestGroup")}function c(a){f.getInstance().getLastChangeLogVersion(function(b){a(null,b)})}function d(a,b){e.fetch(function(c){c?c.version==a?b("alreadySeenThisOne"):b(null,c):b("noChangeLogFound")})}function j(b,c){var d=a.runtime.getManifest().version,e=parseInt(d.replace(/\./g,""),10),f=parseInt(b.minVersion.replace(/\./g,""),10);e>=f?c(null,b):c("notEligible")}function k(a,b){h.getInstance().triggerChangeLogSeen(a.version),f.getInstance().setLastChangeLogVersion(a.version,function(){b(null,a)})}function l(a){a?console.info("ChangeLogDialog.launch: Not launching:",a):m.show()}var m=this;i.waterfall([b,c,d,j,k],l)},j.prototype.show=function(){function a(a){e.fetch(function(b){b?a(null,b):a("noChangeLogFound")})}function b(a,b){f._titleEl.innerHTML=a.title,f._contentEl.innerHTML="",f._dateEl.innerHTML=a.date;var c;for(c=0;c<a.description.length;c++){var d=document.createElement("p");d.innerHTML=a.description[c],f._contentEl.appendChild(d)}for(c=0;c<a.changes.length;c++){var e=document.createElement("div");e.classList.add("change-log-item");var g=document.createElement("img");g.src="/img/chat-"+a.changes[c].person+".png";var h=document.createElement("div");h.classList.add("change-log-text"),h.innerHTML=a.changes[c].text,e.appendChild(g),e.appendChild(h),f._contentEl.appendChild(e)}b()}function c(a){a||d.prototype.show.apply(f)}var f=this;i.waterfall([a,b],c)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=j:b.ChangeLogDialog=j}(b);var Y=function(){DialogView.call(this,"#next-episode-dialog",{dismissable:!1}),this._background=inject("BackgroundCommunicator"),this._desktopView=inject("DesktopView"),this._background.on("loading-movie",this.hide.bind(this)),this._background.on("next-episode-cancelled",this.hide.bind(this)),this.querySelector("#start-next-episode-now").addEventListener("click",this._loadNextVideoClick.bind(this)),this.querySelector("#cancel-next-episode").addEventListener("click",this._cancelNextVideoClick.bind(this)),this._seriesNameLabel=document.getElementById("up-next-chromecast"),this._nextEpisodeNameLabel=document.getElementById("title-of-next-episode"),this._nextEpisodeScreenshot=document.getElementById("up-next-screenshot")};Y.prototype=Object.create(DialogView.prototype),Y.prototype.show=function(){this._desktopView._el.classList.add("blur-5"),DialogView.prototype.show.call(this)},Y.prototype.hide=function(){this._desktopView._el.classList.remove("blur-5"),DialogView.prototype.hide.call(this)},Y.prototype.updateTimer=function(a){},Y.prototype.setNextEpisodeInformation=function(a,b,c){var d="";void 0!=a.series&&null!=a.series&&(d+=a.series),this._seriesNameLabel.innerHTML="<b>Up Next: "+d+"</b>";var e="";if(a.season&&(e+="Season "+parseInt(a.season).toString()),a.episodes&&a.episodes.length>0){e+=", ";for(var f=0;f<a.episodes.length;f++)a.episodes[f]&&(e+="Episode "+parseInt(a.episodes[0]).toString())}this._nextEpisodeNameLabel.innerHTML=e,this._nextEpisodeScreenshot.style.backgroundImage="linear-gradient( rgba(16, 16, 16, 0.65), rgba(16, 16, 16, 0.65) ), url('data:image/png;base64, "+c+"')",this._nextEpisodeScreenshot.style.backgroundSize="cover"},Y.prototype._loadNextVideoClick=function(){this._background.loadNextEpisode()},Y.prototype._cancelNextVideoClick=function(){this._background.cancelNextEpisode(),this.hide()},function(b){var c=b.ElementView||require("common/ui/ElementView"),d=b.RemoteSettings||require("common/RemoteSettings"),e=b.SplitTestController||require("common/SplitTestController"),f=function(){c.call(this,"#playback-view"),this._background=inject("BackgroundCommunicator"),this._analytics=inject("AnalyticsInterface"),this._settings=inject("VideostreamSettings"),this._progressSeeker=new SeekerView("#seeker-progress"),this._volumeSeeker=new SeekerView("#seeker-volume"),this._volumeSeeker.setTotal(1),this._qualityPresetsLocalizedNames={},this._videoTitle=this.querySelector("#video-title"),this._videoSubtitle=this.querySelector("#video-subtitle"),this._chromecastName=this.querySelector("#chromecast-name"),this._timeElapsed=this.querySelector("#time-elapsed"),this._timeDuration=this.querySelector("#time-duration"),this._back30Button=this.querySelector("#button-back-30"),this._forward30Button=this.querySelector("#button-forward-30"),this._previousButton=this.querySelector("#button-previous"),this._nextButton=this.querySelector("#button-next"),this._playButton=this.querySelector("#button-play"),this._pauseButton=this.querySelector("#button-pause"),this._closeButton=this.querySelector("#playback-controls-close-button"),this._languageSettingsButton=this.querySelector("#button-language-settings"),this._muteButton=this.querySelector("#button-mute"),this._unmuteButton=this.querySelector("#button-unmute"),this.trackSelectionDialog=inject("TrackSelectionDialog"),this._qualityChangeQuestionDialog=new DialogView("#quality-change-question-dialog",{dismissElements:".dismiss"}),this._qualityChangeDialogShown=!1,this._adaptiveButton=this.querySelector("#button-adaptive"),this._qualityDropdown=this.querySelector("#button-quality"),this._qualityDropdownTooltip=this.querySelector("#button-quality-tooltip"),this._qualityDropdownList=this.querySelector("#button-quality-dropdown"),this._qualityLabel=this.querySelector("#button-quality-label"),this._qualityLabelDefault=this.querySelector("#button-quality-label-default"),this._playbackTime=this.querySelector(".playback-time"),this._playbackControls=this.querySelector(".playback-controls"),this._playbackSeeker=this.querySelector(".playback-seeker"),this._buttonScale=this.querySelector("#button-scale"),this._bindControls(),this._bindEvents(),this._playerReady=!0,this._onBackgroundVolume(.5,!1),this._onBackgroundProbeComplete([]),this._onBackgroundPlaying(),this._onBackgroundPlaylistPosition(-1),this._enableHLSAsDefault=!0,this._showHLS=!0,this._inQualityPresetTest=!1,this._settings.getReceiverVersion(this._onReceiverVersionChanged.bind(this)),d.fetch(function(a){a&&(a.enableHLS?(this._enableHLSAsDefault=!0,this._showHLS=!0,this._background.setHLSEnabled(!0)):(this._enableHLSAsDefault=!1,this._showHLS=!1,this._background.setHLSEnabled(!1)))}.bind(this))};f.prototype=Object.create(c.prototype),f.prototype._bindEvents=function(){this._qualityPresetClickBind=this._onQualityPresetClick.bind(this),this._background.on("loading-movie",this.resetProgress.bind(this)),this._background.on("playing",this._onBackgroundPlaying.bind(this)),this._background.on("paused",this._onBackgroundPaused.bind(this)),this._background.on("duration",this._onBackgroundDuration.bind(this)),this._background.on("progress",this._onBackgroundProgress.bind(this)),this._background.on("volume",this._onBackgroundVolume.bind(this)),this._background.on("muted",this._onBackgroundMuted.bind(this)),this._background.on("title",this._onBackgroundTitle.bind(this)),this._background.on("subtitle",this._onBackgroundSubtitle.bind(this)),this._background.on("playlist-position",this._onBackgroundPlaylistPosition.bind(this)),this._background.on("enable-playlist-controls",this.enablePlaylistControls.bind(this)),this._background.on("disable-playlist-controls",this.disablePlaylistControls.bind(this)),this._background.on("cast-session-connected",this._onBackgroundCastSessionConnected.bind(this)),this._background.on("cast-session-disconnected",this._onBackgroundCastSessionDisconnected.bind(this)),this._background.on("network-detect-failure",this._onNetworkDetectFail.bind(this)),this._background.on("network-detect-success",this._onNetworkDetectSuccess.bind(this)),this._background.on("probe-complete",this._onBackgroundProbeComplete.bind(this)),this._background.on("quality-preset-selected",this._onBackgroundQualityPresetSelected.bind(this)),this._background.on("player-ready",this._onPlayerReady.bind(this)),this._background.on("player-busy",this._onPlayerBusy.bind(this)),this._background.on("buffering",this._onBackgroundBuffering.bind(this)),this._background.on("buffering-stable",this._onBackgroundBufferingStable.bind(this)),this._background.on("cast-buffering",this._onCastBuffering.bind(this)),this._background.on("receiverVersionChanged",this._onReceiverVersionChanged.bind(this)),this._background.on("scale-setting-changed",this._onScaleSettingChanged.bind(this)),this._background.on("cast-supports-scale",this._onCastSupportsScale.bind(this)),this._background.on("video-can-scale",this._onVideoCanScale.bind(this)),this._background.on("prompt-next-episode",this._showNextEpisodeDialog.bind(this))},f.prototype._bindControls=function(){this._playButton.addEventListener("click",this._onPlayButtonClick.bind(this)),this._pauseButton.addEventListener("click",this._onPauseButtonClick.bind(this)),this._nextButton.addEventListener("click",this._onNextButtonClick.bind(this)),this._previousButton.addEventListener("click",this._onPreviousButtonClick.bind(this)),this._closeButton.addEventListener("click",this._onCloseButtonClick.bind(this)),this._languageSettingsButton.addEventListener("click",this._onLanguageSettingsButtonClick.bind(this)),this._back30Button.addEventListener("click",this._onBack30ButtonClick.bind(this)),this._forward30Button.addEventListener("click",this._onForward30ButtonClick.bind(this)),this._muteButton.addEventListener("click",this._onMuteButtonClick.bind(this)),this._unmuteButton.addEventListener("click",this._onUnmuteButtonClick.bind(this)),this._progressSeeker.on("progress-changed",this._onSeekerProgressChanged.bind(this)),this._volumeSeeker.on("progress-changed",this._onVolumeChanged.bind(this)),this._buttonScale.addEventListener("click",this._onButtonScaleClick.bind(this)),this._adaptiveButton.addEventListener("click",this._onAdaptiveButtonToggle.bind(this)),this._qualityDropdown.addEventListener("click",this._openQualityDialog.bind(this)),document.body.addEventListener("click",this._closeQualityDialog.bind(this)),document.body.addEventListener("keydown",this._onKeyDown.bind(this)),document.body.addEventListener("keyup",this._onKeyUp.bind(this))},f.prototype.show=function(){this._el.classList.remove("gone")},f.prototype.hide=function(){this._el.classList.add("gone")},f.prototype.adjustControls=function(a){a?(this._playbackTime.style.display="none",this._playbackControls.style.display="none",this._playbackSeeker.style.display="none"):(this._playbackTime.style.removeProperty("display"),this._playbackControls.style.removeProperty("display"),this._playbackSeeker.style.removeProperty("display"))},f.prototype._onBackgroundDuration=function(a){null!==a&&(this._duration=a,this._timeDuration.textContent=f._getPrettyOut(this._duration),this._progressSeeker.setTotal(a))},f.prototype.resetProgress=function(){this._onBackgroundDuration(0),this._onBackgroundProgress(0)},f.prototype._onBackgroundProgress=function(a){this._playerReady&&(this._progress=a,inject("Chromecast").setCurrentTime(a),this._progressSeeker.isBeingTouched()||(this._timeElapsed.textContent=f._getPrettyOut(this._progress),this._progressSeeker.setProgress(a)))},f.prototype._onBackgroundVolume=function(a){this._volumeSeeker.isBeingTouched()||this._volumeSeeker.setProgress(a)},f.prototype._onBackgroundMuted=function(a){a?(this._muteButton.style.display="none",this._unmuteButton.style.removeProperty("display"),this._volumeSeeker.setAltStyle(!0)):(this._unmuteButton.style.display="none",this._muteButton.style.removeProperty("display"),this._volumeSeeker.setAltStyle(!1))},f.prototype._onBackgroundPlaying=function(){this._pauseButton.style.removeProperty("display"),this._playButton.style.display="none",this._el.classList.remove("buffering")},f.prototype._onBackgroundPaused=function(){this._playButton.style.removeProperty("display"),this._pauseButton.style.display="none",this._el.classList.remove("buffering")},f.prototype._onBackgroundTitle=function(a){this._videoTitle.innerHTML=a},f.prototype._onBackgroundSubtitle=function(a){a?(this._videoSubtitle.style.removeProperty("display"),this._videoSubtitle.innerHTML=a):this._videoSubtitle.style.display="none"},f.prototype._onBackgroundPlaylistPosition=function(a){a>-1?this.enablePlaylistControls():this.disablePlaylistControls()},f.prototype._onBackgroundCastSessionConnected=function(a,b){this._chromecastName.innerHTML=b},f.prototype._onBackgroundCastSessionDisconnected=function(){this._chromecastName.innerHTML="",inject("NextEpisodeDialog").hide()},f.prototype._onNetworkDetectFail=function(a){this._networkDetectStatus=a},f.prototype._onNetworkDetectSuccess=function(){this._networkDetectStatus=""},f.prototype._onBackgroundProbeComplete=function(b,c,d,f,g){for(c=c||[],this._qualityPresetsLocalizedNames={},this._qualityPresetsLowest="",this._usingLowestQuality=!1,this._qualityDropdown.style.display="none",this._qualityLabel.style.display="none",this._qualityLabel.classList.remove("hint-recommended"),this._qualityLabelDefault.style.removeProperty("display"),this._qualityDropdownTooltip.style.display="none",this._el.classList.remove("unplayable");this._qualityDropdownList.firstChild;){var h=this._qualityDropdownList.firstChild;h.removeEventListener("click",this._qualityPresetClickBind),this._qualityDropdownList.removeChild(h)}if(c.length>0){for(var i=null,j=!1,k=0;k<c.length;++k){var l=c[k],m=a.i18n.getMessage(l.localizableName),n=document.createElement("button");n.classList.add("button-flat","button-grey-faded"),l.selected&&(i=l.identifier,n.classList.add("selected")),l.recommended&&(j="Original"!==l.identifier,this._inQualityPresetTest&&n.classList.add("recommended")),n.value=l.identifier,n.id="button-quality-"+l.identifier.toLowerCase(),n.textContent=m,n.addEventListener("click",this._qualityPresetClickBind),this._qualityDropdownList.appendChild(n),this._qualityPresetsLocalizedNames[l.identifier]=m}this._qualityPresetsLowest=c[c.length-1].identifier,j&&this._inQualityPresetTest&&this._qualityLabel.classList.add("hint-recommended");var o=e.getInstance(),p=o.getTestGroup("superHLS");this._isSuperHLS=f&&g&&p&&p.indexOf("super-hls")>-1,this._qualityChangeDialogShown=!1,this._isSuperHLS&&this._qualityDropdownTooltip.style.removeProperty("display"),this._changeQuality(i),"Original"!==i||this._isSuperHLS||(this._qualityLabel.style.display="none",this._qualityLabelDefault.style.removeProperty("display")),this._qualityDropdown.style.removeProperty("display")}},f.prototype._onPlayerReady=function(){this._playerReady=!0,this._el.classList.remove("busy")},f.prototype._onPlayerBusy=function(a){"PlayerBusy"===a&&(this._playerReady=!1,this._el.classList.add("busy"))},f.prototype._onBackgroundBuffering=function(){this._inQualityPresetTest?this._usingLowestQuality?this._el.classList.add("unplayable"):this._el.classList.add("stuttering-quality-preset"):this._el.classList.add("stuttering")},f.prototype._onBackgroundBufferingStable=function(){this._el.classList.remove("stuttering"),this._el.classList.remove("stuttering-quality-preset")},f.prototype._onCastBuffering=function(){this._el.classList.add("buffering")};var g=27,h=32,i=37,j=38,k=39,l=40;f.prototype._onKeyDown=function(){},f.prototype._onKeyUp=function(a){if(this._isShown)switch(a.keyCode){case h:"none"===this._playButton.style.display?this._onPauseButtonClick():this._onPlayButtonClick(),a.preventDefault();break;case i:this._playerReady&&(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey?this._background.skipBackward(10):this._background.skipBackward(30));break;case k:this._playerReady&&(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey?this._background.skipForward(10):this._background.skipForward(30));break;case j:this._playerReady&&this._onVolumeIncrease();break;case l:this._playerReady&&this._onVolumeDecrease();break;case g:this._closeQualityDialog()}},f.prototype._onVolumeDecrease=function(){var a=this._volumeSeeker.getProgress()-.1;a<0&&(a=0),this._onVolumeChanged(a)},f.prototype._onVolumeIncrease=function(){var a=this._volumeSeeker.getProgress()+.1;a>1&&(a=1),this._onVolumeChanged(a)},f.prototype._onButtonScaleClick=function(){switch(this._scaleSetting){case"fit":this._background.setScaleSetting("stretch");break;case"stretch":this._background.setScaleSetting("fit");break;default:case"fit":this._background.setScaleSetting("fit")}},f.prototype._onPlayButtonClick=function(){this._background.play()},f.prototype._onPauseButtonClick=function(){this._background.pause()},f.prototype._onNextButtonClick=function(){this._background.playlistNext()},f.prototype._onPreviousButtonClick=function(){this._background.playlistPrevious()},f.prototype._onCloseButtonClick=function(){this._background.stop()},f.prototype._onLanguageSettingsButtonClick=function(){this.trackSelectionDialog.show()},f.prototype._onBack30ButtonClick=function(){this._background.skipBackward(30)},f.prototype._onForward30ButtonClick=function(){this._background.skipForward(30)},f.prototype._onMuteButtonClick=function(){this._onBackgroundVolume(this._volumeSeeker.getProgress(),!0),this._background.setMuted(!0)},f.prototype._onUnmuteButtonClick=function(){this._onBackgroundVolume(this._volumeSeeker.getProgress(),!1),this._background.setMuted(!1)},f.prototype._onSeekerProgressChanged=function(a){this._progressSeeker.isBeingTouched()?this._timeElapsed.textContent=f._getPrettyOut(a):(this._progressSeeker.setProgress(a),this._background.seekSeconds(a))},f.prototype._onVolumeChanged=function(a){this._volumeSeeker.isBeingTouched()||(this._onBackgroundVolume(a),this._background.setVolume(a))},f.prototype._onAdaptiveButtonToggle=function(a){this._adaptiveButton.classList.contains("on")?this._adaptiveButton.classList.remove("on"):this._adaptiveButton.classList.add("on")},f.prototype._openQualityDialog=function(a){a&&a.stopPropagation(),this._qualityDropdown.classList.add("open"),this._analytics.qualityPresetsOpened()},f.prototype._onQualityPresetClick=function(a){a.target.value&&(this._onBackgroundQualityPresetSelected(a.target.value),a.stopPropagation(),console.log("PlaybackView._onQualityPresetClick: Selected quality preset: "+a.target.value),this._background.setQualityPreset(a.target.value),this._isSuperHLS&&!this._qualityChangeDialogShown&&(this._qualityChangeDialogShown=!0,this._qualityChangeQuestionDialog.show()))},f.prototype._onBackgroundQualityPresetSelected=function(a){this._qualityLabel.classList.remove("hint-recommended"),a.original?this._qualityDropdownTooltip.style.removeProperty("visibility"):this._qualityDropdownTooltip.style.visibility="hidden",this._changeQuality(a.identifier),this._closeQualityDialog()},f.prototype._changeQuality=function(a){var b=this._qualityDropdownList.querySelector("button.selected");if(b&&b.classList.remove("selected"),a){this._usingLowestQuality=a===this._qualityPresetsLowest,this._el.classList.remove("unplayable");var c=this._qualityDropdownList.querySelector("#button-quality-"+a.toLowerCase());c?(c.classList.add("selected"),this._qualityLabelDefault.style.display="none",this._qualityLabel.style.removeProperty("display"),this._qualityLabel.textContent=this._qualityPresetsLocalizedNames[a]):(this._qualityLabelDefault.style.removeProperty("display"),this._qualityLabel.style.display="none")}},f.prototype._closeQualityDialog=function(){this._qualityDropdown.classList.remove("open")},f.prototype.enablePlaylistControls=function(){this._nextButton.style.removeProperty("display"),this._previousButton.style.removeProperty("display")},f.prototype.disablePlaylistControls=function(){this._nextButton.style.display="none",this._previousButton.style.display="none"},f.prototype._onReceiverVersionChanged=function(a){this._receiverVersion=a},f.prototype._onScaleSettingChanged=function(a){switch(this._scaleSetting=a,a){case"fit":this._buttonScale.classList.remove("active");break;case"stretch":this._buttonScale.classList.add("active")}},f.prototype._onCastSupportsScale=function(a){this._castSupportsScale=a,this._renderScaleButton()},f.prototype._onVideoCanScale=function(a){this._videoCanScale=a,this._renderScaleButton()},f.prototype._renderScaleButton=function(){this._castSupportsScale&&this._videoCanScale?this._buttonScale.style.removeProperty("display"):this._buttonScale.style.display="none"},f.prototype._showNextEpisodeDialog=function(a,b,c){var d=inject("NextEpisodeDialog");d.isOpen()?d.updateTimer(b):(d.setNextEpisodeInformation(a,b,c),d.show())},f._getPrettyOut=function(a){if(!Number.isNaN(a)){var b=Math.floor(a/3600),c=Math.floor(a/60-60*b),d=Math.floor(a-60*c-3600*b);return d<=9&&(d="0"+d),b>=1?(c<=9&&(c="0"+c),b+":"+c+":"+d):c+":"+d}},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=f:b.PlaybackView=f}(b);var Z=function(){var a=this;ElementView.call(this,"#desktop-view"),this._premium=!1,this._hasReceivers=!0,this._antivirusFail=!1,this._background=inject("BackgroundCommunicator"),this._chromecast=inject("Chromecast"),this._settings=inject("VideostreamSettings"),this.playlist=inject("PlaylistPanelView"),this.header=inject("HeaderView"),this.pager=inject("PagerView"),this.loader=inject("LoaderOverlayView"),this.userContentView=inject("UserContentView"),this.recentlyDownloadedView=inject("RecentlyDownloadedView"),this.captureLinkClicks(),this._networkDownErrorDialog=new I,this._castExtensionDialog=new D,this._nativeClientMissingPluginDialog=inject("NaClMissingPluginDialog"),this._selectChromecastView=inject("SelectChromecastView"),this._selectChromecastView.hide(),this._chromecast.on("receivers-unavailable",this.setReceiversUnavailable.bind(this)),this._chromecast.on("receivers-available",this.setReceiversAvailable.bind(this)),this._chromecast.on("request-session",this._onRequestSession.bind(this)),this._chromecast.on("session",this._onSession.bind(this)),this._background.on("cast-media-load-error",this._onCastMediaLoadFail.bind(this)),this._background.on("cast-media-load-success",this._onCastMediaLoadSuccess.bind(this)),this._background.on("loaded",this._onLoadedMovie.bind(this)),this._background.on("loader-cancel",this._onLoaderCancel.bind(this)),this._background.on("resume-video-prompt",this._showResumeVideoPrompt.bind(this)),this._background.on("incompatible-file-prompt",this._showIncompatibleFilePrompt.bind(this)),this.playlist.on("show",this._onPlaylistShown.bind(this)),this.playlist.on("hide",this._onPlaylistHidden.bind(this)),this.loader.on("force-file",this._forceFile.bind(this)),this.loader.on("unload-file",this._unloadFile.bind(this)),this.loader.on("firewall-retry",this._firewallRetry.bind(this)),this._background.on("loading-movie",this._showLoader.bind(this)),this._background.on("load-media-offline",this.networkDownDuringLoad.bind(this)),this._background.on("load-media-online",this.networkUpDuringLoad.bind(this)),this._background.on("load-media-loading",this._onLoadMediaLoading.bind(this)),this._background.on("cast-media-load-success",this._hideLoader.bind(this)),this._background.on("select-chromecast-animation",this._onSelectChromecastAnimation.bind(this)),this._background.on("unloaded",this._hideLoader.bind(this)),this._background.on("unloaded",this._onUnloadedMovie.bind(this)),this._analytics=inject("AnalyticsInterface"),this._settings.getLaunchCount(function(b){a._settings.setLaunchCount(b+1)}),this._contactCloseButton=this.querySelector("#contact-close-button"),this._contactCloseButton.addEventListener("click",this._onContactCloseButtonClick.bind(this))};Z.prototype=Object.create(ElementView.prototype),Z.prototype._onPlaylistShown=function(){this.querySelector("#contact-view").classList.add("murdered")},Z.prototype._onPlaylistHidden=function(){this.chat=this.querySelector("#contact-view"),this.chat.classList.contains("visible")&&this.chat.classList.remove("murdered")},Z.prototype._showResumeVideoPrompt=function(a){this._resumeVideoPrompt=inject("ResumeAsk"),this._resumeVideoPrompt.show(a)},Z.prototype._onContactCloseButtonClick=function(a){this.querySelector("#contact-view").classList.remove("visible"),this.querySelector("#contact-view").classList.remove("expanded");var b=this;setTimeout(function(){b.querySelector("#contact-view").classList.add("murdered")},1e3),a.stopPropagation(),inject("SettingsCache").set("HideChat",!0,Date.now()+12096e5),this.querySelector("#contact-hidden-message").classList.add("visible"),setTimeout(function(){b.querySelector("#contact-hidden-message").classList.remove("visible")},8e3)},Z.prototype._onContactClick=function(){this._contactView=this.querySelector("#contact-view"),this._contactView.classList.contains("expanded")?this._contactView.classList.remove("expanded"):this._contactView.classList.add("expanded")},Z.prototype._showLoader=function(){this.loader.show()},Z.prototype._onUnloadedMovie=function(){this._isLoaded=!1,inject("VideostreamSettings").setWatchedFirstVideo()},Z.prototype._onLoadedMovie=function(){this.header.show()},Z.prototype._onLoaderCancel=function(){this.loader.hide()},Z.prototype._hideLoader=function(){this.loader.hide()},Z.prototype._onSelectChromecastAnimation=function(){},
Z.prototype.ready=function(){function a(){inject("ChangeLogDialog").launch()}var c=this;this._el.classList.add("ready"),this.recentlyDownloadedView.initialize(),b.location.href.indexOf("promoteLauncher=true")>-1?(new R).show():async.parallel([function(a){c._settings.getHasSubmittedEmail(function(b){a(null,b)})},function(a){c._settings.getLastEmailRequest(function(b){a(null,b)})},function(a){c._settings.getTotalWatchedTime(function(b){a(null,b)})}],function(b,d){d.length&&3===d.length&&!d[0]&&!d[1]&&d[2]>14400?(c._settings.setLastEmailRequest(Date.now()),inject("EmailRequestDialog").show()):a()})},Z.prototype.setScreenshot=function(a){this._snapUrl&&this.unsetScreenshot(),this._snapUrl=a,this.pager.setBackgroundImage(a)},Z.prototype.unsetScreenshot=function(){this.pager.removeBackgroundImage()},Z.prototype.captureLinkClicks=function(){function a(a){for(var c=0;c<a.path.length;c++){var d=a.path[c];if(d&&"A"===d.nodeName&&d.href&&!d.classList.contains("log-file"))return a.stopPropagation(),a.preventDefault(),void b._background.launchUrl(d.href)}}var b=this;document.body.addEventListener("click",a)},Z.prototype.standard=function(){this._premium=!1,document.body.classList.remove("premium")},Z.prototype.premium=function(){this._premium=!0,document.body.classList.add("premium")},Z.prototype._onSession=function(a){a?this.hasSession=!0:(this._chromecast.isNewApi()&&this.loader.hide(),this.hasSession=!1)},Z.prototype.showNativeClientFailure=function(){this._naclFailed=!0},Z.prototype.nativeClientLoaded=function(){this._naclFailed=!1},Z.prototype.nativeClientMissingPlugin=function(){this._nativeClientMissingPluginDialog.show()},Z.prototype.hideNoChromecastAPI=function(){this._castExtensionDialog.isOpen()&&this._castExtensionDialog.hide()},Z.prototype.showNoChromecastAPI=function(){this._castExtensionDialog.isOpen()||this._castExtensionDialog.show()},Z.prototype._showIncompatibleFilePrompt=function(a){this._isDVDLikeFile(a)?this.loader.dvdFileError():this.loader.incompatibleFileError(a)},Z.prototype.showProbeComplete=function(a,b,c){a&&this._naclFailed?this.loader.antivirusError():a&&"ProbeTimeout"==a?this._antivirusFail=!0:this._hasReceivers||this._analytics.triggerChromecastNotFound()},Z.prototype._isDVDLikeFile=function(a){var b=a.toUpperCase();return b.match(".BUP$")||b.match(".IFO$")},Z.prototype._onCastMediaLoadFail=function(a){this._antivirusFail&&(this._antivirusFail=!1,this.loader.antivirusError())},Z.prototype._onCastMediaLoadSuccess=function(){this._isLoaded=!0,this._selectChromecastView.hide(),this.loader.clearErrors()},Z.prototype.showDiscoverFail=function(){this.loader.firewallError()},Z.prototype.showNetworkStutter=function(){},Z.prototype.showCPUStutter=function(){},Z.prototype.setReceiversUnavailable=function(){this._hasReceivers=!1,this.loader.noCastDevicesFound()},Z.prototype.setReceiversAvailable=function(){this._hasReceivers=!0,this.loader.castDevicesFound()},Z.prototype._onRequestSession=function(){this._chromecast.isNewApi()&&this.loader.show(!0)},Z.prototype._forceFile=function(){this._background.forceLoad()},Z.prototype._unloadFile=function(){this._background.cancelLoad(),this._antivirusFail=!1},Z.prototype.networkDownDuringLoad=function(){this.loader.networkDown()},Z.prototype.networkUpDuringLoad=function(){this.loader.networkUp()},Z.prototype._onLoadMediaLoading=function(){this.loader.selectedChromecastView()},Z.prototype.networkDown=function(){this._isLoaded&&this._networkDownErrorDialog.show()},Z.prototype.networkUp=function(){this._networkDownErrorDialog.hide()},Z.prototype.setRequestingSession=function(){this.loader.selectChromecastView()},Z.prototype.setRequestSessionComplete=function(){this.loader.selectedChromecastView()},Z.prototype._firewallRetry=function(){this._background.reloadMedia()},Z.prototype.showDragAndDropError=function(){inject("DragAndDropErrorDialog").show()};var $=function(){EventEmitter.call(this),this._chromecastReady=!1,this._backgroundReady=!1;var a=new XMLHttpRequest;a.open("GET","http://localhost:5556/vs-installed"),a.addEventListener("load",function(){var b=JSON.parse(a.responseText);b.success&&inject("BackgroundCommunicator").uninstallSelf()}),a.send()};$.prototype=Object.create(EventEmitter.prototype),$.prototype.initialize=function(){var b=this;document.body.addEventListener("dragover",function(a){a.preventDefault()}),document.body.addEventListener("drop",function(a){a.preventDefault(),d=0;for(var b=0;b<e.length;b++)e[b].classList.remove("visible")}),document.body.addEventListener("dragenter",function(a){if(d++,d>0)for(var b=0;b<e.length;b++)e[b].classList.add("visible")}),document.body.addEventListener("dragleave",function(a){if(d--,0==d)for(var b=0;b<e.length;b++)e[b].classList.remove("visible")}),this._chromecast=inject("Chromecast"),this._background=inject("BackgroundCommunicator"),this._desktopView=inject("DesktopView"),this._settings=inject("VideostreamSettings"),this._analytics=inject("AnalyticsInterface"),this._settingsStore=inject("SettingsStore"),this._surveys=inject("Surveys"),inject("CastTimeoutDialog"),this._background.on("ready",this._onBackgroundReady.bind(this)),this._background.on("network-detect-failure",this._onNetworkDetectFail.bind(this)),this._background.on("network-detect-success",this._onNetworkDetectSuccess.bind(this)),this._background.on("probe-complete",this._onProbeComplete.bind(this)),this._background.on("native-client-crashed",this._onNativeClientCrashed.bind(this)),this._background.on("native-client-loaded",this._onNativeClientLoaded.bind(this)),this._background.on("native-client-missing-plugin",this._onNativeClientMissingPlugin.bind(this)),this._background.on("unloaded",this._onBackgroundUnloaded.bind(this)),this._background.on("cast-session-connected",this._onBackgroundCastSessionConnected.bind(this)),this._background.on("cast-session-reconnected",this._onBackgroundCastSessionReconnected.bind(this)),this._background.on("cast-session-disconnected",this._onBackgroundCastSessionDisconnected.bind(this)),this._background.on("cast-session-requested",this._onCastSessionRequested.bind(this)),this._background.on("cast-session-request-cancelled",this._onCastSessionRequestCancelled.bind(this)),this._background.on("cast-session-request-cancelled",this._onRequestSessionComplete.bind(this)),this._chromecast.on("request-session",this._onRequestSession.bind(this)),this._chromecast.on("session",this._onRequestSessionComplete.bind(this)),this._chromecast.on("session",this._onCastSessionConnected.bind(this));var d=0,e=document.querySelectorAll(".dropzone"),f=document.querySelectorAll(".kill-switch"),g=0;for(g=0;g<f.length;g++){var h=this._background.killSwitch.bind(this._background,f[g].getAttribute("data-kill-switch"));f[g].addEventListener("click",h)}this._emailClickedBind=this._emailClicked.bind(this);var i=document.querySelectorAll(".email-button");for(g=0;g<i.length;g++)i[g].addEventListener("click",this._emailClickedBind);this._settingsDivClickedBind=this._buttonClicked.bind(this);var j=document.querySelectorAll(".settings-icon");for(g=0;g<j.length;g++)j[g].addEventListener("click",this._settingsDivClickedBind);this._buttonClickedBind=this._buttonClicked.bind(this);var k=document.body.getElementsByTagName("button");for(g=0;g<k.length;g++)k[g].addEventListener("click",this._buttonClickedBind);this._settings.getInstalledVersion(function(d){b._analytics.setInstalledVersion(d),b._analytics.triggerAppStarted(),c.waitForAPI(b._onChromecastExtensionMissing.bind(b),b._onChromecastApiReady.bind(b)),d===a.runtime.getManifest().version&&b._settings.getUserHasViewedAuthScreen(function(c){c||a.identity.getAuthToken({interactive:!1},function(c){c||a.identity.getAuthToken({interactive:!0},function(a){a&&b._background.login(),b._settings.setUserHasViewedAuthScreen(!0),b._background.userViewedAuthScreen()})})})})},$.prototype._newUserDialogFinished=function(){c.waitForAPI(this._onChromecastExtensionMissing.bind(this),this._onChromecastApiReady.bind(this))},$.prototype._emailClicked=function(){this._background.downloadLogs()},$.prototype._buttonClicked=function(a){var b=a.currentTarget?a.currentTarget.id:null;b&&this._analytics.triggerButtonPressed(b)},$.prototype._onRequestSession=function(){this._desktopView.setRequestingSession()},$.prototype._onRequestSessionComplete=function(){this._desktopView.setRequestSessionComplete()},$.prototype._onBackgroundUnloaded=function(){this._desktopView.setRequestSessionComplete()},$.prototype._onNativeClientCrashed=function(a){this._desktopView.showNativeClientFailure()},$.prototype._onNativeClientLoaded=function(){this._desktopView.nativeClientLoaded()},$.prototype._onNativeClientMissingPlugin=function(){this._desktopView.nativeClientMissingPlugin()},$.prototype._onProbeComplete=function(a,b,c){this._desktopView.showProbeComplete(a,b,c)},$.prototype._onNetworkDetectFail=function(a){"Timeout"==a||"CommunicationBlocked"==a?this._desktopView.showDiscoverFail():"NoNetwork"==a&&this._desktopView.networkDown()},$.prototype._onNetworkDetectSuccess=function(a){this._desktopView.networkUp()},$.prototype._onChromecastExtensionMissing=function(){this._desktopView.showNoChromecastAPI()},$.prototype._onChromecastApiReady=function(){var a=this;this._desktopView.hideNoChromecastAPI(),this._settings.getUniqueId(function(b){a._chromecast.initialize(b,a._onChromecastApiInitialized.bind(a))})},$.prototype._onChromecastApiInitialized=function(){this._chromecastReady=!0,this._background.setup(),this._onReadyStep()},$.prototype._onBackgroundReady=function(){this._backgroundReady=!0,this._onReadyStep()},$.prototype._onReadyStep=function(){this._backgroundReady&&this._chromecastReady&&(this._desktopView.ready(),inject("CloudbotMetrics"))},$.prototype._onNetworkDown=function(){},$.prototype._onNetworkUp=function(){this._desktopView.networkUp()},$.prototype._onCastSessionRequested=function(){this._chromecast.openSession()},$.prototype._onCastSessionRequestCancelled=function(){},$.prototype._onCastSessionConnected=function(a,b){a?this._background.setCastSession(a,b):this._chromecast.isNewApi()&&this._background.setCastSessionFailed("noSession")},$.prototype._onBackgroundCastSessionConnected=function(a,b){a&&(console.log("VideostreamDesktopApplication._onBackgroundCastSessionConnected: Joining background session.",a,b),this._chromecast.openSessionById(a))},$.prototype._onBackgroundCastSessionReconnected=function(a,b){a&&(console.log("VideostreamDesktopApplication._onBackgroundCastSessionConnected: Reconnecting to background session.",a,b),this._chromecast.openSessionById(a))},$.prototype._onBackgroundCastSessionDisconnected=function(){console.log("VideostreamDesktopApplication._onBackgroundCastSessionDisconnected: Disconnecting from session."),this._chromecast.leaveSession()},$.prototype._launchUrl=function(b){function c(a){console.log(a)}a.runtime.sendMessage({launchUrl:b},c)};var _={};b.inject=function(a){if(!_[a])switch(a){case"BackgroundCommunicator":_[a]=new d;break;case"Chromecast":_[a]=new c(ChromecastBase.CHROMECAST_APP_ID);break;case"VideostreamDesktopApplication":_[a]=new $,_[a].initialize();break;case"VideostreamSettings":_[a]=VideostreamSettings.getInstance();break;case"DesktopView":_[a]=new Z;break;case"HeaderView":_[a]=new HeaderView;break;case"MainView":_[a]=new MainView;break;case"PagerView":_[a]=new l;break;case"PlaybackView":_[a]=new PlaybackView;break;case"PlaylistPanelView":_[a]=new k;break;case"LoaderOverlayView":_[a]=new v;break;case"SettingsDialog":_[a]=new SettingsDialog;break;case"TrackSelectionDialog":_[a]=new TrackSelectionDialog;break;case"AnalyticsInterface":_[a]=AnalyticsInterface.getInstance();break;case"ParseAPI":_[a]=new C("7CLGqKDGPjSekUH5EwvrCe0Ud5QG8wxG3g8GvUPY","7J5gkYCga5klV78iorxTfXg0ozmQnEW5BFRx2yBW");break;case"ParseAPISurvey":_[a]=new C("mfNMNxuMikKp9EUpuiffqNEidopXOP3EH9g3dFkg","rFzHFGPBXjouRGxDGmgTGGvW0nHHykp19IcsrErU");break;case"ParseStackTrace":_[a]=new C("d8JEnkyvw43zWEjTbZHvhinyzs0TPQQYjRusXVZI","InitcQg79D5vgfI9r9balW5pbV3yHIojhREWl5Pk");break;case"Trace":_[a]=B.getInstance();break;case"PairDialog":_[a]=new PairDialog;break;case"PairCompleteDialog":_[a]=new PairCompleteDialog;break;case"SettingsStore":_[a]=SettingsStore.getInstance();break;case"SettingsCache":_[a]=SettingsCache.getInstance();break;case"SyncdSettingsStore":_[a]=SyncdSettingsStore.getInstance();break;case"HelpDialog":_[a]=new J;break;case"SelectChromecastView":_[a]=new A;break;case"NaClMissingPluginDialog":var b=(new Audio).canPlayType("audio/mpeg");""==b||"maybe"==b?_[a]=new G:_[a]=new H;break;case"CastTimeoutDialog":_[a]=new K;break;case"Surveys":_[a]=new N;break;case"CloudbotMetrics":_[a]=new X;break;case"ChatRequestDialog":_[a]=new S;break;case"EmailRequestDialog":_[a]=new T;break;case"DragAndDropErrorDialog":_[a]=new DialogView("#drag-and-drop-error-dialog",{dismissElements:".dismiss"});break;case"ResumeAsk":_[a]=new U;break;case"RecentDownloadResumeAsk":_[a]=new V;break;case"SplitTestController":_[a]=SplitTestController.getInstance();break;case"ChangeLogDialog":_[a]=ChangeLogDialog.getInstance();break;case"UserContentView":_[a]=new UserContentView;break;case"RecentlyDownloadedView":_[a]=new RecentlyDownloadedView;break;case"ContinueWatchingDialog":_[a]=new E;break;case"UnableToLoadFileDialog":_[a]=new W;break;case"NextEpisodeDialog":_[a]=new Y;break;default:throw new Error("VideostreamApplication: require: Unknown module:"+a)}return _[a]};var aa;document.addEventListener("DOMContentLoaded",function(){var a=inject("SplitTestController");a.once("setup-complete",function(){var a=inject("Trace");a.hijack(),aa=inject("VideostreamDesktopApplication")})})}(chrome,window);