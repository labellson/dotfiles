!function(a,b){function c(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}function c(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}!function(){function a(a){var c=!1;return function(){if(c)throw new Error("Callback was already called.");c=!0,a.apply(b,arguments)}}var b,c,d={};b=this,null!=b&&(c=b.async),d.noConflict=function(){return b.async=c,d};var e=Object.prototype.toString,f=Array.isArray||function(a){return"[object Array]"===e.call(a)},g=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},h=function(a,b){if(a.map)return a.map(b);var c=[];return g(a,function(a,d,e){c.push(b(a,d,e))}),c},i=function(a,b,c){return a.reduce?a.reduce(b,c):(g(a,function(a,d,e){c=b(c,a,d,e)}),c)},j=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"!=typeof process&&process.nextTick?(d.nextTick=process.nextTick,"undefined"!=typeof setImmediate?d.setImmediate=function(a){setImmediate(a)}:d.setImmediate=d.nextTick):"function"==typeof setImmediate?(d.nextTick=function(a){setImmediate(a)},d.setImmediate=d.nextTick):(d.nextTick=function(a){setTimeout(a,0)},d.setImmediate=d.nextTick),d.each=function(b,c,d){function e(a){a?(d(a),d=function(){}):(f+=1,f>=b.length&&d())}if(d=d||function(){},!b.length)return d();var f=0;g(b,function(b){c(b,a(e))})},d.forEach=d.each,d.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})};e()},d.forEachSeries=d.eachSeries,d.eachLimit=function(a,b,c,d){var e=k(b);e.apply(null,[a,c,d])},d.forEachLimit=d.eachLimit;var k=function(a){return function(b,c,d){if(d=d||function(){},!b.length||a<=0)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;g<a&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},l=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.each].concat(b))}},m=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[k(a)].concat(c))}},n=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.eachSeries].concat(b))}},o=function(a,b,c,d){if(b=h(b,function(a,b){return{index:b,value:a}}),d){var e=[];a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})}else a(b,function(a,b){c(a.value,function(a){b(a)})})};d.map=l(o),d.mapSeries=n(o),d.mapLimit=function(a,b,c,d){return p(b)(a,c,d)};var p=function(a){return m(a,o)};d.reduce=function(a,b,c,e){d.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){e(a,b)})},d.inject=d.reduce,d.foldl=d.reduce,d.reduceRight=function(a,b,c,e){var f=h(a,function(a){return a}).reverse();d.reduce(f,b,c,e)},d.foldr=d.reduceRight;var q=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(a){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.filter=l(q),d.filterSeries=n(q),d.select=d.filter,d.selectSeries=d.filterSeries;var r=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(a){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.reject=l(r),d.rejectSeries=n(r);var s=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(a){d()})};d.detect=l(s),d.detectSeries=n(s),d.some=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(a){c(!1)})},d.any=d.some,d.every=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(a){c(!0)})},d.all=d.every,d.sortBy=function(a,b,c){d.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0};c(null,h(b.sort(d),function(a){return a.value}))})},d.auto=function(a,b){b=b||function(){};var c=j(a),e=c.length;if(!e)return b();var h={},k=[],l=function(a){k.unshift(a)},m=function(a){for(var b=0;b<k.length;b+=1)if(k[b]===a)return void k.splice(b,1)},n=function(){e--,g(k.slice(0),function(a){a()})};l(function(){if(!e){var a=b;b=function(){},a(null,h)}}),g(c,function(c){var e=f(a[c])?a[c]:[a[c]],k=function(a){var e=Array.prototype.slice.call(arguments,1);if(e.length<=1&&(e=e[0]),a){var f={};g(j(h),function(a){f[a]=h[a]}),f[c]=e,b(a,f),b=function(){}}else h[c]=e,d.setImmediate(n)},o=e.slice(0,Math.abs(e.length-1))||[],p=function(){return i(o,function(a,b){return a&&h.hasOwnProperty(b)},!0)&&!h.hasOwnProperty(c)};if(p())e[e.length-1](k,h);else{var q=function(){p()&&(m(q),e[e.length-1](k,h))};l(q)}})},d.retry=function(a,b,c){var e=5,f=[];"function"==typeof a&&(c=b,b=a,a=e),a=parseInt(a,10)||e;var g=function(e,g){for(var h=function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},g)}};a;)f.push(h(b,!(a-=1)));d.series(f,function(a,b){b=b[b.length-1],(e||c)(b.err,b.result)})};return c?g():g},d.waterfall=function(a,b){if(b=b||function(){},!f(a)){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();var e=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=a.next();g?f.push(e(g)):f.push(b),d.setImmediate(function(){a.apply(null,f)})}}};e(d.iterator(a))()};var t=function(a,b,c){if(c=c||function(){},f(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(j(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};d.parallel=function(a,b){t({map:d.map,each:d.each},a,b)},d.parallelLimit=function(a,b,c){t({map:p(b),each:k(b)},a,c)},d.series=function(a,b){if(b=b||function(){},f(a))d.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};d.eachSeries(j(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},d.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},d.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var u=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};d.concat=l(u),d.concatSeries=n(u),d.whilst=function(a,b,c){a()?b(function(e){return e?c(e):void d.whilst(a,b,c)}):c()},d.doWhilst=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?d.doWhilst(a,b,c):c()})},d.until=function(a,b,c){a()?c():b(function(e){return e?c(e):void d.until(a,b,c)})},d.doUntil=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?c():d.doUntil(a,b,c)})},d.queue=function(b,c){function e(a,b,c,e){return a.started||(a.started=!0),f(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void g(b,function(b){var f={data:b,callback:"function"==typeof e?e:null};c?a.tasks.unshift(f):a.tasks.push(f),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}void 0===c&&(c=1);var h=0,i={tasks:[],concurrency:c,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(a,b){e(i,a,!1,b)},kill:function(){i.drain=null,i.tasks=[]},unshift:function(a,b){e(i,a,!0,b)},process:function(){if(!i.paused&&h<i.concurrency&&i.tasks.length){var c=i.tasks.shift();i.empty&&0===i.tasks.length&&i.empty(),h+=1;var d=function(){h-=1,c.callback&&c.callback.apply(c,arguments),i.drain&&i.tasks.length+h===0&&i.drain(),i.process()},e=a(d);b(c.data,e)}},length:function(){return i.tasks.length},running:function(){return h},idle:function(){return i.tasks.length+h===0},pause:function(){i.paused!==!0&&(i.paused=!0,i.process())},resume:function(){i.paused!==!1&&(i.paused=!1,i.process())}};return i},d.priorityQueue=function(a,b){function c(a,b){return a.priority-b.priority}function e(a,b,c){for(var d=-1,e=a.length-1;d<e;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function h(a,b,h,i){return a.started||(a.started=!0),f(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void g(b,function(b){var f={data:b,priority:h,callback:"function"==typeof i?i:null};a.tasks.splice(e(a.tasks,f,c)+1,0,f),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}var i=d.queue(a,b);return i.push=function(a,b,c){h(i,a,b,c)},delete i.unshift,i},d.cargo=function(a,b){var c=!1,e=[],i={tasks:e,payload:b,saturated:null,empty:null,drain:null,drained:!0,push:function(a,c){f(a)||(a=[a]),g(a,function(a){e.push({data:a,callback:"function"==typeof c?c:null}),i.drained=!1,i.saturated&&e.length===b&&i.saturated()}),d.setImmediate(i.process)},process:function d(){if(!c){if(0===e.length)return i.drain&&!i.drained&&i.drain(),void(i.drained=!0);var f="number"==typeof b?e.splice(0,b):e.splice(0,e.length),j=h(f,function(a){return a.data});i.empty&&i.empty(),c=!0,a(j,function(){c=!1;var a=arguments;g(f,function(b){b.callback&&b.callback.apply(null,a)}),d()})}},length:function(){return e.length},running:function(){return c}};return i};var v=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&g(c,function(b){console[a](b)}))}]))}};d.log=v("log"),d.dir=v("dir"),d.memoize=function(a,b){var c={},e={};b=b||function(a){return a};var f=function(){var f=Array.prototype.slice.call(arguments),g=f.pop(),h=b.apply(null,f);h in c?d.nextTick(function(){g.apply(null,c[h])}):h in e?e[h].push(g):(e[h]=[g],a.apply(null,f.concat([function(){c[h]=arguments;var a=e[h];delete e[h];for(var b=0,d=a.length;b<d;b++)a[b].apply(null,arguments)}])))};return f.memo=c,f.unmemoized=a,f},d.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},d.times=function(a,b,c){for(var e=[],f=0;f<a;f++)e.push(f);return d.map(e,b,c)},d.timesSeries=function(a,b,c){for(var e=[],f=0;f<a;f++)e.push(f);return d.mapSeries(e,b,c)},d.seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),e=c.pop();d.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){e.apply(b,[a].concat(c))})}},d.compose=function(){return d.seq.apply(null,Array.prototype.reverse.call(arguments))};var w=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};d.applyEach=l(w),d.applyEachSeries=n(w),d.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},"undefined"!=typeof module&&module.exports?module.exports=d:"undefined"!=typeof define&&define.amd?define([],function(){return d}):b.async=d}(),function(){"use strict";function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&b(e[d],c)===-1&&(e[d].push(f?c:{listener:c,once:!1}),this.emit("listenerAdded",a,c.listener||c,c.once||!1));return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)if(f.hasOwnProperty(e)&&(d=b(f[e],c),d!==-1))var c=f[e].splice(d,1);return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof module&&module.exports?module.exports=a:e.EventEmitter=a}.call(this),function(){"use strict";var c,d=d||{},e=this,f=function(a){return void 0!==a},g=function(){},h=function(a){var b=typeof a;if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==b&&"undefined"==typeof a.call)return"object";return b},i=function(a){return"array"==h(a)},j=function(a){var b=h(a);return"array"==b||"object"==b&&"number"==typeof a.length},k=function(a){return"string"==typeof a},l=function(a){return"number"==typeof a},m=function(a){return"function"==h(a)},n=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b},o=function(a,b,c){return a.call.apply(a.bind,arguments)},p=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}},q=function(a,b,c){return q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:p,q.apply(null,arguments)},r=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();return b.push.apply(b,arguments),a.apply(this,b)}},s=Date.now||function(){return+new Date},t=function(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var g;c.length&&(g=c.shift());)!c.length&&f(b)?d[g]=b:d=d[g]?d[g]:d[g]={}},u=function(a,b){function c(){}c.prototype=b.prototype,a.P=b.prototype,a.prototype=new c,a.ie=function(a,c,d){for(var e=Array(arguments.length-2),f=2;f<arguments.length;f++)e[f-2]=arguments[f];return b.prototype[c].apply(a,e)}};Function.prototype.bind=Function.prototype.bind||function(a,b){if(1<arguments.length){var c=Array.prototype.slice.call(arguments,1);return c.unshift(this,a),q.apply(null,c)}return q(this,a)};var v=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,v);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))};u(v,Error),v.prototype.name="CustomError";var w=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},x=function(a,b){return a<b?-1:a>b?1:0},y=Array.prototype,z=y.indexOf?function(a,b,c){return y.indexOf.call(a,b,c)}:function(a,b,c){if(c=null==c?0:0>c?Math.max(0,a.length+c):c,k(a))return k(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},A=y.forEach?function(a,b,c){y.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=k(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},B=y.some?function(a,b,c){return y.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=k(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},C=y.every?function(a,b,c){return y.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=k(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0},D=function(a){var b;a:{b=Bd;for(var c=a.length,d=k(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:k(a)?a.charAt(b):a[b]},E=function(a,b){var c,d=z(a,b);return(c=0<=d)&&y.splice.call(a,d,1),c},F=function(a){return y.concat.apply(y,arguments)},G=function(a,b,c){return 2>=arguments.length?y.slice.call(a,b):y.slice.call(a,b,c)},H="StopIteration"in e?e.StopIteration:Error("StopIteration"),I=function(){};I.prototype.next=function(){throw H},I.prototype.Sb=function(){return this};var J=function(a,b,c){for(var d in a)b.call(c,a[d],d,a)},K=function(a){var b,c=[],d=0;for(b in a)c[d++]=a[b];return c},L=function(a){var b,c=[],d=0;for(b in a)c[d++]=b;return c},M=function(a,b){var c;a:{for(c in a)if(b.call(void 0,a[c],c,a))break a;c=void 0}return c&&a[c]},N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),O=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<N.length;f++)c=N[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}},P=function(a){var b=arguments.length;if(1==b&&i(arguments[0]))return P.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c},Q=function(a,b){this.p={},this.b=[],this.Ja=this.j=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.ha(a)};Q.prototype.t=function(){R(this);for(var a=[],b=0;b<this.b.length;b++)a.push(this.p[this.b[b]]);return a},Q.prototype.H=function(){return R(this),this.b.concat()},Q.prototype.T=function(a){return U(this.p,a)},Q.prototype.remove=function(a){return!!U(this.p,a)&&(delete this.p[a],this.j--,this.Ja++,this.b.length>2*this.j&&R(this),!0)};var R=function(a){if(a.j!=a.b.length){for(var b=0,c=0;b<a.b.length;){var d=a.b[b];U(a.p,d)&&(a.b[c++]=d),b++}a.b.length=c}if(a.j!=a.b.length){for(var e={},c=b=0;b<a.b.length;)d=a.b[b],U(e,d)||(a.b[c++]=d,e[d]=1),b++;a.b.length=c}};c=Q.prototype,c.get=function(a,b){return U(this.p,a)?this.p[a]:b},c.set=function(a,b){U(this.p,a)||(this.j++,this.b.push(a),this.Ja++),this.p[a]=b},c.ha=function(a){var b;a instanceof Q?(b=a.H(),a=a.t()):(b=L(a),a=K(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])},c.forEach=function(a,b){for(var c=this.H(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}},c.clone=function(){return new Q(this)},c.Nb=function(){R(this);for(var a={},b=0;b<this.b.length;b++){var c=this.b[b];a[c]=this.p[c]}return a},c.Sb=function(a){R(this);var b=0,c=this.b,d=this.p,e=this.Ja,f=this,g=new I;return g.next=function(){for(;;){if(e!=f.Ja)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw H;var g=c[b++];return a?g:d[g]}},g};var S,T,U=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},V={id:"hitType",name:"t",valueType:"text",maxLength:void 0,defaultValue:void 0},W={id:"sessionControl",name:"sc",valueType:"text",maxLength:void 0,defaultValue:void 0},X={id:"description",name:"cd",valueType:"text",maxLength:2048,defaultValue:void 0},Y={id:"eventCategory",name:"ec",valueType:"text",maxLength:150,defaultValue:void 0},Z={id:"eventAction",name:"ea",valueType:"text",maxLength:500,defaultValue:void 0},$={id:"eventLabel",name:"el",valueType:"text",maxLength:500,defaultValue:void 0},_={id:"eventValue",name:"ev",valueType:"integer",maxLength:void 0,defaultValue:void 0},aa={zd:V,$c:{id:"anonymizeIp",name:"aip",valueType:"boolean",maxLength:void 0,defaultValue:void 0},Kd:{id:"queueTime",name:"qt",valueType:"integer",maxLength:void 0,defaultValue:void 0},fd:{id:"cacheBuster",name:"z",valueType:"text",maxLength:void 0,defaultValue:void 0},Qd:W,Rd:{id:"sessionGroup",name:"sg",valueType:"text",maxLength:void 0,defaultValue:void 0},ge:{id:"userId",name:"uid",valueType:"text",maxLength:void 0,defaultValue:void 0},Hd:{id:"nonInteraction",name:"ni",valueType:"boolean",maxLength:void 0,defaultValue:void 0},qd:X,$d:{id:"title",name:"dt",valueType:"text",maxLength:1500,defaultValue:void 0},bd:{id:"appId",name:"aid",valueType:"text",maxLength:150,defaultValue:void 0},cd:{id:"appInstallerId",name:"aiid",valueType:"text",maxLength:150,defaultValue:void 0},td:Y,sd:Z,ud:$,vd:_,Td:{id:"socialNetwork",name:"sn",valueType:"text",maxLength:50,defaultValue:void 0},Sd:{id:"socialAction",name:"sa",valueType:"text",maxLength:50,defaultValue:void 0},Ud:{id:"socialTarget",name:"st",valueType:"text",maxLength:2048,defaultValue:void 0},ce:{id:"transactionId",name:"ti",valueType:"text",maxLength:500,defaultValue:void 0},be:{id:"transactionAffiliation",name:"ta",valueType:"text",maxLength:500,defaultValue:void 0},de:{id:"transactionRevenue",name:"tr",valueType:"currency",maxLength:void 0,defaultValue:void 0},ee:{id:"transactionShipping",name:"ts",valueType:"currency",maxLength:void 0,defaultValue:void 0},fe:{id:"transactionTax",name:"tt",valueType:"currency",maxLength:void 0,defaultValue:void 0},od:{id:"currencyCode",name:"cu",valueType:"text",maxLength:10,defaultValue:void 0},Dd:{id:"itemPrice",name:"ip",valueType:"currency",maxLength:void 0,defaultValue:void 0},Ed:{id:"itemQuantity",name:"iq",valueType:"integer",maxLength:void 0,defaultValue:void 0},Bd:{id:"itemCode",name:"ic",valueType:"text",maxLength:500,defaultValue:void 0},Cd:{id:"itemName",name:"in",valueType:"text",maxLength:500,defaultValue:void 0},Ad:{id:"itemCategory",name:"iv",valueType:"text",maxLength:500,defaultValue:void 0},md:{id:"campaignSource",name:"cs",valueType:"text",maxLength:100,defaultValue:void 0},kd:{id:"campaignMedium",name:"cm",valueType:"text",maxLength:50,defaultValue:void 0},ld:{id:"campaignName",name:"cn",valueType:"text",maxLength:100,defaultValue:void 0},jd:{id:"campaignKeyword",name:"ck",valueType:"text",maxLength:500,defaultValue:void 0},gd:{id:"campaignContent",name:"cc",valueType:"text",maxLength:500,defaultValue:void 0},hd:{id:"campaignId",name:"ci",valueType:"text",maxLength:100,defaultValue:void 0},yd:{id:"gclid",name:"gclid",valueType:"text",maxLength:void 0,defaultValue:void 0},pd:{id:"dclid",name:"dclid",valueType:"text",maxLength:void 0,defaultValue:void 0},Jd:{id:"pageLoadTime",name:"plt",valueType:"integer",maxLength:void 0,defaultValue:void 0},rd:{id:"dnsTime",name:"dns",valueType:"integer",maxLength:void 0,defaultValue:void 0},Vd:{id:"tcpConnectTime",name:"tcp",valueType:"integer",maxLength:void 0,defaultValue:void 0},Pd:{id:"serverResponseTime",name:"srt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Id:{id:"pageDownloadTime",name:"pdt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Ld:{id:"redirectResponseTime",name:"rrt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Wd:{id:"timingCategory",name:"utc",valueType:"text",maxLength:150,defaultValue:void 0},Zd:{id:"timingVar",name:"utv",valueType:"text",maxLength:500,defaultValue:void 0},Yd:{id:"timingValue",name:"utt",valueType:"integer",maxLength:void 0,defaultValue:void 0},Xd:{id:"timingLabel",name:"utl",valueType:"text",maxLength:500,defaultValue:void 0},wd:{id:"exDescription",name:"exd",valueType:"text",maxLength:150,defaultValue:void 0},xd:{id:"exFatal",name:"exf",valueType:"boolean",maxLength:void 0,defaultValue:"1"}},ba=function(a){if(1>a||200<a)throw Error("Expected dimension index range 1-200, but was : "+a);return{id:"dimension"+a,name:"cd"+a,valueType:"text",maxLength:150,defaultValue:void 0}},ca=function(a){if(1>a||200<a)throw Error("Expected metric index range 1-200, but was : "+a);return{id:"metric"+a,name:"cm"+a,valueType:"integer",maxLength:void 0,defaultValue:void 0}},da=function(a){return 1>a?"0":3>a?"1-2":(a=Math.floor(Math.log(a-1)/Math.log(2)),Math.pow(2,a)+1+"-"+Math.pow(2,a+1))},ea=function(a,b){for(var c=0,d=a.length-1,e=0;c<=d;){var f=Math.floor((c+d)/2),e=a[f];if(b<=e){if(d=0==f?0:a[f-1],b>d)return(d+1).toString()+"-"+e.toString();d=f-1}else if(b>e){if(f>=a.length-1)return(a[a.length-1]+1).toString()+"+";c=f+1}}return"<= 0"},fa=function(){this.gb=[]},ga=function(){return new fa};c=fa.prototype,c.when=function(a){return this.gb.push(a),this},c.Rb=function(a){var b=arguments;return this.when(function(a){return 0<=z(b,a.ub())}),this},c.Yc=function(a,b){var c=G(arguments,1);return this.when(function(b){return b=b.V().get(a),0<=z(c,b)}),this},c.mb=function(a,b){if(n(this.e))throw Error("Filter has already been set.");return this.e=n(b)?q(a,b):a,this},c.ia=function(){if(0==this.gb.length)throw Error("Must specify at least one predicate using #when or a helper method.");if(!n(this.e))throw Error("Must specify a delegate filter using #applyFilter.");return q(function(a){C(this.gb,function(b){return b(a)})&&this.e(a)},this)};var ha=function(){this.lb=!1,this.zb="",this.Kb=!1,this.ya=null};ha.prototype.Wb=function(a){return this.lb=!0,this.zb=a||" - ",this},ha.prototype.Sc=function(){return this.Kb=!0,this},ha.prototype.Dc=function(){return ia(this,da)},ha.prototype.Ec=function(a){return ia(this,r(ea,a))};var ia=function(a,b){if(null!=a.ya)throw Error("LabelerBuilder: Only one labeling strategy may be used.");return a.ya=q(function(a){var c=a.V().get(_),d=a.V().get($);l(c)&&(c=b(c),null!=d&&this.lb&&(c=d+this.zb+c),a.V().set($,c))},a),a};ha.prototype.ia=function(){if(null==this.ya)throw Error("LabelerBuilder: a labeling strategy must be specified prior to calling build().");return ga().Rb("event").mb(q(function(a){this.ya(a),this.Kb&&a.V().remove(_)},this)).ia()};var ja=function(a,b){var c=Array.prototype.slice.call(arguments),d=c.shift();if("undefined"==typeof d)throw Error("[goog.string.format] Template required");return d.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(a,b,d,e,f,g,h,i){if("%"==g)return"%";var j=c.shift();if("undefined"==typeof j)throw Error("[goog.string.format] Not enough arguments");return arguments[0]=j,ka[g].apply(null,arguments)})},ka={s:function(a,b,c){return isNaN(c)||""==c||a.length>=c?a:a=-1<b.indexOf("-",0)?a+Array(c-a.length+1).join(" "):Array(c-a.length+1).join(" ")+a},f:function(a,b,c,d,e){d=a.toString(),isNaN(e)||""==e||(d=parseFloat(a).toFixed(e));var f;return f=0>a?"-":0<=b.indexOf("+")?"+":0<=b.indexOf(" ")?" ":"",0<=a&&(d=f+d),isNaN(c)||d.length>=c?d:(d=isNaN(e)?Math.abs(a).toString():Math.abs(a).toFixed(e),a=c-d.length-f.length,d=0<=b.indexOf("-",0)?f+d+Array(a+1).join(" "):f+Array(a+1).join(0<=b.indexOf("0",0)?"0":" ")+d)},d:function(a,b,c,d,e,f,g,h){return ka.f(parseInt(a,10),b,c,d,0,f,g,h)}};ka.i=ka.d,ka.u=ka.d;var la=function(a){if("function"==typeof a.t)return a.t();if(k(a))return a.split("");if(j(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return K(a)},ma=function(a,b){if("function"==typeof a.forEach)a.forEach(b,void 0);else if(j(a)||k(a))A(a,b,void 0);else{var c;if("function"==typeof a.H)c=a.H();else if("function"!=typeof a.t)if(j(a)||k(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=L(a);else c=void 0;for(var d=la(a),e=d.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}},na=function(a){if(this.w=new Q,0<arguments.length%2)throw Error("Uneven number of arguments to ParameterMap constructor.");for(var b=arguments,c=0;c<b.length;c+=2)this.set(b[c],b[c+1])};na.prototype.set=function(a,b){if(null==b)throw Error("undefined-or-null value for key: "+a.name);this.w.set(a.name,{key:a,value:b})},na.prototype.remove=function(a){this.w.remove(a.name)},na.prototype.get=function(a){return a=this.w.get(a.name,null),null===a?null:a.value},na.prototype.ha=function(a){this.w.ha(a.w)};var oa=function(a,b){A(a.w.t(),function(a){b(a.key,a.value)})};na.prototype.Nb=function(){var a={};return oa(this,function(b,c){a[b.id]=c}),a},na.prototype.clone=function(){var a=new na;return a.w=this.w.clone(),a},na.prototype.toString=function(){var a={};return oa(this,function(b,c){a[b.id]=c}),JSON.stringify(a)};var pa=function(a){this.e=a};c=pa.prototype,c.Yb=function(a){var b=new pa(q(this.M,this));return b.I=Y,b.Q=a,b},c.action=function(a){var b=new pa(q(this.M,this));return b.I=Z,b.Q=a,b},c.label=function(a){var b=new pa(q(this.M,this));return b.I=$,b.Q=a,b},c.value=function(a){var b=new pa(q(this.M,this));return b.I=_,b.Q=a,b},c.fc=function(a){var b=new pa(q(this.M,this));return b.I=ba(a.index),b.Q=a.value,b},c.vc=function(a){var b=new pa(q(this.M,this));return b.I=ca(a.index),b.Q=a.value,b},c.send=function(a){var b=new na;return this.M(b),a.send("event",b)},c.M=function(a){null!=this.I&&null!=this.Q&&!a.w.T(this.I.name)&&a.set(this.I,this.Q),n(this.e)&&this.e(a)};var qa=new pa(g),ra=function(){this.aa=this.aa,this.Ca=this.Ca};ra.prototype.aa=!1,ra.prototype.ma=function(){this.aa||(this.aa=!0,this.o())},ra.prototype.o=function(){if(this.Ca)for(;this.Ca.length;)this.Ca.shift()()};var sa=function(a,b){this.type=a,this.currentTarget=this.target=b,this.defaultPrevented=this.X=!1,this.Hb=!0};sa.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Hb=!1};var ta=function(a){return ta[" "](a),a};ta[" "]=g;var ua;a:{var va=e.navigator;if(va){var wa=va.userAgent;if(wa){ua=wa;break a}}ua=""}var xa=function(){return-1!=ua.indexOf("Edge")||-1!=ua.indexOf("Trident")||-1!=ua.indexOf("MSIE")},ya=function(){return-1!=ua.indexOf("Edge")},za=-1!=ua.indexOf("Opera")||-1!=ua.indexOf("OPR"),Aa=xa(),Ba=!(-1==ua.indexOf("Gecko")||-1!=ua.toLowerCase().indexOf("webkit")&&!ya()||-1!=ua.indexOf("Trident")||-1!=ua.indexOf("MSIE")||ya()),Ca=-1!=ua.toLowerCase().indexOf("webkit")&&!ya(),Da=function(){var a=ua;return Ba?/rv\:([^\);]+)(\)|;)/.exec(a):Aa&&ya()?/Edge\/([\d\.]+)/.exec(a):Aa?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):Ca?/WebKit\/(\S+)/.exec(a):void 0},Ea=function(){var a=e.document;return a?a.documentMode:void 0},Fa=function(){if(za&&e.opera){var a=e.opera.version;return m(a)?a():a}var a="",b=Da();return b&&(a=b?b[1]:""),Aa&&!ya()&&(b=Ea(),b>parseFloat(a))?String(b):a}(),Ga={},Ha=function(a){var b;if(!(b=Ga[a])){b=0;for(var c=w(String(Fa)).split("."),d=w(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",i=/(\d*)(\D*)/g,j=/(\d*)(\D*)/g;
do{var k=i.exec(g)||["","",""],l=j.exec(h)||["","",""];if(0==k[0].length&&0==l[0].length)break;b=x(0==k[1].length?0:parseInt(k[1],10),0==l[1].length?0:parseInt(l[1],10))||x(0==k[2].length,0==l[2].length)||x(k[2],l[2])}while(0==b)}b=Ga[a]=0<=b}return b},Ia=e.document,Ja=Ea(),Ka=!Ia||!Aa||!Ja&&ya()?void 0:Ja||("CSS1Compat"==Ia.compatMode?parseInt(Fa,10):5),La=!Aa||Aa&&(ya()||9<=Ka),Ma=Aa&&!Ha("9"),Na=!Ca||Ha("528"),Oa=Ba&&Ha("1.9b")||Aa&&Ha("8")||za&&Ha("9.5")||Ca&&Ha("528"),Pa=Ba&&!Ha("8")||Aa&&!Ha("9"),Qa=function(a,b){if(sa.call(this,a?a.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.charCode=this.keyCode=this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.sb=this.state=null,a){var c=this.type=a.type;this.target=a.target||a.srcElement,this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ba){var e;a:{try{ta(d.nodeName),e=!0;break a}catch(a){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d,this.offsetX=Ca||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=Ca||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0,this.button=a.button,this.keyCode=a.keyCode||0,this.charCode=a.charCode||("keypress"==c?a.keyCode:0),this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.state=a.state,this.sb=a,a.defaultPrevented&&this.preventDefault()}};u(Qa,sa),Qa.prototype.preventDefault=function(){Qa.P.preventDefault.call(this);var a=this.sb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Ma)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(a){}};var Ra="closure_listenable_"+(1e6*Math.random()|0),Sa=function(a){return!(!a||!a[Ra])},Ta=0,Ua=function(a,b,c,d,e){this.O=a,this.proxy=null,this.src=b,this.type=c,this.ka=!!d,this.sa=e,this.key=++Ta,this.removed=this.ja=!1},Va=function(a){a.removed=!0,a.O=null,a.proxy=null,a.src=null,a.sa=null},Wa=function(a){this.src=a,this.k={},this.fa=0};Wa.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.k[f],a||(a=this.k[f]=[],this.fa++);var g=Ya(a,b,d,e);return-1<g?(b=a[g],c||(b.ja=!1)):(b=new Ua(b,this.src,f,(!!d),e),b.ja=c,a.push(b)),b},Wa.prototype.remove=function(a,b,c,d){if(a=a.toString(),!(a in this.k))return!1;var e=this.k[a];return b=Ya(e,b,c,d),-1<b&&(Va(e[b]),y.splice.call(e,b,1),0==e.length&&(delete this.k[a],this.fa--),!0)};var Xa=function(a,b){var c=b.type;if(!(c in a.k))return!1;var d=E(a.k[c],b);return d&&(Va(b),0==a.k[c].length&&(delete a.k[c],a.fa--)),d};Wa.prototype.removeAll=function(a){a=a&&a.toString();var b,c=0;for(b in this.k)if(!a||b==a){for(var d=this.k[b],e=0;e<d.length;e++)++c,Va(d[e]);delete this.k[b],this.fa--}return c},Wa.prototype.ba=function(a,b,c,d){a=this.k[a.toString()];var e=-1;return a&&(e=Ya(a,b,c,d)),-1<e?a[e]:null};var Ya=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.O==b&&f.ka==!!c&&f.sa==d)return e}return-1},Za="closure_lm_"+(1e6*Math.random()|0),$a={},_a=0,ab=function(a,b,c,d,e){if(i(b)){for(var f=0;f<b.length;f++)ab(a,b[f],c,d,e);return null}return c=mb(c),Sa(a)?a.listen(b,c,d,e):bb(a,b,c,!1,d,e)},bb=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,h=kb(a);return h||(a[Za]=h=new Wa(a)),c=h.add(b,c,d,e,f),c.proxy?c:(d=cb(),c.proxy=d,d.src=a,d.O=c,a.addEventListener?a.addEventListener(b.toString(),d,g):a.attachEvent(gb(b.toString()),d),_a++,c)},cb=function(){var a=jb,b=La?function(c){return a.call(b.src,b.O,c)}:function(c){if(c=a.call(b.src,b.O,c),!c)return c};return b},db=function(a,b,c,d,e){if(i(b)){for(var f=0;f<b.length;f++)db(a,b[f],c,d,e);return null}return c=mb(c),Sa(a)?a.cb(b,c,d,e):bb(a,b,c,!0,d,e)},eb=function(a,b,c,d,e){if(i(b))for(var f=0;f<b.length;f++)eb(a,b[f],c,d,e);else c=mb(c),Sa(a)?a.jb(b,c,d,e):a&&(a=kb(a))&&(b=a.ba(b,c,!!d,e))&&fb(b)},fb=function(a){if(l(a)||!a||a.removed)return!1;var b=a.src;if(Sa(b))return Xa(b.B,a);var c=a.type,d=a.proxy;return b.removeEventListener?b.removeEventListener(c,d,a.ka):b.detachEvent&&b.detachEvent(gb(c),d),_a--,(c=kb(b))?(Xa(c,a),0==c.fa&&(c.src=null,b[Za]=null)):Va(a),!0},gb=function(a){return a in $a?$a[a]:$a[a]="on"+a},hb=function(a,b,c,d){var e=!0;if((a=kb(a))&&(b=a.k[b.toString()]))for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.ka==c&&!f.removed&&(f=ib(f,d),e=e&&!1!==f)}return e},ib=function(a,b){var c=a.O,d=a.sa||a.src;return a.ja&&fb(a),c.call(d,b)},jb=function(a,b){if(a.removed)return!0;if(!La){var c;if(!(c=b))a:{c=["window","event"];for(var d,f=e;d=c.shift();){if(null==f[d]){c=null;break a}f=f[d]}c=f}if(d=c,c=new Qa(d,this),f=!0,!(0>d.keyCode||void 0!=d.returnValue)){a:{var g=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(a){g=!0}(g||void 0==d.returnValue)&&(d.returnValue=!0)}for(d=[],g=c.currentTarget;g;g=g.parentNode)d.push(g);for(var g=a.type,h=d.length-1;!c.X&&0<=h;h--){c.currentTarget=d[h];var i=hb(d[h],g,!0,c),f=f&&i}for(h=0;!c.X&&h<d.length;h++)c.currentTarget=d[h],i=hb(d[h],g,!1,c),f=f&&i}return f}return ib(a,new Qa(b,this))},kb=function(a){return a=a[Za],a instanceof Wa?a:null},lb="__closure_events_fn_"+(1e9*Math.random()>>>0),mb=function(a){return m(a)?a:(a[lb]||(a[lb]=function(b){return a.handleEvent(b)}),a[lb])},nb=function(){ra.call(this),this.B=new Wa(this),this.Tb=this,this.fb=null};u(nb,ra),nb.prototype[Ra]=!0,c=nb.prototype,c.addEventListener=function(a,b,c,d){ab(this,a,b,c,d)},c.removeEventListener=function(a,b,c,d){eb(this,a,b,c,d)},c.dispatchEvent=function(a){var b,c=this.fb;if(c){b=[];for(var d=1;c;c=c.fb)b.push(c),++d}if(c=this.Tb,d=a.type||a,k(a))a=new sa(a,c);else if(a instanceof sa)a.target=a.target||c;else{var e=a;a=new sa(d,c),O(a,e)}var f,e=!0;if(b)for(var g=b.length-1;!a.X&&0<=g;g--)f=a.currentTarget=b[g],e=ob(f,d,!0,a)&&e;if(a.X||(f=a.currentTarget=c,e=ob(f,d,!0,a)&&e,a.X||(e=ob(f,d,!1,a)&&e)),b)for(g=0;!a.X&&g<b.length;g++)f=a.currentTarget=b[g],e=ob(f,d,!1,a)&&e;return e},c.o=function(){nb.P.o.call(this),this.B&&this.B.removeAll(void 0),this.fb=null},c.listen=function(a,b,c,d){return this.B.add(String(a),b,!1,c,d)},c.cb=function(a,b,c,d){return this.B.add(String(a),b,!0,c,d)},c.jb=function(a,b,c,d){return this.B.remove(String(a),b,c,d)};var ob=function(a,b,c,d){if(b=a.B.k[String(b)],!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.removed&&g.ka==c){var h=g.O,i=g.sa||g.src;g.ja&&Xa(a.B,g),e=!1!==h.call(i,d)&&e}}return e&&0!=d.Hb};nb.prototype.ba=function(a,b,c,d){return this.B.ba(String(a),b,c,d)};var pb=function(a,b,c){this.tc=c,this.dc=a,this.Gc=b,this.Ba=0,this.ta=null};pb.prototype.get=function(){var a;return 0<this.Ba?(this.Ba--,a=this.ta,this.ta=a.next,a.next=null):a=this.dc(),a},pb.prototype.put=function(a){this.Gc(a),this.Ba<this.tc&&(this.Ba++,a.next=this.ta,this.ta=a)};var qb,rb=function(a){e.setTimeout(function(){throw a},0)},sb=function(){var a=e.MessageChannel;if("undefined"==typeof a&&"undefined"!=typeof b&&b.postMessage&&b.addEventListener&&-1==ua.indexOf("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none",a.src="",document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open(),a.write(""),a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=q(function(a){"*"!=d&&a.origin!=d||a.data!=c||this.port1.onmessage()},this);b.addEventListener("message",a,!1),this.port1={},this.port2={postMessage:function(){b.postMessage(c,d)}}}),"undefined"!=typeof a&&!xa()){var c=new a,d={},g=d;return c.port1.onmessage=function(){if(f(d.next)){d=d.next;var a=d.ob;d.ob=null,a()}},function(a){g.next={ob:a},g=g.next,c.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null,b.parentNode.removeChild(b),b=null,a(),a=null},document.documentElement.appendChild(b)}:function(a){e.setTimeout(a,0)}},tb=function(){this.Ka=this.Z=null},ub=new pb(function(){return new vb},function(a){a.reset()},100);tb.prototype.add=function(a,b){var c=ub.get();c.set(a,b),this.Ka?this.Ka.next=c:this.Z=c,this.Ka=c},tb.prototype.remove=function(){var a=null;return this.Z&&(a=this.Z,this.Z=this.Z.next,this.Z||(this.Ka=null),a.next=null),a};var vb=function(){this.next=this.scope=this.Wa=null};vb.prototype.set=function(a,b){this.Wa=a,this.scope=b,this.next=null},vb.prototype.reset=function(){this.next=this.scope=this.Wa=null};var wb,xb=function(a,b){wb||yb(),zb||(wb(),zb=!0),Ab.add(a,b)},yb=function(){if(e.Promise&&e.Promise.resolve){var a=e.Promise.resolve();wb=function(){a.then(Bb)}}else wb=function(){var a=Bb;!m(e.setImmediate)||e.Window&&e.Window.prototype&&e.Window.prototype.setImmediate==e.setImmediate?(qb||(qb=sb()),qb(a)):e.setImmediate(a)}},zb=!1,Ab=new tb,Bb=function(){for(var a=null;a=Ab.remove();){try{a.Wa.call(a.scope)}catch(a){rb(a)}ub.put(a)}zb=!1},Cb=function(a){a.prototype.then=a.prototype.then,a.prototype.$goog_Thenable=!0},Db=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(a){return!1}},Eb=function(a,b){if(this.m=0,this.D=void 0,this.S=this.G=this.l=null,this.ra=this.Va=!1,a==Ib)Mb(this,2,b);else try{var c=this;a.call(b,function(a){Mb(c,2,a)},function(a){Mb(c,3,a)})}catch(a){Mb(this,3,a)}},Fb=function(){this.next=this.context=this.da=this.Da=this.L=null,this.Na=!1};Fb.prototype.reset=function(){this.context=this.da=this.Da=this.L=null,this.Na=!1};var Gb=new pb(function(){return new Fb},function(a){a.reset()},100),Hb=function(a,b,c){var d=Gb.get();return d.Da=a,d.da=b,d.context=c,d},Ib=function(){};Eb.prototype.then=function(a,b,c){return Lb(this,m(a)?a:null,m(b)?b:null,c)},Cb(Eb),Eb.prototype.cancel=function(a){0==this.m&&xb(function(){var b=new Tb(a);Jb(this,b)},this)};var Jb=function(a,b){if(0==a.m)if(a.l){var c=a.l;if(c.G){for(var d=0,e=null,f=null,g=c.G;g&&(g.Na||(d++,g.L==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==c.m&&1==d?Jb(c,b):(f?(d=f,d.next==c.S&&(c.S=d),d.next=d.next.next):Pb(c),Qb(c,e,3,b)))}a.l=null}else Mb(a,3,b)},Kb=function(a,b){a.G||2!=a.m&&3!=a.m||Ob(a),a.S?a.S.next=b:a.G=b,a.S=b},Lb=function(a,b,c,d){var e=Hb(null,null,null);return e.L=new Eb(function(a,g){e.Da=b?function(c){try{var e=b.call(d,c);a(e)}catch(a){g(a)}}:a,e.da=c?function(b){try{var e=c.call(d,b);!f(e)&&b instanceof Tb?g(b):a(e)}catch(a){g(a)}}:g}),e.L.l=a,Kb(a,e),e.L};Eb.prototype.Pb=function(a){this.m=0,Mb(this,2,a)},Eb.prototype.Qb=function(a){this.m=0,Mb(this,3,a)};var Mb=function(a,b,c){if(0==a.m){if(a==c)b=3,c=new TypeError("Promise cannot resolve to itself");else{if(Db(c)){a.m=1,b=c,c=a.Pb;var d=a.Qb;return void(b instanceof Eb?Kb(b,Hb(c||g,d||null,a)):b.then(c,d,a))}if(n(c))try{if(d=c.then,m(d))return void Nb(a,c,d)}catch(a){b=3,c=a}}a.D=c,a.m=b,a.l=null,Ob(a),3!=b||c instanceof Tb||Rb(a,c)}},Nb=function(a,b,c){a.m=1;var d=!1,e=function(b){d||(d=!0,a.Pb(b))},f=function(b){d||(d=!0,a.Qb(b))};try{c.call(b,e,f)}catch(a){f(a)}},Ob=function(a){a.Va||(a.Va=!0,xb(a.gc,a))},Pb=function(a){var b=null;return a.G&&(b=a.G,a.G=b.next,b.next=null),a.G||(a.S=null),b};Eb.prototype.gc=function(){for(var a=null;a=Pb(this);)Qb(this,a,this.m,this.D);this.Va=!1};var Qb=function(a,b,c,d){if(b.L&&(b.L.l=null),2==c)b.Da.call(b.context,d);else if(null!=b.da){if(!b.Na)for(;a&&a.ra;a=a.l)a.ra=!1;b.da.call(b.context,d)}Gb.put(b)},Rb=function(a,b){a.ra=!0,xb(function(){a.ra&&Sb.call(null,b)})},Sb=rb,Tb=function(a){v.call(this,a)};u(Tb,v),Tb.prototype.name="cancel";var Ub=function(a,b){this.Fa=[],this.Cb=a,this.rb=b||null,this.ca=this.C=!1,this.D=void 0,this.hb=this.Xb=this.Oa=!1,this.Ia=0,this.l=null,this.Qa=0};Ub.prototype.cancel=function(a){if(this.C)this.D instanceof Ub&&this.D.cancel();else{if(this.l){var b=this.l;delete this.l,a?b.cancel(a):(b.Qa--,0>=b.Qa&&b.cancel())}this.Cb?this.Cb.call(this.rb,this):this.hb=!0,this.C||this.A(new cc)}},Ub.prototype.qb=function(a,b){this.Oa=!1,Vb(this,a,b)};var Vb=function(a,b,c){a.C=!0,a.D=c,a.ca=!b,$b(a)},Wb=function(a){if(a.C){if(!a.hb)throw new bc;a.hb=!1}};Ub.prototype.v=function(a){Wb(this),Vb(this,!0,a)},Ub.prototype.A=function(a){Wb(this),Vb(this,!1,a)},Ub.prototype.n=function(a,b){return Xb(this,a,null,b)};var Xb=function(a,b,c,d){return a.Fa.push([b,c,d]),a.C&&$b(a),a};Ub.prototype.then=function(a,b,c){var d,e,f=new Eb(function(a,b){d=a,e=b});return Xb(this,d,function(a){a instanceof cc?f.cancel():e(a)}),f.then(a,b,c)},Cb(Ub);var Yb=function(a){var b=new Ub;return Xb(a,b.v,b.A,b),b},Zb=function(a){return B(a.Fa,function(a){return m(a[1])})},$b=function(a){if(a.Ia&&a.C&&Zb(a)){var b=a.Ia,c=ec[b];c&&(e.clearTimeout(c.ua),delete ec[b]),a.Ia=0}a.l&&(a.l.Qa--,delete a.l);for(var b=a.D,d=c=!1;a.Fa.length&&!a.Oa;){var g=a.Fa.shift(),h=g[0],i=g[1],g=g[2];if(h=a.ca?i:h)try{var j=h.call(g||a.rb,b);f(j)&&(a.ca=a.ca&&(j==b||j instanceof Error),a.D=b=j),Db(b)&&(d=!0,a.Oa=!0)}catch(d){b=d,a.ca=!0,Zb(a)||(c=!0)}}a.D=b,d&&(j=q(a.qb,a,!0),d=q(a.qb,a,!1),b instanceof Ub?(Xb(b,j,d),b.Xb=!0):b.then(j,d)),c&&(b=new dc(b),ec[b.ua]=b,a.Ia=b.ua)},_b=function(a){var b=new Ub;return b.v(a),b},ac=function(){var a=ed,b=new Ub;return b.A(a),b},bc=function(){v.call(this)};u(bc,v),bc.prototype.message="Deferred has already fired",bc.prototype.name="AlreadyCalledError";var cc=function(){v.call(this)};u(cc,v),cc.prototype.message="Deferred was canceled",cc.prototype.name="CanceledError";var dc=function(a){this.ua=e.setTimeout(q(this.Tc,this),0),this.na=a};dc.prototype.Tc=function(){throw delete ec[this.ua],this.na};var ec={},fc=function(a){this.qa=[],this.e=a};fc.prototype.R=function(a){if(!m(a))throw Error("Invalid filter. Must be a function.");this.qa.push(a)},fc.prototype.send=function(a,b){if(0==this.qa.length)return this.e.send(a,b);var c=new hc(a,b);return gc(this,0,c).n(function(){if(!c.Sa)return this.e.send(a,b)},this)};var gc=function(a,b,c){return _b().n(function(){return this.qa[b](c)},a).n(function(){if(++b<this.qa.length&&!c.Sa)return gc(this,b,c)},a)},hc=function(a,b){this.Wc=a,this.Cc=b,this.Sa=!1};hc.prototype.ub=function(){return this.Wc},hc.prototype.V=function(){return this.Cc},hc.prototype.cancel=function(){this.Sa=!0},P("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));var ic=function(a,b){this.width=a,this.height=b};ic.prototype.clone=function(){return new ic(this.width,this.height)},ic.prototype.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},!Ba&&!Aa||Aa&&Aa&&(ya()||9<=Ka)||Ba&&Ha("1.9.1"),Aa&&Ha("9");var jc={id:"apiVersion",name:"v",valueType:"text",maxLength:void 0,defaultValue:void 0},kc={id:"appName",name:"an",valueType:"text",maxLength:100,defaultValue:void 0},lc={id:"appVersion",name:"av",valueType:"text",maxLength:100,defaultValue:void 0},mc={id:"clientId",name:"cid",valueType:"text",maxLength:void 0,defaultValue:void 0},nc={id:"language",name:"ul",valueType:"text",maxLength:20,defaultValue:void 0},oc={id:"libVersion",name:"_v",valueType:"text",maxLength:void 0,defaultValue:void 0},pc={id:"sampleRateOverride",name:"usro",valueType:"integer",maxLength:void 0,defaultValue:void 0},qc={id:"screenColors",name:"sd",valueType:"text",maxLength:20,defaultValue:void 0},rc={id:"screenResolution",name:"sr",valueType:"text",maxLength:20,defaultValue:void 0},sc={id:"trackingId",name:"tid",valueType:"text",maxLength:void 0,defaultValue:void 0},tc={id:"viewportSize",name:"vp",valueType:"text",maxLength:20,defaultValue:void 0},uc={ad:jc,dd:kc,ed:lc,nd:mc,Fd:nc,Gd:oc,Md:pc,Nd:qc,Od:rc,ae:sc,he:tc},vc=function(a){if(!k(a))return a;var b=wc(a,aa);if(n(b))return b;if(b=wc(a,uc),n(b))return b;if(b=/^dimension(\d+)$/.exec(a),null!==b)return ba(parseInt(b[1],10));if(b=/^metric(\d+)$/.exec(a),null!==b)return ca(parseInt(b[1],10));throw Error(a+" is not a valid parameter name.")},wc=function(a,b){var c=M(b,function(b){return b.id==a&&"metric"!=a&&"dimension"!=a});return n(c)?c:null},xc=function(a,b){this.ac=b,this.q=b.Xa(),this.Fb=new na,this.ib=!1};c=xc.prototype,c.set=function(a,b){if(null==b)throw Error("Value must be defined and not null. Parameter="+a.id);var c=vc(a);this.Fb.set(c,b)},c.R=function(a){this.ac.R(a)},c.send=function(a,b){if(a instanceof pa)return a.send(this);var c=this.Fb.clone();return b instanceof na?c.ha(b):n(b)&&J(b,function(a,b){null!=a&&c.set(vc(b),a)},this),this.ib&&(this.ib=!1,c.set(W,"start")),this.q.send(a,c)},c.Hc=function(a){var b={description:a};return this.set(X,a),this.send("appview",b)},c.Ic=function(a,b,c,d){return this.send("event",{eventCategory:a,eventAction:b,eventLabel:c,eventValue:d})},c.Kc=function(a,b,c){return this.send("social",{socialNetwork:a,socialAction:b,socialTarget:c})},c.Jc=function(a,b){return this.send("exception",{exDescription:a,exFatal:b})},c.Ib=function(a,b,c,d,e){return this.send("timing",{timingCategory:a,timingVar:b,timingLabel:d,timingValue:c,sampleRateOverride:e})},c.jc=function(){this.ib=!0},c.Rc=function(a,b,c,d){return new yc(this,a,b,c,d)};var yc=function(a,b,c,d,e){this.Ob=a,this.Zb=b,this.Xc=c,this.rc=d,this.Ea=e,this.Qc=s()};yc.prototype.send=function(){var a=this.Ob.Ib(this.Zb,this.Xc,s()-this.Qc,this.rc,this.Ea);return this.Ob=null,a};var zc=function(a,b,c,d,e){this.sc=a,this.Ub=b,this.Vb=c,this.g=d,this.$b=e};zc.prototype.mc=function(a){var c=new xc(0,this.$b.create());return c.set(oc,this.sc),c.set(jc,1),c.set(kc,this.Ub),c.set(lc,this.Vb),c.set(sc,a),(a=navigator.language||navigator.browserLanguage)&&c.set(nc,a),(a=screen.colorDepth+"-bit")&&c.set(qc,a),(a=[screen.width,screen.height].join("x"))&&c.set(rc,a),a=b.document,a="CSS1Compat"==a.compatMode?a.documentElement:a.body,a=new ic(a.clientWidth,a.clientHeight),(a=[a.width,a.height].join("x"))&&c.set(tc,a),c},zc.prototype.kc=function(){return Yb(this.g.ea)};var Ac=function(a,b,c,d,e,f){for(Ub.call(this,e,f),this.bb=a,this.Ta=[],this.tb=!!b,this.ic=!!c,this.cc=!!d,b=this.Bb=0;b<a.length;b++)Xb(a[b],q(this.vb,this,b,!0),q(this.vb,this,b,!1));0!=a.length||this.tb||this.v(this.Ta)};u(Ac,Ub),Ac.prototype.vb=function(a,b,c){return this.Bb++,this.Ta[a]=[b,c],this.C||(this.tb&&b?this.v([a,c]):this.ic&&!b?this.A(c):this.Bb==this.bb.length&&this.v(this.Ta)),this.cc&&!b&&(c=null),c},Ac.prototype.A=function(a){for(Ac.P.A.call(this,a),a=0;a<this.bb.length;a++)this.bb[a].cancel()};var Bc=function(a){return new Ac(a,(!1),(!0)).n(function(a){for(var b=[],c=0;c<a.length;c++)b[c]=a[c][1];return b})},Cc=function(){for(var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split(""),b=0,c=a.length;b<c;b++)switch(a[b]){case"x":a[b]=Math.floor(16*Math.random()).toString(16);break;case"y":a[b]=(Math.floor(4*Math.random())+8).toString(16)}return a.join("")},Dc=function(a){this.J=a,this.Ea=100,this.pb=[],this.W=this.ga=null,this.ea=Ec(this),this.ea.n(function(){this.Jb=ab(this.J,"a",q(this.nc,this))},this)},Ec=function(a){return Fc(a).n(function(){return this},a)},Fc=function(a){return Bc([Hc(a),Jc(a)])};Dc.prototype.nc=function(){Nc(this);var a=Ic(this),b=this.xa();Fc(this).n(function(){a!=Ic(this)&&Mc(this,"analytics.user-id"),b!=this.xa()&&Mc(this,"analytics.tracking-permitted")},this)};var Gc=function(a,b){Nc(a),a.pb.push(b)};Dc.prototype.Oc=function(a){Nc(this);var b=this.W!=a;this.W=a,this.J.set("analytics.tracking-permitted",a.toString()),b&&Mc(this,"analytics.tracking-permitted")},Dc.prototype.xa=function(){Nc(this);var a;return(a=this.W)&&(a=e._gaUserPrefs,a=!(a&&a.ioo&&a.ioo())),a};var Hc=function(a){return a.J.get("analytics.tracking-permitted").n(function(a){if(this.W=!0,f(a))switch(a){case"true":this.W=!0;break;case"false":this.W=!1}},a)},Ic=function(a){if(Nc(a),!k(a.ga))throw Error("Invalid state. UserID is not a string.");return a.ga},Jc=function(a){return a.J.get("analytics.user-id").n(function(a){f(a)?this.ga=a:Kc(this)},a)},Kc=function(a){return a.ga=Cc(),a.J.set("analytics.user-id",a.ga).n(function(){Mc(this,"analytics.user-id")},a)};Dc.prototype.Nc=function(a){Nc(this),this.Ea=a};var Lc=function(a){return Nc(a),a.Ea};Dc.prototype.Fc=function(){return Kc(this)};var Mc=function(a,b){A(a.pb,function(a){a(b)})};Dc.prototype.ma=function(){null!=this.Jb&&fb(this.Jb)};var Nc=function(a){if(!Yb(a.ea).C)throw Error("Settings object accessed prior to entering ready state.")},Oc=function(){nb.call(this),this.eb="google-analytics",this.J=a.storage.local,a.storage.onChanged.addListener(q(this.Ac,this))};u(Oc,nb),Oc.prototype.Ac=function(a){Pc(this,a)&&this.dispatchEvent("a")};var Pc=function(a,b){return B(L(b),function(a){return 0==a.lastIndexOf(this.eb,0)},a)};Oc.prototype.get=function(b){var c=new Ub,d=this.eb+"."+b;return this.J.get(d,function(b){a.runtime.lastError?c.A(a.runtime.lastError):(b=b[d],c.v(null!=b?b.toString():void 0))}),c},Oc.prototype.set=function(b,c){var d=new Ub,e={};return e[this.eb+"."+b]=c,this.J.set(e,function(){a.runtime.lastError?d.A(a.runtime.lastError):d.v()}),d};var Qc=function(){};Qc.lc=function(){return Qc.yb?Qc.yb:Qc.yb=new Qc},Qc.prototype.send=function(){return _b()};var Rc=function(a){this.ec=a};Rc.prototype.send=function(a,b){return this.ec.push({pc:a,Bc:b}),_b()};var Sc=function(a,b,c){this.g=a,this.U=[],this.K={enabled:new Rc(this.U),disabled:c},this.q=this.K.enabled,Xb(Yb(this.g.ea),r(this.zc,b),this.yc,this)};Sc.prototype.zc=function(a){if(null===this.U)throw Error("Channel setup already completed.");this.K.enabled=a(),Tc(this),A(this.U,function(a){this.send(a.pc,a.Bc)},this),this.U=null,Gc(this.g,q(this.xc,this))},Sc.prototype.yc=function(){if(null===this.U)throw Error("Channel setup already completed.");this.q=this.K.enabled=this.K.disabled,this.U=null},Sc.prototype.send=function(a,b){return this.q.send(a,b)};var Tc=function(a){a.q=a.g.xa()?a.K.enabled:a.K.disabled};Sc.prototype.xc=function(a){switch(a){case"analytics.tracking-permitted":Tc(this)}};var Uc=function(a,b){this.Ra=[];var c=q(function(){return this.pa=new fc(b.Xa()),A(this.Ra,function(a){this.pa.R(a)},this),this.Ra=null,this.pa},this);this.q=new Sc(a,c,Qc.lc())};Uc.prototype.Xa=function(){return this.q},Uc.prototype.R=function(a){this.pa?this.pa.R(a):this.Ra.push(a)};var Vc=function(a,b){this.g=a,this.Pc=b};Vc.prototype.create=function(){return new Uc(this.g,this.Pc)};var Wc=function(a,b){nb.call(this),this.wa=a||1,this.Y=b||e,this.Pa=q(this.Uc,this),this.ab=s()};u(Wc,nb),c=Wc.prototype,c.enabled=!1,c.h=null,c.Uc=function(){if(this.enabled){var a=s()-this.ab;0<a&&a<.8*this.wa?this.h=this.Y.setTimeout(this.Pa,this.wa-a):(this.h&&(this.Y.clearTimeout(this.h),this.h=null),this.dispatchEvent("tick"),this.enabled&&(this.h=this.Y.setTimeout(this.Pa,this.wa),this.ab=s()))}},c.start=function(){this.enabled=!0,this.h||(this.h=this.Y.setTimeout(this.Pa,this.wa),this.ab=s())},c.stop=function(){this.enabled=!1,this.h&&(this.Y.clearTimeout(this.h),this.h=null)},c.o=function(){Wc.P.o.call(this),this.stop(),delete this.Y};var Xc=function(a,b,c){if(m(a))c&&(a=q(a,c));else{if(!a||"function"!=typeof a.handleEvent)throw Error("Invalid listener argument");a=q(a.handleEvent,a)}return 2147483647<b?-1:e.setTimeout(a,b||0)},Yc=function(a){ra.call(this),this.Ya=a,this.b={}};u(Yc,ra);var Zc=[];Yc.prototype.listen=function(a,b,c,d){i(b)||(b&&(Zc[0]=b.toString()),b=Zc);for(var e=0;e<b.length;e++){var f=ab(a,b[e],c||this.handleEvent,d||!1,this.Ya||this);if(!f)break;this.b[f.key]=f}return this},Yc.prototype.cb=function(a,b,c,d){return $c(this,a,b,c,d)};var $c=function(a,b,c,d,e,f){if(i(c))for(var g=0;g<c.length;g++)$c(a,b,c[g],d,e,f);else{if(b=db(b,c,d||a.handleEvent,e,f||a.Ya||a),!b)return a;a.b[b.key]=b}return a};Yc.prototype.jb=function(a,b,c,d,e){if(i(b))for(var f=0;f<b.length;f++)this.jb(a,b[f],c,d,e);else c=c||this.handleEvent,e=e||this.Ya||this,c=mb(c),d=!!d,b=Sa(a)?a.ba(b,c,d,e):a&&(a=kb(a))?a.ba(b,c,d,e):null,b&&(fb(b),delete this.b[b.key]);return this},Yc.prototype.removeAll=function(){J(this.b,fb),this.b={}},Yc.prototype.o=function(){Yc.P.o.call(this),this.removeAll()},Yc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _c=function(){nb.call(this),this.oa=new Yc(this),Na&&(Oa?this.oa.listen(Pa?document.body:b,["online","offline"],this.wb):(this.Eb=!Na||navigator.onLine,this.h=new Wc(250),this.oa.listen(this.h,"tick",this.oc),this.h.start()))};u(_c,nb),_c.prototype.oc=function(){var a=!Na||navigator.onLine;a!=this.Eb&&(this.Eb=a,this.wb())},_c.prototype.wb=function(){this.dispatchEvent((Na?navigator.onLine:1)?"online":"offline")},_c.prototype.o=function(){_c.P.o.call(this),this.oa.ma(),this.oa=null,this.h&&(this.h.ma(),this.h=null)};var ad=function(a,b){this.g=a,this.e=b};ad.prototype.send=function(a,b){return b.set(mc,Ic(this.g)),this.e.send(a,b)};var bd=function(a){this.e=a};bd.prototype.send=function(a,b){return cd(b),dd(b),this.e.send(a,b)};var cd=function(a){oa(a,function(b,c){f(b.maxLength)&&"text"==b.valueType&&0<b.maxLength&&c.length>b.maxLength&&a.set(b,c.substring(0,b.maxLength))})},dd=function(a){oa(a,function(b,c){f(b.defaultValue)&&c==b.defaultValue&&a.remove(b)})},ed={status:"device-offline",la:void 0},fd={status:"rate-limited",la:void 0},gd={status:"sampled-out",la:void 0},hd={status:"sent",la:void 0},id=function(a,b){this.Vc=a,this.e=b};id.prototype.send=function(a,b){var c;c=this.Vc;var d=c.Lb(),e=Math.floor((d-c.Ab)*c.hc);return 0<e&&(c.$=Math.min(c.$+e,c.uc),c.Ab=d),1>c.$?c=!1:(--c.$,c=!0),c||"item"==a||"transaction"==a?this.e.send(a,b):_b(fd)};var jd=function(){this.$=60,this.uc=500,this.hc=5e-4,this.Lb=function(){return(new Date).getTime()},this.Ab=this.Lb()},kd=function(a,b){this.g=a,this.e=b};kd.prototype.send=function(a,b){var c,d=b.get(mc),d=parseInt(d.split("-")[1],16);return"timing"!=a?c=Lc(this.g):((c=b.get(pc))&&b.remove(pc),c=c||Lc(this.g)),d<655.36*c?this.e.send(a,b):_b(gd)};var ld=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/,md=function(a){if(nd){nd=!1;var b=e.location;if(b){var c=b.href;if(c&&(c=(c=md(c)[3]||null)?decodeURI(c):c)&&c!=b.hostname)throw nd=!0,Error()}}return a.match(ld)},nd=Ca,od=function(a,b){for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f=null,g=null;0<=e?(f=c[d].substring(0,e),g=c[d].substring(e+1)):f=c[d],b(f,g?decodeURIComponent(g.replace(/\+/g," ")):"")}},pd=function(){};pd.prototype.nb=null;var qd,rd=function(a){var b;return(b=a.nb)||(b={},ud(a)&&(b[0]=!0,b[1]=!0),b=a.nb=b),b},sd=function(){};u(sd,pd);var td=function(a){return(a=ud(a))?new ActiveXObject(a):new XMLHttpRequest},ud=function(a){if(!a.xb&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.xb=d}catch(a){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return a.xb};qd=new sd;var vd=function(a){nb.call(this),this.headers=new Q,this.Ma=a||null,this.F=!1,this.La=this.a=null,this.za=this.$a="",this.N=this.Za=this.va=this.Ua=!1,this.Ha=0,this.Ga=null,this.Gb="",this.kb=this.Zc=!1};u(vd,nb);var wd=/^https?$/i,xd=["POST","PUT"],yd=[],zd=function(a,b,c){var d=new vd;yd.push(d),b&&d.listen("complete",b),d.cb("ready",d.bc),d.send(a,"POST",c,void 0)};vd.prototype.bc=function(){this.ma(),E(yd,this)},vd.prototype.send=function(a,b,c,d){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.$a+"; newUri="+a);b=b?b.toUpperCase():"GET",this.$a=a,this.za="",this.Ua=!1,this.F=!0,this.a=td(this.Ma?this.Ma:qd),this.La=rd(this.Ma?this.Ma:qd),this.a.onreadystatechange=q(this.Db,this);try{this.Za=!0,this.a.open(b,String(a),!0),this.Za=!1}catch(a){return void this.na(5,a)}a=c||"";var f=this.headers.clone();d&&ma(d,function(a,b){f.set(b,a)}),d=D(f.H()),c=e.FormData&&a instanceof e.FormData,!(0<=z(xd,b))||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),f.forEach(function(a,b){this.a.setRequestHeader(b,a)},this),this.Gb&&(this.a.responseType=this.Gb),"withCredentials"in this.a&&(this.a.withCredentials=this.Zc);try{Fd(this),0<this.Ha&&((this.kb=Ad(this.a))?(this.a.timeout=this.Ha,this.a.ontimeout=q(this.Mb,this)):this.Ga=Xc(this.Mb,this.Ha,this)),this.va=!0,this.a.send(a),this.va=!1}catch(a){this.na(5,a)}};var Ad=function(a){return Aa&&Ha(9)&&l(a.timeout)&&f(a.ontimeout)},Bd=function(a){return"content-type"==a.toLowerCase()};vd.prototype.Mb=function(){"undefined"!=typeof d&&this.a&&(this.za="Timed out after "+this.Ha+"ms, aborting",this.dispatchEvent("timeout"),this.abort(8))},vd.prototype.na=function(a,b){this.F=!1,this.a&&(this.N=!0,this.a.abort(),this.N=!1),this.za=b,Cd(this),Ed(this)};var Cd=function(a){a.Ua||(a.Ua=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))};vd.prototype.abort=function(){this.a&&this.F&&(this.F=!1,this.N=!0,this.a.abort(),this.N=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ed(this))},vd.prototype.o=function(){this.a&&(this.F&&(this.F=!1,this.N=!0,this.a.abort(),this.N=!1),Ed(this,!0)),vd.P.o.call(this)},vd.prototype.Db=function(){this.aa||(this.Za||this.va||this.N?Dd(this):this.wc())},vd.prototype.wc=function(){Dd(this)};var Dd=function(a){if(a.F&&"undefined"!=typeof d&&(!a.La[1]||4!=Gd(a)||2!=Hd(a)))if(a.va&&4==Gd(a))Xc(a.Db,0,a);else if(a.dispatchEvent("readystatechange"),4==Gd(a)){a.F=!1;try{var b,c=Hd(a);a:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:b=!0;break a;default:b=!1}var e;if(!(e=b)){var f;if(f=0===c){var g=md(String(a.$a))[1]||null;if(!g&&self.location)var h=self.location.protocol,g=h.substr(0,h.length-1);f=!wd.test(g?g.toLowerCase():"")}e=f}if(e)a.dispatchEvent("complete"),a.dispatchEvent("success");else{var i;try{i=2<Gd(a)?a.a.statusText:""}catch(a){i=""}a.za=i+" ["+Hd(a)+"]",Cd(a)}}finally{Ed(a)}}},Ed=function(a,b){if(a.a){Fd(a);var c=a.a,d=a.La[0]?g:null;a.a=null,a.La=null,b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(a){}}},Fd=function(a){a.a&&a.kb&&(a.a.ontimeout=null),l(a.Ga)&&(e.clearTimeout(a.Ga),a.Ga=null)},Gd=function(a){return a.a?a.a.readyState:0},Hd=function(a){try{return 2<Gd(a)?a.a.status:-1}catch(a){return-1}},Id=function(a,b,c){this.r=a||null,this.qc=!!c},Jd=function(a){a.c||(a.c=new Q,a.j=0,a.r&&od(a.r,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))};c=Id.prototype,c.c=null,c.j=null,c.add=function(a,b){Jd(this),this.r=null,a=Kd(this,a);var c=this.c.get(a);return c||this.c.set(a,c=[]),c.push(b),this.j++,this},c.remove=function(a){return Jd(this),a=Kd(this,a),!!this.c.T(a)&&(this.r=null,this.j-=this.c.get(a).length,this.c.remove(a))},c.T=function(a){return Jd(this),a=Kd(this,a),this.c.T(a)},c.H=function(){Jd(this);for(var a=this.c.t(),b=this.c.H(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c},c.t=function(a){Jd(this);var b=[];if(k(a))this.T(a)&&(b=F(b,this.c.get(Kd(this,a))));else{a=this.c.t();for(var c=0;c<a.length;c++)b=F(b,a[c])}return b},c.set=function(a,b){return Jd(this),this.r=null,a=Kd(this,a),this.T(a)&&(this.j-=this.c.get(a).length),this.c.set(a,[b]),this.j++,this},c.get=function(a,b){var c=a?this.t(a):[];return 0<c.length?String(c[0]):b},c.toString=function(){if(this.r)return this.r;if(!this.c)return"";for(var a=[],b=this.c.H(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.t(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f]))),a.push(g)}return this.r=a.join("&")},c.clone=function(){var a=new Id;return a.r=this.r,this.c&&(a.c=this.c.clone(),a.j=this.j),a};var Kd=function(a,b){var c=String(b);return a.qc&&(c=c.toLowerCase()),c},Ld=function(a,b){this.Mc=a,this.Aa=b};Ld.prototype.send=function(a,b){if(Na&&!navigator.onLine)return ac();var c=new Ub,d=Md(a,b);return d.length>this.Aa?c.A({status:"payload-too-big",la:ja("Encoded hit length == %s, but should be <= %s.",d.length,this.Aa)}):zd(this.Mc,function(){c.v(hd)},d),c};var Md=function(a,b){var c=new Id;return c.add(V.name,a),
oa(b,function(a,b){c.add(a.name,b.toString())}),c.toString()},Nd=function(a,b,c){this.g=a,this.Lc=b,this.Aa=c};Nd.prototype.Xa=function(){if(!this.q){if(!Yb(this.g.ea).C)throw Error("Cannot construct shared channel prior to settings being ready.");new _c;var a=new bd(new Ld(this.Lc,this.Aa)),b=new jd;this.q=new ad(this.g,new kd(this.g,new id(b,a)))}return this.q};var Od=new Q,Pd=function(){return S||(S=new Dc(new Oc)),S};t("goog.async.Deferred",Ub),t("goog.async.Deferred.prototype.addCallback",Ub.prototype.n),t("goog.async.Deferred.prototype.callback",Ub.prototype.v),t("goog.async.Deferred.prototype.then",Ub.prototype.then),t("goog.events.EventTarget",nb),t("goog.events.EventTarget.prototype.listen",nb.prototype.listen),t("analytics.getService",function(b,c){var d=Od.get(b,null),e=c||a.runtime.getManifest().version;if(null===d){if(d=Pd(),!T){var f=Pd();T=new Vc(f,new Nd(f,"https://www.google-analytics.com/collect",8192))}d=new zc("ca1.6.0",b,e,d,T),Od.set(b,d)}return d}),t("analytics.internal.GoogleAnalyticsService",zc),t("analytics.internal.GoogleAnalyticsService.prototype.getTracker",zc.prototype.mc),t("analytics.internal.GoogleAnalyticsService.prototype.getConfig",zc.prototype.kc),t("analytics.internal.ServiceSettings",Dc),t("analytics.internal.ServiceSettings.prototype.setTrackingPermitted",Dc.prototype.Oc),t("analytics.internal.ServiceSettings.prototype.isTrackingPermitted",Dc.prototype.xa),t("analytics.internal.ServiceSettings.prototype.setSampleRate",Dc.prototype.Nc),t("analytics.internal.ServiceSettings.prototype.resetUserId",Dc.prototype.Fc),t("analytics.internal.ServiceTracker",xc),t("analytics.internal.ServiceTracker.prototype.send",xc.prototype.send),t("analytics.internal.ServiceTracker.prototype.sendAppView",xc.prototype.Hc),t("analytics.internal.ServiceTracker.prototype.sendEvent",xc.prototype.Ic),t("analytics.internal.ServiceTracker.prototype.sendSocial",xc.prototype.Kc),t("analytics.internal.ServiceTracker.prototype.sendException",xc.prototype.Jc),t("analytics.internal.ServiceTracker.prototype.sendTiming",xc.prototype.Ib),t("analytics.internal.ServiceTracker.prototype.startTiming",xc.prototype.Rc),t("analytics.internal.ServiceTracker.Timing",yc),t("analytics.internal.ServiceTracker.Timing.prototype.send",yc.prototype.send),t("analytics.internal.ServiceTracker.prototype.forceSessionStart",xc.prototype.jc),t("analytics.internal.ServiceTracker.prototype.addFilter",xc.prototype.R),t("analytics.internal.FilterChannel.Hit",hc),t("analytics.internal.FilterChannel.Hit.prototype.getHitType",hc.prototype.ub),t("analytics.internal.FilterChannel.Hit.prototype.getParameters",hc.prototype.V),t("analytics.internal.FilterChannel.Hit.prototype.cancel",hc.prototype.cancel),t("analytics.ParameterMap",na),t("analytics.ParameterMap.Entry",na.Entry),t("analytics.ParameterMap.prototype.set",na.prototype.set),t("analytics.ParameterMap.prototype.get",na.prototype.get),t("analytics.ParameterMap.prototype.remove",na.prototype.remove),t("analytics.ParameterMap.prototype.toObject",na.prototype.Nb),t("analytics.HitTypes.APPVIEW","appview"),t("analytics.HitTypes.EVENT","event"),t("analytics.HitTypes.SOCIAL","social"),t("analytics.HitTypes.TRANSACTION","transaction"),t("analytics.HitTypes.ITEM","item"),t("analytics.HitTypes.TIMING","timing"),t("analytics.HitTypes.EXCEPTION","exception"),J(aa,function(a){var b=a.id.replace(/[A-Z]/,"_$&").toUpperCase();t("analytics.Parameters."+b,a)}),t("analytics.filters.EventLabelerBuilder",ha),t("analytics.filters.EventLabelerBuilder.prototype.appendToExistingLabel",ha.prototype.Wb),t("analytics.filters.EventLabelerBuilder.prototype.stripValue",ha.prototype.Sc),t("analytics.filters.EventLabelerBuilder.prototype.powersOfTwo",ha.prototype.Dc),t("analytics.filters.EventLabelerBuilder.prototype.rangeBounds",ha.prototype.Ec),t("analytics.filters.EventLabelerBuilder.prototype.build",ha.prototype.ia),t("analytics.filters.FilterBuilder",fa),t("analytics.filters.FilterBuilder.builder",ga),t("analytics.filters.FilterBuilder.prototype.when",fa.prototype.when),t("analytics.filters.FilterBuilder.prototype.whenHitType",fa.prototype.Rb),t("analytics.filters.FilterBuilder.prototype.whenValue",fa.prototype.Yc),t("analytics.filters.FilterBuilder.prototype.applyFilter",fa.prototype.mb),t("analytics.filters.FilterBuilder.prototype.build",fa.prototype.ia),t("analytics.EventBuilder",pa),t("analytics.EventBuilder.builder",function(){return qa}),t("analytics.EventBuilder.prototype.category",pa.prototype.Yb),t("analytics.EventBuilder.prototype.action",pa.prototype.action),t("analytics.EventBuilder.prototype.label",pa.prototype.label),t("analytics.EventBuilder.prototype.value",pa.prototype.value),t("analytics.EventBuilder.prototype.dimension",pa.prototype.fc),t("analytics.EventBuilder.prototype.metric",pa.prototype.vc),t("analytics.EventBuilder.prototype.send",pa.prototype.send)}.call(this),function(b){var c=b.EventEmitter||require("lib/EventEmitter"),d=function(a){return c.call(this),d.instance?d.instance:(this._isBackground=a,this._cbList={},this._portList=[],this._initialize(),void(d.instance=this))};d.prototype=Object.create(c.prototype),d.prototype._initialize=function(){if(this._isBackground)a.runtime.onConnect.addListener(this._onPortConnect.bind(this));else{var b=a.runtime.connect();this._onPortConnect(b)}},d.prototype._onPortConnect=function(a){this._portList.push(a),a.onDisconnect.addListener(this._onPortDisconnect.bind(this,a)),a.onMessage.addListener(this._onMessage.bind(this)),this.emit("port-connected")},d.prototype._onPortDisconnect=function(a){this._portList.splice(this._portList.indexOf(a),1),this._isBackground||this._initialize()},d.prototype._onMessage=function(a){var b=a,c=b.args,d=b._cb,e=b.isCb;if(e){if(!this._cbList[d])return;return this._cbList[d].apply(null,c),void delete this._cbList[d]}if(d){var f=this,g=[].concat(c);g.push(function(){for(var a={args:[].slice.apply(arguments),_cb:d,isCb:!0},b=0;b<f._portList.length;b++){var c=f._portList[b];c.postMessage(a)}}),this.emit.apply(this,g)}else this.emit.apply(this,c)},d.prototype.send=d.prototype.postMessage=function(){var a=[].slice.apply(arguments),b=null;"function"==typeof a[a.length-1]&&(b=a.pop());var c={args:a};b&&(c._cb=Uuid.generate(),this._cbList[c._cb]=b);for(var d=0;d<this._portList.length;d++){var e=this._portList[d];e.postMessage(c)}},d.prototype._onError=function(){},d.prototype.postTo=function(){var a=[].slice.apply(arguments),b=null,c=a.shift();"function"==typeof a[a.length-1]&&(b=a.pop());var d={args:a,to:c};b&&(d._cb=Uuid.generate(),this._cbList[d._cb]=b),this.worker.port.postMessage(d)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=d:b.SuperWorker=d}(b),function(a){var b=a.EventEmitter||require("lib/EventEmitter"),c=function(a){b.call(this),this._el=document.querySelector(a),this._isShown=!0};c.prototype=Object.create(b.prototype),c.prototype.show=function(a){this._el.style.removeProperty("display"),this._isShown=!0,a||this.emit("show")},c.prototype.hide=function(a){this._el.style.display="none",this._isShown=!1,a||this.emit("hide")},c.prototype.querySelector=function(a){return null==this._el?null:this._el.querySelector(a)},c.prototype.querySelectorAll=function(a){return null==this._el?[]:this._el.querySelectorAll(a)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.ElementView=c}(b),function(b){var c,d=b.EventEmitter||require("lib/EventEmitter"),e=function(){d.call(this),this.cache=inject("SettingsCache"),this._analytics=inject("AnalyticsInterface"),this.setMode("production")};e.getInstance=function(){return c||(c=new e),c},e.prototype=Object.create(d.prototype),e.prototype.setMode=function(a){"production"===a?(this.url="https://identity.getvideostream.com",this._env="prod"):"staging"===a?(this.url="http://identity-staging.getvideostream.com:3000",this._env="sandbox"):(this.url="http://localhost:3000",this._env="sandbox")},e.prototype.isProduction=function(){return"prod"==this._env},e.prototype.isAuthenticated=function(a){this._getToken(function(b){null==b?a(null,!1):a(null,!0)})},e.prototype.getSubscription=function(a){var b=this;this.cache.get("identitySubscription",function(c){c?(b.emit("subscription",c),a&&a(null,c)):(console.log("IdentityInterface.getSubscription: Not in cache!"),b._getAndroidSubscription(function(c,d){c?c.toLowerCase().indexOf("lifetime")>-1?b.getAndroidProductVerification(a):b.getAndroidSubscriptionVerification(a):b.getSubscriptionFromServer(a)}))})},e.prototype.getEmail=function(a){var b=this;this._getToken(function(c){c?b._videostreamRequest("POST","/subscribed",{key:c},function(b,c){!b&&c?c.email?a(null,c.email):a("invalidSession"):a(b||"noResponse")}):a("noToken")})},e.prototype.getLocation=function(a){var b=this;b._videostreamRequest("GET","/location",{},function(b,c){!b&&c?c.result?a(null,c.result):a("lookupFailed"):a(b||"noResponse")})},e.prototype.doPaymentSuccessRequest=function(a){var b=this;this.login(function(){var c=a.getQuery(),d="unknown";c&&(d=c.type),b._analytics.triggerPremiumPaymentSuccess(d),MixpanelReporter.getInstance().sendEvent("premiumPaymentSuccess",{plan:d},null),a.sendText(JSON.stringify({success:!0}),function(){a.close()})})},e.prototype.login=function(a){var b=this;this._getTokenInteractive(function(c){c?b.cache.unset("identitySubscription",function(){b.getSubscription(a)}):a("noToken")})},e.prototype.stripeSubscribe=function(a,b,c,d){var e=this;this._getToken(function(f){if(f){var g={stripeToken:b,googleToken:f,type:a,isCanada:c};e._videostreamRequest("POST","/stripe/create-subscription",g,function(a,b){!a&&b?(console.log(b),b.success?(e.getSubscription(),inject("VideostreamSettings").setStripeSubscriptionCancellationDate(0),d&&d(null)):d&&d(b.reason,b.info)):(d&&d(a||"noResponse"),console.log("identity::createSubscription::stripeSubscribe"))})}else d&&d("noToken","Failed to get Google Account")})},e.prototype.stripeCancel=function(a){var b=this;this._getToken(function(c){if(c){var d={googleToken:c};b._videostreamRequest("POST","/stripe/cancel-subscription",d,function(c,d){!c&&d?(console.log(d),d.success?(inject("VideostreamSettings").setStripeSubscriptionCancellationDate(Date.now(),function(){b.getSubscription()}),a&&a(null)):a&&a(d.reason,d.info)):(a&&a(c||"noResponse"),console.log("identity::createSubscription::stripeSubscribe"))})}else a&&a("noToken","Failed to get Google Account")})},e.prototype.paypalCancel=function(a){var b=this;this._getToken(function(c){if(c){var d={token:c};b._videostreamRequest("POST","/paypal/cancel-subscription",d,function(c,d){!c&&d?(console.log(d),d.success?(inject("VideostreamSettings").setPaypalSubscriptionCancellationDate(Date.now(),function(){b.getSubscription()}),a&&a(null)):a&&a(d.reason,d.info)):(a&&a(c||"noResponse"),console.log("identity::createSubscription::paypalSubscribe"))})}else a&&a("noToken","Failed to get Google Account")})},e.prototype.getSubscriptionFromServer=function(a){var b=this;b._getToken(function(c){c?(console.log("IdentityInterface.getSubscription: Got token."),b._videostreamRequest("POST","/subscribed",{key:c},function(c,d){!c&&d?(console.debug("IdentityInterface.getSubscription:",d),a&&a(null,d),b.cache.set("identitySubscription",d,Date.now()+24192e5),b.emit("subscription",d)):(console.debug("IdentityInterface.getSubscription: No response."),a&&a(c||"noResponse",null))})):(console.debug("IdentityInterface.getSubscription: No token."),a&&a("noToken",null))})},e.prototype.getAndroidSubscriptionVerification=function(a){var b=this;this._getAndroidSubscription(function(c,d){if(c&&d){var e={subscriptionId:c,token:d};b._videostreamRequest("GET","/android-subscription-verification",e,function(c,d){!c&&d?(console.log(d),d.isSubscribed?(b.cache.set("identitySubscription",d,Date.now()+432e6),b.emit("subscription",d),a&&a(null,d)):(b.cache.unset("androidSubscriptionId"),b.cache.unset("androidPurchaseToken"),b.getSubscriptionFromServer(a))):a&&a(c||"noResponse")})}else a&&a("noPurchase",null)})},e.prototype.getAndroidProductVerification=function(a){var b=this;this._getAndroidSubscription(function(c,d){if(c&&d){var e={productId:c,token:d};b._videostreamRequest("GET","/android-product-verification",e,function(c,d){!c&&d?(console.log(d),d.isSubscribed?(b.cache.set("identitySubscription",d,Date.now()+432e6),b.emit("subscription",d),a&&a(null,d)):(b.cache.unset("androidSubscriptionId"),b.cache.unset("androidPurchaseToken"),b.getSubscriptionFromServer(a))):a&&a(c||"noResponse")})}else a&&a("noPurchase",null)})},e.prototype.setAndroidSubscription=function(a,b){var c=this;a&&b&&this.cache.get("androidPurchaseToken",function(d){d!==b&&(c.cache.set("androidSubscriptionId",a,Date.now()+432e6),c.cache.set("androidPurchaseToken",b,Date.now()+432e6),c.cache.get("identitySubscription",function(a){a&&a.isSubscribed!==!1||(c.cache.unset("identitySubscription"),c.getSubscription())}))})},e.prototype._getAndroidSubscription=function(a){function b(a){g.cache.get("androidSubscriptionId",function(b){e=b,a()})}function c(a){g.cache.get("androidPurchaseToken",function(b){f=b,a()})}function d(){a&&a(e,f)}var e,f,g=this;async.waterfall([b,c],d)},e.prototype.getCheckoutUrl=function(a,b,c){var d=this;this._getToken(function(e){var f=d.url+"/paypal/create-subscription?key="+e+"&type="+a;b&&(f+="&isCanada=true"),c(null,f)})},e.prototype._videostreamRequest=function(a,b,c,d){null==d&&"function"==typeof c&&(d=c,c={});for(var e=new XMLHttpRequest,f="",g=Object.keys(c),h=0;h<g.length;h++)f+=encodeURIComponent(g[h])+"="+encodeURIComponent(c[g[h]])+"&";"GET"===a&&g.length>0?e.open(a,this.url+b+"?"+f):e.open(a,this.url+b),e.onload=function(){if(200===this.status){var a=null,b=null;try{a=JSON.parse(this.response)}catch(c){b=c,a=null}d&&d(b,a)}else d&&d(this.status)},"GET"!==a&&e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(f)},e.prototype._getToken=function(b){var c=this;a.permissions.contains({permissions:["identity"]},function(d){d?a.identity.getAuthToken({interactive:!1},b):(console.log('App does not have the "identity" permission.'),c.emit("requestPermissions",b))})},e.prototype._getTokenInteractive=function(b){console.log("identity::_getTokenInteractive::"),a.identity.getAuthToken({interactive:!0},b)},e.prototype._getTokenNonInteractive=function(b){console.log("identity::_getTokenNonInteractive::"),a.identity.getAuthToken({interactive:!1},b)},e.prototype.removeToken=function(b){b||(b=function(){console.log("TOKEN REMOVEDDDDDDDD")}),this._getToken(function(c){console.log("removetoken",c),c&&a.identity.removeCachedAuthToken({token:c},b)})},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:b.IdentityInterface=e}(b);var d=function(a,b){this._settings=inject("VideostreamSettings"),this.available_queries=d.MAX_API_QUERY,this.available_connections=d.MAX_API_CONNECTIONS,this.waiting_queries=[],this._settings.getUniqueId(function(a){this._userId=a}.bind(this)),this._appId=a,this._apiKey=b};d.MAX_API_QUERY=30,d.MAX_API_CONNECTIONS=30,d.MAX_API_QUERY_TIME=1e3,d.prototype._onQueryAvailable=function(){if(0!=this.available_queries&&0!=this.available_connections){var a=this.waiting_queries.shift();a&&this._query(a.url,a.query,a.resolve,a.reject)}},d.prototype.query=function(a,b){var c=this;return b=b||{},new Promise(function(d,e){return 0==c.available_queries?void c.waiting_queries.push({url:a,query:b,resolve:d,reject:e}):0==c.available_connections?void c.waiting_queries.push({url:a,query:b,resolve:d,reject:e}):void c._query(a,b,d,e)})},d.prototype._query=function(a,b,c,e){var f=this;f.available_connections--,f.available_queries--,setTimeout(function(){f.available_queries++,f._onQueryAvailable()},d.MAX_API_QUERY_TIME);var g=new XMLHttpRequest;g.open("POST",a,!0),g.setRequestHeader("X-Parse-Application-Id",f._appId),g.setRequestHeader("X-Parse-REST-API-Key",f._apiKey),g.setRequestHeader("Content-Type","application/json"),b.userId=this._userId;JSON.stringify(b);g.onload=function(){f.available_connections++,c()},g.onerror=function(){f.available_connections++,e()}},function(b){var c,d=b.EventEmitter||require("lib/EventEmitter"),e=function(){d.call(this)};e.prototype=Object.create(d.prototype),e.getInstance=function(){return c||(c=new e((!0))),c},e.prototype.set=function(b,c,d){var e={};e[b]=c,a.storage.local.set(e,d),this.emit("localchange",b,c),this.emit("change",b,c),this.emit(b+"-changed",c)},e.prototype.remoteSettingChanged=function(a,b){this.emit("change",a,b),this.emit(a+"-changed",b)},e.prototype.onChanged=function(a,b){d.prototype.on.call(this,a+"-changed",b),this.get(a,function(a){b(a)})},e.prototype.removeChangedListener=function(a,b){d.prototype.removeListener.call(this,a+"-changed",b)},e.prototype.get=function(b,c){a.storage.local.get(b,function(a){c&&c(a[b])})},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:b.SettingsStore=e}(b),function(a){var b,c=a.EventEmitter||require("lib/EventEmitter"),d=a.SettingsStore||require("common/SettingsStore"),e=function(){c.call(this),this.settingsStore=d.getInstance()};e.getInstance=function(){return b||(b=new e),b},e.prototype=Object.create(c.prototype),e.prototype.set=function(a,b,c,d){this.settingsStore.set(a,{expiry:c,value:b},d)},e.prototype.get=function(a,b){var c=this;this.settingsStore.get(a,function(d){d&&Date.now()>=d.expiry?(c.settingsStore.set(a,null),b&&b(null)):d?b&&b(d.value):b&&b(d)})},e.prototype.expire=function(a,b,c){var d=this;this.settingsStore.get(a,function(e){d.settingsStore.set(a,e.value,b,c)})},e.prototype.unset=function(a,b){this.settingsStore.set(a,null,b)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:a.SettingsCache=e}(b),function(b){var c,d=b.EventEmitter||require("lib/EventEmitter"),e=function(){d.call(this)};e.getInstance=function(){return c||(c=new e),c},e.prototype=Object.create(d.prototype),e.prototype.set=function(b,c,d){var e={};e[b]=c,a.storage.sync.set(e,d),this.emit("change",b,c)},e.prototype.get=function(b,c){a.storage.sync.get(b,function(a){c&&c(a[b])})},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:b.SyncdSettingsStore=e}(b),function(a){var b,c=a.SettingsCache||require("common/SettingsCache"),d=a.SettingsStore||require("common/SettingsStore"),e=function(){this._settingsCache=c.getInstance(),this._settingsStore=d.getInstance()};e.getInstance=function(){return b||(b=new e),b},e.prototype.on=function(a,b){switch(a){case"registrationIdChanged":this.getRegistrationId(b);break;case"fivePointOnePolicyChanged":this.getFivePointOnePolicy(b);break;case"scaleSettingChanged":this.getScaleSetting(b);break;case"playlistRepeatModeChanged":this.getPlaylistRepeatMode(b);break;case"transcodeQualityChanged":this.getTranscodeQuality(b);break;case"lastPlaylistItemChanged":this.lastPlaylistItem(b);break;case"defaultEncodingChanged":this.getDefaultEncoding(b);break;case"defaultAudioLanguageChanged":this.getDefaultAudioLanguage(b);break;case"defaultSubtitleLanguageChanged":this.getDefaultSubtitleLanguage(b);break;case"subtitleLoadingChanged":this.getSubtitleLoading(b);break;case"remoteSubtitlesEnabledChanged":this.getRemoteSubtitlesEnabled(b);break;case"analyticsOptInChanged":this.getAnalyticsOptIn(b);break;case"resumeOptInChanged":this.getResumeOptIn(b);break;case"localMediaContentSuggestionsOptInChanged":this.getLocalMediaContentSuggestionsOptIn(b);break;case"recentlyDownloadedContentSuggestionsOptInChanged":this.getRecentlyDownloadedContentSuggestionsOptIn(b);break;case"isPlaylistEnabledChanged":this.getPlaylistEnabled(b);break;case"subtitleStylesChanged":this.getSubtitleStyles(b);break;case"libraryRescanDatesChanged":this.getLibraryRescanDates(b);break;case"libraryEntriesChanged":this.getLibraryEntryIds(b);break;case"computerNameChanged":this.getComputerName(b);break;case"portfixStateChanged":this.getPortfixState(b);break;case"watchedFirstVideoChanged":this.getWatchedFirstVideo(b);break;case"launchCountChanged":this.getLaunchCount(b);break;case"receiverVersionChanged":this.getReceiverVersion(b);break;case"stripeSubscriptionCancellationDateChanged":this.getStripeSubscriptionCancellationDate(b);break;case"x264PresetChanged":this.getX264Preset(b);break;case"userHasViewedAuthScreenChanged":this.getUserHasViewedAuthScreen(b);break;case"splashContentImagesOptInChanged":this.getSplashContentImagesOptIn(b);break;case"contentScreenshotOptInChanged":this.getContentScreenshotOptIn(b);break;case"continueWatchingListChanged":this.getContinueWatchingList(b);break;case"libraryVideosChanged":break;case"librarySubtitlesChanged":break;default:this._settingsStore.get(a,b)}a=a.replace("Changed","-changed"),this._settingsStore.on(a,b)},e.prototype.removeListener=function(a,b){a=a.replace("Changed","-changed"),this._settingsStore.removeListener(a,b)},e.prototype.getKeystoneId=function(a){var b=this;return b._keystoneId?void a(b._keystoneId):void this._settingsStore.get("keystoneId",function(c){null==c&&null==b._keystoneId?(c=Uuid.generate()+":"+Uuid.generate(),b._settingsStore.set("keystoneId",c)):null!=b._keystoneId&&(c=b._keystoneId),b._keystoneId=c,a(c)})},e.prototype.getRegistrationId=function(a){this._settingsStore.get("registrationId",a)},e.prototype.setRegistrationId=function(a,b){this._settingsStore.set("registrationId",a,b)},e.prototype.setFivePointOnePolicy=function(a,b){this._settingsStore.set("fivePointOnePolicy",a,b)},e.prototype.getFivePointOnePolicy=function(a){this._settingsStore.get("fivePointOnePolicy",function(b){a&&a(b||MediaSourceFactory.FIVEPOINTONE_DISABLED_PASSTHROUGH)})},e.prototype.setScaleSetting=function(a,b){this._settingsStore.set("scaleSetting",a,b)},e.prototype.getScaleSetting=function(a){this._settingsStore.get("scaleSetting",function(b){a&&a(b||"fit")})},e.prototype.setPlaylistRepeatMode=function(a,b){this._settingsStore.set("playlistRepeatMode",a,b)},e.prototype.getPlaylistRepeatMode=function(a){this._settingsStore.get("playlistRepeatMode",function(b){a&&a(b||"off")})},e.prototype.setTranscodeQuality=function(a,b){this._settingsStore.set("transcodeQuality",a,b)},e.prototype.getTranscodeQuality=function(a){this._settingsStore.get("transcodeQuality",function(b){a&&a(b||"high")})},e.prototype.lastPlaylistItem=function(a){this._settingsStore.get("lastPlaylistItem",a)},e.prototype.setLastPlaylistItem=function(a,b){this._settingsStore.set("lastPlaylistItem",a,b)},e.prototype.setInstallDate=function(a,b){this._settingsStore.set("installDate",a,b)},e.prototype.getInstallDate=function(a){this._settingsStore.get("installDate",a)},e.prototype.setInstalledVersion=function(a,b){this._settingsStore.set("installedVersion",a,b)},e.prototype.getInstalledVersion=function(a){this._settingsStore.get("installedVersion",a)},e.prototype.getDefaultEncoding=function(a){this._settingsStore.get("defaultEncoding",function(b){a&&a(b||"windows-1252")})},e.prototype.setDefaultEncoding=function(a,b){this._settingsStore.set("defaultEncoding",a,b)},e.prototype.setDefaultAudioLanguage=function(a,b){this._settingsStore.set("defaultAudioLanguage",a,b)},e.prototype.setDefaultSubtitleLanguage=function(a,b){this._settingsStore.set("defaultSubtitleLanguage",a,b)},e.prototype.getDefaultAudioLanguage=function(a){this._settingsStore.get("defaultAudioLanguage",function(b){var c=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;c=c.substr(0,2),a&&a(b||c)})},e.prototype.getDefaultSubtitleLanguage=function(a){this._settingsStore.get("defaultSubtitleLanguage",function(b){var c=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;c=c.substr(0,2),a&&a(b||c)})},e.prototype.setSubtitleLoading=function(a,b){this._settingsStore.set("subtitleLoading",a,b)},e.prototype.getSubtitleLoading=function(a){var b=this;this._settingsStore.get("subtitleLoading",function(c){b.getDefaultSubtitleLanguage(function(d){c!==!0&&c!==!1&&(c="en"!==d,b.setSubtitleLoading(c)),a&&a(c)})})},e.prototype.getRemoteSubtitlesEnabled=function(a){this._settingsStore.get("remoteSubtitlesEnabled",function(b){null==b&&(b=!0),a&&a(b)})},e.prototype.setRemoteSubtitlesEnabled=function(a,b){this._settingsStore.set("remoteSubtitlesEnabled",a,b)},e.prototype.getAnalyticsOptIn=function(a){this._settingsStore.get("analyticsOptIn",function(b){null==b&&(b=!0),a(b)})},e.prototype.setAnalyticsOptIn=function(a,b){this._settingsStore.set("analyticsOptIn",a,b)},e.prototype.getResumeOptIn=function(a){this._settingsStore.get("resumeOptIn",function(b){null==b&&(b=!0),a(b)})},e.prototype.setResumeOptIn=function(a,b){this._settingsStore.set("resumeOptIn",a,b)},e.prototype.getLocalMediaContentSuggestionsOptIn=function(a){this._settingsStore.get("localMediaContentSuggestionsOptIn",function(b){null==b&&(b=!0),a(b)})},e.prototype.getRecentlyDownloadedContentSuggestionsOptIn=function(a){this._settingsStore.get("recentlyDownloadedContentSuggestionsOptIn",function(b){null==b&&(b=!0),a(b)})},e.prototype.setLocalMediaContentSuggestionsOptIn=function(a,b){this._settingsStore.set("localMediaContentSuggestionsOptIn",a,b)},e.prototype.setRecentlyDownloadedContentSuggestionsOptIn=function(a,b){this._settingsStore.set("recentlyDownloadedContentSuggestionsOptIn",a,b)},e.prototype.getPlaylistEnabled=function(a){this._settingsStore.get("isPlaylistEnabled",a)},e.prototype.setPlaylistEnabled=function(a,b){this._settingsStore.set("isPlaylistEnabled",a,b)},e.prototype.setSubtitleStyles=function(a,b){this._settingsStore.set("subtitleStyles",a,b)},e.prototype.getSubtitleStyles=function(a){this._settingsStore.get("subtitleStyles",function(b){b||(b={size:"small",position:"bottom",color:"1"}),a&&a(b)})},e.prototype.getLibraryRescanDates=function(a){this._settingsStore.get("libraryRescanDates",function(b){if(!b){var c=+Date.now();b={},b[FileSystemScanner.DirectoryPriority.VERY_LIKELY]=c-2e3,b[FileSystemScanner.DirectoryPriority.LIKELY]=c-2e3,b[FileSystemScanner.DirectoryPriority.PROBABLE]=c-2e3,b[FileSystemScanner.DirectoryPriority.UNLIKELY]=c-2e3}a&&a(b)})},e.prototype.setLibraryRescanDates=function(a,b){this._settingsStore.set("libraryRescanDates",a,b)},e.prototype.setLibraryLastScanDate=function(a,b){this._settingsStore.set("libraryLastRescanDate",+a,b)},e.prototype.getLibraryLastScanDate=function(a){this._settingsStore.get("libraryLastRescanDate",function(b){b||(b=+Date.now()-2e3),a&&a(new Date(b))})},e.prototype.getLibraryEntryIds=function(a){this._settingsStore.get("libraryEntries",function(b){b||(b=[]),a&&a(b)})},e.prototype.setLibraryEntries=function(a,b){this._settingsStore.set("libraryEntries",a,b)},e.prototype.addLibraryEntryId=function(a,b){var c=this;this._settingsStore.get("libraryEntries",function(d){d.push(a),c.setLibraryEntries(d,b)})},e.prototype.getUniqueId=function(a){var b=this;this._settingsStore.get("uniqueId",function(c){null==c&&(c=Uuid.generate(),b._settingsStore.set("uniqueId",c)),a&&a(c)})},e.prototype.getComputerName=function(a){var b=this;this._settingsStore.get("computerName",function(c){if(!c){var d="What?";navigator.appVersion.indexOf("Win")!=-1&&(d="Windows"),navigator.appVersion.indexOf("Mac")!=-1&&(d="Mac"),navigator.appVersion.indexOf("Linux")!=-1&&(d="Linux"),c="Videostream for "+d,b.setComputerName(c)}a(c)})},e.prototype.setComputerName=function(a,b){this._settingsStore.set("computerName",a,b)},e.prototype.getTrialInformation=function(a){var b=this;this._settingsStore.get("trialInformation",function(c){var d=!1;c||(c={},d=!0),void 0===c.remainingDownloadNotifications&&(c.remainingDownloadNotifications=10,d=!0),d&&b.setTrialInformation(c),a&&a(c)})},e.prototype.setTrialInformation=function(a,b){this._settingsStore.set("trialInformation",a,b)},e.prototype.getPortfixState=function(a){var b=this;this._settingsStore.get("portfixState",function(c){null==c&&(c=!1,b._settingsStore.set("portfixState",c)),a&&a(c)})},e.prototype.setPortfixState=function(a,b){this._settingsStore.set("portfixState",a,b)},e.prototype.getTotalWatchedTime=function(a){var b=this;this._settingsStore.get("totalWatchedTime",function(c){null==c&&(c=0,b._settingsStore.set("totalWatchedTime",0)),a&&a(c)})},e.prototype.incrementTotalWatchedTime=function(a,b){var c=this;this._settingsStore.get("totalWatchedTime",function(d){null==d?(d=0,c._settingsStore.set("totalWatchedTime",0)):(d+=a,c._settingsStore.set("totalWatchedTime",d)),b&&b(d)})},e.prototype.getWatchedFirstVideo=function(a){this._settingsStore.get("watchedFirstVideo",function(b){a&&a(b===!0)})},e.prototype.setWatchedFirstVideo=function(a){var b=this;this.getWatchedFirstVideo(function(c){c?a&&a():b._settingsStore.set("watchedFirstVideo",!0,function(){a&&a()})})},e.prototype.getLaunchCount=function(a){var b=this;this._settingsStore.get("launchCount",function(c){null==c&&(c=0,b._settingsStore.set("launchCount",c)),a&&a(c)})},e.prototype.setLaunchCount=function(a,b){this._settingsStore.set("launchCount",a,b)},e.prototype.getReceiverVersion=function(a){this._settingsStore.get("receiverVersion",function(b){a&&a(b)})},e.prototype.setReceiverVersion=function(a,b){this._settingsStore.set("receiverVersion",a,b)},e.prototype.getStripeSubscriptionCancellationDate=function(a){this._settingsStore.get("stripeSubscriptionCancellationDate",function(b){a&&a(b)})},e.prototype.setStripeSubscriptionCancellationDate=function(a,b){this._settingsStore.set("stripeSubscriptionCancellationDate",a,b)},e.prototype.getPaypalSubscriptionCancellationDate=function(a){this._settingsStore.get("paypalSubscriptionCancellationDate",function(b){a&&a(b)})},e.prototype.setPaypalSubscriptionCancellationDate=function(a,b){this._settingsStore.set("paypalSubscriptionCancellationDate",a,b)},e.prototype.getLocationCached=function(a){var b="VideoStreamSettingsLocationOfIp",c=this;this._settingsCache.get(b,function(b){b?c._parseLocation(b,a):a("NotCached",null)})},e.prototype.getLocation=function(a){var b="VideoStreamSettingsLocationOfIp",c=this;this._settingsCache.get(b,function(d){if(d)c._parseLocation(d,a);else{var e="https://identity.getvideostream.com/location",f=new XMLHttpRequest;f.open("GET",e,!0),f.onreadystatechange=function(){if(4==this.readyState){var d=null;try{d=JSON.parse(this.response)}catch(b){return a("error parsing responseFromWebsite",null),void console.error("VideostreamSettings.getLocation: Error parsing response from website.")}if(d&&d.success){var e=d.result.slice(1,-1),f=18144e5,g=Date.now()+f;c._settingsCache.set(b,e,g,null),c._parseLocation(e,a)}else a("error parsing responseFromWebsite",null),console.error("VideostreamSettings.getLocation: IP returned error: "+d.reason)}},f.send()}})},e.prototype._parseLocation=function(a,b){var c=null;if(a){var d=JSON.parse(a);c={city:d[0],state:d[1],country:d[2],latitude:d[4],longitude:d[5],countryAbbrev:d[6]}}else console.error("VIDEOSTREAMSETTINGS","_parseLocation error: no location object");b&&b(null,c)},e.prototype.setLastChatRequestDate=function(a){this._settingsStore.set("lastChatRequestDate",a)},e.prototype.getLastChatRequestDate=function(a){this._settingsStore.get("lastChatRequestDate",function(b){a&&a(b||null)})},e.prototype.setHasSubmittedEmail=function(a){this._settingsStore.set("hasSubmittedEmail",a)},e.prototype.getHasSubmittedEmail=function(a){this._settingsStore.get("hasSubmittedEmail",function(b){a&&a(b||!1)})},e.prototype.setLastEmailRequest=function(a){this._settingsStore.set("lastEmailRequest",a)},e.prototype.getLastEmailRequest=function(a){this._settingsStore.get("lastEmailRequest",function(b){a&&a(b||0)})},e.prototype.setSeenPremiumDialogue=function(a){this._settingsStore.set("seenPremiumNotificationDialogue",a)},e.prototype.getSeenPremiumDialogue=function(a){this._settingsStore.get("seenPremiumNotificationDialogue",function(b){a&&a(b||0)})},e.prototype.saveProgress=function(a,b){var c="SAVELASTPROGRESS."+a,d=12096e5,e=Date.now()+d;this._settingsCache.set(c,b,e,null)},e.prototype.getProgress=function(a,b){var c="SAVELASTPROGRESS."+a;this._settingsCache.get(c,function(a){b(a?a:0)})},e.prototype.saveNonResumeProgress=function(a,b){var c="SAVELASTNONRESUMEPROGRESS."+a,d=12096e5,e=Date.now()+d;this._settingsCache.set(c,b,e,null);
},e.prototype.getNonResumeProgress=function(a,b){var c="SAVELASTNONRESUMEPROGRESS."+a;this._settingsCache.get(c,function(a){b(a?a:0)})},e.prototype.deleteProgress=function(a){var b="SAVELASTPROGRESS."+a;this._settingsCache.unset(b,null)},e.prototype.setX264Preset=function(a){this._settingsStore.set("x264Preset",a)},e.prototype.getX264Preset=function(a){this._settingsStore.get("x264Preset",function(b){a&&a(b||"ultrafast")})},e.prototype.saveBitString=function(a,b){var c="BITSTRING."+a,d=12096e5,e=Date.now()+d;this._settingsCache.set(c,b,e,null)},e.prototype.getBitString=function(a,b){var c="BITSTRING."+a;this._settingsCache.get(c,function(a){b(a?a:null)})},e.prototype.setLastUsed=function(a,b){this._settingsStore.set("lastUsed",a,b)},e.prototype.getLastChangeLogVersion=function(a){this._settingsStore.get("lastChangeLogVersion",function(b){a(b||0)})},e.prototype.setLastChangeLogVersion=function(a,b){this._settingsStore.set("lastChangeLogVersion",a,b)},e.prototype.incrementTotalPaused=function(a){function b(a){e._settingsStore.get("totalPauses",function(b){b=b||0,e._settingsStore.set("totalPauses",++b,a)})}function c(a){e._settingsStore.set("dateLastPause",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalBufferingTime=function(a,b){function c(a){f._settingsStore.get("totalBufferingEvents",function(b){b=b||0,f._settingsStore.set("totalBufferingEvents",++b,a)})}function d(b){f._settingsStore.get("totalBufferingTime",function(c){c=c||0,c+=a,f._settingsStore.set("totalBufferingTime",c,b)})}function e(){b&&b()}var f=this;async.parallel([c,d],e)},e.prototype.incrementTotalPlaylistPlays=function(a){function b(a){e._settingsStore.get("totalPlaylistPlays",function(b){b=b||0,e._settingsStore.set("totalPlaylistPlays",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastPlaylistPlay",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalLibraryPlays=function(a){function b(a){e._settingsStore.get("totalLibraryPlays",function(b){b=b||0,e._settingsStore.set("totalLibraryPlays",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastLibraryPlay",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalButtonPlays=function(a){function b(a){e._settingsStore.get("totalButtonPlays",function(b){b=b||0,e._settingsStore.set("totalButtonPlays",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastButtonPlay",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalVideosLoaded=function(a){function b(a){e._settingsStore.get("totalVideosLoaded",function(b){b=b||0,e._settingsStore.set("totalVideosLoaded",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastVideoLoaded",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalLoadSuccesses=function(a){function b(a){e._settingsStore.get("totalLoadSuccesses",function(b){b=b||0,e._settingsStore.set("totalLoadSuccesses",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastLoadSuccess",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalLoadFailures=function(a){function b(a){e._settingsStore.get("totalLoadFailures",function(b){b=b||0,e._settingsStore.set("totalLoadFailures",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastLoadFailure",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalSubtitlesLoaded=function(a){function b(a){e._settingsStore.get("totalSubtitlesLoaded",function(b){b=b||0,e._settingsStore.set("totalSubtitlesLoaded",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastSubtitleLoaded",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.incrementTotalVideoTranscodes=function(a){function b(a){e._settingsStore.get("totalVideoTranscodes",function(b){b=b||0,e._settingsStore.set("totalVideoTranscodes",++b,function(){a()})})}function c(a){e._settingsStore.set("dateLastVideoTranscode",Date.now(),a)}function d(){a&&a()}var e=this;async.parallel([b,c],d)},e.prototype.setDateUserLoggedIn=function(a,b){this._settingsStore.set("dateUserLoggedIn",a,b)},e.prototype.setUserHasViewedAuthScreen=function(a,b){this._settingsStore.set("userHasViewedAuthScreen",a,b)},e.prototype.getUserHasViewedAuthScreen=function(a){this._settingsStore.get("userHasViewedAuthScreen",function(b){a&&a(b||!1)})},e.prototype.setLastCrawlTime=function(a,b){this._settingsStore.set("lastCrawlTime",a,b)},e.prototype.getLastCrawlTime=function(a){this._settingsStore.get("lastCrawlTime",function(b){a&&a(b||0)})},e.prototype.setSplashContentImagesOptIn=function(a,b){this._settingsStore.set("splashContentImagesOptIn",a,b)},e.prototype.getSplashContentImagesOptIn=function(a){this._settingsStore.get("splashContentImagesOptIn",function(b){null==b&&(b=!0),a&&a(b)})},e.prototype.setContentScreenshotOptIn=function(a,b){this._settingsStore.set("contentScreenshotOptIn",a,b)},e.prototype.getContentScreenshotOptIn=function(a){this._settingsStore.get("contentScreenshotOptIn",function(b){null==b&&(b=!0),a&&a(b)})},e.prototype.updateContinueWatchingList=function(a,b){this._settingsStore.set("continueWatchingList",a,b)},e.prototype.getContinueWatchingList=function(a){this._settingsStore.get("continueWatchingList",function(b){a&&a(b||[])})},e.prototype.getClientUUID=function(a){var b=this;this._settingsStore.get("clientUUID",function(c){c||(c=uuid.v4(),b._settingsStore.set("clientUUID",c)),a&&a(c)})},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:a.VideostreamSettings=e}(b);var e=function(a,b){EventEmitter.call(this),this.list={},this.container=a,this._listLocked=!1,b.addEventListener("click",this._onAddLibraryDirectory.bind(this))};e.prototype=Object.create(EventEmitter.prototype),e.prototype.getCount=function(){return Object.keys(this.list).length},e.prototype.scanStarted=function(){this.container.classList.add("scan-in-progress"),this._listLocked=!0,this.emit("scan-has-started-add-file-dialog")},e.prototype.scanEnded=function(){this.container.classList.remove("scan-in-progress"),this._listLocked=!1,this.emit("scan-is-done-add-file-dialog")},e.prototype.addLibrary=function(a){var b=new f(a);b.on("remove",this._onRemoveLibraryDirectory.bind(this,b.libraryPath)),this.list[a]=b,this.container.appendChild(b.el),b.blink()},e.prototype.addLibraryDirectories=function(a){var b=this;async.each(a,function(a,c){b.addLibrary(a),c()})},e.prototype.removeLibraryDirectories=function(a){var b=this;async.each(a,function(a,c){b.list[a].el.parentElement.removeChild(b.list[a].el),delete b.list[a],c()})},e.prototype.addLibraryDirectoryDuplicate=function(a){console.log("duplicate::",a)},e.prototype.setLibraryDirectories=function(a){for(;this.container.hasChildNodes();)this.container.removeChild(this.container.lastChild);this.addLibraryDirectories(a)},e.prototype._onRemoveLibraryDirectory=function(a){this._listLocked||this.emit("remove-directory",a)},e.prototype._onAddLibraryDirectory=function(){this.emit("add-directory")},e.prototype._onLibraryDirectoriesRemoved=function(a){console.log("SettingsDialogLibrary.prototype._onLibraryDirectoriesRemoved::",a),this.removeLibraryDirectories(a)},e.prototype._onLibraryDirectoriesAdded=function(a){console.log("SettingsDialogLibrary.prototype._onLibraryDirectoriesAdded::",a),this.addLibraryDirectories(a)},e.prototype._onLibraryDirectoriesAddedDuplicate=function(a){console.log("SettingsDialogLibrary.prototype._onLibraryDirectoriesAddedDuplicate::",a);var b=this;async.each(a,function(a,c){b.list[a].blink(),c()})};var f=function(a){EventEmitter.call(this),this.libraryPath=a,this.el=document.createElement("li"),this.el.classList.add("folder-item");var b=document.createElement("div");b.textContent=a,b.classList.add("library-item-title"),this.el.appendChild(b);var c=document.createElement("div");c.classList.add("library-syncing"),this.el.appendChild(c);var d=document.createElement("div");d.classList.add("loader"),c.appendChild(d);var e=document.createElement("div");e.classList.add("flipper"),d.appendChild(e);var f=document.createElement("div");f.classList.add("front"),e.appendChild(f);var g=document.createElement("div");g.classList.add("back"),e.appendChild(g);var h=document.createElement("div");h.textContent="Scanning",c.appendChild(h);var i=document.createElement("button");"library-item-remove-button button-flat button-small button-clear-grey-alt dobby dobby-x".split(" ").forEach(function(a){i.classList.add(a)}),i.addEventListener("click",this._onRemoveLibraryDirectory.bind(this)),this.el.appendChild(i)};f.prototype=Object.create(EventEmitter.prototype),f.prototype._onRemoveLibraryDirectory=function(){this.emit("remove")},f.prototype.blink=function(){this.el.classList.add("library-blink"),setTimeout(function(){this.el.classList.remove("library-blink")}.bind(this),3e3)},function(b){function c(a){var b=new Date(a);return b.getUTCMonth()+1+"/"+b.getUTCDate()+"/"+b.getUTCFullYear()}var d,e=b.EventEmitter||require("lib/EventEmitter"),f=b.analytics||require("lib/google-analytics-bundle"),g=b.SettingsStore||require("common/SettingsStore"),h=b.SyncdSettingsStore||require("common/SyncdSettingsStore"),i=b.VideostreamSettings||require("common/Settings"),j=function(){var a=this;e.call(this),this._service=f.getService("ChromestreamApp"),this._parse=inject("ParseAPI");var b;this._service.getConfig().addCallback(function(a){b=a}),this._tracker=this._service.getTracker("UA-36247732-8"),this._lastProgressEventDate=Date.now(),this._filename="",this._title="",this._subtitle="",this._sentEvents={},this._todaySentEvents={},this._goals={},this._installedVersion=-1,this._settingsStore=g.getInstance(),this._syncdSettingsStore=h.getInstance(),this._settings=i.getInstance(),this._lastProgressEventTime=0,this._currentRunningTime=0,this.enableLog=!0,this._settings.getInstallDate(function(b){a._installDate=b}),this._settingsStore.get("isMobileLoadedMediaUser",function(b){a._isMobileLoadedMediaUser=b}),this._settingsStore.get("isMobileRemoteControlUser",function(b){a._isMobileRemoteControlUser=b}),this._settingsStore.get("isMobilePairedUser",function(b){a._isMobilePairedUser=b})};j.getInstance=function(){return d||(d=new j),d},j.prototype=Object.create(e.prototype),j.prototype.sendEvent=function(){var a=[].slice.call(arguments);if(this.enableLog)switch(a.length){case 1:console.debug("AnalyticsInterface.sendEvent",a[0]);break;case 2:console.debug("AnalyticsInterface.sendEvent",a[0],a[1]);break;case 3:console.debug("AnalyticsInterface.sendEvent",a[0],a[1],a[2]);break;case 4:console.debug("AnalyticsInterface.sendEvent",a[0],a[1],a[2],a[3])}this._tracker.sendEvent.apply(this._tracker,a)},j.prototype.sendAppView=function(a){console.debug("AnalyticsInterface.sendAppView",a),this._tracker.sendAppView(a)},j.prototype.hijackEvents=function(a){j.prototype.sendEvent=a},j.prototype.hijackAppViews=function(a){j.prototype.sendAppView=a},j.prototype.sendSplitEvent=function(a,b){if(this._splitTestGroups)for(var c=0;c<this._splitTestGroups.length;c++){var d="SplitEventsSentOnce";b&&(d+=b),this.sendEvent(d,this._splitTestGroups[c],a);var e="v"+this._installedVersion;b&&(e+=b),this.sendEvent(e,this._splitTestGroups[c],a)}},j.prototype.sendSplitEventForFirstTime=function(a,b){var c=this;if(!this._sentEvents[a]){if(!this._sentEvents.hasOwnProperty(a))return void this._settingsStore.get(a,function(d){var e=d;c._sentEvents[a]=e,e||c.sendSplitEventForFirstTime(a,b)});if(this._splitTestGroups)for(var d=0;d<this._splitTestGroups.length;d++){var e="SplitEventsSentOnce";b&&(e+=b),this.sendEvent(e,this._splitTestGroups[d],a);var f="v"+this._installedVersion;b&&(f+=b),this.sendEvent(f,this._splitTestGroups[d],a)}this._sentEvents[a]=!0,this._settingsStore.set(a,!0)}},j.prototype.sendEventForFirstTime=function(a,b,c){var d=this,e=a;if(b&&(e+=", "+b,c&&(e+=", "+c)),!this._sentEvents[e]){if(!this._sentEvents.hasOwnProperty(e))return void this._settingsStore.get(e,function(f){var g=f;g||(b?c?d.sendEvent(a,b,c):d.sendEvent(a,b):d.sendEvent(a)),d._sentEvents[e]=!0,d._settingsStore.set(e,!0)});this.sendEvent(a,b,c),this._sentEvents[e]=!0,this._settingsStore.set(e,!0)}},j.prototype.sendEventOnceToday=function(a,b,c){var d=this,e=a;b&&(e+=", "+b,c&&(e+=", "+c)),this._todaySentEvents[e]||(this._todaySentEvents[e]=!0,this._settingsStore.get("onceToday:"+e,function(f){if(f=f||0,f<Date.now()){d.sendEvent(a,b,c);var g=new Date;g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0),g=g.getTime()+864e5,d._settingsStore.set("onceToday:"+e,g,function(){d._todaySentEvents[e]=!1})}else d._todaySentEvents[e]=!1}))},j.prototype._createNewGoal=function(a){var b=this,c="goal-"+a,d="created",e="reached";if(this._goals[a]!==d&&this._goals[a]!==e){if(!this._goals.hasOwnProperty(a))return void this._settingsStore.get(c,function(f){var g=f;g!==d&&g!==e&&(b.sendEvent("v"+b._installedVersion+"-goal",a,d),b._goals[a]=d,b._settingsStore.set(c,d))});this.sendEvent("v"+this._installedVersion+"-goal",a,d),this._goals[a]=d,this._settingsStore.set(c,d)}},j.prototype._reachGoal=function(a){var b=this,c="goal-"+a,d="created",e="reached";if(this._goals[a]!==e){if(!this._goals.hasOwnProperty(a))return void this._settingsStore.get(c,function(f){var g=f;g===d&&(b.sendEvent("v"+b._installedVersion+"-goal",a,e),b._goals[a]=e,b._settingsStore.set(c,e))});this.sendEvent("v"+this._installedVersion+"-goal",a,e),this._goals[a]=e,this._settingsStore.set(c,e)}},j.prototype.triggerGoalCreated=function(a){for(var b=0;b<this._splitTestGroups.length;b++)this._createNewGoal(this._splitTestGroups[b]+"-"+a)},j.prototype.triggerGoalReached=function(a){for(var b=0;b<this._splitTestGroups.length;b++)this._reachGoal(this._splitTestGroups[b]+"-"+a)},j.prototype.setInstalledVersion=function(a){this._installedVersion=a},j.prototype.setInstallDate=function(a){this._installDate=a},j.prototype.setSplitGroups=function(a){this._splitTestGroups=a},j.prototype.triggerUserCpu=function(){var b=this;a.system.cpu.getInfo(function(a){b._cpuModel=a.modelName,console.log("User CPU: "+b._cpuModel);var c=864e5,d=7*c*8;Date.now()-b._installDate<c?b.sendEventForFirstTime("User CPU 2","Under A Day",b._cpuModel):Date.now()-b._installDate>d&&b.sendEventForFirstTime("User CPU 2","Over Two Months",b._cpuModel),b.sendEventForFirstTime("User CPU 2","All Users",b._cpuModel)})},j.prototype._triggerDailyActive=function(){var a=new Date(Date.now()),b=a.getUTCDate()+"/"+(a.getUTCMonth()+1)+"/"+a.getUTCFullYear();this.sendEventForFirstTime("Daily Active",b);var c=inject("SplitTestController").getTestGroup("oldUserGroup");"control"===c?this.sendEventForFirstTime("Daily Active - July 10 - Control",b):"master"===c&&this.sendEventForFirstTime("Daily Active - July 10 - Master",b),this._isMobileLoadedMediaUser&&this.sendEventForFirstTime("Daily Active Mobile Loaded Media User",b),this._isMobileRemoteControlUser&&this.sendEventForFirstTime("Daily Active Mobile Remote Control User",b),this._isMobilePairedUser&&this.sendEventForFirstTime("Daily Active Mobile Paired User",b)},j.prototype._triggerWeeklyActive=function(){var a=new Date(Date.now()),b=a.getUTCDay(),c=0;b<5?c=-b-2:b>5&&(c=-b+5),c=1e3*c*60*60*24;var d=new Date(Date.now()+c),e=d.getUTCDate()+"/"+(d.getUTCMonth()+1)+"/"+d.getUTCFullYear();this.sendEventForFirstTime("Weekly Active",e),this.sendEventForFirstTime("Weekly Active 2015.04.21",e);var f=inject("SplitTestController").getTestGroup("oldUserGroup");"control"===f?this.sendEventForFirstTime("Weekly Active - July 10 - Control",e):"master"===f&&this.sendEventForFirstTime("Weekly Active - July 10 - Master",e),this._isMobileLoadedMediaUser&&this.sendEventForFirstTime("Weekly Active Mobile Loaded Media User",e),this._isMobileRemoteControlUser&&this.sendEventForFirstTime("Weekly Active Mobile Remote Control User",e),this._isMobilePairedUser&&this.sendEventForFirstTime("Weekly Active Mobile Paired User",e)},j.prototype.triggerAppStarted=function(){this.sendEvent("Started App"),this.sendSplitEventForFirstTime("Started App")},j.prototype.triggerAppLoaded=function(){this.sendEvent("Loaded App"),this.sendSplitEventForFirstTime("Loaded App")},j.prototype.triggerFirewallRetry=function(){this.sendEvent("Playback","Firewall Retry Attempt"),this.sendAppView("Firewall_Retry")},j.prototype.triggerFirewallPortFixDownload=function(){this.sendEvent("Playback","Firewall Portfix Download"),this.sendAppView("Firewall_Portfix_Download")},j.prototype.triggerChromecastNotFound=function(){this.sendEvent("Chromecast","Not Found")},j.prototype.triggerChromecastTimeoutReinitializeFailure=function(){this.sendEvent("BackgroundChromecast","reinitialize-failure")},j.prototype.triggerChromecastTimeout=function(){this.sendEvent("BackgroundChromecast","timeout-attempting-reinitialize")},j.prototype.triggerButtonPressed=function(a){this.sendEventForFirstTime("Button Pressed",a)},j.prototype.triggerPickFile=function(a){this.sendSplitEventForFirstTime("Pick File Button")},j.prototype.triggerLoadMovie=function(a,b,c){this._title=a,this._subtitle=b,this._filename=c,this.sendEvent("FilePicked",this._filename),this.sendSplitEventForFirstTime("File Picked")},j.prototype.triggerPlaying=function(){function a(){var a=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!a&&parseInt(a[2],10)}this.sendEvent("Play",this._filename),this.sendEvent("Chrome Version",a()),this.calculateBuffering()},j.prototype.triggerPaused=function(){this.sendEvent("Pause",this._filename),this._settings.incrementTotalPaused(),this.calculateBuffering()},j.prototype.triggerStopped=function(){this.sendEvent("Stop",this._filename),this.calculateBuffering()},j.prototype.calculateBuffering=function(){if(this._mediaBufferTime){var a=(Date.now()-this._mediaBufferTime)/1e3;this._settings.incrementTotalBufferingTime(a),this._mediaBufferTime=null}},j.prototype.triggerMovieProgress=function(a){var b=this;if(!this._lastProgressEventDate||Date.now()-this._lastProgressEventDate>6e4){this._lastProgressEventDate=Date.now();var c=this._title;this._subtitle&&(c+=" "+this._subtitle),this.sendEvent("NewMovieProgress",c,this._filename),this.sendSplitEventForFirstTime("File started playing"),this._triggerDailyActive(),this._triggerWeeklyActive(),this._settings.incrementTotalWatchedTime(this._currentRunningTime,function(a){b._triggerTotalWatchedProgress(a)}),this._currentRunningTime=0}var d=a-this._lastProgressEventTime;d>0&&d<15&&(this._currentRunningTime+=d),this._lastProgressEventTime=a,this._triggerTotalWatchedProgress(this._currentRunningTime)},j.prototype._triggerTotalWatchedProgress=function(a){a>1&&(this.sendEventForFirstTime("Total watched duration","1 second"),this.sendSplitEventForFirstTime("1 second","-watched")),a>30&&(this.sendEventForFirstTime("Total watched duration","30 second"),this.sendSplitEventForFirstTime("30 second","-watched")),a>60&&(this.sendEventForFirstTime("Total watched duration","1 minute"),this.sendSplitEventForFirstTime("1 minute","-watched")),a>120&&(this.sendEventForFirstTime("Total watched duration","2 minutes"),this.sendSplitEventForFirstTime("2 minute","-watched")),a>180&&(this.sendEventForFirstTime("Total watched duration","3 minutes"),this.sendSplitEventForFirstTime("3 minute","-watched")),a>300&&(this.sendEventForFirstTime("Total watched duration","5 minutes"),this.sendSplitEventForFirstTime("5 minutes","-watched")),a>600&&(this.sendEventForFirstTime("Total watched duration","10 minutes"),this.sendSplitEventForFirstTime("10 minutes","-watched")),a>1200&&(this.sendEventForFirstTime("Total watched duration","20 minutes"),this.sendSplitEventForFirstTime("20 minutes","-watched")),a>1800&&(this.sendEventForFirstTime("Total watched duration","30 minutes"),this.sendSplitEventForFirstTime("30 minutes","-watched")),a>3600&&(this.sendEventForFirstTime("Total watched duration","1 hour"),this.sendSplitEventForFirstTime("1 hour","-watched")),a>7200&&(this.sendEventForFirstTime("Total watched duration","2 hour"),this.sendSplitEventForFirstTime("2 hour","-watched")),a>10800&&(this.sendEventForFirstTime("Total watched duration","3 hour"),this.sendSplitEventForFirstTime("3 hour","-watched")),a>18e3&&(this.sendEventForFirstTime("Total watched duration","5 hour"),this.sendSplitEventForFirstTime("5 hour","-watched")),a>36e3&&(this.sendEventForFirstTime("Total watched duration","10 hour"),this.sendSplitEventForFirstTime("10 hour","-watched")),a>72e3&&(this.sendEventForFirstTime("Total watched duration","20 hour"),this.sendSplitEventForFirstTime("20 hour","-watched")),a>18e4&&(this.sendEventForFirstTime("Total watched duration","50 hour"),this.sendSplitEventForFirstTime("50 hour","-watched")),a>36e4&&(this.sendEventForFirstTime("Total watched duration","100 hour"),this.sendSplitEventForFirstTime("100 hour","-watched"))},j.prototype.logBrowserVersion=function(a){this.sendEventForFirstTime("Chromecast","Browser",a)},j.prototype.triggerSubtitlesLoaded=function(a,b){this.sendEvent("SubtitlesLoaded",a,b)},j.prototype.triggerInternalSRTSubtitleLoaded=function(){this.sendEvent("internalSRTSubtitleLoaded")},j.prototype.triggerSplitTests=function(a){for(var b=0;b<a.length;b++)this.sendEvent("splitTest",a[b]);this._splitTestGroups=a},j.prototype.triggerProbeActive=function(){this.sendEvent("ProbeActive")},j.prototype.triggerProbeComplete=function(){this.sendEvent("ProbeComplete")},j.prototype.triggerPlaylistNext=function(){this.sendEvent("playlistNext")},j.prototype.triggerPlaylistPrevious=function(){this.sendEvent("playlistPrevious")},j.prototype.triggerPremiumCheckoutLoaded=function(){this.sendEvent("Premium Checkout");var a=inject("SplitTestController").getTestGroup("premiumFlow");this.sendEvent("Premium Checkout-"+a)},j.prototype.triggerPremiumPlanSelected=function(a){this.sendEvent("Premium Plan Selected",a)},j.prototype.triggerPremiumPaymentAttempt=function(a){this.sendEvent("Premium Payment Attempt",a);var b=inject("SplitTestController").getTestGroup("premiumFlow");this.sendEvent("Premium Payment Attempt-"+b,a)},j.prototype.triggerPremiumPaymentSuccess=function(a){this.sendEvent("paymentSuccess",a);var b=inject("SplitTestController").getTestGroup("premiumFlow");this.sendEvent("paymentSuccess-"+b,a)},j.prototype.triggerPremiumLoginAttempt=function(a){this.sendEvent("Premium Login Attempt",a)},j.prototype.triggerPremiumLoginSuccess=function(){this.sendEvent("Premium Login Success")},j.prototype.triggerPremiumAbandon=function(){this.sendEvent("Premium Abandon")},j.prototype.triggerSubscriptionCancelled=function(){this.sendEvent("Subscription Cancelled")},j.prototype.sendNotPlaying=function(){this.sendAppView("Not_Playing")},j.prototype.sendVideoQualityView=function(a,b){a!=-1&&(a=null==a?"NT":a<=240?"240p":a<=360?"360p":a<=480?"480p":a<=720?"720p":a<=1080?"1080p":"BufferCity",b=b||"Original",this.sendAppView("Play_"+a+"_"+b))},j.prototype.qualityPresetSelected=function(a){var b="Original";null!=a&&(b=a.name),this.sendEvent("Playback","Quality Preset Selected",b)},j.prototype.qualityPresetsOpened=function(){this.sendEvent("Playback","Quality Presets Opened")},j.prototype.triggerNativeMissingPlugin=function(){this.sendEvent("Native","Missing Plugin")},j.prototype.triggerNativeStartupCrash=function(){this.sendEvent("Native","Startup Crash")},j.prototype.triggerNativeLoading=function(){this.sendEvent("Native","Loading")},j.prototype.triggerNativeCommunicationFailure=function(){this.sendEvent("Native","Ping Failure")},j.prototype.triggerNativeCrash=function(b){if(!inject._forceAssembly&&!inject._forceFFmpegAssembly){this.sendEvent("Native","Crash",b);var c=a.runtime.getManifest(),d=c?c.version:"0.0.0.0",e={filename:this._filename,testgroup:inject("SplitTestController").getTestGroupString(),cpu:this._cpuModel,version:d},f=inject("VideostreamNativeModule"),g=f&&f.arch();g&&(e.arch=g);var h=inject("PlaybackController");h&&(e.lastPlaybackEvent=h._lastProgressEvent,e.qualityPreset=h._qualityPreset);var i="https://api.parse.com/1/classes/NativeCrash8";inject("ParseStackTrace").query(i,e)}},j.prototype.triggerNativeCrashRecovery=function(){this.sendEvent("Native","Recovering")},j.prototype.triggerNativeCrashRecoveryFailure=function(a){this.sendEvent("Native","Recovery Failed",a)},j.prototype.triggerNativeCrashRecoverySuccess=function(){this.sendEvent("Native","Recovery Success")},j.prototype.triggerNativeLoaded=function(){this.sendEvent("Native","Loaded")},j.prototype.triggerBindleLoading=function(){this.sendEvent("Bindle","Loading")},j.prototype.triggerBindleLoadFailure=function(a){this.sendEvent("Bindle","Load Failure",a)},j.prototype.triggerBindleLoaded=function(){this.sendEvent("Bindle","Loaded")},j.prototype.triggerScreenshotLoading=function(){this.sendEvent("Screenshot","Loading")},j.prototype.triggerScreenshotLoadFailure=function(a){this.sendEvent("Screenshot","Load Failure",a)},j.prototype.triggerScreenshotLoaded=function(){this.sendEvent("Screenshot","Loaded")},j.prototype.triggerProbeRequest=function(){this.sendEvent("Probe","Requested")},j.prototype.triggerProbeTimedOut=function(){this.sendEvent("Probe","Timed Out")},j.prototype.triggerProbeFileSourceForced=function(){this.sendEvent("Probe","File Source Forced")},j.prototype.triggerProbeFailure=function(a){this.sendEvent("Probe","Failure",a)},j.prototype.triggerProbeSuccess=function(){this._settings.incrementTotalVideosLoaded()},j.prototype.triggerNoCastExtension=function(){this.sendEvent("Chromecast","No Cast Extension")},j.prototype.triggerLoadMedia=function(){this.sendEvent("Playback","Load Media")},j.prototype.triggerIncompatibleFile=function(a){this.sendEvent("Playback","Incompatible File",a),this.sendAppView("Incompatible_File")},j.prototype.triggerNoNetwork=function(){this.sendEvent("Playback","No Network"),this.sendAppView("No_Network")},j.prototype.triggerFirewallBlock=function(){var a;a=navigator.appVersion.indexOf("Win")!=-1?"Windows":navigator.appVersion.indexOf("Mac")!=-1?"OSX":navigator.appVersion.indexOf("Linux")!=-1?"Linux":"Other",this.sendEvent("Playback","Firewall Block",a),this.sendAppView("Firewall_Block")},j.prototype.triggerChromecastConnectTimeout=function(a){this.sendEvent("Chromecast","Connect Timeout",a)},j.prototype.triggerFirewallFalsePositive=function(){this.sendEvent("Playback","Firewall False Positive")},j.prototype.triggerAntivirusBlock=function(){this.sendEvent("Playback","Antivirus Block"),this.sendAppView("Antivirus_Block")},j.prototype.triggerPlaybackLoadError=function(a){this.sendEvent("Playback","Controller Load Failure",a)},j.prototype.triggerLoadCastMediaFailure=function(a){this.sendEvent("Playback","Load Cast Media Failure",a)},j.prototype.triggerLoadedCastMedia=function(){this.sendEvent("Playback","Loaded Media")},j.prototype.triggerMediaTranscodeType=function(a,b){this.sendEvent("Media",a?"Transcoding":"Passthrough",b?"Video":"Not Video")},j.prototype.triggerMediaBuffering=function(a){this._mediaBufferTime=Date.now(),this.sendEvent("Buffering",a?"Transcoding":"Passthrough");var b=inject("SplitTestController").getTestGroup("superHLS");if(a&&b){var c=inject("SplitTestController").isOldUser(),d=inject("SplitTestController").isBrandNewUser();b+=c?"-oldUser":d?"-brandNewUser":"-newUser",this.sendEvent("SuperHLSv4","Buffering-"+b)}},j.prototype.triggerStutterWarning=function(){this.sendEvent("Playback","Stutter Warning")},j.prototype.triggerImageViewed=function(a){this.sendEvent("NewImageProgress",a)},j.prototype.triggerChromecastSessionEvent=function(a){var b=this;inject("SettingsStore").get("watchedFirstVideo",function(c){inject("VideostreamSettings").getInstallDate(function(d){d>=SplitTestController.OLD_USER_CUTOFF&&(c||b.sendEvent("Chromecast-Session-Request",a))})})},j.prototype.triggerAppLauncherUnavailableLaunch=function(){var a=this;inject("SettingsStore").get("appLauncherTestGroup",function(b){a.sendEvent("app-launcher-unavailable","launch",b||"null")})},j.prototype.triggerAppLauncherUnavailableError=function(){var a=this;inject("SettingsStore").get("appLauncherTestGroup",function(b){a.sendEvent("app-launcher-unavailable","receiver_unavailable",b||"null")})},j.prototype._generateDateString=function(){var a=new Date;return a.getFullYear()+"/"+(a.getMonth()+1<10?"0":"")+a.getMonth()+"/"+(a.getDate()<10?"0":"")+a.getDate()},j.prototype.triggerWallFunnel=function(b,c){if(1==b||b===this._lastWallFunnelNumber+1){var d=Date.now(),e=this._lastWallFunnelTime||d,f=(b<=9?"0":"")+b+". "+c;1==b&&(e=d),this._lastWallFunnelNumber=b,this._lastWallFunnelAction=c,this._lastWallFunnelTime=d,Date.now()-this._installDate<864e5?this.sendEvent("wall-funnel-past-day",f,this._generateDateString(),d-e):this._installDate<SplitTestController.OLD_USER_CUTOFF?this.sendEvent("wall-funnel-before-apr-01",f,this._generateDateString(),d-e):this.sendEvent("wall-funnel-after-apr-01",f,this._generateDateString(),d-e),this.sendEventOnceToday("wall-funnel-"+a.runtime.getManifest().version,f,this._generateDateString(),d-e);var g=inject("SplitTestController").getTestGroup("superHLS");if(g){var h=inject("SplitTestController").isOldUser(),i=inject("SplitTestController").isBrandNewUser();g+=h?"-oldUser":i?"-brandNewUser":"-newUser",this.sendEvent("wall-funnel-superhls-v3-"+g,f,this._generateDateString(),d-e)}}},j.prototype.triggerKillSwitchFunnel=function(){var a=Date.now(),b=this._lastWallFunnelTime||a,c=this._lastWallFunnelNumber||0,d=this._lastWallFunnelAction||"null",e=null;null!=d&&(e=(c<=9?"0":"")+c+". "+d),Date.now()-this._installDate<864e5?this.sendEvent("kill-switch-funnel-past-day",e,this._generateDateString(),a-b):this._installDate<SplitTestController.OLD_USER_CUTOFF?this.sendEvent("kill-switch-funnel-before-apr-01",e,this._generateDateString(),a-b):this.sendEvent("kill-switch-funnel-after-apr-01",e,this._generateDateString(),a-b)},j.prototype.startStopwatch=function(a){this._stopwatches||(this._stopwatches={}),this._stopwatches[a]=performance.now()},j.prototype.cancelStopwatch=function(a){this._stopwatches&&this._stopwatches[a]&&delete this._stopwatches[a]},j.prototype.stopStopwatch=function(a){if(this._stopwatches&&this._stopwatches[a]){var b=Math.round(performance.now()-this._stopwatches[a]);delete this._stopwatches[a],this.sendEvent("Profiling","Stopwatch",a,b)}},j.prototype.sendPlaylistPath=function(a){this.sendEvent("PlaylistPath",a)},j.prototype._onMobilePaired=function(){this.sendEvent("MobilePaired")},j.prototype.fileSystemScannerTraversing=function(){this.sendEventOnceToday("FileSystemScanner","Traversal Started Today")},j.prototype.fileSystemScannerTransactionStuck=function(){this.sendEvent("FileSystemScanner","Transaction Stuck"),this.sendEventOnceToday("FileSystemScanner","Transaction Stuck Today")},j.prototype._onMobileLoadMediaSuccess=function(){this.sendEvent("MobileLoadMedia","Success")},j.prototype._onMobileLoadMediaFail=function(a){this.sendEvent("MobileLoadMedia","Fail",a)},j.prototype._onLibraryCreated=function(a){this.sendEventForFirstTime("LibraryCreated",a);var b=this;this._settingsStore.get("library-analytics-level",function(a){a||(a=Math.random(),b._settingsStore.set("library-analytics-level",a))})},j.prototype.scanStarted=function(){var a=this;this._settingsStore.get("library-analytics-level",function(b){null!=b&&b>.98&&a.sendEvent("MediaLibrary","Scan Started")})},j.prototype.scanCompleted=function(){var a=this;this._settingsStore.get("library-analytics-level",function(b){null!=b&&b>.98&&a.sendEvent("MediaLibrary","Scan Completed")})},j.prototype._onPlaying=function(a){this.sendEvent("MobilePlaying",a)},j.prototype._onLibrarySize=function(a){this.sendEvent("LibrarySize",a)},j.prototype._onDownloadComplete=function(a){this.sendEvent("DownloadComplete",a)},j.prototype._onLibraryItemAdded=function(a){var b="https://api.parse.com/1/classes/LibraryItem";this._parse.query(b,a)},j.prototype._onLibraryMovieAdded=function(a){var b="https://api.parse.com/1/classes/LibraryMovie";this._parse.query(b,a)},j.prototype._onLibraryShowAdded=function(a){var b="https://api.parse.com/1/classes/LibraryShow";
this._parse.query(b,a)},j.prototype._onLibrarySubtitleAdded=function(a){var b="https://api.parse.com/1/classes/LibrarySubtitle";this._parse.query(b,a)},j.prototype._onAndroidDownload=function(){this.sendEvent("AndroidDownload")},j.prototype.triggerChooseDevice=function(a){this.sendEvent("ChooseDevice",a)},j.prototype.sendNetworkBufferEvents=function(a,b,c,d){var e=a/1e3/b;this.sendEvent("NETWORK_BUFFER_"+d,c?"TRANSCODE":"NON_TRANSCODE",e)},j.prototype.videoQualitySurveyResult=function(a){this.sendEvent("VideoQualitySurvey",a)},j.prototype._triggerNewInstall=function(){this.sendEventForFirstTime("Install base","New Install")},j.prototype._triggerDuplicateInstall=function(){this.sendEventForFirstTime("Install base","Duplicate Install")},j.prototype.triggerHLSTestStarted=function(){var a=inject("SplitTestController").getTestGroup("superHLS");if(a){var b=inject("SplitTestController").isOldUser(),c=inject("SplitTestController").isBrandNewUser();a+=b?"-oldUser":c?"-brandNewUser":"-newUser",this.sendEvent("SuperHLSv4","Movie Started - "+a)}},j.prototype.triggerHLSVariableSuccess=function(){var a=inject("SplitTestController").getTestGroup("superHLS");if(a){var b=inject("SplitTestController").isOldUser(),c=inject("SplitTestController").isBrandNewUser();a+=b?"-oldUser":c?"-brandNewUser":"-newUser",this.sendEvent("SuperHLSv4","Movie Variable Success - "+a)}},j.prototype.triggerHLSTestEnded=function(){var a=inject("SplitTestController").getTestGroup("superHLS");if(a){var b=inject("SplitTestController").isOldUser(),c=inject("SplitTestController").isBrandNewUser();a+=b?"-oldUser":c?"-brandNewUser":"-newUser",this.sendEvent("SuperHLSv4","Movie Ended - "+a)}},j.prototype.triggerReceiverVersion=function(a){this.sendEvent("Chromecast","Receiver Version",a)},j.prototype.triggerCastApiStatusTrue=function(){this.sendEvent("CastApi","StatusTrue2")},j.prototype.triggerCastApiStatusFalse=function(){this.sendEvent("CastApi","StatusFalse2")},j.prototype.triggerCastApiActionStop=function(){this.sendEvent("CastApi","ActionStop2")},j.prototype.triggerCastApiUnwarrantedDisconnect=function(a){this.sendEvent("CastApi","UnwarrantedDisconnect-"+a)},j.prototype.triggerCastApiUnwarrantedDisconnectUnderTwoMinutes=function(a){this.sendEvent("CastApi","UnwarrantedDisconnectUnderTwoMinutes-"+a)},j.prototype.setMobileLoadedMediaUser=function(){this._isMobileLoadedMediaUser||(this._isMobileLoadedMediaUser=!0,this._settingsStore.set("isMobileLoadedMediaUser",!0,function(){}))},j.prototype.setMobileRemoteControlUser=function(){this._isMobileRemoteControlUser||(this._isMobileRemoteControlUser=!0,this._settingsStore.set("isMobileRemoteControlUser",!0,function(){}))},j.prototype.setMobilePairedUser=function(){this._isMobilePairedUser||(this._isMobilePairedUser=!0,this._settingsStore.set("isMobilePairedUser",!0,function(){}))},j.prototype.triggerExitedDueToBuffering=function(a){this.sendEvent("UserExitedDueToBuffering",a)},j.prototype._connectAndDisconnect=function(b,c,d,e){a.sockets.tcp.connect(b,c,d,function(c){a.sockets.tcp.disconnect(b),e&&e(c>=0)})},j.prototype.onBindFail=function(){this.sendEvent("WebserverBlocked","Failed-Bind")},j.prototype.onRebindSuccess=function(){this.sendEvent("WebserverBlocked","Success-Rebind")},j.prototype.onRebindFail=function(){this.sendEvent("WebserverBlocked","Failed-Rebind")},j.prototype.onRebindPartialFail=function(){this.sendEvent("WebserverBlocked","Partial-Fail-Rebind")},j.prototype.triggerPlayerReloadAttempt=function(){var a=inject("SplitTestController").getTestGroup("playbackControllerReload");a&&(this._playerReloadAttempt=!0,this.sendEvent("Player-Reloader-"+a,"Attempt"))},j.prototype.triggerPlayerReloadSuccess=function(){var a=inject("SplitTestController").getTestGroup("playbackControllerReload");a&&this._playerReloadAttempt===!0&&(this.sendEvent("Player-Reloader-"+a,"Success"),this._playerReloadAttempt=!1)},j.prototype.triggerCastDeviceType=function(a){this.sendEvent("Cast-Device-Type",a)},j.prototype.triggerAndroidTVReset=function(){this._androidTVAttempt=!1,this._androidTVTranscoding=!1},j.prototype.triggerAndroidTVAttempt=function(a){this._androidTVAttempt=!0,this._androidTVTranscoding=a||!1,this.sendEvent("Cast-AndroidTV-"+(a?"Transcode":"Direct"),"Attempt")},j.prototype.triggerAndroidTV20PercentSuccess=function(){this._androidTVAttempt&&this.sendEvent("Cast-AndroidTV-"+(this._androidTVTranscoding?"Transcode":"Direct"),"20 Percent Reached")},j.prototype.triggerAndroidTV80PercentSuccess=function(){this._androidTVAttempt&&(this.sendEvent("Cast-AndroidTV-"+(this._androidTVTranscoding?"Transcode":"Direct"),"80 Percent Reached"),this.triggerAndroidTVReset())},j.prototype.triggerAppLoadedPremiumTest=function(a,b){this.sendEvent("Loaded App - "+a+" - install: "+c(b))},j.prototype.triggerPremiumCheckoutLoadedPremiumTest=function(a,b){this.sendEvent("Premium Checkout - "+a+" - install: "+c(b))},j.prototype.triggerPremiumPlanSelectedPremiumTest=function(a,b,d){this.sendEvent("Premium Plan Selected - "+a+" - plan: "+d+" - install: "+c(b),d)},j.prototype.triggerPremiumPaymentAttemptPremiumTest=function(a,b,d){this.sendEvent("Premium Payment Attempt - "+a+" - plan: "+d+" - install: "+c(b),d)},j.prototype.triggerPremiumPaymentSuccessPremiumTest=function(a,b,d){this.sendEvent("paymentSuccess - "+a+" - plan: "+d+" - install: "+c(b),d)},j.prototype.triggerPremiumAbandonPremiumTest=function(a,b){this.sendEvent("Premium Abandon - "+a+" - install: "+c(b))},j.prototype.triggerSubscriptionCancelledPremiumTest=function(a,b){this.sendEvent("Subscription Cancelled - "+a+" - install: "+c(b))},j.prototype.minidump=function(b,c){var d=a.runtime.getManifest(),e=d?d.version:"0.0.0.0",f={filename:this._filename,testgroup:inject("SplitTestController").getTestGroupString(),cpu:this._cpuModel,version:e,overflowed:c,dump:b},g=inject("PlaybackController");g&&(f.lastPlaybackEvent=g._lastProgressEvent,f.qualityPreset=g._qualityPreset);var h="https://api.parse.com/1/classes/NativeDump";inject("ParseStackTrace").query(h,f)},j.prototype.triggerEmailRequest=function(a){this.sendEvent("EmailRequest","Attempt-"+a)},j.prototype.triggerContactEmail=function(a,b){var c=this;this._settingsStore.get("contactEmailId",function(d){d||c._settings.getInstallDate(function(d){c.sendEvent("EmailRequest","Success-"+b);var e=inject("ParseChurnData");e.createObject("TestData",{email:a,installDate:d},function(a,b){console.log("AnalyticsInterface.triggerContactEmail: COMPLETE",arguments),!a&&b&&c._settingsStore.set("contactEmailId",b)})})})},j.prototype.triggerChurnDataVideoWatched=function(){this._settingsStore.get("contactEmailId",function(a){if(a){var b=inject("ParseChurnData");b.updateObject("TestData",a,{watchedDate:{__op:"Add",objects:[Date.now()]}},function(a){console.log("AnalyticsInterface.triggerChurnDataVideoWatched: COMPLETE",arguments)})}})},j.prototype.triggerChurnDataTotalWatched=function(){var a=this;this._settingsStore.get("contactEmailId",function(b){b&&a._settings.getTotalWatchedTime(function(a){var c=inject("ParseChurnData");c.updateObject("TestData",b,{totalWatchTime:a})},function(a){console.log("AnalyticsInterface.triggerChurnDataTotalWatched: COMPLETE",arguments)})})},j.prototype.triggerChangeLogSeen=function(a){this.sendEvent("ChangeLog-Launched",a)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=j:b.AnalyticsInterface=j,j.prototype.triggerAppLaunched=function(a){if(a){var b="no source",c="no url";a.source&&(b=a.source),a.url&&(c=a.url),this.sendEvent("onboarding",b,c),("url_handler"==b||"url_handlers"==b&&a.referrerUrl)&&this.sendEvent("onboarding","referral",a.referrerUrl)}}}(b);var g={};b.inject=function(a){if(!g[a])switch(a){case"BackgroundCommunicator":g[a]=new h;break;case"PairView":g[a]=new o;break;case"PairCompleteView":g[a]=new p;break;case"IdentityInterface":g[a]=IdentityInterface.getInstance();break;case"SettingsCache":g[a]=SettingsCache.getInstance();break;case"AnalyticsInterface":g[a]=AnalyticsInterface.getInstance();break;case"VideostreamSettings":g[a]=VideostreamSettings.getInstance();break;case"ParseAPI":g[a]=new d("7CLGqKDGPjSekUH5EwvrCe0Ud5QG8wxG3g8GvUPY","7J5gkYCga5klV78iorxTfXg0ozmQnEW5BFRx2yBW");break;case"ParseAPISurvey":g[a]=new d("mfNMNxuMikKp9EUpuiffqNEidopXOP3EH9g3dFkg","rFzHFGPBXjouRGxDGmgTGGvW0nHHykp19IcsrErU");break;case"ParseStackTrace":g[a]=new d("d8JEnkyvw43zWEjTbZHvhinyzs0TPQQYjRusXVZI","InitcQg79D5vgfI9r9balW5pbV3yHIojhREWl5Pk");break;case"PairPromptView":g[a]=new n;break;default:throw new Error("VideostreamApplication: require: Unknown module:"+a)}return g[a]},function(){var b=document.querySelectorAll("[data-localize]"),c=document.querySelectorAll("[data-localize-label]"),d=document.querySelectorAll("[data-localize-title]"),e=document.querySelectorAll("[data-localize-placeholder");!function(){for(var c=0;c<b.length;c++){var d=b[c],e=a.i18n.getMessage(d.getAttribute("data-localize"));e&&null!==e&&(d.innerHTML=e)}}(),function(){for(var b=0;b<c.length;b++){var d=c[b],e=a.i18n.getMessage(d.getAttribute("data-localize-label"));e&&null!==e&&(d.label=e)}}(),function(){for(var b=0;b<d.length;b++){var c=d[b],e=a.i18n.getMessage(c.getAttribute("data-localize-title"));e&&null!==e&&(c.title=e)}}(),function(){for(var b=0;b<e.length;b++){var c=e[b],d=a.i18n.getMessage(c.getAttribute("data-localize-placeholder"));d&&null!==d&&(c.placeholder=d)}}()}();var h=function(){EventEmitter.call(this);var a="PairPopupCommunicator::";this.pairDialogNamespace=a,this.keystoneId=c("keystoneId"),this._proxy=new SuperWorker((!1)),this._proxy.on(a+"library-pair-begin",this._onLibraryPairBegin.bind(this)),this._proxy.on(a+"library-pair-cancel",this._onLibraryPairCancel.bind(this)),this._proxy.on(a+"library-setup",this._onLibrarySetup.bind(this)),this._proxy.on("library-directories-list",this._onLibraryDirectoriesList.bind(this)),this._proxy.on("library-directories-added",this._onLibraryDirectoriesAdded.bind(this)),this._proxy.on("library-directories-added-duplicate",this._onLibraryDirectoriesAddedDuplicate.bind(this)),this._proxy.on("library-directories-removed",this._onLibraryDirectoriesRemoved.bind(this)),this._proxy.on("library-scan-begin",this._onLibraryScanBegin.bind(this)),this._proxy.on("library-scan-end",this._onLibraryScanEnd.bind(this)),this._proxy.on("subtitlePairLoadingChanged",this._onSubtitleLoadingChange.bind(this))};h.prototype=Object.create(EventEmitter.prototype),h.prototype._onLoad=function(){this._proxy.send("popup-loaded",this.keystoneId)},h.prototype.setSubtitleLoading=function(a){this._proxy.send("setSubtitleLoading",a)},h.prototype._onSubtitleLoadingChange=function(a){this.emit("subtitle-loading-change",a)},h.prototype._onLibraryPairBegin=function(){this.emit("library-pair-begin")},h.prototype._onLibraryPairCancel=function(){this.emit("library-pair-cancel")},h.prototype._onLibrarySetup=function(){this.emit("library-setup")},h.prototype._onLibraryDirectoriesList=function(a,b){this.emit("library-directories-list",b)},h.prototype._onLibraryDirectoriesAdded=function(a,b){this.emit("library-directories-added",b)},h.prototype._onLibraryDirectoriesAddedDuplicate=function(a,b){this.emit("library-directories-added-duplicate",b)},h.prototype._onLibraryDirectoriesRemoved=function(a,b){this.emit("library-directories-removed",b)},h.prototype._onLibraryScanBegin=function(){this.emit("library-scan-begin")},h.prototype._onLibraryScanEnd=function(){this.emit("library-scan-end")},h.prototype.libraryAddDirectory=function(){this._proxy.send(this.pairDialogNamespace+"libraryAddDirectory")},h.prototype.libraryRemoveDirectory=function(a){this._proxy.send(this.pairDialogNamespace+"libraryRemoveDirectory",a)},h.prototype.libraryPairDevice=function(){this._proxy.send(this.pairDialogNamespace+"libraryPairDevice")},h.prototype.libraryGetDirectories=function(a){this._proxy.send("libraryGetDirectories",a)},h.prototype._onBeginPair=function(){this.emit("library-pair-begin")},h.prototype._onCancelPair=function(){this.emit("library-pair-cancel")},h.prototype.completePairRequest=function(a){this._proxy.send(this.pairDialogNamespace+"complete-pair-request",this.keystoneId,a)},h.prototype.completePrepair=function(){this._proxy.send(this.pairDialogNamespace+"complete-prepair-request",this.keystoneId)};var i=function(a,b){EventEmitter.call(this),this._el=a,this._checkbox=this._el.children[0],this._label=this._el.children[1],this._isChecked=!1,this._isUncheckable=b,this._isReadOnly=a&&void 0!==a.attributes.readonly,this.setChecked(!1),this._el.addEventListener("click",this._onClick.bind(this)),this._el.addEventListener("mouseover",this._onMouseOver.bind(this)),this._el.addEventListener("mouseout",this._onMouseOut.bind(this))};i.prototype=Object.create(EventEmitter.prototype),i.prototype.setChecked=function(a){this._isChecked=a,a?(this._el.classList.add("checked"),this._checkbox.classList.add("checked")):(this._el.classList.remove("checked"),this._checkbox.classList.remove("checked"))},i.prototype.isChecked=function(){return this._isChecked},i.prototype.getValue=function(){return this._el.getAttribute("value")},i.prototype._onClick=function(){this._isReadOnly||(this._isChecked?this._isUncheckable&&(this.setChecked(!1),this.emit("unchecked")):(this.setChecked(!0),this.emit("checked")))},i.prototype._onMouseOver=function(){this._isReadOnly||(this._el.classList.add("hover"),this._checkbox.classList.add("hover"))},i.prototype._onMouseOut=function(){this._isReadOnly||(this._el.classList.remove("hover"),this._checkbox.classList.remove("hover"))};var j=function(a){i.call(this,a,!1)};j.prototype=Object.create(i.prototype);var k=function(a){i.call(this,a,!0),a.style.transition="border-radius 0.5s ease-in-out",a.style.animation="rotating 2s linear infinite;"};k.prototype=Object.create(i.prototype),k.prototype.check=function(){this._isChecked||(delete this._checkbox.style.borderRadius,this.setChecked(!0),this.emit("checked"))},k.prototype.uncheck=function(){this._isChecked&&this._isUncheckable&&(this.setChecked(!1),this.emit("unchecked"))},k.prototype.startSpinning=function(){this._checkbox.classList.add("checkbox-spin")},k.prototype.stopSpinning=function(){this._checkbox.classList.remove("checkbox-spin")};var l=function(a){EventEmitter.call(this),this._radioButtonList=[],this._checkedRadioButton=null,this._isReadOnly=a.readonly;for(var b=a.querySelectorAll(".radio-button-wrapper"),c=0;c<b.length;c++)this._bindRadioButtonElement(b[c])};l.prototype=Object.create(EventEmitter.prototype),l.prototype._bindRadioButtonElement=function(a){var b=new j(a);b.on("checked",this._onRadioButtonChecked.bind(this,b)),this._radioButtonList.push(b)},l.prototype._onRadioButtonChecked=function(a){for(var b=0;b<this._radioButtonList.length;b++)this._radioButtonList[b]!==a&&this._radioButtonList[b].setChecked(!1);this._checkedRadioButton=a,this.emit("change",a.getValue())},l.prototype.getValue=function(){return null==this._checkedRadioButton?null:this._checkedRadioButton.getValue()},l.prototype.setValue=function(a){for(var b=0;b<this._radioButtonList.length;b++){var c=this._radioButtonList[b];c.getValue()==a?(c.setChecked(!0),this._checkedRadioButton=c):c.setChecked(!1)}};var m=function(a){i.call(this,a,!0)};m.prototype=Object.create(i.prototype);var n=function(){ElementView.call(this,"#pair-prompt-view"),this._pairView=inject("PairView"),this._background=inject("BackgroundCommunicator"),this._pairCompleteView=inject("PairCompleteView");var a="PairPopupCommunicator::";this.pairDialogNamespace=a,this.querySelector("#pair-prompt-view-cancel").addEventListener("click",this._onCancelClick.bind(this));var b=c("deviceName");this._pairDeviceName=this.querySelector("#pair-phone-name"),this._pairDeviceName.innerHTML=b,this._pairDeviceName2=this.querySelector("#pair-phone-name2"),this._pairDeviceName2.innerHTML=b,this.querySelector("#goto-pair-view").addEventListener("click",this._onStartPairClick.bind(this))};n.prototype=Object.create(ElementView.prototype),n.prototype._onCancelClick=function(){a.app.window.current().close()},n.prototype._onStartPairClick=function(){this._background.completePairRequest(),this._pairView._shortPairMode===!0?(this.hide(),this._pairCompleteView.show()):(this.hide(),this._pairView.show())};var o=function(){ElementView.call(this,"#pair-view"),this._directoryCount=0,this._shortPairMode=!1,this._background=inject("BackgroundCommunicator"),this._libraryDialog=new e(this.querySelector("#pair-view-list"),this.querySelector("#button-pair-add")),this._background.on("library-pair-begin",this.show.bind(this)),this._background.on("library-pair-cancel",ElementView.prototype.hide.bind(this)),this._background.on("library-scan-begin",this._libraryDialog.scanStarted.bind(this._libraryDialog)),this._background.on("library-scan-end",this._libraryDialog.scanEnded.bind(this._libraryDialog)),this._background.on("subtitle-loading-change",this._onBackgroundSubtitleLoadingChange.bind(this)),this._finishButton=this.querySelector("#pair-view-finish"),this._finishButton.addEventListener("click",this._onFinishClick.bind(this)),this._subtitleLoadingSwitch=new m(this.querySelector("#subtitle-loading-pair-switch")),this._subtitleLoadingSwitch.on("checked",this._onSubtitleLoadingSwitchChanged.bind(this,!0)),this._subtitleLoadingSwitch.on("unchecked",this._onSubtitleLoadingSwitchChanged.bind(this,!1)),this._pairCompleteView=inject("PairCompleteView"),this._libraryDialog.on("remove-directory",this._background.libraryRemoveDirectory.bind(this._background)),this._libraryDialog.on("add-directory",this._background.libraryAddDirectory.bind(this._background)),this._background.on("library-directories-added",this._validateList.bind(this)),this._background.on("library-directories-list",this._validateList.bind(this)),this._background.on("library-directories-removed",this._validateList.bind(this)),this._background.on("library-directories-list",this._libraryDialog.setLibraryDirectories.bind(this._libraryDialog)),this._background.on("library-directories-added",this._libraryDialog._onLibraryDirectoriesAdded.bind(this._libraryDialog)),this._background.on("library-directories-removed",this._libraryDialog._onLibraryDirectoriesRemoved.bind(this._libraryDialog)),this._background.on("library-directories-added-duplicate",this._libraryDialog._onLibraryDirectoriesAddedDuplicate.bind(this._libraryDialog)),this._background.libraryGetDirectories(),this._background._onLoad()};o.prototype=Object.create(ElementView.prototype),o.prototype._validateList=function(){var a=this;console.log("PairView::_validateList"),this._directoryCount=this._libraryDialog.getCount();var b=a.querySelector("#pair-view-finish"),c=a.querySelector("#pair-view-add-folders");this._directoryCount>0?(c.style.display="none",b.style.removeProperty("display"),this._shortPairMode=!0):(b.style.display="none",c.style.removeProperty("display"),this._shortPairMode=!1)},o.prototype._onBackgroundSubtitleLoadingChange=function(a){this._subtitleLoadingSwitch.setChecked(a)},o.prototype._onSubtitleLoadingSwitchChanged=function(a){this._background.setSubtitleLoading(a)},o.prototype.hide=function(){ElementView.prototype.hide.call(this)},o.prototype._onFinishClick=function(){this._directoryCount>0&&(ElementView.prototype.hide.call(this),this._pairCompleteView.show())},o.prototype._onCancelClick=function(){a.app.window.current().close()};var p=function(){ElementView.call(this,"#pair-complete-view"),this._completeButton=this.querySelector("#pair-complete-view-finish"),this._completeButton.addEventListener("click",this._onCompleteClick.bind(this))};p.prototype=Object.create(ElementView.prototype),p.prototype._onCompleteClick=function(){a.app.window.current().close()},inject("PairView"),inject("PairCompleteView"),inject("PairPromptView")}(chrome,window);